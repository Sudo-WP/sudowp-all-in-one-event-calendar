==================================================
FILE PATH: ./app/config/constants.php
==================================================
<?php

/**
 * Define required constants, if these have not been defined already.
 *
 * @param string $ai1ec_base_dir Sanitized, absolute, path to Ai1EC base dir
 *
 * @uses plugin_basename To determine plug-in folder+file name
 * @uses plugins_url     To determine absolute URI to plug-ins' folder
 * @uses get_option      To fetch 'home' URI value
 *
 * @return void Method does not return
 */
function ai1ec_initiate_constants( $ai1ec_base_dir, $ai1ec_base_url ) {

    // ===============
    // = Plugin Path =
    // ===============
    if ( ! defined( 'AI1EC_PATH' ) ) {
        define( 'AI1EC_PATH', $ai1ec_base_dir );
    }

    // =======================
    // = Extensions base dir =
    // =======================
    if ( ! defined( 'AI1EC_EXTENSIONS_BASEDIR' ) ) {
        define(
            'AI1EC_EXTENSIONS_BASEDIR',
            dirname( $ai1ec_base_dir ) . DIRECTORY_SEPARATOR
        );
    }

    // ===============
    // = Plugin Name =
    // ===============
    if ( ! defined( 'AI1EC_PLUGIN_NAME' ) ) {
        define( 'AI1EC_PLUGIN_NAME', 'all-in-one-event-calendar' );
    }

    // ===================
    // = Plugin Basename =
    // ===================
    if ( ! defined( 'AI1EC_PLUGIN_BASENAME' ) ) {
        $plugin = AI1EC_PATH . DIRECTORY_SEPARATOR . AI1EC_PLUGIN_NAME . '.php';
        define( 'AI1EC_PLUGIN_BASENAME', plugin_basename( $plugin ) );
        unset( $plugin );
    }

    // ==================
    // = Plugin Version =
    // ==================
    if ( ! defined( 'AI1EC_VERSION' ) ) {
define( 'AI1EC_VERSION', '3.0.0' );
    }

    // ================
    // = RSS FEED URL =
    // ================
    if ( ! defined( 'AI1EC_RSS_FEED' ) ) {
        define( 'AI1EC_RSS_FEED',           'https://time.ly/blog/feed/' );
    }

    // =================
    // = Language Path =
    // =================
    if ( ! defined( 'AI1EC_LANGUAGE_PATH' ) ) {
        define(
            'AI1EC_LANGUAGE_PATH',
            AI1EC_PLUGIN_NAME . DIRECTORY_SEPARATOR . 'language' . DIRECTORY_SEPARATOR
        );
    }
    // ================
    // = Cron Version =
    // ================
    if ( ! defined( 'AI1EC_CRON_VERSION' ) ) {
        define( 'AI1EC_CRON_VERSION', AI1EC_VERSION );
    }
    if ( ! defined( 'AI1EC_U_CRON_VERSION' ) ) {
        define( 'AI1EC_U_CRON_VERSION', AI1EC_VERSION );
    }
    if ( ! defined( 'AI1EC_U_CRON_FREQ' ) ) {
        define( 'AI1EC_U_CRON_FREQ', 'hourly' );
    }

    // ==============
    // = Plugin Url =
    // ==============
    if ( ! defined( 'AI1EC_URL' ) ) {
        define( 'AI1EC_URL', $ai1ec_base_url );
    }
    // ===============
    // = VENDOR PATH =
    // ===============
    if ( ! defined( 'AI1EC_VENDOR_PATH' ) ) {
        define(
            'AI1EC_VENDOR_PATH',
            AI1EC_PATH . DIRECTORY_SEPARATOR . 'vendor' .
                    DIRECTORY_SEPARATOR
        );
    }

    // ===============
    // = ADMIN PATH  =
    // ===============
    if ( ! defined( 'AI1EC_ADMIN_PATH' ) ) {
        define(
            'AI1EC_ADMIN_PATH',
            AI1EC_PATH . DIRECTORY_SEPARATOR . 'public' .
                DIRECTORY_SEPARATOR . 'admin' . DIRECTORY_SEPARATOR
        );
    }

    // ===============
    // = ADMIN URL   =
    // ===============
    if ( ! defined( 'AI1EC_ADMIN_URL' ) ) {
        define(
            'AI1EC_ADMIN_URL',
            AI1EC_URL . '/public/admin/'
        );
    }

    // ==============
    // = CACHE PATH =
    // ==============
    if ( ! defined( 'AI1EC_CACHE_PATH' ) ) {
        define(
            'AI1EC_CACHE_PATH',
            AI1EC_PATH . DIRECTORY_SEPARATOR . 'cache' .
            DIRECTORY_SEPARATOR
        );
    }

    // ==============
    // = CACHE URL =
    // ==============
    if ( ! defined( 'AI1EC_CACHE_URL' ) ) {
        define(
        'AI1EC_CACHE_URL',
        AI1EC_URL . '/cache/'
        );
    }

    // ==============
    // = TWIG CACHE PATH =
    // ==============
    if ( ! defined( 'AI1EC_TWIG_CACHE_PATH' ) ) {
        define(
        'AI1EC_TWIG_CACHE_PATH',
        AI1EC_CACHE_PATH . 'twig' .
            DIRECTORY_SEPARATOR
        );
    }

    // ======================
    // = Default theme name =
    // ======================
    if ( ! defined( 'AI1EC_DEFAULT_THEME_NAME' ) ) {
        define( 'AI1EC_DEFAULT_THEME_NAME', 'vortex' );
    }
    // ================
    // = THEME FOLDER =
    // ================
    if ( ! defined( 'AI1EC_THEME_FOLDER' ) ) {
        define( 'AI1EC_THEME_FOLDER', 'themes-ai1ec' );
    }

    // =======================
    // = DEFAULT THEME PATH  =
    // =======================
    if ( ! defined( 'AI1EC_DEFAULT_THEME_ROOT' ) ) {
        define(
            'AI1EC_DEFAULT_THEME_ROOT',
            AI1EC_PATH . DIRECTORY_SEPARATOR . 'public' .
                DIRECTORY_SEPARATOR . AI1EC_THEME_FOLDER
        );
    }

    // =======================
    // = DEFAULT THEME PATH  =
    // =======================
    if ( ! defined( 'AI1EC_DEFAULT_THEME_PATH' ) ) {
        define(
            'AI1EC_DEFAULT_THEME_PATH',
            AI1EC_DEFAULT_THEME_ROOT . DIRECTORY_SEPARATOR .
                AI1EC_DEFAULT_THEME_NAME
        );
    }

    // ===================
    // = AI1EC Theme URL =
    // ===================
    if ( ! defined( 'AI1EC_THEMES_URL' ) ) {
        define(
            'AI1EC_THEMES_URL',
            AI1EC_URL . '/public/' . AI1EC_THEME_FOLDER
        );
    }


    // =====================
    // = AI1EC Core themes =
    // =====================
    if ( ! defined( 'AI1EC_CORE_THEMES' ) ) {
        define( 'AI1EC_CORE_THEMES', 'vortex,umbra,gamma,plana,journey' );
    }

    // ===================
    // = AI1EC Theme URL =
    // ===================
    if ( ! defined( 'AI1EC_THEMES_URL' ) ) {
        define( 'AI1EC_THEMES_URL', AI1EC_URL . '/public/' . AI1EC_THEME_FOLDER . '/' );
    }

    // =================
    // = Admin CSS URL =
    // =================
    if ( ! defined( 'AI1EC_ADMIN_THEME_CSS_URL' ) ) {
        define( 'AI1EC_ADMIN_THEME_CSS_URL', AI1EC_URL .'/public/admin/css/' );
    }

    // =================
    // = Admin Font URL =
    // =================
    if ( ! defined( 'AI1EC_ADMIN_THEME_FONT_URL' ) ) {
        define( 'AI1EC_ADMIN_THEME_FONT_URL', AI1EC_URL .'/public/admin/font/' );
    }

    // =================
    // = Admin Js  URL =
    // =================
    if ( ! defined( 'AI1EC_ADMIN_THEME_JS_URL' ) ) {
        define( 'AI1EC_ADMIN_THEME_JS_URL', AI1EC_URL .'/public/js/' );
    }

    // =============
    // = POST TYPE =
    // =============
    if ( ! defined( 'AI1EC_POST_TYPE' ) ) {
        define( 'AI1EC_POST_TYPE',           'ai1ec_event' );
    }

    // ==============
    // = SCRIPT URL =
    // ==============
    if ( ! defined( 'AI1EC_SCRIPT_URL' ) ) {
        define(
            'AI1EC_SCRIPT_URL',
            get_option( 'home' ) . '/?plugin=' . AI1EC_PLUGIN_NAME
        );
    }

    // =========================================
    // = BASE URL FOR ALL CALENDAR ADMIN PAGES =
    // =========================================
    if ( ! defined( 'AI1EC_ADMIN_BASE_URL' ) ) {
        define( 'AI1EC_ADMIN_BASE_URL', 'edit.php?post_type=' . AI1EC_POST_TYPE );
    }


    // =====================================================
    // = THEME OPTIONS PAGE BASE URL (wrap in admin_url()) =
    // =====================================================
    if ( ! defined( 'AI1EC_THEME_OPTIONS_BASE_URL' ) ) {
        define( 'AI1EC_THEME_OPTIONS_BASE_URL', AI1EC_ADMIN_BASE_URL . '&page=' . AI1EC_PLUGIN_NAME . '-edit-css' );
    }

    // =======================================================
    // = THEME SELECTION PAGE BASE URL (wrap in admin_url()) =
    // =======================================================
    if ( ! defined( 'AI1EC_THEME_SELECTION_BASE_URL' ) ) {
        define(
            'AI1EC_THEME_SELECTION_BASE_URL',
            AI1EC_ADMIN_BASE_URL . '&page=' . AI1EC_PLUGIN_NAME . '-themes'
        );
    }


    // =====================================================
    // = FEED SETTINGS PAGE BASE URL (wrap in admin_url()) =
    // =====================================================
    if ( ! defined( 'AI1EC_FEED_SETTINGS_BASE_URL' ) ) {
        define( 'AI1EC_FEED_SETTINGS_BASE_URL', AI1EC_ADMIN_BASE_URL . '&page=' . AI1EC_PLUGIN_NAME . '-feeds' );
    }

    // ================================================
    // = SETTINGS PAGE BASE URL (wrap in admin_url()) =
    // ================================================
    if ( ! defined( 'AI1EC_SETTINGS_BASE_URL' ) ) {
        define(
            'AI1EC_SETTINGS_BASE_URL',
            AI1EC_ADMIN_BASE_URL . '&page=' . AI1EC_PLUGIN_NAME . '-settings'
        );
    }

    // ==============
    // = EXPORT URL =
    // ==============
    if ( ! defined( 'AI1EC_EXPORT_URL' ) ) {
        // ====================================================
        // = Convert http:// to webcal:// in AI1EC_SCRIPT_URL =
        // =  (webcal:// protocol does not support https://)  =
        // ====================================================
        $webcal_url = preg_replace( '/^https?:\/\//', 'webcal://', AI1EC_SCRIPT_URL );
        define(
            'AI1EC_EXPORT_URL',
            $webcal_url . '&controller=ai1ec_exporter_controller' .
                '&action=export_events'
        );
        unset( $webcal_url );
    }

    if ( ! defined( 'AI1EC_CA_ROOT_PEM' ) ) {
        define(
            'AI1EC_CA_ROOT_PEM',
            AI1EC_PATH . DIRECTORY_SEPARATOR . 'ca_cert' .
                DIRECTORY_SEPARATOR . 'ca_cert.pem'
        );
    }

    // ====================
    // = SPECIAL SETTINGS =
    // ====================

    // Set AI1EC_EVENT_PLATFORM to TRUE to turn WordPress into an events-only
    // platform. For a multi-site install, setting this to TRUE is equivalent to a
    // super-administrator selecting the
    //   "Turn this blog into an events-only platform" checkbox
    // on the Calendar Settings page of every blog on the network.
    // This mode, when enabled on blogs where this plugin is active, hides all
    // administrative functions unrelated to events and the calendar (except to
    // super-administrators), and sets default WordPress settings appropriate for
    // pure event management.
    if ( ! defined( 'AI1EC_EVENT_PLATFORM' ) ) {
        define( 'AI1EC_EVENT_PLATFORM', false );
    }

    // If i choose to use the calendar url as the base for events permalinks,
    // i must specify another name for the events archive.
    if ( ! defined( 'AI1EC_ALTERNATIVE_ARCHIVE_URL' ) ) {
        define( 'AI1EC_ALTERNATIVE_ARCHIVE_URL', 'ai1ec_events_archive' );
    }

    // ===================
    // = AI1EC Theme URL =
    // ===================
    if ( ! defined( 'AI1EC_THEMES_URL_LEGACY' ) ) {
        define( 'AI1EC_THEMES_URL_LEGACY',         WP_CONTENT_URL . '/' . AI1EC_THEME_FOLDER );
    }

    // =====================
    // = Default theme url legacy=
    // =====================
    if ( ! defined( 'AI1EC_DEFAULT_THEME_URL_LEGACY' ) ) {
        define( 'AI1EC_DEFAULT_THEME_URL_LEGACY',  AI1EC_THEMES_URL . '/' . AI1EC_DEFAULT_THEME_NAME . '/' );
    }

    // =====================
    // = Default theme url =
    // =====================
    if ( ! defined( 'AI1EC_DEFAULT_THEME_URL' ) ) {
        define( 'AI1EC_DEFAULT_THEME_URL',  AI1EC_THEMES_URL . '/' . AI1EC_DEFAULT_THEME_NAME . '/' );
    }

    // ===================
    // = CSS Folder name =
    // ===================
    if ( ! defined( 'AI1EC_CSS_FOLDER' ) ) {
        define( 'AI1EC_CSS_FOLDER',         'css' );
    }

    // ==================
    // = JS Folder name =
    // ==================
    if ( ! defined( 'AI1EC_JS_FOLDER' ) ) {
        define( 'AI1EC_JS_FOLDER',          'js' );
    }

    // =====================
    // = Image folder name =
    // =====================
    if ( ! defined( 'AI1EC_IMG_FOLDER' ) ) {
        define( 'AI1EC_IMG_FOLDER',         'img' );
    }



    // ========================
    // = Admin theme CSS path =
    // ========================
    if ( ! defined( 'AI1EC_ADMIN_THEME_CSS_PATH' ) ) {
        define( 'AI1EC_ADMIN_THEME_CSS_PATH', AI1EC_ADMIN_PATH . AI1EC_CSS_FOLDER );
    }

    // =======================
    // = Admin theme JS path =
    // =======================
    if ( ! defined( 'AI1EC_ADMIN_THEME_JS_PATH' ) ) {
        define( 'AI1EC_ADMIN_THEME_JS_PATH', AI1EC_PATH . DIRECTORY_SEPARATOR . 'public' .
            DIRECTORY_SEPARATOR . AI1EC_JS_FOLDER );
    }

    // =================
    // = Admin IMG URL =
    // =================
    if ( ! defined( 'AI1EC_ADMIN_THEME_IMG_URL' ) ) {
        define( 'AI1EC_ADMIN_THEME_IMG_URL',  AI1EC_URL . '/public/admin/' . AI1EC_IMG_FOLDER );
    }

    // ====================
    // = Add-ons list URL =
    // ====================
    if ( ! defined( 'AI1EC_TIMELY_ADDONS_URI' ) ) {
        define( 'AI1EC_TIMELY_ADDONS_URI', 'https://time.ly/?action=addons_list' );
    }

    // Enable All-in-One-Event-Calendar to work in debug mode, which means,
    // that cache is ignored, extra output may appear at places, etc.
    // Do not set this to any other value than `false` on production even if
    // you know what you are doing, because you will waste valuable
    // resources - save the Earth, at least.
    if ( ! defined( 'AI1EC_DEBUG' ) ) {
        define( 'AI1EC_DEBUG', false );
    }

    // Enable Ai1EC cache functionality. If you set this to false, only cache
    // that is based on request, will remain active.
    // This is pointless in any case other than development, where literary
    // every second refresh needs to take fresh copy of everything.
    if ( ! defined( 'AI1EC_CACHE' ) ) {
        define( 'AI1EC_CACHE', true );
    }

    if ( ! defined( 'AI1EC_DISABLE_FILE_CACHE' ) ) {
        define( 'AI1EC_DISABLE_FILE_CACHE', false );
    }

    // A value identifying that cache is not available.
    // Used in place of actual path for cache to use.
    // Named constant allows reuse of a single typed variable.
    if ( ! defined( 'AI1EC_CACHE_UNAVAILABLE' ) ) {
        define( 'AI1EC_CACHE_UNAVAILABLE', 'AI1EC_CACHE_UNAVAILABLE' );
    }

    // Defines if backward (<= 2.1.5) theme compatibility is enabled or not.
    if ( ! defined( 'AI1EC_THEME_COMPATIBILITY_FER' ) ) {
        define( 'AI1EC_THEME_COMPATIBILITY_FER', true );
    }

    // Defines amount of needed free memory to compile LESS files.
    if ( ! defined( 'AI1EC_LESS_MIN_AVAIL_MEMORY' ) ) {
        define( 'AI1EC_LESS_MIN_AVAIL_MEMORY', '24M' );
    }

    // Defines if LESS files are parsed at every request
    if ( ! defined( 'AI1EC_PARSE_LESS_FILES_AT_EVERY_REQUEST' ) ) {
        define( 'AI1EC_PARSE_LESS_FILES_AT_EVERY_REQUEST', false );
    }

    // Defines a list of FER-enabled templates.
    if ( ! defined( 'AI1EC_FER_ENABLED_TEMPLATES_LIST' ) ) {
        define(
            'AI1EC_FER_ENABLED_TEMPLATES_LIST',
            'agenda,oneday,week,month,posterboard,stream'
        );
    }

    // Defines API URL.
    if ( ! defined( 'AI1EC_API_URL' ) ) {
        define(
            'AI1EC_API_URL',
            'https://api.time.ly/api/'
        );
    }

    // Defines Tickets checkout URL.
    if ( ! defined( 'AI1EC_TICKETS_CHECKOUT_URL' ) ) {
        define(
            'AI1EC_TICKETS_CHECKOUT_URL',
            'https://api.time.ly/events/{event_id}/checkout'
        );
    }

    // ================================================
    // = Force WordPress updates command link         =
    // ================================================
    if ( ! defined( 'AI1EC_FORCE_UPDATES_URL' ) ) {
        define(
            'AI1EC_FORCE_UPDATES_URL',
            AI1EC_ADMIN_BASE_URL . '&ai1ec_force_updates=true'
        );
    }
}


==================================================
FILE PATH: ./app/config/exception.php
==================================================
<?php
/**
 * This exception is thrown when no constant function is found.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Config
 */
class Ai1ec_Constants_Not_Set_Exception extends Ai1ec_Exception {
}

==================================================
FILE PATH: ./app/view/embeddable.php
==================================================
<?php
abstract class Ai1ec_Embeddable extends WP_Widget {

    /**
     * @var Ai1ec_Registry_Object
     */
    protected $_registry;

    /**
     * @var string
     */
    protected $_id;

    /**
     * @var boolean
     */
    protected $_css_loaded = false;

    /**
     * Get default values for shortcode or widget.
     *
     * @return array
     */
    abstract public function get_defaults();

    /**
     * Get values which are configurable in the Javascript widget.
     * Some things might not be configurable.
     *
     * @return array
     */
    abstract public function get_js_widget_configurable_defaults();

    /**
     * Create the html for the widget. Shared by all versions.
     *
     * @param array $args_for_widget
     * @param bool  $remote_request whether the request is for a remote site or not (useful to inline CSS)
     */
    abstract public function get_content( array $args_for_widget, $remote_request = false );

    /**
     * Add the required javascript for the widget. Needed for shortcode and Wordpress widget
     */
    abstract public function add_js();

    /**
     * Register the widget to the controller.
     *
     * @param string $id_base
     */
    abstract public function register_javascript_widget( $id_base );


    /**
     * Return options needed for thw "Widget creator page
     *
     * @return array
     */
    abstract public function get_configurable_for_widget_creation();

    /**
     * The human-readable name of the widget.
     *
     * @return string
     */
    abstract public function get_name();

    /**
     * The icon class associated with the widget. Defaults to calendar.
     *
     * @return string
     */
    public function get_icon() {
        return 'ai1ec-fa ai1ec-fa-calendar';
    }

    /**
     * Checks and returns widget requirements.
     *
     * @return string
     */
    abstract public function check_requirements();

    /**
     * Register widget class with current WP instance.
     * This must be static as otherwise the class would be instantiated twice,
     * one to register it and the other from Wordpress.
     *
     * @return string
     */
    public static function register_widget() {
        throw new Ai1ec_Exception( 'This should be implemented in child class' );
    }

    public function __construct( $id_base, $name, $widget_options = array(), $control_options = array() ) {
        $this->_id = $id_base;
        parent::__construct( $id_base, $name, $widget_options, $control_options );
        add_shortcode( $id_base, array( $this, 'shortcode' ) );
        add_filter(
            'ai1ec_content_remove_shortcode_' . $id_base,
            array( $this, 'is_this_to_remove_from_event' )
        );
        $this->_registry = apply_filters( 'ai1ec_registry', false );
        $this->register_javascript_widget( $id_base );
        add_filter( 'ai1ec_js_translations', array( $this, 'add_js_translations' ) );
        $this->_registry->get( 'css.frontend' )->add_link_to_html_for_frontend();
    }

    /**
     * @param array $translations
     * @return array
     */
    public function add_js_translations( array $translations ) {
        $translations['javascript_widgets'][$this->_id] = $this->get_js_widget_configurable_defaults();
        return $translations;
    }
    /**
     * Widget function.
     *
     * Outputs the given instance of the widget to the front-end.
     *
     * @param  array $args     Display arguments passed to the widget
     * @param  array $instance The settings for this widget instance
     * @return void
     */
    public function widget( $args, $instance ) {
        $defaults = $this->get_defaults();
        $instance = wp_parse_args( $instance, $defaults );
        $this->add_js();
        $args['widget_html'] = $this->get_content( $instance );
        if ( ! empty( $args['widget_html'] ) ) {
            $args['title'] = $instance['title'];
            $args          = $this->_filter_widget_args( $args );
            // Display theme
            $this->_registry->get( 'theme.loader' )->get_file(
                'widget.twig',
                $args
            )->render();
        }

    }

    /**
     * Renders shortcode
     *
     * @param array $atts
     * @param string $content
     */
    public function shortcode( $atts, $content = null ) {
        $defaults = $this->get_defaults();
        $atts = shortcode_atts( $defaults, $atts );
        $this->add_js();
        return $this->get_content( $atts );
    }

    /**
     * Renders js widget
     *
     * @param array $args
     */
    public function javascript_widget( $args ) {
        $defaults = $this->get_defaults();
        $args = wp_parse_args( $args, $defaults );
        return $this->get_content( $args, true );
    }

    /**
     * Returns whether this shortcode should be removed from event content.
     *
     * @return bool True.
     */
    public function is_this_to_remove_from_event() {
        return true;
    }

    /**
     * Filters default widget parameters like classes, html elements before and
     * after title or widget. Useful for Feature Events widget which has
     * different title styling.
     *
     * @param array $args Widget arguments.
     *
     * @return array Filtered arguments.
     */
    protected function _filter_widget_args( $args ) {
        return $args;
    }
}


==================================================
FILE PATH: ./app/view/calendar/subscribe-button.php
==================================================
<?php

/**
 * Generate translation entities for subscription buttons.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Calendar_SubscribeButton {

    /**
     * Get a list of texts for subscribtion buttons.
     *
     * @return array Map of labels.
     */
    public function get_labels() {
        return array(
            'label' => array(
                'timely'    => Ai1ec_I18n::__( 'Add to Timely Calendar' ),
                'google'    => Ai1ec_I18n::__( 'Add to Google' ),
                'outlook'   => Ai1ec_I18n::__( 'Add to Outlook' ),
                'apple'     => Ai1ec_I18n::__( 'Add to Apple Calendar' ),
                'plaintext' => Ai1ec_I18n::__( 'Add to other calendar' ),
                'xml'       => Ai1ec_I18n::__( 'Export to XML' ),
            ),
            'title' => array(
                'timely'    => Ai1ec_I18n::__( 'Copy this URL for your own Timely calendar or click to add to your rich-text calendar' ),
                'google'    => Ai1ec_I18n::__( 'Subscribe to this calendar in your Google Calendar' ),
                'outlook'   => Ai1ec_I18n::__( 'Subscribe to this calendar in MS Outlook' ),
                'apple'     => Ai1ec_I18n::__( 'Subscribe to this calendar in Apple Calendar/iCal' ),
                'plaintext' => Ai1ec_I18n::__( 'Subscribe to this calendar in another plain-text calendar' ),
            ),
        );
    }

}


==================================================
FILE PATH: ./app/view/calendar/page.php
==================================================
<?php

/**
 * The concrete class for the calendar page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_Calendar_Page extends Ai1ec_Base {

    /**
     * @var Ai1ec_Memory_Utility Instance of memory to hold exact dates
     */
    protected $_exact_dates = NULL;

    /**
     * Public constructor
     *
     * @param Ai1ec_Registry_Object $registry The registry object
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $this->_exact_dates = $registry->get( 'cache.memory' );
    }

    /**
     * Get the content if the calendar page
     *
     * @param Ai1ec_Request_Parser $request Request object.
     * @param string               $caller  Method caller, expected one of
     *                                      ['shortcode', 'render-command']
     *                                      Defaults to 'render-command'.
     *
     * @return string Content.
     */
    public function get_content(
        Ai1ec_Request_Parser $request,
        $caller = 'render-command'
    ) {
        // Get args for the current view; required to generate HTML for views
        // dropdown list, categories, tags, subscribe buttons, and of course the
        // view itself.
        $view_args  = $this->get_view_args_for_view( $request );

        try {
            $action   = $this->_registry->get( 'model.settings-view' )
                ->get_configured( $view_args['action'] );
        } catch ( Ai1ec_Settings_Exception $exception ) {
            // short-circuit and return error message
            return '<div id="ai1ec-container"><div class="timely"><p>' .
                Ai1ec_I18n::__(
                    'There was an error loading calendar. Please contact site administrator and inform him to configure calendar views.'
                ) .
                '</p></div></div>';
        }
        $type    = $request->get( 'request_type' );
        $is_json = $this->_registry->get( 'http.request' )->is_json_required(
            $view_args['request_format'], $action
        );

        // Add view-specific args to the current view args.
        $exact_date = $this->get_exact_date( $request );
        try {
            $view_obj = $this->_registry->get(
                'view.calendar.view.' . $action,
                $request
            );
        } catch ( Ai1ec_Bootstrap_Exception $exc ) {
            $this->_registry->get( 'notification.admin' )->store(
                sprintf(
                        Ai1ec_I18n::__( 'Calendar was unable to initialize %s view and has reverted to Agenda view. Please check if you have installed the latest versions of calendar add-ons.' ),
                        ucfirst( $action )
                ),
                'error',
                0,
                array( Ai1ec_Notification_Admin::RCPT_ADMIN ),
                true
            );
            // don't disable calendar - just switch to agenda which should
            // always exists
            $action   = 'agenda';
            $view_obj = $this->_registry->get(
                'view.calendar.view.' . $action,
                $request
            );
        }
        $view_args = $view_obj->get_extra_arguments( $view_args, $exact_date );

        // Get HTML for views dropdown list.
        $dropdown_args = $view_args;
        if (
            isset( $dropdown_args['time_limit'] ) &&
            false !== $exact_date
        ) {
            $dropdown_args['exact_date'] = $exact_date;
        }
        $views_dropdown =
            $this->get_html_for_views_dropdown( $dropdown_args, $view_obj );
        // Add views dropdown markup to view args.
        $view_args['views_dropdown'] = $views_dropdown;

        $settings = $this->_registry->get( 'model.settings' );
        if ( $settings->get( 'ai1ec_use_frontend_rendering' ) ) {
            $view_args['request_format'] = 'json';
        }

        // Get HTML for subscribe buttons.
        $subscribe_buttons = $this->get_html_for_subscribe_buttons( $view_args );

        // Get HTML for view itself.
        $view              = $view_obj->get_content( $view_args );

        $router            = $this->_registry->get( 'routing.router' );
        $are_filters_set   = $router->is_at_least_one_filter_set_in_request(
            $view_args
        );

        if (
            $is_json &&
            ( $view_args['no_navigation'] || $type !== 'html' )
        ) {
            // send data both for json and jsonp as shortcodes are jsonp
            return array(
                'html'               => $view,
                'views_dropdown'     => $views_dropdown,
                'subscribe_buttons'  => $subscribe_buttons,
                'are_filters_set'    => $are_filters_set,
                'is_json'            => $is_json,
            );

        } else {
            $loader     = $this->_registry->get( 'theme.loader' );
            $empty      = $loader->get_file( 'empty.twig', array(), false );
            // Get HTML for categories and for tags
            $taxonomy   = $this->_registry->get( 'view.calendar.taxonomy' );
            $categories = $taxonomy->get_html_for_categories(
                $view_args
            );
            $tags       = $taxonomy->get_html_for_tags(
                $view_args,
                true
            );

            // option to show filters in the super widget
            // Define new arguments for overall calendar view
            $filter_args = array(
                'views_dropdown'               => $views_dropdown,
                'categories'                   => $categories,
                'tags'                         => $tags,
                'contribution_buttons'         => apply_filters(
                    'ai1ec_contribution_buttons',
                    '',
                    $type,
                    $caller
                ),
                'additional_buttons'           => apply_filters(
                    'ai1ec_additional_buttons',
                    '',
                    $view_args
                ),
                'show_dropdowns'               => apply_filters(
                    'ai1ec_show_dropdowns',
                    true
                ),
                'show_select2'                 => apply_filters(
                    'ai1ec_show_select2',
                    false
                ),
                'span_for_select2'             => apply_filters(
                    'ai1ec_span_for_select2',
                    ''
                ),
                'authors'                      => apply_filters(
                    'ai1ec_authors',
                    ''
                ),
                'save_view_btngroup'           => apply_filters(
                    'ai1ec_save_view_btngroup',
                    $empty
                ),
                'view_args'                    => $view_args,
                'request'                      => $request,
            );

            $filter_menu   = $loader->get_file(
                'filter-menu.twig',
                $filter_args,
                false
            )->get_content();
            // hide filters in the SW
            if ( 'true' !== $request->get( 'display_filters' ) && 'jsonp' === $type ) {
                $filter_menu = '';
            }

            $calendar_args = array(
                'version'                      => AI1EC_VERSION,
                'filter_menu'                  => $filter_menu,
                'view'                         => $view,
                'subscribe_buttons'            => $subscribe_buttons,
                'disable_standard_filter_menu' => apply_filters(
                    'ai1ec_disable_standard_filter_menu',
                    false
                ),
                'inline_js_calendar'           => apply_filters(
                    'ai1ec_inline_js_calendar',
                    ''
                ),
                'after_view'                   => apply_filters(
                    'ai1ec_after_view',
                    ''
                ),
                'ai1ec_above_calendar'         => apply_filters(
                    'ai1ec_above_calendar',
                    ''
                ),
            );

            if ( is_array( $calendar_args['view'] ) ) {
                $view_args['request_format'] = 'html';
                $calendar_args['view']       = $view_obj->get_content( $view_args );
            }
            $calendar = $loader->get_file( 'calendar.twig', $calendar_args, false );
            // if it's just html, only the calendar html must be returned.
            if ( 'html' === $type ) {
                return $calendar->get_content();
            }
            // send data both for json and jsonp as shortcodes are jsonp
            return array(
                'html'               => $calendar->get_content(),
                'views_dropdown'     => $views_dropdown,
                'subscribe_buttons'  => $subscribe_buttons,
                'are_filters_set'    => $are_filters_set,
                'is_json'            => $is_json
            );
        }
    }

    /**
     * Render the HTML for the `subscribe' buttons.
     *
     * @param array $view_args Args to pass.
     *
     * @return string Rendered HTML to include in output.
     */
    public function get_html_for_subscribe_buttons( array $view_args ) {
        $settings           = $this->_registry->get( 'model.settings' );
        $turn_off_subscribe = $settings->get( 'turn_off_subscription_buttons' );
        if ( $turn_off_subscribe ) {
            return '';
        }

        $args = array(
            'url_args'           => '',
            'is_filtered'        => false,
            'export_url'         => AI1EC_EXPORT_URL,
            'export_url_no_html' => AI1EC_EXPORT_URL . '&no_html=true',
            'text_filtered'      => Ai1ec_I18n::__( 'Subscribe to filtered calendar' ),
            'text_subscribe'     => Ai1ec_I18n::__( 'Subscribe' ),
            'text_get_calendar'  => Ai1ec_I18n::__( 'Get a Timely Calendar' ),
            'show_get_calendar'  => ! $settings->get( 'disable_get_calendar_button' ),
            'text'               => $this->_registry
                ->get( 'view.calendar.subscribe-button' )
                ->get_labels(),
            'placement'          => 'up',
        );
        if ( ! empty( $view_args['cat_ids'] ) ) {
            $args['url_args'] .= '&ai1ec_cat_ids=' .
                implode( ',', $view_args['cat_ids'] );
            $args['is_filtered'] = true;
        }
        if ( ! empty( $view_args['tag_ids'] ) ) {
            $args['url_args']  .= '&ai1ec_tag_ids=' .
                implode( ',', $view_args['tag_ids'] );
            $args['is_filtered'] = true;
        }
        if ( ! empty( $view_args['post_ids'] ) ) {
            $args['url_args']  .= '&ai1ec_post_ids=' .
                implode( ',', $view_args['post_ids'] );
            $args['is_filtered'] = true;
        }
        $args = apply_filters(
            'ai1ec_subscribe_buttons_arguments',
            $args,
            $view_args
        );
        $localization = $this->_registry->get( 'p28n.wpml' );
        if (
            NULL !== ( $use_lang = $localization->get_language() )
        ) {
            $args['url_args'] .= '&lang=' . $use_lang;
        }
        $subscribe = $this->_registry->get( 'theme.loader' )
            ->get_file( 'subscribe-buttons.twig', $args, false );
        return $subscribe->get_content();
    }

    /**
     * This function generates the html for the view dropdowns.
     *
     * @param array                        $view_args Args passed to view
     * @param Ai1ec_Calendar_View_Abstract $view      View object
     */
    protected function get_html_for_views_dropdown(
        array $view_args,
        Ai1ec_Calendar_View_Abstract $view
    ) {
        $settings        = $this->_registry->get( 'model.settings' );
        $available_views = array();
        $enabled_views   = (array)$settings->get( 'enabled_views', array() );
        $view_names      = array();
        $mode            = wp_is_mobile() ? '_mobile' : '';
        foreach ( $enabled_views as $key => $val ) {
            $view_names[$key] = translate_nooped_plural(
                $val['longname'],
                1
            );
            // Find out if view is enabled in requested mode (mobile or desktop). If
            // no mode-specific setting is available, fall back to desktop setting.
            $view_enabled = isset( $enabled_views[$key]['enabled' . $mode] ) ?
                $enabled_views[$key]['enabled' . $mode] :
                $enabled_views[$key]['enabled'];
            $values = array();
            $options = $view_args;
            if ( $view_enabled ) {
                if ( $view instanceof Ai1ec_Calendar_View_Agenda ) {
                    if (
                        isset( $options['exact_date'] ) &&
                        ! isset( $options['time_limit'] )
                    ) {
                        $options['time_limit'] = $options['exact_date'];
                    }
                    unset( $options['exact_date'] );
                } else {
                    unset( $options['time_limit'] );
                }
                unset( $options['month_offset'] );
                unset( $options['week_offset'] );
                unset( $options['oneday_offset'] );
                $options['action'] = $key;
                $values['desc'] = translate_nooped_plural(
                    $val['longname'],
                    1
                );
                if ( $settings->get( 'ai1ec_use_frontend_rendering' ) ) {
                    $options['request_format'] = 'json';
                }
                $href = $this->_registry->get( 'html.element.href', $options );
                $values['href'] = $href->generate_href();
                $available_views[$key] = $values;
            }
        };
        $args = array(
            'view_names'              => $view_names,
            'available_views'         => $available_views,
            'current_view'            => $view_args['action'],
            'data_type'               => $view_args['data_type'],
        );

        $views_dropdown = $this->_registry->get( 'theme.loader' )
            ->get_file( 'views_dropdown.twig', $args, false );
        return $views_dropdown->get_content();
    }

    /**
     * Get the exact date from request if available, or else from settings.
     *
     * @param Ai1ec_Abstract_Query settings
     *
     * @return boolean|int
     */
    private function get_exact_date( Ai1ec_Abstract_Query $request ) {
        $settings = $this->_registry->get( 'model.settings' );

        // Preprocess exact_date.
        // Check to see if a date has been specified.
        $exact_date = $request->get( 'exact_date' );
        $use_key    = $exact_date;
        if ( null === ( $exact_date = $this->_exact_dates->get( $use_key ) ) ) {
            $exact_date = $use_key;
            // Let's check if we have a date
            if ( false !== $exact_date ) {
                // If it's not a timestamp
                if ( ! Ai1ec_Validation_Utility::is_valid_time_stamp( $exact_date ) ) {
                    // Try to parse it
                    $exact_date = $this->return_gmtime_from_exact_date( $exact_date );
                    if ( false === $exact_date ) {
                        return null;
                    }
                }
            }
            // Last try, let's see if an exact date is set in settings.
            if ( false === $exact_date && $settings->get( 'exact_date' ) !== '' ) {
                $exact_date = $this->return_gmtime_from_exact_date(
                    $settings->get( 'exact_date' )
                );
            }
            $this->_exact_dates->set( $use_key, $exact_date );
        }
        return $exact_date;
    }

    /**
     * Decomposes an 'exact_date' parameter into month, day, year components based
     * on date pattern defined in settings (assumed to be in local time zone),
     * then returns a timestamp in GMT.
     *
     * @param  string     $exact_date 'exact_date' parameter passed to a view
     * @return bool|int               false if argument not provided or invalid,
     *                                else UNIX timestamp in GMT
     */
    private function return_gmtime_from_exact_date( $exact_date ) {
        $input_format = $this->_registry->get( 'model.settings' )
            ->get( 'input_date_format' );

        $date = Ai1ec_Validation_Utility::format_as_iso(
            $exact_date,
            $input_format
        );
        if ( false === $date ) {
            $exact_date = false;
        } else {
            $exact_date = $this->_registry->get(
                'date.time',
                $date,
                'sys.default'
            )->format_to_gmt();
            if ( $exact_date < 0 ) {
                return false;
            }
        }
        return $exact_date;
    }

    /**
     * Returns the correct data attribute to use in views
     *
     * @param string $type
     */
    private function return_data_type_for_request_type( $type ) {
        $data_type = 'data-type="json"';
        if ( $type === 'jsonp' ) {
            $data_type = 'data-type="jsonp"';
        }
        return $data_type;
    }

    /**
     * Get the parameters for the view from the request object
     *
     * @param Ai1ec_Abstract_Query $request
     *
     * @return array
     */
    protected function get_view_args_for_view( Ai1ec_Abstract_Query $request ) {
        $settings = $this->_registry->get( 'model.settings' );
        // Define arguments for specific calendar sub-view (month, agenda, etc.)
        // Preprocess action.
        // Allow action w/ or w/o ai1ec_ prefix. Remove ai1ec_ if provided.
        $action = $request->get( 'action' );

        if ( 0 === strncmp( $action, 'ai1ec_', 6 ) ) {
            $action = substr( $action, 6 );
        }
        $view_args = $request->get_dict(
            apply_filters(
                'ai1ec_view_args_for_view',
                array(
                    'post_ids',
                    'auth_ids',
                    'cat_ids',
                    'tag_ids',
                    'events_limit',
                    'instance_ids',
                )
            )
        );
        $type = $request->get( 'request_type' );
        if ( 'html' === $type ) {
            $add_defaults = array(
                'cat_ids' => 'categories',
                'tag_ids' => 'tags',
            );
            foreach ( $add_defaults as $query => $default ) {
                if ( empty( $view_args[$query] ) ) {
                    $setting = $settings->get( 'default_tags_categories' );
                    if ( isset( $setting[$default] ) ) {
                        $view_args[$query] = $setting[$default];
                    }
                }
            }
        }

        $view_args['data_type'] = $this->return_data_type_for_request_type(
            $type
        );

        $view_args['request_format'] = $request->get( 'request_format' );
        $exact_date = $this->get_exact_date( $request );

        $view_args['no_navigation'] = $request->get( 'no_navigation' ) == true;

        // Find out which view of the calendar page was requested, and render it
        // accordingly.
        $view_args['action'] = $action;

        $view_args['request'] = $request;
        $view_args            = apply_filters(
            'ai1ec_view_args_array',
            $view_args
        );
        if ( null === $exact_date ) {
            $href = $this->_registry->get( 'html.element.href', $view_args )
                ->generate_href();
            return Ai1ec_Http_Response_Helper::redirect( $href, 307 );

        }
        return $view_args;
    }
}


==================================================
FILE PATH: ./app/view/calendar/view/oneday.php
==================================================
<?php

/**
 * The concrete class for day view.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_Calendar_View_Oneday extends Ai1ec_Calendar_View_Abstract {

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_name()
     */
    public function get_name() {
        return 'oneday';
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_content()
     */
    public function get_content( array $view_args ) {
        $date_system = $this->_registry->get( 'date.system' );
        $settings    = $this->_registry->get( 'model.settings' );
        $defaults    = array(
            'oneday_offset' => 0,
            'cat_ids'       => array(),
            'tag_ids'       => array(),
            'auth_ids'      => array(),
            'post_ids'      => array(),
            'instance_ids'  => array(),
            'exact_date'    => $date_system->current_time(),
        );
        $args = wp_parse_args( $view_args, $defaults );
        $local_date = $this->_registry
            ->get( 'date.time', $args['exact_date'], 'sys.default' )
            ->adjust_day( 0 + $args['oneday_offset'] )
            ->set_time( 0, 0, 0 );

        $cell_array = $this->get_oneday_cell_array(
            $local_date,
            apply_filters(
                'ai1ec_get_events_relative_to_filter',
                array(
                    'cat_ids'      => $args['cat_ids'],
                    'tag_ids'      => $args['tag_ids'],
                    'post_ids'     => $args['post_ids'],
                    'auth_ids'     => $args['auth_ids'],
                    'instance_ids' => $args['instance_ids'],
                ),
                $view_args,
                apply_filters(
                    'ai1ec_show_unique_events',
                    false
                )
            )
        );
        // Create pagination links.
        $title            = $local_date->format_i18n(
            $this->_registry->get( 'model.option' )
                ->get( 'date_format', 'l, M j, Y' )
        );
        $pagination_links = $this->_get_pagination( $args, $title );

        // Calculate today marker's position.
        $midnight         = $this->_registry->get( 'date.time', 'now', 'sys.default' )
            ->set_time( 0, 0, 0 );
        $now              = $this->_registry->get( 'date.time', 'now', 'sys.default' );
        $now_text         = $this->_registry->get( 'view.event.time' )
            ->get_short_time( $now );
        $now              = (int) ( $now->diff_sec( $midnight ) / 60 );

        $is_ticket_button_enabled = apply_filters( 'ai1ec_oneday_ticket_button', false );
        $show_reveal_button       = apply_filters( 'ai1ec_oneday_reveal_button', false );

        $time_format              = $this->_registry->get( 'model.option' )
            ->get( 'time_format', Ai1ec_I18n::__( 'g a' ) );

        $hours = array();
        $today = $this->_registry->get( 'date.time', 'now', 'sys.default' );
        for ( $hour = 0; $hour < 24; $hour++ ) {
            $hours[] = $today
                ->set_time( $hour, 0, 0 )
                ->format_i18n( $time_format );
        }

        $view_args = array(
            'title'                    => $title,
            'type'                     => 'oneday',
            'cell_array'               => $cell_array,
            'show_location_in_title'   => $settings->get( 'show_location_in_title' ),
            'now_top'                  => $now,
            'now_text'                 => $now_text,
            'time_format'              => $time_format,
            'done_allday_label'        => false,// legacy
            'done_grid'                => false,// legacy
            'data_type'                => $args['data_type'],
            'is_ticket_button_enabled' => $is_ticket_button_enabled,
            'show_reveal_button'       => $show_reveal_button,
            'text_full_day'            => __( 'Reveal full day', AI1EC_PLUGIN_NAME ),
            'text_all_day'             => __( 'All-day', AI1EC_PLUGIN_NAME ),
            'text_now_label'           => __( 'Now:', AI1EC_PLUGIN_NAME ),
            'text_venue_separator'     => __( '@ %s', AI1EC_PLUGIN_NAME ),
            'hours'                    => $hours,
            'indent_multiplier'        => 16,
            'indent_offset'            => 54,
            'pagination_links'         => $pagination_links,
        );

        $view_args = $this->get_extra_template_arguments( $view_args );

        // Add navigation if requested.
        $view_args['navigation'] = $this->_get_navigation(
            array(
                'no_navigation'    => $args['no_navigation'],
                'pagination_links' => $pagination_links,
                'views_dropdown'   => $args['views_dropdown'],
                'below_toolbar'    => apply_filters(
                    'ai1ec_below_toolbar',
                    '',
                    $this->get_name(),
                    $args
                ),
            )
        );

        return
            $this->_registry->get( 'http.request' )->is_json_required(
                $args['request_format'], 'oneday'
            )
            ? $this->_apply_filters_to_args( $view_args )
            : $this->_get_view( $view_args );

    }

    /**
     * Produce an array of three links for the day view of the calendar.
     *
     * Each element is an associative array containing the link's enabled status
     * ['enabled'], CSS class ['class'], text ['text'] and value to assign to
     * link's href ['href'].
     *
     * @param array  $args  Current request arguments.
     * @param string $title Title to display in datepicker button
     *
     * @return array Array of links.
     */
    function get_oneday_pagination_links( $args, $title ) {
        $links = array();
        $orig_date = $args['exact_date'];

        // ================
        // = Previous day =
        // ================
        $local_date = $this->_registry
            ->get( 'date.time', $args['exact_date'], 'sys.default' )
            ->adjust_day( $args['oneday_offset'] - 1 )
            ->set_time( 0, 0, 0 );
        $args['exact_date'] = $local_date->format();
        $href       = $this->_registry->get( 'html.element.href', $args );
        $links[]    = array(
            'enabled' => true,
            'class'=> 'ai1ec-prev-day',
            'text' => '<i class="ai1ec-fa ai1ec-fa-chevron-left"></i>',
            'href' => $href->generate_href(),
        );

        // ======================
        // = Minical datepicker =
        // ======================
        $args['exact_date'] = $orig_date;
        $factory = $this->_registry->get( 'factory.html' );
        $links[] = $factory->create_datepicker_link(
            $args,
            $args['exact_date'],
            $title
        );

        // ============
        // = Next day =
        // ============
        $local_date->adjust_day( +2 ); // above was (-1), (+2) is to counteract
        $args['exact_date'] = $local_date->format();
        $href    = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'enabled' => true,
            'class'   => 'ai1ec-next-day',
            'text'    => '<i class="ai1ec-fa ai1ec-fa-chevron-right"></i>',
            'href'    => $href->generate_href(),
        );

        return $links;
    }

    /**
     * get_oneday_cell_array function
     *
     * Return an associative array of weekdays, indexed by the day's date,
     * starting the day given by $timestamp, each element an associative array
     * containing three elements:
     *   ['today']     => whether the day is today
     *   ['allday']    => non-associative ordered array of events that are all-day
     *   ['notallday'] => non-associative ordered array of non-all-day events to
     *                    display for that day, each element another associative
     *                    array like so:
     *     ['top']       => how many minutes offset from the start of the day
     *     ['height']    => how many minutes this event spans
     *     ['indent']    => how much to indent this event to accommodate multiple
     *                      events occurring at the same time (0, 1, 2, etc., to
     *                      be multiplied by whatever desired px/em amount)
     *     ['event']     => event data object
     *
     * @param int $timestamp    the UNIX timestamp of the first day of the week
     * @param array $filter     Array of filters for the events returned:
     *                          ['cat_ids']      => non-associatative array of category IDs
     *                          ['tag_ids']      => non-associatative array of tag IDs
     *                          ['post_ids']     => non-associatative array of post IDs
     *                          ['auth_ids']     => non-associatative array of author IDs
     *                          ['instance_ids'] => non-associatative array of event instance IDs
     *
     * @return array            array of arrays as per function description
     */
    function get_oneday_cell_array(
        Ai1ec_Date_Time $start_time,
        array $filter = array(),
        $legacy       = false
    ) {
        $search = $this->_registry->get( 'model.search' );

        $loc_start_time = $this->_registry
            ->get( 'date.time', $start_time, 'sys.default' )
            ->set_time( 0, 0, 0 );
        $loc_end_time   = $this->_registry
            ->get( 'date.time', $start_time, 'sys.default' )
            ->adjust_day( +1 )
            ->set_time( 0, 0, 0 );

        $day_events = $search->get_events_for_day( $loc_start_time, $filter );
        $this->_update_meta( $day_events );
        // Split up events on a per-day basis
        $all_events = array();

        $day_start_ts = $loc_start_time->format();
        $day_end_ts   = $loc_end_time->format();
        $this->_registry->get( 'controller.content-filter' )
            ->clear_the_content_filters();
        foreach ( $day_events as $evt ) {
            list( $evt_start, $evt_end ) = $this->
                _get_view_specific_timestamps( $evt );

            // If event falls on this day, make a copy.
            if ( $evt_end > $day_start_ts && $evt_start < $day_end_ts ) {
                $_evt = clone $evt;
                if ( $evt_start < $day_start_ts ) {
                    // If event starts before this day, adjust copy's start time
                    $_evt->set( 'start', $day_start_ts );
                    $_evt->set( 'start_truncated', true );
                }
                if ( $evt_end > $day_end_ts ) {
                    // If event ends after this day, adjust copy's end time
                    $_evt->set( 'end', $day_end_ts );
                    $_evt->set( 'end_truncated', true );
                }

                // Store reference to original, unmodified event, required by view.
                $_evt->set( '_orig', $evt );
                $this->_add_runtime_properties( $_evt );
                // Place copy of event in appropriate category
                if ( $_evt->is_allday() ) {
                    $all_events[$day_start_ts]['allday'][] = $_evt;
                } else {
                    $all_events[$day_start_ts]['notallday'][] = $_evt;
                }
            }

        }
        $this->_registry->get( 'controller.content-filter' )
            ->restore_the_content_filters();

        // This will store the returned array
        $days = array();

        // Initialize empty arrays for this day if no events to minimize warnings
        if ( ! isset( $all_events[$day_start_ts]['allday'] ) ) {
            $all_events[$day_start_ts]['allday'] = array();
        }
        if ( ! isset( $all_events[$day_start_ts]['notallday'] ) ) {
            $all_events[$day_start_ts]['notallday'] = array();
        }

        $today_ymd = $this->_registry->get(
            'date.time',
            $this->_registry->get( 'date.system' )->current_time()
        )->format( 'Y-m-d' );

        $evt_stack = array( 0 ); // Stack to keep track of indentation

        foreach ( $all_events[$day_start_ts] as $event_type => &$events ) {
            foreach ( $events as &$evt ) {
                $event = array(
                    'filtered_title'     => $evt->get_runtime( 'filtered_title' ),
                    'post_excerpt'       => $evt->get_runtime( 'post_excerpt' ),
                    'color_style'        => $evt->get_runtime( 'color_style' ),
                    'category_colors'    => $evt->get_runtime( 'category_colors' ),
                    'permalink'          => $evt->get_runtime( 'instance_permalink' ),
                    'ticket_url_label'   => $evt->get_runtime( 'ticket_url_label' ),
                    'edit_post_link'     => $evt->get_runtime( 'edit_post_link' ),
                    'faded_color'        => $evt->get_runtime( 'faded_color' ),
                    'rgba_color'         => $evt->get_runtime( 'rgba_color' ),
                    'short_start_time'   => $evt->get_runtime( 'short_start_time' ),
                    'instance_id'        => $evt->get( 'instance_id' ),
                    'post_id'            => $evt->get( 'post_id' ),
                    'is_multiday'        => $evt->get( 'is_multiday' ),
                    'venue'              => $evt->get( 'venue' ),
                    'ticket_url'         => $evt->get( 'ticket_url' ),
                    'start_truncated'    => $evt->get( 'start_truncated' ),
                    'end_truncated'      => $evt->get( 'end_truncated' ),
                    'popup_timespan'     => $this->_registry
                        ->get( 'twig.ai1ec-extension')->timespan( $evt, 'short' ),
                    'avatar_not_wrapped' => $evt->getavatar( false ),
                    'avatar'             => $this->_registry
                        ->get( 'twig.ai1ec-extension')->avatar(
                            $evt,
                            array(
                                'post_thumbnail',
                                'content_img',
                                'location_avatar',
                                'category_avatar',
                            ),
                            '',
                            false ),
                );
                $meta = $this->_registry->get( 'model.meta-post' );
                if ( ! $event['ticket_url'] ) {
                    $timely_tickets = $meta->get(
                        $evt->get( 'post_id' ),
                        '_ai1ec_timely_tickets_url',
                        null
                    );
                    if ( $timely_tickets ) {
                        $event['ticket_url'] = $timely_tickets;
                        $evt->set( 'ticket_url', $event['ticket_url'] );
                    }
                }
                if (
                    true === apply_filters(
                        'ai1ec_buy_button_product',
                        false
                    )
                ) {
                    $full_details = $meta->get(
                        $evt->get( 'post_id' ),
                        '_ai1ec_ep_product_details',
                        null
                    );
                    if (
                        is_array( $full_details ) &&
                        isset( $full_details['show_buy_button'] ) &&
                        true === $full_details['show_buy_button']
                        && $event['ticket_url']
                    ) {
                        // Tickets button is shown by default in this case.
                    } else {
                        // Otherwise not.
                        $event['ticket_url'] = false;
                    }
                    $evt->set( 'ticket_url', $event['ticket_url'] );
                }

                if (
                    $this->_compatibility->use_backward_compatibility()
                ) {
                    $event = $evt;
                }
                if ( 'notallday' === $event_type) {
                    // Calculate top and bottom edges of current event
                    $top    = (int)(
                        $evt->get( 'start' )->diff_sec( $loc_start_time ) / 60
                    );
                    $bottom = min(
                        $top + ( $evt->get_duration() / 60 ),
                        1440
                    );
                    // While there's more than one event in the stack and this event's
                    // top position is beyond the last event's bottom, pop the stack
                    while ( count( $evt_stack ) > 1 && $top >= end( $evt_stack ) ) {
                        array_pop( $evt_stack );
                    }
                    // Indentation is number of stacked events minus 1
                    $indent = count( $evt_stack ) - 1;
                    // Push this event onto the top of the stack
                    array_push( $evt_stack, $bottom );
                    $evt = array(
                        'top'    => $top,
                        'height' => $bottom - $top,
                        'indent' => $indent,
                        'event'  => $event,
                    );
                } else {
                    $evt = $event;
                }
            }
        }
        $days[$day_start_ts] = array(
            'today'     => 0 === strcmp(
                $today_ymd,
                $start_time->format( 'Y-m-d' )
            ),
            'allday'    => $all_events[$day_start_ts]['allday'],
            'notallday' => $all_events[$day_start_ts]['notallday'],
            'day'       => $this->_registry->
                get( 'date.time', $day_start_ts )->format_i18n( 'j' ),
            'weekday'   => $this->_registry->
                get( 'date.time', $day_start_ts )->format_i18n( 'D' ),
        );

        return apply_filters(
            'ai1ec_get_oneday_cell_array',
            $days,
            $start_time->format(),
            $filter
        );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::_add_view_specific_runtime_properties()
     */
    protected function _add_view_specific_runtime_properties( Ai1ec_Event $event ) {
        $event->set_runtime(
            'multiday',
            $event->get( '_orig' )->is_multiday()
        );
    }

}


==================================================
FILE PATH: ./app/view/calendar/view/month.php
==================================================
<?php

/**
 * The concrete class for month view.
*
* @author     Time.ly Network Inc.
* @since      2.0
*
* @package    AI1EC
* @subpackage AI1EC.View
*/
class Ai1ec_Calendar_View_Month extends Ai1ec_Calendar_View_Abstract {

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_name()
    */
    public function get_name() {
        return 'month';
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_content()
    */
    public function get_content( array $view_args ) {
        $date_system = $this->_registry->get( 'date.system' );
        $settings    = $this->_registry->get( 'model.settings' );
        $defaults = array(
            'month_offset'  => 0,
            'cat_ids'       => array(),
            'auth_ids'      => array(),
            'tag_ids'       => array(),
            'post_ids'      => array(),
            'instance_ids'  => array(),
            'exact_date'    => $date_system->current_time(),
        );
        $args = wp_parse_args( $view_args, $defaults );
        $local_date = $this->_registry
            ->get( 'date.time', $args['exact_date'], 'sys.default' );
        $local_date->set_date(
                $local_date->format( 'Y' ),
                $local_date->format( 'm' ) + $args['month_offset'],
                1
            )
            ->set_time( 0, 0, 0 );

        $days_events = $this->get_events_for_month(
            $local_date,
            apply_filters(
                'ai1ec_get_events_relative_to_filter',
                array(
                    'cat_ids'      => $args['cat_ids'],
                    'tag_ids'      => $args['tag_ids'],
                    'post_ids'     => $args['post_ids'],
                    'auth_ids'     => $args['auth_ids'],
                    'instance_ids' => $args['instance_ids'],
                ),
                $view_args,
                apply_filters(
                    'ai1ec_show_unique_events',
                    false
                )
            )
        );
        $cell_array = $this->get_month_cell_array(
            $local_date,
            $days_events
        );
        // Create pagination links.
        $title = $local_date->format_i18n( 'F Y' );
        $pagination_links = $this->_get_pagination( $args, $title );

        $is_ticket_button_enabled = apply_filters(
            'ai1ec_month_ticket_button',
            false
        );

        $view_args = array(
            'title'                    => $title,
            'type'                     => 'month',
            'weekdays'                 => $this->get_weekdays(),
            'cell_array'               => $cell_array,
            'show_location_in_title'   => $settings->get( 'show_location_in_title' ),
            'month_word_wrap'          => $settings->get( 'month_word_wrap' ),
            'post_ids'                 => join( ',', $args['post_ids'] ),
            'data_type'                => $args['data_type'],
            'is_ticket_button_enabled' => $is_ticket_button_enabled,
            'text_venue_separator'     => __( '@ %s', AI1EC_PLUGIN_NAME ),
            'pagination_links'         => $pagination_links,
        );

        // Add navigation if requested.
        $view_args['navigation'] = $this->_get_navigation(
            array(
                'no_navigation'    => $args['no_navigation'],
                'pagination_links' => $pagination_links,
                'views_dropdown'   => $args['views_dropdown'],
                'below_toolbar'    => apply_filters(
                    'ai1ec_below_toolbar',
                    '',
                    $this->get_name(),
                    $args
                ),
            )
        );

        $view_args = $this->get_extra_template_arguments( $view_args );

        return
            $this->_registry->get( 'http.request' )->is_json_required(
                $args['request_format'], 'month'
            )
            ? $this->_apply_filters_to_args( $view_args )
            : $this->_get_view( $view_args );
    }

    /**
     * Returns a non-associative array of four links for the month view of the
     * calendar:
     *    previous year, previous month, next month, and next year.
     * Each element is an associative array containing the link's enabled status
     * ['enabled'], CSS class ['class'], text ['text'] and value to assign to
     * link's href ['href'].
     *
     * @param array  $args  Current request arguments
     * @param string $title Title to display in datepicker button
     *
     * @return array      Array of links
     */
    function get_month_pagination_links( $args, $title ) {
        $links = array();

        $local_date = $this->_registry
            ->get( 'date.time', $args['exact_date'], 'sys.default' );
        $orig_date  = $this->_registry->get( 'date.time',  $local_date );
        $default_tz = $this->_registry->get( 'date.timezone' )->get_default_timezone();
        // =================
        // = Previous year =
        // =================
        // Align date to first of month, month offset applied, 1 year behind.
        $local_date
            ->set_timezone( $default_tz )
            ->set_date(
                $local_date->format( 'Y' ) -1,
                $local_date->format( 'm' ) + $args['month_offset'],
                1
            )
            ->set_time( 0, 0, 0 );

        $args['exact_date'] = $local_date->format();
        $href = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'enabled' => true,
            'class'=> 'ai1ec-prev-year',
            'text' => '<i class="ai1ec-fa ai1ec-fa-angle-double-left"></i> ' .
                $local_date->format_i18n( 'Y' ),
            'href' => $href->generate_href(),
        );

        // ==================
        // = Previous month =
        // ==================
        // Align date to first of month, month offset applied, 1 month behind.
        $local_date
            ->set_date(
                $local_date->format( 'Y' ) + 1,
                $local_date->format( 'm' ) - 1,
                1
            );
        $args['exact_date'] = $local_date->format();
        $href = $this->_registry->get( 'html.element.href', $args );
        $months = apply_filters( 'ai1ec_i18n_months', array() );
        $m = $local_date->format_i18n( 'M' );
        $month_text = array_key_exists( $m, $months ) ? $months[$m] : $m;
        $links[] = array(
            'enabled' => true,
            'class'=> 'ai1ec-prev-month',
            'text' => '<i class="ai1ec-fa ai1ec-fa-angle-left"></i> ' . $month_text,
            'href' => $href->generate_href(),
        );

        // ======================
        // = Minical datepicker =
        // ======================
        // Align date to first of month, month offset applied.

        $orig_date
            ->set_timezone('UTC')
            ->set_date(
                $orig_date->format( 'Y' ),
                $orig_date->format( 'm' ) + $args['month_offset'],
                1
            );
        $args['exact_date'] = $orig_date->format();
        $factory = $this->_registry->get( 'factory.html' );
        $links[] = $factory->create_datepicker_link(
            $args,
            $args['exact_date'],
            $title
        );

        // ==============
        // = Next month =
        // ==============
        // Align date to first of month, month offset applied, 1 month ahead.
        $orig_date
            ->set_timezone( $default_tz )
            ->set_date(
                $orig_date->format( 'Y' ),
                $orig_date->format( 'm' ) + 1,
                1
            )
            ->set_time( 0, 0, 0 );
        $args['exact_date'] = $orig_date->format();
        $href = $this->_registry->get( 'html.element.href', $args );
        $m = $orig_date->format_i18n( 'M' );
        $links[] = array(
            'enabled' => true,
            'class'=> 'ai1ec-next-month',
            'text' => ( array_key_exists( $m, $months ) ? $months[$m] : $m ) .
                ' <i class="ai1ec-fa ai1ec-fa-angle-right"></i>',
            'href' => $href->generate_href(),
        );

        // =============
        // = Next year =
        // =============
        // Align date to first of month, month offset applied, 1 year ahead.
        $orig_date
            ->set_date(
                $orig_date->format( 'Y' ) + 1,
                $orig_date->format( 'm' ) - 1,
                1
            );
        $args['exact_date'] = $orig_date->format();
        $href = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'enabled' => true,
            'class'=> 'ai1ec-next-year',
            'text' => $orig_date->format_i18n( 'Y' ) .
            ' <i class="ai1ec-fa ai1ec-fa-angle-double-right"></i>',
            'href' => $href->generate_href(),
        );

        return $links;
    }

    /**
     * get_weekdays function
     *
     * Returns a list of abbreviated weekday names starting on the configured
     * week start day setting.
     *
     * @return array
     */
    protected function get_weekdays() {
        $settings    = $this->_registry->get( 'model.settings' );
        static $weekdays;

        if ( ! isset( $weekdays ) ) {
            $time = $this->_registry->get(
                'date.time',
                'next Sunday',
                'sys.default'
            );
            $time->adjust_day( $settings->get( 'week_start_day' ) );

            $weekdays = array();
            for( $i = 0; $i < 7; $i++ ) {
                $weekdays[] = $time->format_i18n( 'D' );
                $time->adjust_day( 1 );// Add a day
            }
        }
        return $weekdays;
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::_add_view_specific_runtime_properties()
     */
    protected function _add_view_specific_runtime_properties(
        Ai1ec_Event $event
    ) {
        $end_day = $this->_registry->get( 'date.time', $event->get( 'end' ) )
            ->adjust( -1, 'second' )
            ->format_i18n( 'd' );
        $event->set_runtime( 'multiday_end_day', $end_day );
        $event->set_runtime(
            'start_day',
            $event->get( 'start' )->format( 'j' )
        );
    }

    /**
     * get_month_cell_array function
     *
     * Return an array of weeks, each containing an array of days, each
     * containing the date for the day ['date'] (if inside the month) and
     * the events ['events'] (if any) for the day, and a boolean ['today']
     * indicating whether that day is today.
     *
     * @param int $timestamp        UNIX timestamp of the 1st day of the desired
     *                            month to display
     * @param array $days_events  list of events for each day of the month in
     *                            the format returned by get_events_for_month()
     *
     * @return void
     */
    protected function get_month_cell_array( Ai1ec_Date_Time $timestamp, $days_events ) {
        $settings    = $this->_registry->get( 'model.settings' );
        $date_system = $this->_registry->get( 'date.system' );
        $today = $this->_registry->get( 'date.time' );// Used to flag today's cell

        // Figure out index of first table cell
        $first_cell_index = $timestamp->format( 'w' );
        // Modify weekday based on start of week setting
        $first_cell_index = ( 7 + $first_cell_index - $settings->get( 'week_start_day' ) ) % 7;

        // Get the last day of the month
        $last_day = $timestamp->format( 't' );
        $last_timestamp = $this->_registry->get( 'date.time', $timestamp );
        $last_timestamp->set_date(
            $timestamp->format( 'Y' ),
            $timestamp->format( 'm' ),
            $last_day
            )->set_time( 0, 0, 0 );
        // Figure out index of last table cell
        $last_cell_index = $last_timestamp->format( 'w' );
        // Modify weekday based on start of week setting
        $last_cell_index = ( 7 + $last_cell_index - $settings->get( 'week_start_day' ) ) % 7;

        $weeks = array();
        $week = 0;
        $weeks[$week] = array();

        // Insert any needed blank cells into first week
        for( $i = 0; $i < $first_cell_index; $i++ ) {
            $weeks[$week][] = array(
                'date'       => null,
                'events'     => array(),
                'date_link'  => null
            );
        }

        // Insert each month's day and associated events
        for( $i = 1; $i <= $last_day; $i++ ) {
            $day = $this->_registry->get( 'date.time' )
                ->set_date(
                    $timestamp->format( 'Y' ),
                    $timestamp->format( 'm' ),
                    $i
                )
                ->set_time( 0, 0, 0 )
                ->format();
            $exact_date = $date_system->format_date_for_url(
                $day,
                $settings->get( 'input_date_format' )
            );
            $events = array();
            foreach ( $days_events[$i] as $evt ){
                $event_data = array(
                    'filtered_title'     => $evt->get_runtime( 'filtered_title' ),
                    'post_excerpt'       => $evt->get_runtime( 'post_excerpt' ),
                    'color_style'        => $evt->get_runtime( 'color_style' ),
                    'category_colors'    => $evt->get_runtime( 'category_colors' ),
                    'permalink'          => $evt->get_runtime( 'instance_permalink' ),
                    'ticket_url_label'   => $evt->get_runtime( 'ticket_url_label' ),
                    'edit_post_link'     => $evt->get_runtime( 'edit_post_link' ),
                    'short_start_time'   => $evt->get_runtime( 'short_start_time' ),
                    'multiday_end_day'   => $evt->get_runtime( 'multiday_end_day' ),
                    'start_day'          => $evt->get_runtime( 'start_day' ),
                    'short_start_time'   => $evt->get_runtime( 'short_start_time' ),
                    'instance_id'        => $evt->get( 'instance_id' ),
                    'post_id'            => $evt->get( 'post_id' ),
                    'is_allday'          => $evt->is_allday(),
                    'is_multiday'        => $evt->is_multiday(),
                    'venue'              => $evt->get( 'venue' ),
                    'ticket_url'         => $evt->get( 'ticket_url' ),
                    'start_truncated'    => $evt->get( 'start_truncated' ),
                    'end_truncated'      => $evt->get( 'end_truncated' ),
                    'popup_timespan'     => $this->_registry
                        ->get( 'twig.ai1ec-extension')->timespan( $evt, 'short' ),
                    'avatar_not_wrapped' => $evt->getavatar( false ),
                    'avatar'             => $this->_registry
                        ->get( 'twig.ai1ec-extension')->avatar(
                            $evt,
                            array(
                                'post_thumbnail',
                                'content_img',
                                'location_avatar',
                                'category_avatar',
                            ),
                            '',
                            false ),
                );
                $meta = $this->_registry->get( 'model.meta-post' );
                if ( ! $event_data['ticket_url'] ) {
                    $timely_tickets = $meta->get(
                        $evt->get( 'post_id' ),
                        '_ai1ec_timely_tickets_url',
                        null
                    );
                    if ( $timely_tickets ) {
                        $event_data['ticket_url'] = $timely_tickets;
                        $evt->set( 'ticket_url', $event_data['ticket_url'] );
                    }
                }
                if (
                    true === apply_filters(
                        'ai1ec_buy_button_product',
                        false
                    )
                ) {
                    $full_details = $meta->get(
                        $evt->get( 'post_id' ),
                        '_ai1ec_ep_product_details',
                        null
                    );
                    if (
                        is_array( $full_details ) &&
                        isset( $full_details['show_buy_button'] ) &&
                        true === $full_details['show_buy_button']
                        && $event_data['ticket_url']
                    ) {
                        // Tickets button is shown by default in this case.
                    } else {
                        // Otherwise not.
                        $event_data['ticket_url'] = false;
                    }
                    $evt->set( 'ticket_url', $event_data['ticket_url'] );
                }

                if (
                    $this->_compatibility->use_backward_compatibility()
                ) {
                    $event_data = $evt;
                }
                $events[] = $event_data;
            }
            $weeks[$week][] = array(
                'date' => $i,
                'date_link' => $this->_create_link_for_day_view( $exact_date ),
                'today' =>
                    $timestamp->format( 'Y' ) == $today->format( 'Y' ) &&
                    $timestamp->format( 'm' ) == $today->format( 'm' ) &&
                    $i                        == $today->format( 'j' ),
                'events' => $events,

            );
            // If reached the end of the week, increment week
            if( count( $weeks[$week] ) == 7 )
                $week++;
        }

        // Insert any needed blank cells into last week
        for( $i = $last_cell_index + 1; $i < 7; $i++ ) {
            $weeks[$week][] = array( 'date' => null, 'events' => array() );
        }

        return $weeks;
    }

    /**
     * get_events_for_month function
     *
     * Return an array of all dates for the given month as an associative
     * array, with each element's value being another array of event objects
     * representing the events occuring on that date.
     *
     * @param int $time         the UNIX timestamp of a date within the desired month
     * @param array $filter     Array of filters for the events returned:
     *                          ['cat_ids']   => non-associatative array of category IDs
     *                          ['tag_ids']   => non-associatative array of tag IDs
     *                          ['post_ids']  => non-associatative array of post IDs
     *                          ['auth_ids']  => non-associatative array of author IDs
     *
     * @return array            array of arrays as per function's description
     */
    protected function get_events_for_month(
        Ai1ec_Date_Time $time,
        $filter = array()
    ) {
        $last_day = $time->format( 't' );

        $day_entry = array(
            'multi'  => array(),
            'allday' => array(),
            'other'  => array(),
        );
        $days_events = array_fill(
            1,
            $last_day,
            $day_entry
        );
        unset( $day_entry );
        $start_time = $this->_registry->get( 'date.time',  $time );
        $start_time->set_date(
            $time->format( 'Y' ),
            $time->format( 'm' ),
            1
        )->set_time( 0, 0, 0 );
        $end_time = $this->_registry->get( 'date.time',  $start_time );

        $end_time->adjust_month( 1 );

        $search = $this->_registry->get( 'model.search' );
        $month_events = $search->get_events_between(
            $start_time,
            $end_time,
            $filter,
            true
        );
        $start_time = $start_time->format();
        $end_time   = $end_time->format();
        $this->_update_meta( $month_events );
        $this->_registry->get( 'controller.content-filter' )
            ->clear_the_content_filters();
        foreach ( $month_events as $event ) {
            $event_start = $event->get( 'start' )->format();
            $event_end   = $event->get( 'end' )->format();

            /**
             * REASONING: we assume, that event spans multiple periods, one of
             * which happens to be current (month). Thus we mark, that current
             * event starts at the very first day of current month and further
             * we will mark it as having truncated beginning (unless it is not
             * overlapping period boundaries).
             * Although, if event starts after the first second of this period
             * it's start day will be decoded as time 'j' format (`int`-casted
             * to increase map access time), of it's actual start time.
            */
            $day = 1;
            if ( $event_start > $start_time ) {
                $day = (int)$event->get( 'start' )->format( 'j' );
            }

            // Set multiday properties. TODO: Should these be made event object
            // properties? They probably shouldn't be saved to the DB, so I'm
            // not sure. Just creating properties dynamically for now.
            if ( $event_start < $start_time ) {
                $event->set( 'start_truncated', true );
            }
            if ( $event_end >= $end_time ) {
                $event->set( 'end_truncated', true );
            }

            // Categorize event.
            $priority = 'other';
            if ( $event->is_allday() ) {
                $priority = 'allday';
            } elseif ( $event->is_multiday() ) {
                $priority = 'multi';
            }
            $this->_add_runtime_properties( $event );
            $days_events[$day][$priority][] = $event;
        }
        $this->_registry->get( 'controller.content-filter' )
            ->restore_the_content_filters();
        for ( $day = 1; $day <= $last_day; $day++ ) {
            $days_events[$day] = array_merge(
                $days_events[$day]['multi'],
                $days_events[$day]['allday'],
                $days_events[$day]['other']
            );
        }

        return apply_filters(
            'ai1ec_get_events_for_month',
            $days_events,
            $time,
            $filter
        );
    }

}


==================================================
FILE PATH: ./app/view/calendar/view/week.php
==================================================
<?php

/**
 * The concrete class for day view.
*
* @author     Time.ly Network Inc.
* @since      2.0
*
* @package    AI1EC
* @subpackage AI1EC.View
*/
class Ai1ec_Calendar_View_Week extends Ai1ec_Calendar_View_Abstract {

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_name()
    */
    public function get_name() {
        return 'week';
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_content()
    */
    public function get_content( array $view_args ) {
        $date_system = $this->_registry->get( 'date.system' );
        $settings    = $this->_registry->get( 'model.settings' );
        $defaults    = array(
            'week_offset'   => 0,
            'cat_ids'       => array(),
            'tag_ids'       => array(),
            'auth_ids'      => array(),
            'post_ids'      => array(),
            'instance_ids'  => array(),
            'exact_date'    => $date_system->current_time(),
        );
        $args = wp_parse_args( $view_args, $defaults );

        // Localize requested date and get components.
        $local_date = $this->_registry
            ->get( 'date.time', $args['exact_date'], 'sys.default' );
        $start_day_offset = $this->get_week_start_day_offset( $local_date->format( 'w' ) );
        // get the first day of week
        $local_date->adjust_day( 0 + $start_day_offset + ( $args['week_offset'] * 7 ) )
            ->set_time( 0, 0, 0 );

        $cell_array = $this->get_week_cell_array(
            $local_date,
            apply_filters(
                'ai1ec_get_events_relative_to_filter',
                array(
                    'cat_ids'      => $args['cat_ids'],
                    'tag_ids'      => $args['tag_ids'],
                    'post_ids'     => $args['post_ids'],
                    'auth_ids'     => $args['auth_ids'],
                    'instance_ids' => $args['instance_ids'],
                ),
                $view_args,
                apply_filters(
                    'ai1ec_show_unique_events',
                    false
                )
            )
        );

        // Create pagination links.    (Translators: '%s' = week's start date.)
        $title = sprintf(
            __( 'Week of %s', AI1EC_PLUGIN_NAME ),
            $local_date->format_i18n( 'F j' )
        );
        $pagination_links = $this->_get_pagination( $args, $title );

        $time_format = $this->_registry->get( 'model.option' )
            ->get( 'time_format', Ai1ec_I18n::__( 'g a' ) );

        // Calculate today marker's position.
        $now = $this->_registry->get( 'date.time', 'now', 'sys.default' );
        $now_text = $now->format_i18n( 'M j h:i a' );
        $now = $now->format( 'G' ) * 60 + $now->format( 'i' );
        // Find out if the current week view contains "now" and thus should display
        // the "now" marker.
        $show_now = false;
        foreach ( $cell_array as $day ) {
            if ( $day['today'] ) {
                $show_now = true;
                break;
            }
        }

        $is_ticket_button_enabled = apply_filters( 'ai1ec_week_ticket_button', false );
        $show_reveal_button       = apply_filters( 'ai1ec_week_reveal_button', false );

        $hours = array();
        $today = $this->_registry->get( 'date.time', 'now', 'sys.default' );
        for ( $hour = 0; $hour < 24; $hour++ ) {
            $hours[] = $today
                ->set_time( $hour, 0, 0 )
                ->format_i18n( $time_format );
        }

        $view_args = array(
            'title'                    => $title,
            'type'                     => 'week',
            'cell_array'               => $cell_array,
            'show_location_in_title'   => $settings->get( 'show_location_in_title' ),
            'now_top'                  => $now,
            'now_text'                 => $now_text,
            'show_now'                 => $show_now,
            'post_ids'                 => join( ',', $args['post_ids'] ),
            'time_format'              => $time_format,
            'done_allday_label'        => false,
            'done_grid'                => false,
            'data_type'                => $args['data_type'],
            'is_ticket_button_enabled' => $is_ticket_button_enabled,
            'show_reveal_button'       => $show_reveal_button,
            'text_full_day'            => __( 'Reveal full day', AI1EC_PLUGIN_NAME ),
            'text_all_day'             => __( 'All-day', AI1EC_PLUGIN_NAME ),
            'text_now_label'           => __( 'Now:', AI1EC_PLUGIN_NAME ),
            'text_venue_separator'     => __( '@ %s', AI1EC_PLUGIN_NAME ),
            'hours'                    => $hours,
            'indent_multiplier'        => 8,
            'indent_offset'            => 0,
            'pagination_links'         => $pagination_links,
        );

        // Add navigation if requested.
        $view_args['navigation'] = $this->_get_navigation(
            array(
                'no_navigation'    => $args['no_navigation'],
                'pagination_links' => $pagination_links,
                'views_dropdown'   => $args['views_dropdown'],
                'below_toolbar'    => apply_filters(
                    'ai1ec_below_toolbar',
                    '',
                    $this->get_name(),
                    $args
                ),
            )
        );

        $view_args = $this->get_extra_template_arguments( $view_args );

        return
            $this->_registry->get( 'http.request' )->is_json_required(
                $args['request_format'], 'week'
            )
            ? $this->_apply_filters_to_args( $view_args )
            : $this->_get_view( $view_args );
    }

    /**
     * Returns a non-associative array of two links for the week view of the
     * calendar:
     *    previous week, and next week.
     * Each element is an associative array containing the link's enabled status
     * ['enabled'], CSS class ['class'], text ['text'] and value to assign to
     * link's href ['href'].
     *
     * @param array  $args  Current request arguments
     * @param string $title Title to display in datepicker button
     *
     * @return array      Array of links
     */
    protected function get_week_pagination_links( $args, $title ) {
        $links = array();

        $orig_date = $args['exact_date'];

        $negative_offset = $args['week_offset'] * 7 - 7;
        $positive_offset = $args['week_offset'] * 7 + 7;
        // =================
        // = Previous week =
        // =================
        $local_date = $this->_registry
            ->get( 'date.time', $args['exact_date'], 'sys.default' )
            ->adjust_day( $negative_offset )
            ->set_time( 0, 0, 0 );
        $args['exact_date'] = $local_date->format();
        $href       = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'enabled' => true,
            'class'=> 'ai1ec-prev-week',
            'text' => '<i class="ai1ec-fa ai1ec-fa-chevron-left"></i>',
            'href' => $href->generate_href(),
        );
        // ======================
        // = Minical datepicker =
        // ======================
        $args['exact_date'] = $orig_date;
        $factory = $this->_registry->get( 'factory.html' );
        $links[] = $factory->create_datepicker_link(
            $args,
            $args['exact_date'],
            $title
        );

        // =============
        // = Next week =
        // =============
        $local_date->adjust_day( $positive_offset * 2 ); // above was (-1), (+2) is to counteract
        $args['exact_date'] = $local_date->format();
        $href    = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'enabled' => true,
            'class'=> 'ai1ec-next-week',
            'text' => '<i class="ai1ec-fa ai1ec-fa-chevron-right"></i>',
            'href' => $href->generate_href(),
        );

        return $links;
    }

    /**
     * get_week_cell_array function
     *
     * Return an associative array of weekdays, indexed by the day's date,
     * starting the day given by $timestamp, each element an associative array
     * containing three elements:
     *   ['today']     => whether the day is today
     *   ['allday']    => non-associative ordered array of events that are all-day
     *   ['notallday'] => non-associative ordered array of non-all-day events to
     *                    display for that day, each element another associative
     *                    array like so:
     *   ['top']       => how many minutes offset from the start of the day
     *   ['height']    => how many minutes this event spans
     *   ['indent']    => how much to indent this event to accommodate multiple
     *                    events occurring at the same time (0, 1, 2, etc., to
     *                    be multiplied by whatever desired px/em amount)
     *   ['event']     => event data object
     *
     * @param int $start_of_week    the UNIX timestamp of the first day of the week
     * @param array $filter     Array of filters for the events returned:
     *                          ['cat_ids']   => non-associatative array of category IDs
     *                          ['tag_ids']   => non-associatative array of tag IDs
     *                          ['post_ids']  => non-associatative array of post IDs
     *                          ['auth_ids']  => non-associatative array of author IDs
     *
     * @return array            array of arrays as per function description
     */
    protected function get_week_cell_array( Ai1ec_Date_Time $start_of_week, $filter = array() ) {
        $search      = $this->_registry->get( 'model.search' );
        $settings    = $this->_registry->get( 'model.settings' );
        $date_system = $this->_registry->get( 'date.system' );
        $end_of_week = $this->_registry->get( 'date.time', $start_of_week );
        $end_of_week->adjust_day( 7 );
        // Do one SQL query to find all events for the week, including spanning
        $week_events = $search->get_events_between(
            $start_of_week,
            $end_of_week,
            $filter,
            true
        );
        $this->_update_meta( $week_events );
        // Split up events on a per-day basis
        $all_events = array();
        $this->_days_cache = $this->_registry->get( 'cache.memory' );
        $this->_registry->get( 'controller.content-filter' )
            ->clear_the_content_filters();
        foreach ( $week_events as $evt ) {
            list( $evt_start, $evt_end ) = $this->
                _get_view_specific_timestamps( $evt );

            // Iterate through each day of the week and generate new event object
            // based on this one for each day that it spans
            for (
                $day = $start_of_week->format( 'j' ),
                    $last_week_day_index = $start_of_week->format( 'j' ) + 7;
                $day < $last_week_day_index;
                $day++
            ) {
                list( $day_start, $day_end ) = $this->
                    _get_wkday_start_end( $day, $start_of_week );

                if ( $evt_end < $day_start ) {
                    break; // save cycles
                }

                // If event falls on this day, make a copy.
                if ( $evt_end > $day_start && $evt_start < $day_end ) {
                    $_evt = clone $evt;
                    if ( $evt_start < $day_start ) {
                        // If event starts before this day, adjust copy's start time
                        $_evt->set( 'start', $day_start );
                        $_evt->set( 'start_truncated', true );
                    }
                    if ( $evt_end > $day_end ) {
                        // If event ends after this day, adjust copy's end time
                        $_evt->set( 'end', $day_end );
                        $_evt->set( 'end_truncated', true );
                    }

                    // Store reference to original, unmodified event, required by view.
                    $_evt->set( '_orig', $evt );
                    $this->_add_runtime_properties( $_evt );

                    // Place copy of event in appropriate category
                    if ( $_evt->is_allday() ) {
                        $all_events[$day_start]['allday'][] = $_evt;
                    } else {
                        $all_events[$day_start]['notallday'][] = $_evt;
                    }
                }
            }
        }
        $this->_registry->get( 'controller.content-filter' )
            ->restore_the_content_filters();
        // This will store the returned array
        $days = array();
        $now  = $this->_registry->get(
            'date.time',
            'now',
            $start_of_week->get_timezone()
        );
        // =========================================
        // = Iterate through each date of the week =
        // =========================================
        for (
            $day = $start_of_week->format( 'j' ),
                $last_week_day_index = $start_of_week->format( 'j' ) + 7;
            $day < $last_week_day_index;
            $day++
        ) {
            list( $day_date, , $day_date_ob ) = $this->
                _get_wkday_start_end( $day, $start_of_week );

            $exact_date = $date_system->format_datetime_for_url(
                $day_date_ob,
                $settings->get( 'input_date_format' )
            );
            $href_for_date = $this->_create_link_for_day_view( $exact_date );

            // Initialize empty arrays for this day if no events to minimize warnings
            if ( ! isset( $all_events[$day_date]['allday'] ) ) {
                $all_events[$day_date]['allday'] = array();
            }
            if ( ! isset( $all_events[$day_date]['notallday'] ) ) {
                $all_events[$day_date]['notallday'] = array();
            }

            $evt_stack = array( 0 ); // Stack to keep track of indentation

            foreach ( $all_events[$day_date] as $event_type => &$events ) {
                foreach ( $events as &$evt ) {
                    $event = array(
                        'filtered_title'     => $evt->get_runtime( 'filtered_title' ),
                        'post_excerpt'       => $evt->get_runtime( 'post_excerpt' ),
                        'color_style'        => $evt->get_runtime( 'color_style' ),
                        'category_colors'    => $evt->get_runtime( 'category_colors' ),
                        'permalink'          => $evt->get_runtime( 'instance_permalink' ),
                        'ticket_url_label'   => $evt->get_runtime( 'ticket_url_label' ),
                        'edit_post_link'     => $evt->get_runtime( 'edit_post_link' ),
                        'faded_color'        => $evt->get_runtime( 'faded_color' ),
                        'rgba_color'         => $evt->get_runtime( 'rgba_color' ),
                        'short_start_time'   => $evt->get_runtime( 'short_start_time' ),
                        'instance_id'        => $evt->get( 'instance_id' ),
                        'post_id'            => $evt->get( 'post_id' ),
                        'is_multiday'        => $evt->get( 'is_multiday' ),
                        'venue'              => $evt->get( 'venue' ),
                        'ticket_url'         => $evt->get( 'ticket_url' ),
                        'start_truncated'    => $evt->get( 'start_truncated' ),
                        'end_truncated'      => $evt->get( 'end_truncated' ),
                        'popup_timespan'     => $this->_registry
                            ->get( 'twig.ai1ec-extension')->timespan( $evt, 'short' ),
                        'avatar_not_wrapped' => $evt->getavatar( false ),
                        'avatar'             => $this->_registry
                            ->get( 'twig.ai1ec-extension')->avatar(
                                $evt,
                                array(
                                    'post_thumbnail',
                                    'content_img',
                                    'location_avatar',
                                    'category_avatar',
                                ),
                                '',
                                false ),
                    );
                    $meta = $this->_registry->get( 'model.meta-post' );
                    if ( ! $event['ticket_url'] ) {
                        $timely_tickets = $meta->get(
                            $evt->get( 'post_id' ),
                            '_ai1ec_timely_tickets_url',
                            null
                        );
                        if ( $timely_tickets ) {
                            $event['ticket_url'] = $timely_tickets;
                            $evt->set( 'ticket_url', $event['ticket_url'] );
                        }
                    }
                    if (
                        true === apply_filters(
                            'ai1ec_buy_button_product',
                            false
                        )
                    ) {
                        $full_details = $meta->get(
                            $evt->get( 'post_id' ),
                            '_ai1ec_ep_product_details',
                            null
                        );
                        if (
                            is_array( $full_details ) &&
                            isset( $full_details['show_buy_button'] ) &&
                            true === $full_details['show_buy_button']
                            && $event['ticket_url']
                        ) {
                            // Tickets button is shown by default in this case.
                        } else {
                            // Otherwise not.
                            $event['ticket_url'] = false;
                        }
                        $evt->set( 'ticket_url', $event['ticket_url'] );
                    }

                    if (
                        $this->_compatibility->use_backward_compatibility()
                    ) {
                        $event = $evt;
                    }
                    if ( 'notallday' === $event_type) {
                        $start = $evt->get( 'start' );
                        // Calculate top and bottom edges of current event
                        $top = $start->format( 'G' ) * 60 + $start->format( 'i' );
                        $bottom = min( $top + $evt->get_duration() / 60, 1440 );
                        // While there's more than one event in the stack and this event's top
                        // position is beyond the last event's bottom, pop the stack
                        while ( count( $evt_stack ) > 1 && $top >= end( $evt_stack ) ) {
                            array_pop( $evt_stack );
                        }
                        // Indentation is number of stacked events minus 1
                        $indent = count( $evt_stack ) - 1;
                        // Push this event onto the top of the stack
                        array_push( $evt_stack, $bottom );
                        $evt = array(
                            'top'    => $top,
                            'height' => $bottom - $top,
                            'indent' => $indent,
                            'event'  => $event,
                        );
                    } else {
                        $evt = $event;
                    }
                }
            }

            $days[$day_date] = array(
                'today'     =>
                    $day_date_ob->format( 'Y' ) == $now->format( 'Y' ) &&
                    $day_date_ob->format( 'm' ) == $now->format( 'm' ) &&
                    $day_date_ob->format( 'j' ) == $now->format( 'j' ),
                'allday'    => $all_events[$day_date]['allday'],
                'notallday' => $all_events[$day_date]['notallday'],
                'href'      => $href_for_date,
                'day'       => $this->_registry->
                    get( 'date.time', $day_date )->format_i18n( 'j' ),
                'weekday'   => $this->_registry->
                    get( 'date.time', $day_date )->format_i18n( 'D' ),
            );
        }

        return apply_filters( 'ai1ec_get_week_cell_array', $days, $start_of_week, $filter );
    }

    /**
     * get_week_start_day_offset function
     *
     * Returns the day offset of the first day of the week given a weekday in
     * question.
     *
     * @param int $wday      The weekday to get information about
     * @return int           A value between -6 and 0 indicating the week start
     *                       day relative to the given weekday.
     */
    protected function get_week_start_day_offset( $wday ) {
        $settings = $this->_registry->get( 'model.settings' );
        return - ( 7 - ( $settings->get( 'week_start_day' ) - $wday ) ) % 7;
    }

    /**
     * Get start/end timestamps for a given weekday and week start identifier.
     *
     * @param int             $day        Week day number.
     * @param Ai1ec_Date_Time $week_start Date/Time information for week start.
     *
     * @return array List of start and and timestamps, 0-indexed array.
     */
    protected function _get_wkday_start_end(
        $day,
        Ai1ec_Date_Time $week_start
    ) {
        $entry = null;
        $day   = (int)$day;
        if ( null === ( $entry = $this->_days_cache->get( $day ) ) ) {
            $day_start = $this->_registry
                ->get( 'date.time', $week_start )
                ->set_date(
                    $week_start->format( 'Y' ),
                    $week_start->format( 'm' ),
                    $day
                )
                ->set_time( 0, 0, 0 );
            $day_end   = $this->_registry->get( 'date.time', $day_start );
            $day_end->adjust_day( 1 );
            $entry     = array(
                $day_start->format(),
                $day_end->format(),
                $day_start
            );
            unset( $day_end ); // discard and free memory
            $this->_days_cache->set( $day, $entry );
        }
        return $entry;
    }

}


==================================================
FILE PATH: ./app/view/calendar/view/abstract.php
==================================================
<?php

/**
 * The abstract class for a view.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
abstract class Ai1ec_Calendar_View_Abstract extends Ai1ec_Base {

    /**
     * @var Ai1ec_Request_Parser The request object
     */
    protected $_request;

    /**
     * @var Ai1ec_Compatibility_Check Theme compatibility check object.
     */
    protected $_compatibility;

    /**
     * Public constructor
     *
     * @param Ai1ec_Registry_Object $registry
     * @param Ai1ec_Request_Parser $request
     */
    public function __construct( Ai1ec_Registry_Object $registry, Ai1ec_Request_Parser $request ) {
        parent::__construct( $registry );
        $this->_request       = $request;
        $this->_compatibility = $registry->get( 'compatibility.check' );
    }

    /**
     * Get the machine name for the view
     *
     * @return string The machine name of the view.
     */
    abstract public function get_name();

    /**
     * Get extra arguments specific for the view
     *
     * @param array $view_args
     * @param int|bool $exact_date the exact date used to display the view.
     *
     * @return array The view arguments with the extra parameters added.
     */
    public function get_extra_arguments( array $view_args, $exact_date ) {
        $offset = $this->get_name() . '_offset';
        $view_args[$offset] = $this->_request->get( $offset );
        if( false !== $exact_date ) {
            $view_args['exact_date'] = $exact_date;
        }
        return $view_args;
    }

    /**
     * Get extra arguments specific for the view's template
     *
     * @param array $args
     *
     * @return array The template arguments with the extra parameters added.
     */
    public function get_extra_template_arguments( array $args ) {
        $loader                 = $this->_registry->get( 'theme.loader' );
        $args['action_buttons'] = apply_filters(
            'ai1ec_add_action_buttons',
            $this->_action_buttons()
        );
        if (
            true === apply_filters(
                'ai1ec_buy_button_product',
                false
            )
        ) {
            $args['has_product_buy_button'] = true;
        }
        return $args;
    }

    /**
     * Render the view and return the content
     *
     * @param array $view_args
     *
     * @return string the html of the view
     */
    abstract public function get_content( array $view_args );

    /**
     *
     * @return string HTML of action buttons
     */
    protected function _action_buttons() {
        $loader         = $this->_registry->get( 'theme.loader' );
        $action_buttons = $loader->get_file(
            'buttons.twig',
            array(
                'action_buttons' => apply_filters(
                    'ai1ec_action_buttons',
                    ''
                ),
                'tickets_button' => true,
                'text_tickets'   => __( 'Tickets', AI1EC_PLUGIN_NAME ),
                'has_buy_tickets_product' => apply_filters(
                    'ai1ec_buy_button_product',
                    false
                )
            ),
            false
        )->get_content();
        return $action_buttons;
    }


    /**
     *
     * @param string $exact_date
     */
    protected function _create_link_for_day_view( $exact_date ) {
        $href = $this->_registry->get(
            'html.element.href',
            array(
                'action'     => 'oneday',
                'exact_date' => $exact_date,
            )
        );
        return $href->generate_href();
    }

    /**
     * Get the view html
     *
     * @param array $view_args
     *
     * @return string
     */
    protected function _get_view( array $view_args ) {
        $loader = $this->_registry->get( 'theme.loader' );
        $view = $this->get_name();
        $file = $loader->get_file( $view . '.twig', $view_args, false );

        return apply_filters(
            'ai1ec_get_' . $view . '_view',
            $file->get_content(),
            $view_args
        );
    }

    /**
     * Applies filters to view args for front end rendering
     *
     * @param array $args
     */
    protected function _apply_filters_to_args( array $args ) {
        $loader = $this->_registry->get( 'theme.loader' );
        $view   = $this->get_name();
        return $loader->apply_filters_to_args( $args, $view . '.twig', false );
    }

    /**
     * Prepare week specific event start/end timestamps.
     *
     * @param Ai1ec_Event $event Instance of event.
     *
     * @return array Start and end respectively in 0 and 1 positions.
     */
    protected function _get_view_specific_timestamps( Ai1ec_Event $event ) {
        if ( $event->is_allday() ) {
            // reset to be day-contained with respect to current timezone
            $event_start = $this->_registry
                ->get( 'date.time', $event->get( 'start' ), 'sys.default' )
                ->set_time( 0, 0, 0 )
                ->format();
            $event_end   = $this->_registry
                ->get( 'date.time', $event->get( 'end' ), 'sys.default' )
                ->set_time( 0, 0, 0 )
                ->format();
        } else {
            $event_start = $event->get( 'start' )->format();
            $event_end   = $event->get( 'end' )->format();
        }
        return array( $event_start, $event_end );
    }

    /**
     * Update metadata for retrieved events.
     *
     * This speeds up further meta data requests.
     *
     * @param array $events List of events retrieved.
     *
     * @return void
     */
    protected function _update_meta( array $events ) {
        $post_ids = array();
        foreach ( $events as $event ) {
            $post_ids[] = (int)$event->get( 'post_id' );
        }
        update_meta_cache( 'post', $post_ids );
        $this->_registry->get( 'model.taxonomy' )
            ->update_meta( $post_ids );
    }

    /**
     * Gets the navigation bar HTML.
     *
     * @param array $nav_args Args for the navigation bar template, including
     *                        'no_navigation' which determines whether to show it
     * @return string
     */
    protected function _get_navigation( array $nav_args ) {
        $navigation                       = '';
        $loader                           = $this->_registry->get( 'theme.loader' );
        $nav_args['contribution_buttons'] = apply_filters(
            'ai1ec_contribution_buttons',
            '',
            'html',
            'render-command'
        );
        if ( true !== $nav_args['no_navigation'] ) {
            $navigation = $loader->get_file(
                'navigation.twig',
                $nav_args,
                false
            )->get_content();
        }
        return $navigation;
    }

    /**
     * Calls the get_*_pagination_links method for the current view type and
     * renders its result, returning the rendered pagination links.
     *
     * @param array  $args  Current request arguments
     * @param string $title Title to display in datepicker button
     * @return string
     */
    protected function _get_pagination( array $args, $title ) {
        $method = 'get_' . $this->get_name() . '_pagination_links';
        $pagination_links = $this->$method( $args, $title );
        $loader           = $this->_registry->get( 'theme.loader' );
        $pagination_links = $loader->get_file(
            'pagination.twig',
            array(
                'links'      => $pagination_links,
                'data_type'  => $args['data_type'],
            ),
            false
        )->get_content();
        return $pagination_links;
    }

    /**
     * Adds runtime properties to the event.
     *
     * @param Ai1ec_Event $event
     */
    protected function _add_runtime_properties( Ai1ec_Event $event ) {
        global $post;
        $original_post      = $post;
        $post               = $event->get( 'post' );
        $instance_permalink = get_permalink(
            $event->get( 'post_id' )
        );
        $instance_permalink = add_query_arg(
            'instance_id',
            $event->get( 'instance_id' ),
            $instance_permalink
        );
        $event->set_runtime( 'instance_permalink', $instance_permalink );

        $event->set_runtime(
            'filtered_title',
            apply_filters(
                'the_title',
                $event->get( 'post' )->post_title,
                $event->get( 'post_id' ),
                true
            )
        );
        $calendar_state = $this->_registry->get( 'calendar.state' );
        $calendar_state->set_append_content( false );
        $event->set_runtime(
            'filtered_content',
            apply_filters(
                'ai1ec_the_content',
                apply_filters(
                    'the_content',
                    $event->get( 'post' )->post_content
                )
            )
        );
        $calendar_state->set_append_content( true );

        $taxonomy = $this->_registry->get( 'view.event.taxonomy' );
        $ticket   = $this->_registry->get( 'view.event.ticket' );
        $event->set_runtime(
            'color_style',
            $taxonomy->get_color_style( $event )
        );
        $event->set_runtime( 'category_colors', $taxonomy->get_category_colors( $event ) );
        $event->set_runtime( 'ticket_url_label', $ticket->get_tickets_url_label( $event, false ) );
        $event->set_runtime( 'edit_post_link', get_edit_post_link( $event->get( 'post_id' ) ) );
        $event_post = $this->_registry->get( 'view.event.post' );
        $event->set_runtime( 'post_excerpt', $event_post->trim_excerpt( $event ) );
        $color = $this->_registry->get( 'view.event.color' );
        $event->set_runtime( 'faded_color', $color->get_faded_color( $event ) );
        $event->set_runtime( 'rgba_color', $color->get_rgba_color( $event ) );
        $event->set_runtime(
            'short_start_time',
            $this->_registry->get( 'view.event.time' )
            ->get_short_time( $event->get( 'start' ) )
        );
        $this->_add_view_specific_runtime_properties( $event );
        $post = $original_post;
    }

    /**
     * If some views have specific runtime properties they must extend this method
     *
     * @param Ai1ec_Event $event
     */
    protected function _add_view_specific_runtime_properties( Ai1ec_Event $event ) {

    }
}


==================================================
FILE PATH: ./app/view/calendar/view/agenda.php
==================================================
<?php

/**
 * The concrete class for agenda view.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_Calendar_View_Agenda extends Ai1ec_Calendar_View_Abstract {

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_name()
    */
    public function get_name() {
        return 'agenda';
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_content()
    */
    public function get_content( array $view_args ) {

        $type = $this->get_name();
        $time = $this->_registry->get( 'date.system' );
        // Get localized time
        $timestamp = $time->current_time();

        // Get events, then classify into date array
        $per_page_setting = $type . '_events_per_page';
        $search           = $this->_registry->get( 'model.search' );
        $settings         = $this->_registry->get( 'model.settings' );
        $events_limit     = is_numeric( $view_args['events_limit'] )
            ? $view_args['events_limit']
            : $settings->get( $per_page_setting );
        $events_limit = apply_filters(
            'ai1ec_events_limit',
            $events_limit
        );
        $relative_to_reference = in_array( $this->get_name(), array( 'agenda', 'posterboard', 'stream' ) );
        if ( $relative_to_reference ) {
            $results = $search->get_events_relative_to_reference(
                $view_args['time_limit'],
                $events_limit,
                $view_args['page_offset'],
                apply_filters(
                    'ai1ec_get_events_relative_to_filter',
                    array(
                        'post_ids'     => $view_args['post_ids'],
                        'auth_ids'     => $view_args['auth_ids'],
                        'cat_ids'      => $view_args['cat_ids'],
                        'tag_ids'      => $view_args['tag_ids'],
                        'instance_ids' => $view_args['instance_ids'],
                    ),
                    $view_args
                    ),
                apply_filters(
                    'ai1ec_show_unique_events',
                    false
                    )
                );
        } else {
            $results = $search->get_events_relative_to(
                $timestamp,
                $events_limit,
                $view_args['page_offset'],
                apply_filters(
                    'ai1ec_get_events_relative_to_filter',
                    array(
                        'post_ids'     => $view_args['post_ids'],
                        'auth_ids'     => $view_args['auth_ids'],
                        'cat_ids'      => $view_args['cat_ids'],
                        'tag_ids'      => $view_args['tag_ids'],
                        'instance_ids' => $view_args['instance_ids'],
                    ),
                    $view_args
                ),
                $view_args['time_limit'],
                apply_filters(
                    'ai1ec_show_unique_events',
                    false
                )
            );
        }
        $this->_update_meta( $results['events'] );
        $dates = $this->get_agenda_like_date_array(
            $results['events'],
            $view_args['request']
        );


        // Generate title of view based on date range month & year.
        $range_start       = $results['date_first'] &&
                                false === $results['date_first']->is_empty() ?
                                    $results['date_first'] :
                                    $this->_registry->get( 'date.time', $timestamp );
        $range_end         = $results['date_last'] &&
                                false === $results['date_last']->is_empty() ?
                                    $results['date_last'] :
                                    $this->_registry->get( 'date.time', $timestamp );
        $range_start       = $this->_registry->get( 'date.time', $range_start );
        $range_end         = $this->_registry->get( 'date.time', $range_end );
        $start_year        = $range_start->format_i18n( 'Y' );
        $end_year          = $range_end->format_i18n( 'Y' );
        $start_month       = $range_start->format_i18n( 'F' );
        $start_month_short = $range_start->format_i18n( 'M' );
        $end_month         = $range_end->format_i18n( 'F' );
        $end_month_short   = $range_end->format_i18n( 'M' );
        if ( $start_year === $end_year && $start_month === $end_month ) {
            $title = "$start_month $start_year";
            $title_short = "$start_month_short $start_year";
        } elseif ( $start_year === $end_year ) {
            $title = "$start_month  $end_month $end_year";
            $title_short = "$start_month_short  $end_month_short $end_year";
        } else {
            $title = "$start_month $start_year  $end_month $end_year";
            $title_short = "$start_month_short $start_year  $end_month_short $end_year";
        }

        // Create navigation bar if requested.
        $navigation       = '';
        $loader           = $this->_registry->get( 'theme.loader' );
        $pagination_links = '';
        if ( ! $view_args['no_navigation'] ) {

            if ( $relative_to_reference ) {
                $pagination_links = $this->_get_pagination_links(
                    $view_args,
                    $results['prev'],
                    $results['next'],
                    $results['date_first'],
                    $results['date_last'],
                    $title,
                    $title_short,
                    $view_args['page_offset'] + -1,
                    $view_args['page_offset'] + 1
                    );
            } else {
                $pagination_links = $this->_get_agenda_like_pagination_links(
                    $view_args,
                    $results['prev'],
                    $results['next'],
                    $results['date_first'],
                    $results['date_last'],
                    $title,
                    $title_short,
                    null === $view_args['time_limit'] ||
                                0 === $view_args['time_limit'] ?
                                    $timestamp :
                                    $view_args['time_limit']
                );
            }

            $pagination_links = $loader->get_file(
                'pagination.twig',
                array(
                    'links'      => $pagination_links,
                    'data_type'  => $view_args['data_type'],
                ),
                false
            )->get_content();

            // Get HTML for navigation bar.
            $nav_args = array(
                'no_navigation'    => $view_args['no_navigation'],
                'pagination_links' => $pagination_links,
                'views_dropdown'   => $view_args['views_dropdown'],
                'below_toolbar'    => apply_filters(
                    'ai1ec_below_toolbar',
                    '',
                    $type,
                    $view_args
                ),
            );
            // Add extra buttons to Agenda view's nav bar if events were returned.
            if ( $type === 'agenda' && $dates ) {
                $button_args = array(
                    'text_collapse_all' => __( 'Collapse All', AI1EC_PLUGIN_NAME ),
                    'text_expand_all'   => __( 'Expand All', AI1EC_PLUGIN_NAME ),
                );
                $nav_args['after_pagination'] = $loader
                    ->get_file( 'agenda-buttons.twig', $button_args, false )
                    ->get_content();
            }
            $navigation = $this->_get_navigation( $nav_args );
        }

        $is_ticket_button_enabled = apply_filters( 'ai1ec_' . $type . '_ticket_button', false );
        $args = array(
            'title'                     => $title,
            'dates'                     => $dates,
            'type'                      => $type,
            'show_year_in_agenda_dates' => $settings->get( 'show_year_in_agenda_dates' ),
            'expanded'                  => $settings->get( 'agenda_events_expanded' ),
            'show_location_in_title'    => $settings->get( 'show_location_in_title' ),
            'page_offset'               => $view_args['page_offset'],
            'navigation'                => $navigation,
            'pagination_links'          => $pagination_links,
            'post_ids'                  => join( ',', $view_args['post_ids'] ),
            'data_type'                 => $view_args['data_type'],
            'is_ticket_button_enabled'  => $is_ticket_button_enabled,
            'text_upcoming_events'      => __( 'There are no upcoming events to display at this time.', AI1EC_PLUGIN_NAME ),
            'text_edit'                 => __( 'Edit', AI1EC_PLUGIN_NAME ),
            'text_read_more'            => __( 'Read more', AI1EC_PLUGIN_NAME ),
            'text_categories'           => __( 'Categories:', AI1EC_PLUGIN_NAME ),
            'text_tags'                 => __( 'Tags:', AI1EC_PLUGIN_NAME ),
            'text_venue_separator'      => __( '@ %s', AI1EC_PLUGIN_NAME ),
        );

        // Allow child views to modify arguments passed to template.
        $args = $this->get_extra_template_arguments( $args );

        return
            $this->_registry->get( 'http.request' )->is_json_required(
                $view_args['request_format'], $type
            )
            ? $loader->apply_filters_to_args( $args, $type . '.twig', false )
            : $this->_get_view( $args );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_extra_arguments()
     */
    public function get_extra_arguments( array $view_args, $exact_date ) {
        $view_args += $this->_request->get_dict( array(
            'page_offset',
            'time_limit',
        ) );
        if( false !== $exact_date ) {
            $view_args['time_limit'] = $exact_date;
        }
        return $view_args;
    }

    /**
     * Breaks down the given ordered array of event objects into dates, and
     * outputs an ordered array of two-element associative arrays in the
     * following format:
     *    key: localized UNIX timestamp of date
     *    value:
     *        ['events'] => two-element associatative array broken down thus:
     *            ['allday'] => all-day events occurring on this day
     *            ['notallday'] => all other events occurring on this day
     *        ['today'] => whether or not this date is today
     *
     * @param array                     $events Event results
     * @param Ai1ec_Abstract_Query|null $query  Current calendar page request, if
     *                                          any (null for widget)
     *
     * @return array
     */
    public function get_agenda_like_date_array(
        $events,
        Ai1ec_Abstract_Query $query = null
    ) {
        $dates    = array();
        $time     = $this->_registry->get( 'date.system' );
        $settings = $this->_registry->get( 'model.settings' );
        $this->_registry->get( 'controller.content-filter' )
            ->clear_the_content_filters();
        // Classify each event into a date/allday category
        foreach ( $events as $event ) {
            $start_time    = $this->_registry
                ->get(
                    'date.time',
                    $event->get( 'start' )->format( 'Y-m-d\T00:00:00' ),
                    'sys.default'
                );
            $exact_date    = $time->format_datetime_for_url(
                $start_time,
                $settings->get( 'input_date_format' )
            );
            $href_for_date = $this->_create_link_for_day_view( $exact_date );
            // timestamp is used to have correctly sorted array as UNIX
            // timestamp never goes in decreasing order for increasing dates.
            $timestamp     = $start_time->format();
            // Ensure all-day & non all-day categories are created in correct
            // order: "allday" preceding "notallday".
            if ( ! isset( $dates[$timestamp]['events'] ) ) {
                $dates[$timestamp]['events'] = array(
                    'allday'    => array(),
                    'notallday' => array(),
                );
            }
            $this->_add_runtime_properties( $event );
            // Add the event.
            $category                           = $event->is_allday()
                ? 'allday'
                : 'notallday';
            $event_props                        = array();
            $event_props['post_id']             = $event->get( 'post_id' );
            $event_props['instance_id']         = $event->get( 'instance_id' );
            $event_props['venue']               = $event->get( 'venue' );
            $event_props['ticket_url']          = $event->get( 'ticket_url' );
            $event_props['filtered_title']      = $event->get_runtime( 'filtered_title' );
            $event_props['edit_post_link']      = $event->get_runtime( 'edit_post_link' );
            $event_props['content_img_url']     = $event->get_runtime( 'content_img_url' );
            $event_props['filtered_content']    = $event->get_runtime( 'filtered_content' );
            $event_props['ticket_url_label']    = $event->get_runtime( 'ticket_url_label' );
            $event_props['permalink']           = $event->get_runtime( 'instance_permalink' );
            $event_props['categories_html']     = $event->get_runtime( 'categories_html' );
            $event_props['category_bg_color']   = $event->get_runtime( 'category_bg_color' );
            $event_props['category_text_color'] = $event->get_runtime( 'category_text_color' );
            $event_props['tags_html']           = $event->get_runtime( 'tags_html' );
            $event_props['post_excerpt']        = $event->get_runtime( 'post_excerpt' );
            $event_props['short_start_time']    = $event->get_runtime( 'short_start_time' );
            $event_props['is_allday']           = $event->is_allday();
            $event_props['is_multiday']         = $event->is_multiday();
            $event_props['enddate_info']        = $event->getenddate_info();
            $event_props['timespan_short']      = $event->_registry->
                get( 'view.event.time' )->get_timespan_html( $event, 'short' );
            $event_props['avatar']              = $event->getavatar();
            $event_props['avatar_not_wrapped']  = $event->getavatar( false );
            $event_props['avatar_url']  = $this->_registry
                ->get( 'view.event.avatar' )->get_event_avatar_url( $event );
            $event_props['category_divider_color'] = $event->get_runtime(
                'category_divider_color'
            );

            $meta = $this->_registry->get( 'model.meta-post' );
            if ( ! $event_props['ticket_url'] ) {
                $timely_tickets = $meta->get(
                    $event->get( 'post_id' ),
                    '_ai1ec_timely_tickets_url',
                    null
                );
                if ( $timely_tickets ) {
                    $event_props['ticket_url'] = $timely_tickets;
                    $event->set( 'ticket_url', $event_props['ticket_url'] );
                }
            }
            if (
                true === apply_filters(
                    'ai1ec_buy_button_product',
                    false
                )
            ) {
                $full_details = $meta->get(
                    $event->get( 'post_id' ),
                    '_ai1ec_ep_product_details',
                    null
                );
                if (
                    is_array( $full_details ) &&
                    isset( $full_details['show_buy_button'] ) &&
                    true === $full_details['show_buy_button']
                    && $event_props['ticket_url']
                ) {
                    // Tickets button is shown by default in this case.
                } else {
                    // Otherwise not.
                    $event_props['ticket_url'] = false;
                }
                $event->set( 'ticket_url', $event_props['ticket_url'] );
            }

            $event_object = $event_props;
            if (
                $this->_compatibility->use_backward_compatibility()
            ) {
                $event_object = $event;
            }

            $months   = apply_filters( 'ai1ec_i18n_months', array() );
            $weekdays = apply_filters( 'ai1ec_i18n_weekdays', array() );

            $dates[$timestamp]['events'][$category][] = $event_object;
            $dates[$timestamp]['href']                = $href_for_date;
            $dates[$timestamp]['day']                 = $this->_registry->
                get( 'date.time', $timestamp )->format_i18n( 'j' );

            $w                                        = $this->
                _registry->get( 'date.time', $timestamp )->format_i18n( 'D' );
            $dates[$timestamp]['weekday']             = array_key_exists( $w, $weekdays ) ? $weekdays[$w] : $w;

            $m                                        = $this->
                _registry->get( 'date.time', $timestamp )->format_i18n( 'M' );
            $dates[$timestamp]['month']               = array_key_exists( $m, $months ) ? $months[$m] : $m;

            $this->_registry->
                get( 'date.time', $timestamp )->format_i18n( 'M' );

            $dates[$timestamp]['full_month']          = $this->_registry->
                get( 'date.time', $timestamp )->format_i18n( 'F' );
            $dates[$timestamp]['full_weekday']        = $this->_registry->
                get( 'date.time', $timestamp )->format_i18n( 'l' );
            $dates[$timestamp]['year']                = $this->_registry->
                get( 'date.time', $timestamp )->format_i18n( 'Y' );
        }
        $this->_registry->get( 'controller.content-filter' )
            ->restore_the_content_filters();
        // Flag today
        $today = $this->_registry->get( 'date.time', 'now', 'sys.default' )
            ->set_time( 0, 0, 0 )
            ->format();
        if ( isset( $dates[$today] ) ) {
            $dates[$today]['today'] = true;
        }
        return $dates;
    }

    /**
     * Returns an associative array of two links for any agenda-like view of the
     * calendar:
     *    previous page (if previous events exist),
     *    next page (if next events exist).
     * Each element is an associative array containing the link's enabled status
     * ['enabled'], CSS class ['class'], text ['text'] and value to assign to
     * link's href ['href'].
     *
     * @param array $args Current request arguments
     *
     * @param bool     $prev         Whether there are more events before
     *                               the current page
     * @param bool     $next         Whether there are more events after
     *                               the current page
     * @param Ai1ec_Date_Time|null $date_first
     * @param Ai1ec_Date_Time|null $date_last
     * @param string   $title        Title to display in datepicker button
     * @param string   $title_short  Short month names.
     * @param int|null $default_time_limit  The default time limit in the case of pagination ends.
     * @return array      Array of links
     */
    protected function _get_agenda_like_pagination_links(
        $args,
        $prev               = false,
        $next               = false,
        $date_first         = null,
        $date_last          = null,
        $title              = '',
        $title_short        = '',
        $default_time_limit = 0
    ) {
        $links = array();

        if (
            $this->_registry->get(
                'model.settings'
            )->get( 'ai1ec_use_frontend_rendering' )
        ) {
            $args['request_format'] = 'json';
        }
        $args['page_offset'] = -1;
        if ( null === $date_first || $date_first->is_empty() ) {
            $args['time_limit'] = $default_time_limit;
        } else {
            $args['time_limit'] = $this->_registry
                ->get( 'date.time', $date_first )->set_time(
                    $date_first->format( 'H' ),
                    $date_first->format( 'i' ),
                    $date_first->format( 's' ) - 1
                )->format_to_gmt();
        }
        $href = $this->_registry->get(
            'html.element.href',
            $args
        );
        $links[] = array(
            'class'   => 'ai1ec-prev-page',
            'text'    => '<i class="ai1ec-fa ai1ec-fa-chevron-left"></i>',
            'href'    => $href->generate_href(),
            'enabled' => $prev,
        );

        // Minical datepicker.
        $factory = $this->_registry->get( 'factory.html' );
        $links[] = $factory->create_datepicker_link(
            $args,
            $date_first->format_to_gmt(),
            $title,
            $title_short
        );

        $args['page_offset'] = 1;
        if ( null === $date_last || $date_last->is_empty() ) {
            $args['time_limit'] = $default_time_limit;
        } else {
            $args['time_limit'] = $this->_registry
                ->get( 'date.time', $date_last )->set_time(
                    $date_last->format( 'H' ),
                    $date_last->format( 'i' ),
                    $date_last->format( 's' ) + 1
                )->format_to_gmt();
        }
        $href = $this->_registry->get(
            'html.element.href',
            $args
        );
        $links[] = array(
            'class'   => 'ai1ec-next-page',
            'text'    => '<i class="ai1ec-fa ai1ec-fa-chevron-right"></i>',
            'href'    => $href->generate_href(),
            'enabled' => $next,
        );

        return $links;
    }

    /**
     * Returns an associative array of two links for any agenda-like view of the
     * calendar:
     *    previous page (if previous events exist),
     *    next page (if next events exist).
     * Each element is an associative array containing the link's enabled status
     * ['enabled'], CSS class ['class'], text ['text'] and value to assign to
     * link's href ['href'].
     *
     * @param array $args Current request arguments
     *
     * @param bool     $prev         Whether there are more events before
     *                               the current page
     * @param bool     $next         Whether there are more events after
     *                               the current page
     * @param Ai1ec_Date_Time|null $date_first
     * @param Ai1ec_Date_Time|null $date_last
     * @param string   $title        Title to display in datepicker button
     * @param string   $title_short  Short month names.
     * @param int|null $default_time_limit  The default time limit in the case of pagination ends.
     * @return array      Array of links
     */
    protected function _get_pagination_links(
        $args,
        $prev = false,
        $next = false,
        $date_first = null,
        $date_last = null,
        $title = '',
        $title_short = '',
        $prev_offset = -1,
        $next_offset = 1) {

        $links = array();

        if ( $this->_registry->get( 'model.settings' )->get( 'ai1ec_use_frontend_rendering' ) ) {
            $args['request_format'] = 'json';
        }
        $args['page_offset'] = $prev_offset;

        $href = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'class' => 'ai1ec-prev-page',
            'text' => '<i class="ai1ec-fa ai1ec-fa-chevron-left"></i>',
            'href' => $href->generate_href(),
            'enabled' => $prev );

        // Minical datepicker.
        $factory = $this->_registry->get( 'factory.html' );
        $links[] = $factory->create_datepicker_link( $args, $date_first->format_to_gmt(), $title, $title_short );

        $args['page_offset'] = $next_offset;
        $href = $this->_registry->get( 'html.element.href', $args );
        $links[] = array(
            'class' => 'ai1ec-next-page',
            'text' => '<i class="ai1ec-fa ai1ec-fa-chevron-right"></i>',
            'href' => $href->generate_href(),
            'enabled' => $next );

        return $links;
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::_add_view_specific_runtime_properties()
    */
    protected function _add_view_specific_runtime_properties( Ai1ec_Event $event ) {
        $taxonomy = $this->_registry->get( 'view.event.taxonomy' );
        $avatar   = $this->_registry->get( 'view.event.avatar' );
        $event->set_runtime(
            'categories_html',
            $taxonomy->get_categories_html( $event )
        );
        $event->set_runtime(
            'tags_html',
            $taxonomy->get_tags_html( $event )
        );
        $event->set_runtime(
            'content_img_url',
            $avatar->get_content_img_url( $event )
        );
    }
}


==================================================
FILE PATH: ./app/view/calendar/widget.php
==================================================
<?php

/**
 * Calendar Widget class
 *
 * A widget that displays the next X upcoming events (similar to Agenda view).
 */
class Ai1ec_View_Admin_Widget extends Ai1ec_Embeddable {

    /**
     * @var boolean
     */
    protected $_css_loaded = false;

    /**
     * @return string
     */
    public function get_id() {
        return 'ai1ec_agenda_widget';
    }

    /**
     * Register the widget class.
     */
    public static function register_widget() {
        register_widget( 'Ai1ec_View_Admin_Widget' );
    }

    /**
     * Constructor for widget.
     */
    public function __construct() {

        parent::__construct(
            $this->get_id(),
            __( 'Upcoming Events', AI1EC_PLUGIN_NAME ),
            array(
                'description' => __( 'All-in-One Event Calendar: Lists upcoming events in Agenda view', AI1EC_PLUGIN_NAME ),
                'class' => 'ai1ec-agenda-widget',
            )
        );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::register_javascript_widget()
     */
    public function register_javascript_widget( $id_base ) {
        $this->_registry->get( 'controller.javascript-widget' )
            ->add_widget( $id_base, 'view.calendar.widget' );
    }
    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::get_defaults()
     */
    public function get_defaults() {
        return array(
            'title'                  => __( 'Upcoming Events', AI1EC_PLUGIN_NAME ),
            'events_seek_type'       => 'events',
            'events_per_page'        => 10,
            'days_per_page'          => 10,
            'show_subscribe_buttons' => true,
            'show_calendar_button'   => true,
            'hide_on_calendar_page'  => true,
            'limit_by_cat'           => false,
            'limit_by_tag'           => false,
            'cat_ids'                => array(),
            'tag_ids'                => array(),
            'link_for_days'          => true,
        );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::get_configurable_for_widget_creation()
     */
    public function get_configurable_for_widget_creation() {
        $defaults = $this->get_js_widget_configurable_defaults();
        return array(
            'events_seek_type' => array(
                'renderer' => array(
                    'class'   => 'select',
                    'label'   => __(
                        'Choose how to limit the upcoming events',
                        AI1EC_PLUGIN_NAME
                    ),
                    'options' => array(
                        array(
                            'text'  => __(
                                'Events',
                                AI1EC_PLUGIN_NAME
                            ),
                            'value' => 'events'
                        ),
                        array(
                            'text'  => __(
                                'Days',
                                AI1EC_PLUGIN_NAME
                            ),
                            'value' => 'days'
                        ),
                    ),
                ),
                'value' => $defaults['events_seek_type']
            ),
            'events_per_page' => array(
                'renderer' => array(
                    'class'     => 'input',
                    'label'     => Ai1ec_I18n::__( 'Number of events to show' ),
                    'type'      => 'append',
                    'append'    => 'events',
                ),
                'value'  => $defaults['events_per_page'],
            ),
            'days_per_page' => array(
                'renderer' => array(
                    'class'     => 'input',
                    'label'     => Ai1ec_I18n::__( 'Number of days to show' ),
                    'type'      => 'append',
                    'append'    => 'days',
                ),
                'value'  => $defaults['days_per_page'],
            ),
            'upcoming_widgets_default_tags_categories' => array(
                'renderer' => array(
                    'class' => 'tags-categories',
                    'label' => __(
                        'Show events filtered for the following tags/categories',
                        AI1EC_PLUGIN_NAME
                    ),
                    'help'  => __(
                        'To clear, hold &#8984;/<abbr class="initialism">CTRL</abbr> and click selection.',
                        AI1EC_PLUGIN_NAME
                    )
                ),
                'value' => array(
                    'categories' => array(),
                    'tags'       => array(),
                ),
            ),
            'show_subscribe_buttons' => array(
                'renderer' => array(
                    'class'     => 'checkbox',
                    'label'     => Ai1ec_I18n::__( 'Show the subscribe button in the widget' ),
                ),
                'value'  => $defaults['show_subscribe_buttons'],
            ),
        );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Calendar_View_Abstract::get_name()
    */
    public function get_name() {
        return 'Upcoming Events';
    }

    /**
     * The icon class associated with the widget.
     *
     * @return string
     */
    public function get_icon() {
        return 'ai1ec-fa ai1ec-fa-clock-o';
    }

    /**
     * Form function.
     *
     * Renders the widget's configuration form for the Manage Widgets page.
     *
     * @param  array $instance The data array for the widget instance being configured.
     * @return void
     */
    public function form( $instance ) {
        $default = $this->get_defaults();
        $instance = wp_parse_args( (array) $instance, $default );

        // Get available cats, tags, events to allow user to limit widget to certain categories
        $events_categories = get_terms( 'events_categories', array( 'orderby' => 'name', "hide_empty" => false ) );
        $events_tags       = get_terms( 'events_tags', array( 'orderby' => 'name', "hide_empty" => false ) );

        // Generate unique IDs and NAMEs of all needed form fields
        $fields = array(
            'title'                  => array('value'   => $instance['title']),
            'events_seek_type'       => array('value'   => $instance['events_seek_type']),
            'events_per_page'        => array('value'   => $instance['events_per_page']),
            'days_per_page'          => array('value'   => $instance['days_per_page']),
            'show_subscribe_buttons' => array('value'   => $instance['show_subscribe_buttons']),
            'show_calendar_button'   => array('value'   => $instance['show_calendar_button']),
            'hide_on_calendar_page'  => array('value'   => $instance['hide_on_calendar_page']),
            'limit_by_cat'           => array('value'   => $instance['limit_by_cat']),
            'limit_by_tag'           => array('value'   => $instance['limit_by_tag']),
            'cat_ids'          => array(
                                              'value'   => (array)$instance['cat_ids'],
                                              'options' => $events_categories
                                             ),
            'tag_ids'          => array(
                                              'value'   => (array)$instance['tag_ids'],
                                              'options' => $events_tags
                                             ),
        );
        foreach ( $fields as $field => $data ) {
            $fields[$field]['id']    = $this->get_field_id( $field );
            $fields[$field]['name']  = $this->get_field_name( $field );
            $fields[$field]['value'] = $data['value'];
            if ( isset($data['options']) ) {
                $fields[$field]['options'] = $data['options'];
            }
        }

        // Display theme
        $this->_registry->get( 'theme.loader' )->get_file(
            'agenda-widget-form.php',
            $fields,
            true
        )->render();
    }

    /**
     * Update function.
     *
     * Called when a user submits the widget configuration form.
     * The data should be validated and returned.
     *
     * @param  array $new_instance The new data that was submitted.
     * @param  array $old_instance The widget's old data.
     * @return array               The new data to save for this widget instance.
     */
    public function update( $new_instance, $old_instance ) {
        // Save existing data as a base to modify with new data
        $instance = $old_instance;
        $instance['title']                  = strip_tags( $new_instance['title'] );
        $instance['events_per_page']        = Ai1ec_Primitive_Int::index(
            $new_instance['events_per_page'],
            1,
            1
        );
        $instance['days_per_page']          = Ai1ec_Primitive_Int::index(
            $new_instance['days_per_page'],
            1,
            1
        );
        $instance['events_seek_type']       = $this->_valid_seek_type(
            $new_instance['events_seek_type']
        );
        $instance['show_subscribe_buttons'] = isset( $new_instance['show_subscribe_buttons'] ) ? true : false;
        $instance['show_calendar_button']   = isset( $new_instance['show_calendar_button'] ) ? true : false;
        $instance['hide_on_calendar_page']  = isset( $new_instance['hide_on_calendar_page'] ) ? true : false;

        // For limits, set the limit to False if no IDs were selected, or set the respective IDs to empty if "limit by" was unchecked
        $instance['limit_by_cat'] = false;
        $instance['cat_ids'] = array();
        if ( isset( $new_instance['cat_ids'] ) && $new_instance['cat_ids'] != false ) {
            $instance['limit_by_cat'] = true;
        }
        if ( isset( $new_instance['limit_by_cat'] ) && $new_instance['limit_by_cat'] != false ) {
            $instance['limit_by_cat'] = true;
        }
        if ( isset( $new_instance['cat_ids'] ) && $instance['limit_by_cat'] === true ) {
            $instance['cat_ids'] = $new_instance['cat_ids'];
        }

        $instance['limit_by_tag'] = false;
        $instance['tag_ids'] = array();
        if ( isset( $new_instance['tag_ids'] ) && $new_instance['tag_ids'] != false ) {
            $instance['limit_by_tag'] = true;
        }
        if ( isset( $new_instance['limit_by_tag'] ) && $new_instance['limit_by_tag'] != false ) {
            $instance['limit_by_tag'] = true;
        }
        if ( isset( $new_instance['tag_ids'] ) && $instance['limit_by_tag'] === true ) {
            $instance['tag_ids'] = $new_instance['tag_ids'];
        }

        return $instance;
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::add_js()
     */
    public function add_js() {
        $this->_registry->get( 'controller.javascript' )->add_link_to_render_js(
            Ai1ec_Javascript_Controller::LOAD_ONLY_FRONTEND_SCRIPTS,
            false
        );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::get_content()
     */
    public function get_content( array $args_for_widget, $remote = false ) {
        $agenda     = $this->_registry->get(
            'view.calendar.view.agenda',
            $this->_registry->get( 'http.request.parser' )
        );
        $time       = $this->_registry->get( 'date.time' );
        $search     = $this->_registry->get( 'model.search' );
        $settings   = $this->_registry->get( 'model.settings' );
        $html       = $this->_registry->get( 'factory.html' );

        $is_calendar_page = is_page( $settings->get( 'calendar_page_id' ) );
        if ( $args_for_widget['hide_on_calendar_page'] &&
            $is_calendar_page ) {
            return;
        }

        // Add params to the subscribe_url for filtering by Limits (category, tag)
        $subscribe_filter  = '';
        if ( ! is_array( $args_for_widget['cat_ids'] ) ) {
            $args_for_widget['cat_ids'] = explode( ',', $args_for_widget['cat_ids'] );
        }

        if ( ! is_array( $args_for_widget['tag_ids'] ) ) {
            $args_for_widget['tag_ids'] = explode( ',', $args_for_widget['tag_ids'] );
        }
        $subscribe_filter .= $args_for_widget['cat_ids'] ? '&ai1ec_cat_ids=' . join( ',', $args_for_widget['cat_ids'] ) : '';
        $subscribe_filter .= $args_for_widget['tag_ids'] ? '&ai1ec_tag_ids=' . join( ',', $args_for_widget['tag_ids'] ) : '';

        // Get localized time
        $timestamp = $time->format_to_gmt();

        // Set $limit to the specified category/tag
        $limit = array(
            'cat_ids'    => $args_for_widget['cat_ids'],
            'tag_ids'    => $args_for_widget['tag_ids'],
        );
        $limit = apply_filters( 'ai1ec_add_filters_upcoming_widget', $limit );

        // Get events, then classify into date array
        // JB: apply seek check here
        $seek_days  = ( 'days' === $args_for_widget['events_seek_type'] );
        $seek_count = $args_for_widget['events_per_page'];
        $last_day   = false;
        if ( $seek_days ) {
            $seek_count = $args_for_widget['days_per_page'] * 5;
            $last_day   = strtotime(
                '+' . $args_for_widget['days_per_page'] . ' days'
            );
        }

        $event_results = $search->get_events_relative_to(
            $timestamp,
            $seek_count,
            0,
            $limit
        );
        if ( $seek_days ) {
            foreach ( $event_results['events'] as $ek => $event ) {
                if ( $event->get( 'start' )->format() >= $last_day ) {
                    unset( $event_results['events'][$ek] );
                }
            }
        }

        $dates                    = $agenda->get_agenda_like_date_array( $event_results['events'] );


        $args_for_widget['dates']                     = $dates;
        // load CSS just once for all widgets.
        // Do not load it on the calendar page as it's already loaded.
        if ( false === $this->_css_loaded && ! $is_calendar_page ) {
            if ( true === $remote ) {
                $args_for_widget['css'] = $this->_registry->get( 'css.frontend' )->get_compiled_css();
            }
            $this->_css_loaded = true;
        }
        $args_for_widget['show_location_in_title']    = $settings->get( 'show_location_in_title' );
        $args_for_widget['show_year_in_agenda_dates'] = $settings->get( 'show_year_in_agenda_dates' );
        $args_for_widget['calendar_url']              = $html->create_href_helper_instance( $limit )->generate_href();
        $args_for_widget['subscribe_url']             = AI1EC_EXPORT_URL . $subscribe_filter;
        $args_for_widget['subscribe_url_no_html']     = AI1EC_EXPORT_URL . '&no_html=true' . $subscribe_filter;
        $args_for_widget['text_upcoming_events']      = __( 'There are no upcoming events.', AI1EC_PLUGIN_NAME );
        $args_for_widget['text_all_day']              = __( 'all-day', AI1EC_PLUGIN_NAME );
        $args_for_widget['text_view_calendar']        = __( 'View Calendar', AI1EC_PLUGIN_NAME );
        $args_for_widget['text_edit']                 = __( 'Edit', AI1EC_PLUGIN_NAME );
        $args_for_widget['text_venue_separator']      = __( '@ %s', AI1EC_PLUGIN_NAME );
        $args_for_widget['text_subscribe_label']      = __( 'Add', AI1EC_PLUGIN_NAME );
        $args_for_widget['subscribe_buttons_text']    = $this->_registry
            ->get( 'view.calendar.subscribe-button' )
            ->get_labels();
        // Display theme
        return $this->_registry->get( 'theme.loader' )->get_file(
            'agenda-widget.twig',
            $args_for_widget
        )->get_content();
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::get_js_widget_configurable_defaults()
     */
    public function get_js_widget_configurable_defaults() {
        $def = $this->get_defaults();
        unset( $def['title'] );
        unset( $def['link_for_days'] );
        return $def;
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::javascript_widget()
     */
    public function javascript_widget( $args ) {
        $args['show_calendar_button'] = false;
        $args['link_for_days']        = false;
        return parent::javascript_widget( $args );
    }

    /* (non-PHPdoc)
     * @see Ai1ec_Embeddable::check_requirements()
     */
    public function check_requirements() {
        return null;
    }

    /**
     * _valid_seek_type method.
     *
     * Return valid seek type for given user input (selection).
     *
     * @param  string $value User selection for seek type
     * @return string        Seek type to use
     */
    protected function _valid_seek_type( $value ) {
        static $list = array( 'events', 'days' );
        if ( ! in_array( $value, $list ) ) {
            return (string)reset( $list );
        }
        return $value;
    }

}


==================================================
FILE PATH: ./app/view/calendar/shortcode.php
==================================================
<?php
/**
 * The class that handles rendering the shortcode.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Calendar_Shortcode extends Ai1ec_Base {

    /**
     * Generate replacement content for [ai1ec] shortcode.
     *
     * @param array     $atts      Attributes provided on shortcode
     * @param string $content Tag internal content (shall be empty)
     * @param string $tag      Used tag name (must be 'ai1ec' always)
     *
     * @staticvar $call_count Used to restrict to single calendar per page
     *
     * @return string Replacement for shortcode entry
     */
    public function shortcode( $atts, $content = '', $tag = 'ai1ec' ) {
        $settings_view   = $this->_registry->get( 'model.settings-view' );
        $view_names_list = array_keys( $settings_view->get_all() );
        $default_view    = $settings_view->get_default();

        $view_names      = array();
        foreach ( $view_names_list as $view_name ) {
            $view_names[$view_name] = true;
        }

        $view               = $default_view;
        $_events_categories = $_events_tags = $post_ids = array();

        if ( isset( $atts['view'] ) ) {
            if ( 'ly' === substr( $atts['view'], -2 ) ) {
                $atts['view'] = substr( $atts['view'], 0, -2 );
            }
            if ( ! isset( $view_names[$atts['view']] ) ) {
                return false;
            }
            $view = $atts['view'];
        }

        $mappings = array(
            'cat_name'     => 'events_categories',
            'cat_id'       => 'events_categories',
            'tag_name'     => 'events_tags',
            'tag_id'       => 'events_tags',
            'post_id'      => 'post_ids',
            'events_limit' => 'events_limit',
        );
        $matches           = array();
        $custom_taxonomies = array();
        if ( ! empty( $atts ) ) {
            foreach ( $atts as $att => $value ) {
                if (
                ! preg_match( '/([a-z0-9\_]+)_(id|name)/', $att, $matches ) ||
                isset( $mappings[$matches[1] . '_id'] )
                ) {
                    continue;
                }
                ${'_' . $matches[1] . '_ids'} = array();
                $custom_taxonomies[]    = $matches[1];

                if ( ! isset( $mappings[$matches[1] . '_id'] ) ) {
                    $mappings[$matches[1] . '_id']   = $matches[1];
                }
                if ( ! isset( $mappings[$matches[1] . '_name'] ) ) {
                    $mappings[$matches[1] . '_name'] = $matches[1];
                }
            }
        }

        foreach ( $mappings as $att_name => $type ) {
            if ( ! isset( $atts[$att_name] ) ) {
                continue;
            }
            $raw_values = explode( ',', $atts[$att_name] );
            foreach ( $raw_values as $argument ) {
                if ( 'post_id' === $att_name ) {
                    if ( ( $argument = (int)$argument ) > 0 ) {
                        $post_ids[] = $argument;
                    }
                } else {
                    if ( ! is_numeric( $argument ) ) {
                        $search_val = trim( $argument );
                        $argument   = false;
                        foreach ( array( 'name', 'slug' ) as $field ) {
                            $record = get_term_by(
                                $field,
                                $search_val,
                                $type
                            );
                            if ( false !== $record ) {
                                $argument = $record;
                                break;
                            }
                        }
                        unset( $search_val, $record, $field );
                        if ( false === $argument ) {
                            continue;
                        }
                        $argument = (int)$argument->term_id;
                    } else {
                        if ( ( $argument = (int)$argument ) <= 0 ) {
                            continue;
                        }
                    }
                    ${'_' . $type}[] = $argument;
                }
            }
        }
        $query = array(
            'ai1ec_cat_ids'     => implode( ',', $_events_categories ),
            'ai1ec_tag_ids'     => implode( ',', $_events_tags ),
            'ai1ec_post_ids' => implode( ',', $post_ids ),
            'action'         => $view,
            'request_type'   => 'jsonp',
            'events_limit'   => isset( $atts['events_limit'] )
            // definition above casts values as array, so we take first element,
            // as there won't be others
                ? (int) $atts['events_limit']
                : null,
        );
        // this is the opposite of how the SuperWidget works.
        if ( ! isset( $atts['display_filters'] ) ) {
            $query['display_filters'] = 'true';
        } else {
            $query['display_filters'] = $atts['display_filters'];
        }

        foreach ( $custom_taxonomies as $taxonomy ) {
            $query['ai1ec_' . $taxonomy . '_ids'] = implode( ',', ${'_' . $taxonomy} );
        }
        if ( isset( $atts['exact_date'] ) ) {
            $query['exact_date'] = $atts['exact_date'];
        }
        $request = $this->_registry->get(
            'http.request.parser',
            $query,
            $default_view
        );
        $request->parse();
        $page_content = $this->_registry->get( 'view.calendar.page' )
            ->get_content( $request, 'shortcode' );
        $this->_registry->get( 'css.frontend' )
            ->add_link_to_html_for_frontend();
        $this->_registry->get( 'controller.javascript' )
            ->load_frontend_js( true );
        $page_content['html'] = preg_replace( '/\s+/', ' ', $page_content['html'] );
        return $page_content['html'];
    }
}

==================================================
FILE PATH: ./app/view/calendar/taxonomy.php
==================================================
<?php

/**
 * The class that handles html generation for taxonomies.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Calendar_Taxonomy extends Ai1ec_Base {

    /**
     * Returns a link to a calendar page without the given arguments; does not
     * otherwise disturb current page state.
     *
     * @param array $args           Current arguments to the calendar
     * @param array $args_to_remove Names of arguments to remove from current args
     *
     * @return string
     */
    public function generate_href_without_arguments(
        array $args,
        array $args_to_remove
    ) {
        $args_to_remove = array_flip( $args_to_remove );
        $args = array_diff_key( $args, $args_to_remove );
        $href = $this->_registry->get( 'html.element.href', $args );
        return $href->generate_href();
    }

    /**
     * Creates the html for tags filter
     *
     * @param array $view_args
     * @return string
     */
    public function get_html_for_tags( array $view_args ) {
        return $this->_get_html_for_taxonomy( $view_args, true );
    }

    /**
     * Creates the html for categories filter
     *
     * @param array $view_args
     * @return string
     */
    public function get_html_for_categories( array $view_args ) {
        return $this->_get_html_for_taxonomy( $view_args );
    }

    /**
     * Generates the HTML for a taxonomy selector.
     *
     * @param array $view_args Arguments to the parent view
     * @param bool  $tag       whether it's tags or categories.
     *
     * @return string          Markup for categories selector
     */
    protected function _get_html_for_taxonomy( $view_args, $tag = false ) {
        $taxonomy_name      = 'events_categories';
        $type               = 'category';
        $type_for_filter    = 'cat_ids';
        $type_for_view_args = 'categories';
        if ( true === $tag ) {
            $taxonomy_name      = 'events_tags';
            $type               = 'tag';
            $type_for_filter    = 'tag_ids';
            $type_for_view_args = 'tags';
        }


        $terms = get_terms( $taxonomy_name, array( 'orderby' => 'name' ) );
        if( empty( $terms ) ) {
            return '';
        }

        foreach( $terms as &$term ) {
            $href = $this->_registry->get( 'html.element.href', $view_args, $type );
            $href->set_term_id( $term->term_id );
            $term->href = $href->generate_href();
            if ( false === $tag ) {
                $taxonomy = $this->_registry->get( 'view.event.taxonomy' );
                $term->color = $taxonomy->get_category_color_square( $term->term_id );
            }
        }

        $href_for_clearing_filter =
            $this->generate_href_without_arguments( $view_args, array( $type_for_filter ) );

        $args = array(
            $type_for_view_args            => $terms,
            'selected_' . $type_for_filter => $view_args[$type_for_filter],
            'data_type'                    => $view_args['data_type'],
            'clear_filter'                 => $href_for_clearing_filter,
            'text_clear_category_filter'   => __( 'Clear category filter', AI1EC_PLUGIN_NAME ),
            'text_categories'              => __( 'Categories', AI1EC_PLUGIN_NAME ),
            'text_clear_tag_filter'        => __( 'Clear tag filter', AI1EC_PLUGIN_NAME ),
            'text_tags'                    => __( 'Tags', AI1EC_PLUGIN_NAME ),
        );
        $loader = $this->_registry->get( 'theme.loader' );
        return $loader->get_file( $type_for_view_args . '.twig', $args, false )
            ->get_content();
    }

}

==================================================
FILE PATH: ./app/view/calendar/fallbacks.php
==================================================
<?php

/**
 * The concrete class for the calendar page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.1
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_Calendar_Avatar_Fallbacks extends Ai1ec_Base {

    /**
     * Default avatar fallbacks.
     *
     * @var array
     */
    protected $_fallbacks = array(
        'post_thumbnail',
        'content_img',
        'category_avatar',
    );

    /**
     * Get registered fallbacks.
     *
     * @return array
     */
    public function get_all() {
        return apply_filters( 'ai1ec_avatar_fallbacks', $this->_fallbacks );
    }

    /**
     * Register new avatar fallbacks.
     *
     * @param array $fallbacks Fallbacks.
     *
     * @return void Method does not return.
     */
    public function set( array $fallbacks ) {
        $this->_fallbacks = $fallbacks;
    }

}


==================================================
FILE PATH: ./app/view/admin/tickets.php
==================================================
<?php

/**
 * Tickets page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.4
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Tickets extends Ai1ec_View_Admin_Abstract {

    /**
     * @var string The nonce action
     */
    const NONCE_ACTION = 'ai1ec_api_ticketing_signup';

    /**
     * @var string The nonce name
     */
    const NONCE_NAME  = 'ai1ec_api_ticketing_nonce';

    /**
     * @var string The id/name of the submit button.
     */
    const SUBMIT_ID = 'ai1ec_api_ticketing_signup';

    /**
     * Adds the page to the correct menu.
     */
    public function add_page() {
        add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            __( 'Ticketing', AI1EC_PLUGIN_NAME ),
            __( 'Ticketing', AI1EC_PLUGIN_NAME ),
            'manage_ai1ec_feeds',
            AI1EC_PLUGIN_NAME . '-tickets',
            array( $this, 'display_page' )
        );
    }

    /**
     * Add meta box for page.
     *
     * @wp_hook admin_init
     *
     * @return void
     */
    public function add_meta_box() {}

    /**
     * Display the page html
     */
    public function display_page() {

        $signed_to_api       = $this->_api_registration->is_signed();
        $signup_available    = $this->_api_registration->is_api_sign_up_available();
        $ticketing_available = $this->_api_registration->is_ticket_available();
        $ticketing_enabled   = $this->_api_registration->has_subscription_active( Ai1ec_Api_Features::CODE_TICKETING );
        $ticketing_message   = $this->_api_registration->get_sign_message();
        $loader              = $this->_registry->get( 'theme.loader' );
         wp_enqueue_style(
            'ai1ec_samples.css',
            AI1EC_ADMIN_THEME_CSS_URL . 'samples.css',
            array(),
            AI1EC_VERSION
        );

        if ( ! $signed_to_api ) {

            if ( false === ai1ec_is_blank( $ticketing_message ) ) {
                $this->_api_registration->clear_sign_message();
            }

            $args = array(
                'title' => Ai1ec_I18n::__(
                    'Timely Ticketing'
                ),
                'sign_up_text' => 'Please, <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-settings">Sign Up for a Timely Network account</a> to use Ticketing.',
                'signup_form'  => Ai1ec_I18n::__( 'You need to sign up for a Timely Network account in order to use Ticketing.<br /><br />' ) .
                    (
                        $signup_available
                        ? Ai1ec_I18n::__( '<a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-settings" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg">Sign In to Timely Network</a>' )
                        : Ai1ec_I18n::__( '<b>Signing up for a Timely Network account is currently unavailable. Please, try again later.</b>' )
                    ),
                'show_info'    => true

            );
            $file = $loader->get_file( 'ticketing/signup.twig', $args, true );
        } elseif ( ! $ticketing_available ) {
            $args = array(
                'title' => Ai1ec_I18n::__(
                    'Timely Ticketing'
                ),
                'sign_up_text' => '',
                'signup_form'  => 'Ticketing is currently not available for this website. Please, try again later.',
                'show_info'    => true

            );
            $file = $loader->get_file( 'ticketing/signup.twig', $args, true );
        } elseif ( ! $ticketing_enabled ) {
            $args = array(
                    'title' => Ai1ec_I18n::__(
                            'Timely Ticketing'
                            ),
                    'sign_up_text' => '',
                    'signup_form'  => '',
                    'show_info'    => true
            );
            $file = $loader->get_file( 'ticketing/signup.twig', $args, true );
        } else {
            $response  = $this->_api_registration->get_payment_preferences();
            $purchases = $this->_api_registration->get_purchases();
            $args      = array(
                'title'                             => Ai1ec_I18n::__(
                    'Timely Ticketing'
                ),
                'settings_text'                     => Ai1ec_I18n::__( 'Settings' ),
                'sales_text'                        => Ai1ec_I18n::__( 'Sales' ),
                'select_payment_text'               => Ai1ec_I18n::__( 'Please provide your PayPal details.' ),
                'cheque_text'                       => Ai1ec_I18n::__( 'Cheque' ),
                'paypal_text'                       => Ai1ec_I18n::__( 'PayPal' ),
                'currency_text'                     => Ai1ec_I18n::__( 'Preferred currency for tickets:' ),
                'required_text'                     => Ai1ec_I18n::__( 'This field is required.' ),
                'save_changes_text'                 => Ai1ec_I18n::__( 'Save Changes' ),
                'date_text'                         => Ai1ec_I18n::__( 'Date' ),
                'event_text'                        => Ai1ec_I18n::__( 'Event' ),
                'purchaser_text'                    => Ai1ec_I18n::__( 'Purchaser' ),
                'tickets_text'                      => Ai1ec_I18n::__( 'Tickets' ),
                'email_text'                        => Ai1ec_I18n::__( 'Email' ),
                'status_text'                       => Ai1ec_I18n::__( 'Status' ),
                'total_text'                        => Ai1ec_I18n::__( 'Total' ),
                'sign_out_button_text'              => Ai1ec_I18n::__( 'Sign Out' ),
                'payment_method'                    => $response->payment_method,
                'paypal_email'                      => $response->paypal_email,
                'first_name'                        => $response->first_name,
                'last_name'                         => $response->last_name,
                'currency'                          => $response->currency,
                'nonce'                             => array(
                    'action'   => self::NONCE_ACTION,
                    'name'     => self::NONCE_NAME,
                    'referrer' => false,
                ),
                'action'                            =>
                    '?controller=front&action=ai1ec_api_ticketing_signup&plugin=' .
                    AI1EC_PLUGIN_NAME,
                'purchases'                         => $purchases,
                'paypal_currencies'                    => array (
                    array( 'description' => Ai1ec_I18n::__( 'United States Dollar' ), 'code' => 'USD' ),
                    array( 'description' => Ai1ec_I18n::__( 'Canadian Dollar' ), 'code' => 'CAD' ),
                    array( 'description' => Ai1ec_I18n::__( 'Australian Dollar' ), 'code' => 'AUD' ),
                    array( 'description' => Ai1ec_I18n::__( 'Brazilian Real' ), 'code' => 'BRL', 'note' => Ai1ec_I18n::__( 'Note: This currency is supported as a payment currency and a currency balance for in-country PayPal accounts only.' ) ),
                    array( 'description' => Ai1ec_I18n::__( 'Czech Koruna' ), 'code' => 'CZK' ),
                    array( 'description' => Ai1ec_I18n::__( 'Danish Krone' ), 'code' => 'DKK' ),
                    array( 'description' => Ai1ec_I18n::__( 'Euro' ), 'code' => 'EUR' ),
                    array( 'description' => Ai1ec_I18n::__( 'Hong Kong Dollar' ), 'code' => 'HKD' ),
                    array( 'description' => Ai1ec_I18n::__( 'Hungarian Forint' ), 'code' => 'HUF', 'note' => Ai1ec_I18n::__( 'Note: Decimal amounts are not supported for this currency. Passing a decimal amount will throw an error.' ) ),
                    array( 'description' => Ai1ec_I18n::__( 'Israeli New Sheqel' ), 'code' => 'ILS' ),
                    array( 'description' => Ai1ec_I18n::__( 'Japanese Yen' ), 'code' => 'JPY', 'note' => Ai1ec_I18n::__( 'Note: This currency does not support decimals. Passing a decimal amount will throw an error. 1,000,000' ) ),
                    array( 'description' => Ai1ec_I18n::__( 'Malaysian Ringgit' ), 'code' => 'MYR', 'note' => Ai1ec_I18n::__( 'Note: This currency is supported as a payment currency and a currency balance for in-country PayPal accounts only.' ) ),
                    array( 'description' => Ai1ec_I18n::__( 'Mexican Peso' ), 'code' => 'MXN' ),
                    array( 'description' => Ai1ec_I18n::__( 'Norwegian Krone' ), 'code' => 'NOK' ),
                    array( 'description' => Ai1ec_I18n::__( 'New Zealand Dollar' ), 'code' => 'NZD' ),
                    array( 'description' => Ai1ec_I18n::__( 'Philippine Peso' ), 'code' => 'PHP' ),
                    array( 'description' => Ai1ec_I18n::__( 'Polish Zloty' ), 'code' => 'PLN' ),
                    array( 'description' => Ai1ec_I18n::__( 'Pound Sterling' ), 'code' => 'GBP' ),
                    array( 'description' => Ai1ec_I18n::__( 'Russian Ruble' ), 'code' => 'RUB', 'note' => Ai1ec_I18n::__( 'For in-border payments (payments made within Russia), the Russian Ruble is the only accepted currency. If you use another currency for in-border payments, the transaction will fail' ) ),
                    array( 'description' => Ai1ec_I18n::__( 'Singapore Dollar' ), 'code' => 'SGD' ),
                    array( 'description' => Ai1ec_I18n::__( 'Swedish Krona' ), 'code' => 'SEK' ),
                    array( 'description' => Ai1ec_I18n::__( 'Swiss Franc' ), 'code' => 'CHF' ),
                    array( 'description' => Ai1ec_I18n::__( 'Taiwan New Dollar' ), 'code' => 'TWD', 'note' => Ai1ec_I18n::__( 'Note: Decimal amounts are not supported for this currency. Passing a decimal amount will throw an error.' ) ),
                    array( 'description' => Ai1ec_I18n::__( 'Thai Baht' ), 'code' => 'THB' ),
                )
            );
            $file = $loader->get_file( 'ticketing/manage.twig', $args, true );
        }

        $this->_registry->get( 'css.admin' )->admin_enqueue_scripts(
            'ai1ec_event_page_all-in-one-event-calendar-settings'
        );
        $this->_registry->get( 'css.admin' )->process_enqueue(
            array(
                array( 'style', 'ticketing.css', ),
            )
        );
        if ( isset( $_POST['ai1ec_save_settings'] ) ) {
            $response = $this->_api_registration->save_payment_preferences();

            // this redirect makes sure that the error messages appear on the screen
            if ( isset( $_SERVER['HTTP_REFERER'] ) ) {
                header( "Location: " . $_SERVER['HTTP_REFERER'] );
            }
        }
        return $file->render();
    }

    /**
     * Handle post, likely to be deprecated to use commands.
     */
    public function handle_post(){}

}


==================================================
FILE PATH: ./app/view/admin/all-events.php
==================================================
<?php

class Ai1ec_View_Admin_All_Events extends Ai1ec_Base {

    /**
     * change_columns function
     *
     * Adds Event date/time column to our custom post type
     * and renames Date column to Post Date
     *
     * @param array $columns Existing columns
     *
     * @return array Updated columns array
     */
    public function change_columns( array $columns = array() ) {
        $columns['author']           = __( 'Author',          AI1EC_PLUGIN_NAME );
        $columns['date']             = __( 'Post Date',       AI1EC_PLUGIN_NAME );
        $columns['ai1ec_event_date'] = __( 'Event date/time', AI1EC_PLUGIN_NAME );
        $api = $this->_registry->get( 'model.api.api-ticketing' );
        if ( $api->is_signed() ) {
            $columns['tickets'] = __( 'Ticket Types',    AI1EC_PLUGIN_NAME );
        }
        return $columns;
    }

    /**
     * orderby function
     *
     * Orders events by event date
     *
     * @param string $orderby Orderby sql
     * @param object $wp_query
     *
     * @return void
     **/
    public function orderby( $orderby, $wp_query ) {

        $db = $this->_registry->get( 'dbi.dbi' );
        $aco = $this->_registry->get( 'acl.aco' );

        if( true === $aco->is_all_events_page() ) {
            $wp_query->query = wp_parse_args( $wp_query->query );
            $table_name = $db->get_table_name( 'ai1ec_events' );
            $posts = $db->get_table_name( 'posts' );
            if( isset( $wp_query->query['orderby'] ) && 'ai1ec_event_date' === @$wp_query->query['orderby'] ) {
                $orderby = "(SELECT start FROM {$table_name} WHERE post_id = {$posts}.ID) " . $wp_query->get('order');
            } else if( empty( $wp_query->query['orderby'] ) || $wp_query->query['orderby'] === 'menu_order title' ) {
                $orderby = "(SELECT start FROM {$table_name} WHERE post_id = {$posts}.ID) " . 'desc';
            }
        }
        return $orderby;
    }

    /**
     * custom_columns function
     *
     * Adds content for custom columns
     *
     * @return void
     **/
    public function custom_columns( $column, $post_id ) {
        if ( 'ai1ec_event_date' === $column ) {
            try {
                $event = $this->_registry->get( 'model.event', $post_id );
                $time  = $this->_registry->get( 'view.event.time' );
                echo $time->get_timespan_html( $event );
            } catch ( Exception $e ) {
                // event wasn't found, output empty string
                echo '';
            }
        } else if ( 'tickets' === $column ) {
            $api = $this->_registry->get( 'model.api.api-ticketing' );
            if ( $api->is_ticket_event_imported( $post_id ) ) {
                echo '';
            } else {
                try {
                    $event        = $this->_registry->get( 'model.event', $post_id );
                    $api          = $this->_registry->get( 'model.api.api-ticketing' );
                    $api_event_id = $api->get_api_event_id( $post_id );
                    if ( $api_event_id ) {
                        echo '<a href="#" class="ai1ec-has-tickets" data-post-id="'
                            . $post_id . '">'
                            . __( 'Ticketing Details', AI1EC_PLUGIN_NAME ) . '</a>';
                    }

                } catch ( Exception $e ) {
                    // event wasn't found, output empty string
                    echo '';
                }
            }
        }
    }

    /**
     * sortable_columns function
     *
     * Enable sorting of columns
     *
     * @return void
     **/
    public function sortable_columns( $columns ) {
        $columns['ai1ec_event_date'] = 'ai1ec_event_date';
        $columns['author']           = 'author';
        return $columns;
    }

    /**
     * taxonomy_filter_restrict_manage_posts function
     *
     * Adds filter dropdowns for event categories and event tags.
     * Adds filter dropdowns for event authors.
     *
     * @uses wp_dropdown_users To create a dropdown with current user selected.
     *
     * @return void
     **/
    function taxonomy_filter_restrict_manage_posts() {
        global $typenow;

        // =============================================
        // = add the dropdowns only on the events page =
        // =============================================
        if( $typenow === AI1EC_POST_TYPE ) {
            $filters = get_object_taxonomies( $typenow );
            foreach( $filters as $tax_slug ) {
                $tax_obj = get_taxonomy( $tax_slug );
                wp_dropdown_categories( array(
                'show_option_all' => __( 'Show All ', AI1EC_PLUGIN_NAME ) . $tax_obj->label,
                'taxonomy'        => $tax_slug,
                'name'            => $tax_obj->name,
                'orderby'         => 'name',
                'selected'        => isset( $_GET[$tax_slug] ) ? $_GET[$tax_slug] : '',
                'hierarchical'    => $tax_obj->hierarchical,
                'show_count'      => true,
                'hide_if_empty'   => true,
                'value_field'     => 'slug',
                ));
            }
            $args = array(
                'name'            => 'author',
                'show_option_all' => __( 'Show All Authors', AI1EC_PLUGIN_NAME ),
            );
            if ( isset( $_GET['user'] ) ) {
                $args['selected'] = (int)$_GET['user'];
            }
            wp_dropdown_users($args);
        }
    }

    /**
     * taxonomy_filter_post_type_request function
     *
     * Adds filtering of events list by event tags and event categories
     *
     * @return void
     **/
    public function taxonomy_filter_post_type_request( $query ) {
        global $pagenow, $typenow;
        if( 'edit.php' === $pagenow ) {
            $filters = get_object_taxonomies( $typenow );
            foreach( $filters as $tax_slug ) {
                $var = &$query->query_vars[$tax_slug];
                if( isset( $var ) ) {
                    $term = null;

                    if( is_numeric( $var ) ) {
                        $term = get_term_by( 'id', $var, $tax_slug );
                    } else {
                        $term = get_term_by( 'slug', $var, $tax_slug );
                    }

                    if( isset( $term->slug ) ) {
                        $var = $term->slug;
                    }
                }
            }
        }
        // ===========================
        // = Order by Event date ASC =
        // ===========================
        if( 'ai1ec_event' === $typenow ) {
            if ( ! array_key_exists( 'orderby', $query->query_vars ) ) {
                $query->query_vars['orderby'] = 'ai1ec_event_date';
                $query->query_vars['order']   = 'desc';
            }
        }
    }

    /**
     * CSS and templates files needed for ticketing.
     */
    public function add_ticketing_styling() {
        // Add CSS
        $this->_registry->get( 'css.admin' )->admin_enqueue_scripts(
            'ai1ec_event_page_all-in-one-event-calendar-settings'
        );
        $this->_registry->get( 'css.admin' )->process_enqueue(
            array(
                array( 'style', 'ticketing.css', ),
            )
        );
    }

    /**
     * Get ticket details by Event id.
     */
    public function show_ticket_details() {
        $post_id = $_POST['ai1ec_event_id'];
        $api     = $this->_registry->get( 'model.api.api-ticketing' );
        if ( $api->is_ticket_event_from_another_account( $post_id ) )  {
            $tickets = json_encode(
                array( 'data' => array(), 'error' =>
                    sprintf(
                        __( 'This Event was created using a different account %s. Changes are not allowed.', AI1EC_PLUGIN_NAME ),
                        $api->get_api_event_account( $post_id )
                    )
            ) );
        } else {
            $tickets = $api->get_ticket_types( $post_id );
        }
        echo $tickets;
        wp_die();
    }

    /**
     * Get attendees list.
     */
    public function show_attendees() {
        $post_id  = $_POST['ai1ec_event_id'];
        $api      = $this->_registry->get( 'model.api.api-ticketing' );
        $tickets  = $api->get_tickets( $post_id );
        echo $tickets;
        wp_die();
    }

    /**
     * count_future_events function
     *
     * @return Count future events
     **/
    public function count_future_events( $user_id = null ) {
        if ( is_admin() ) {
            $settings            = $this->_registry->get( 'model.settings' );
            $current_time        = $this->_registry->get( 'date.time' );
            $current_time->set_timezone( $settings->get( 'timezone_string' ) );
            $current_time        = $current_time->format_to_gmt();
            $user_id             = get_current_user_id();
            $where               = get_posts_by_author_sql( AI1EC_POST_TYPE, true, $user_id );
            $db                  = $this->_registry->get( 'dbi.dbi' );
            $posts               = $db->get_table_name( 'posts' );
            $table_name          = $db->get_table_name( 'ai1ec_events' );
            $sql                 = "SELECT COUNT(*) FROM $table_name INNER JOIN $posts on $table_name.post_id = {$posts}.ID"
                . " $where AND $table_name.start > $current_time"; //future event
            return $db->get_var( $sql );
        } else {
            return 0;
        }
    }

}


==================================================
FILE PATH: ./app/view/admin/add-ons.php
==================================================
<?php

/**
 * The Calendar Add-ons page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.1
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Add_Ons extends Ai1ec_View_Admin_Abstract {
    /**
     * Adds page to the menu.
     *
     * @wp_hook admin_menu
     *
     * @return void
     */
    public function add_page() {
        // =======================
        // = Calendar Add Ons Page =
        // =======================
        add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            Ai1ec_I18n::__( 'Add-ons' ),
            Ai1ec_I18n::__( 'Add-ons' ),
            'manage_ai1ec_feeds',
            AI1EC_PLUGIN_NAME . '-add-ons',
            array( $this, 'display_page' )
        );
    }
    /**
     * Display Add Ons list page.
     *
     * @return void
     */
    public function display_page() {
        wp_enqueue_style(
            'ai1ec_addons.css',
            AI1EC_ADMIN_THEME_CSS_URL . 'addons.css',
            array(),
            AI1EC_VERSION
        );
        $content  = get_site_transient( 'ai1ec_timely_addons' );
        $is_error = false;
        if (
            false === $content ||
            (
                defined( 'AI1EC_DEBUG' ) &&
                AI1EC_DEBUG
            )
        ) {
            $is_error = true;
            $feed     = wp_remote_get( AI1EC_TIMELY_ADDONS_URI );
            if ( ! is_wp_error( $feed ) ) {
                $content  = json_decode( wp_remote_retrieve_body( $feed ) );
                if ( null !== $content ) {
                    set_site_transient( 'ai1ec_timely_addons', $content, 3600 );
                    $is_error = false;
                }
            }
        }
        $this->_registry->get( 'theme.loader' )->get_file(
            'add-ons-list/page.twig',
            array(
                'labels'   => array(
                    'title'             => Ai1ec_I18n::__(
                        'Add-ons for All In One Event Calendar'
                    ),
                    'button_title'      => Ai1ec_I18n::__(
                        'Browse All Add-ons'
                    ),
                    'paragraph_content' => Ai1ec_I18n::__(
                        'These add-ons extend the functionality of the All-in-One Event Calendar.'
                    ),
                    'error'             => Ai1ec_I18n::__(
                        'There was an error retrieving the extensions list from the server. Please try again later.'
                    ),
                ),
                'content'  => $content,
                'is_error' => $is_error,
            ),
            true
        )->render();
    }

    public function add_meta_box() {
    }

    public function display_meta_box( $object, $box ) {
    }

    public function handle_post() {
    }

}


==================================================
FILE PATH: ./app/view/admin/theme-options.php
==================================================
<?php

/**
 * The Theme options page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Theme_Options extends Ai1ec_View_Admin_Abstract {

    /**
     * @var string The nonce action
     */
    const NONCE_ACTION = 'ai1ec_theme_options_save';

    /**
     * @var string The nonce name
     */
    const NONCE_NAME  = 'ai1ec_theme_options_nonce';

    /**
     * @var string The id/name of the submit button.
     */
    const SUBMIT_ID = 'ai1ec_save_themes_options';

    /**
     * @var string The id/name of the Reset button.
     */
    const RESET_ID = 'ai1ec_reset_themes_options';

    /**
     * @var string
     */
    public $title;

    /**
     * @var string
     */
    public $meta_box_id;

    /**
     * Adds the page to the correct menu.
     */
    public function add_page() {
        $theme_options_page = add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            Ai1ec_I18n::__( 'Theme Options' ),
            Ai1ec_I18n::__( 'Theme Options' ),
            'manage_ai1ec_options',
            AI1EC_PLUGIN_NAME . '-edit-css',
            array( $this, 'display_page' )
        );
        $settings = $this->_registry->get( 'model.settings' );
        if ( false !== $settings->get( 'less_variables_page' ) ) {
            // Make copy of Theme Options page at its old location.
            $submenu['themes.php'][] = array(
                Ai1ec_I18n::__( 'Calendar Theme Options' ),
                'manage_ai1ec_options',
                AI1EC_THEME_OPTIONS_BASE_URL,
            );
        };
        $settings->set( 'less_variables_page', $theme_options_page );
    }

    /**
     * Add meta box for page.
     *
     * @wp_hook admin_init
     *
     * @return void
     */
    public function add_meta_box() {
        // Add the 'General Settings' meta box.
        add_meta_box(
            'ai1ec-less-variables-tabs',
            Ai1ec_I18n::_x( 'Calendar Theme Options', 'meta box' ),
            array( $this, 'display_meta_box' ),
            $this->_registry->get( 'model.settings' )
                ->get( 'less_variables_page' ),
            'left',
            'default'
        );
    }

    /**
     * Display the page html
     */
    public function display_page() {

        $settings = $this->_registry->get( 'model.settings' );

        $args = array(
            'title' => Ai1ec_I18n::__(
                'Calendar Theme Options'
            ),
            'nonce' => array(
                'action'   => self::NONCE_ACTION,
                'name'     => self::NONCE_NAME,
                'referrer' => false,
            ),
            'metabox' => array(
                'screen' => $settings->get( 'themes_option_page' ),
                'action' => 'left',
                'object' => null
            ),
            'action' =>
                '?controller=front&action=ai1ec_save_theme_options&plugin=' . AI1EC_PLUGIN_NAME
        );

        $frontend = $this->_registry->get( 'css.frontend' );

        $loader = $this->_registry->get( 'theme.loader' );

        $file   = $loader->get_file( 'theme-options/page.twig', $args, true );

        return $file->render();

    }

    /**
     * Displays the meta box for the settings page.
     *
     * @param mixed $object
     * @param mixed $box
     */
    public function display_meta_box( $object, $box )  {

        $tabs = array(
            'general' => array(
                'name' => Ai1ec_I18n::__( 'General' ),
            ),
            'table' => array(
                'name' => Ai1ec_I18n::__( 'Tables' ),
            ),
            'buttons' => array(
                'name' => Ai1ec_I18n::__( 'Buttons' ),
            ),
            'forms' => array(
                'name' => Ai1ec_I18n::__( 'Forms' ),
            ),
            'calendar' => array(
                'name' => Ai1ec_I18n::__( 'Calendar general' ),
            ),
            'month' => array(
                'name' => Ai1ec_I18n::__( 'Month/week/day view' ),
            ),
            'agenda' => array(
                'name' => Ai1ec_I18n::__( 'Agenda view' ),
            ),
        );

        $tabs = apply_filters( 'ai1ec_less_variables_tabs', $tabs );

        $less_variables  = $this->_registry
            ->get( 'less.lessphp' )->get_saved_variables();
        $tabs            = $this->_get_tabs_to_show( $less_variables, $tabs );

        $loader          = $this->_registry->get( 'theme.loader' );
        $args            = array(
            'stacked'       => true,
            'content_class' => 'ai1ec-form-horizontal',
            'tabs'          => $tabs,
            'submit'        => array(
                'id'          => self::SUBMIT_ID,
                'value'       => '<i class="ai1ec-fa ai1ec-fa-save ai1ec-fa-fw"></i> ' .
                    Ai1ec_I18n::__( 'Save Options' ),
                'args'        => array(
                    'class'     => 'ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg',
                ),
            ),
            'reset'         => array(
                'id'          => self::RESET_ID,
                'value'       => '<i class="ai1ec-fa ai1ec-fa-undo ai1ec-fa-fw"></i> ' .
                    Ai1ec_I18n::__( 'Reset to Defaults' ),
                'args'        => array(
                    'class'     => 'ai1ec-btn ai1ec-btn-danger ai1ec-btn-lg',
                ),
            ),
        );
        $file = $loader->get_file( 'theme-options/bootstrap_tabs.twig', $args, true );
        $file->render();

    }

    /**
     * Return the theme options tabs
     *
     * @param array $less_variables
     * @param array $tabs list of tabs
     *
     * @return array the array of tabs to display
     */
    protected function _get_tabs_to_show( array $less_variables, array $tabs) {

        // Inizialize the array of tabs that will be added to the layout
        $bootstrap_tabs_to_add = array();

        foreach( $tabs as $id => $tab ){
            $tab['elements'] = array();
            $bootstrap_tabs_to_add[$id] = $tab;
        }
        foreach ( $less_variables as $variable_id => $variable_attributes ) {
            $variable_attributes['id'] = $variable_id;
            $renderable = $this->_registry->get(
                'less.variable.' . $variable_attributes['type'],
                $variable_attributes
            );
            $bootstrap_tabs_to_add[$variable_attributes['tab']]['elements'][] = array(
                'html' => $renderable->render()
            );
        }
        return $bootstrap_tabs_to_add;
    }

    /**
     * Handle post, likely to be deprecated to use commands.
     */
    public function handle_post()  {

    }
}


==================================================
FILE PATH: ./app/view/admin/activate.php
==================================================
<?php

/**
 * The Calendar Activation page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.6
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Activate extends Ai1ec_View_Admin_Abstract {
    /**
     * Adds page to the menu.
     *
     * @wp_hook admin_menu
     *
     * @return void
     */
    public function add_page() {
        global $submenu;

        add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            __( 'Activate', AI1EC_PLUGIN_NAME ),
            __( 'Activate', AI1EC_PLUGIN_NAME ),
            'manage_options',
            AI1EC_PLUGIN_NAME . '-activate',
            array( $this, 'display_page' )
        );

        if ( $this->isLoggedIn() ) {
            remove_submenu_page( AI1EC_ADMIN_BASE_URL, AI1EC_PLUGIN_NAME . '-activate' );
        } else {
            if ( isset( $submenu[AI1EC_ADMIN_BASE_URL] ) ) {
                foreach ( $submenu[AI1EC_ADMIN_BASE_URL] as $submenuItem ) {
                    if ( count( $submenuItem ) > 2 ) {
                        $submenuSlug = $submenuItem[2];
                        if ( $submenuSlug != AI1EC_PLUGIN_NAME . '-activate' ) {
                            remove_submenu_page( AI1EC_ADMIN_BASE_URL, $submenuSlug );
                        }
                    }
                }
            }
        }
    }
    /**
     * Display activation page
     *
     * @return void
     */
    public function display_page() {
        if ( isset( $_POST['ai1ec_save_login'] ) ) {
            $email     = isset( $_POST['ai1ec_email'] )      ? $_POST['ai1ec_email']      : null;
            $authToken = isset( $_POST['ai1ec_auth_token'] ) ? $_POST['ai1ec_auth_token'] : null;

            $result    = false;

            if ( $email && $authToken ) {
                $result = $this->login( $authToken, $email );
            }

            if ( $result ) {
                wp_redirect( ai1ec_admin_url( AI1EC_ADMIN_BASE_URL . '&page=' . AI1EC_PLUGIN_NAME . '-add-ons' ) );
            }
        }

        wp_enqueue_style(
            'ai1ec_activate.css',
            AI1EC_ADMIN_THEME_CSS_URL . 'activate.css',
            array(),
            AI1EC_VERSION
        );

        $this->_registry->get( 'theme.loader' )->get_file(
            'activate.twig',
            array(),
            true
        )->render();
    }

    public function add_meta_box() {
    }

    public function display_meta_box( $object, $box ) {
    }

    public function handle_post() {
    }

    public function login( $authToken, $email ) {
        $api = $this->_registry->get( 'model.api.api-registration' );
        $result = $api->saveLoginInfo( '', $authToken, $email );

        return $result;
    }
}

==================================================
FILE PATH: ./app/view/admin/add-new-event.php
==================================================
<?php

/**
 * Event create/update form backend view layer.
 *
 * Manage creation of boxes (containers) for our control elements
 * and instantiating, as well as updating them.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @package      Ai1EC
 * @subpackage   Ai1EC.View
 */
class Ai1ec_View_Add_New_Event extends Ai1ec_Base {

    /**
     * Create hook to display event meta box when creating or editing an event.
     *
     * @wp_hook add_meta_boxes
     *
     * @return void
     */
    public function event_meta_box_container() {
        add_meta_box(
            AI1EC_POST_TYPE,
            Ai1ec_I18n::__( 'Event Details' ),
            array( $this, 'meta_box_view' ),
            AI1EC_POST_TYPE,
            'normal',
            'high'
        );
        
        add_meta_box(
            AI1EC_POST_TYPE . '_features',
            Ai1ec_I18n::__( 'Empower your calendar, build your community' ),
            array( $this, 'features_info' ),
            AI1EC_POST_TYPE,
            'side',
            'low'
        );
        
    }

    /**
     * Add Event Details meta box to the Add/Edit Event screen in the dashboard.
     *
     * @return void
     */
    public function features_info( $post ) {
        $message = __(
                '<ul class="ai1ec-features-list"><li><a href="https://time.ly/hub" target="_blank">Pull events from other calendars</a></li><li><a href="https://time.ly/hub" target="_blank">Pull events from Facebook</a></li><li><a href="https://time.ly/hub" target="_blank">Add a Newsletter</a></li><li><a href="https://time.ly/hub" target="_blank">Get public event submissions</a></li><li><a href="https://time.ly/hub" target="_blank">Charge people to post events</a></li><li><a href="https://time.ly/hub" target="_blank">Add social sharing</a></li><li><a href="https://time.ly/hub" target="_blank">And more</a></li></ul>',
                AI1EC_PLUGIN_NAME
            );
            
        echo $message;
    }


    /**
     * Add Event Details meta box to the Add/Edit Event screen in the dashboard.
     *
     * @return void
     */
    public function meta_box_view( $post ) {

        $theme_loader         = $this->_registry->get( 'theme.loader' );
        $empty_event          = $this->_registry->get( 'model.event' );

        // ==================
        // = Default values =
        // ==================
        // ATTENTION - When adding new fields to the event remember that you must
        // also set up the duplicate-controller.
        // TODO: Fix this duplication.
        $all_day_event         = '';
        $instant_event         = '';
        $start                 = $this->_registry->get( 'date.time' );
        $end                   = $this->_registry->get( 'date.time', '+1 hour' );
        $timezone_name         = null;
        $timezones_list        = $this->_registry->get( 'date.timezone' )->get_timezones( true );
        $show_map              = false;
        $google_map            = '';
        $venue                 = '';
        $country               = '';
        $address               = '';
        $city                  = '';
        $province              = '';
        $postal_code           = '';
        $contact_name          = '';
        $contact_phone         = '';
        $contact_email         = '';
        $contact_url           = '';
        $cost                  = '';
        $is_free               = '';
        $cost_type             = 'free';
        $rrule                 = '';
        $rrule_text            = '';
        $repeating_event       = false;
        $exrule                = '';
        $exrule_text           = '';
        $exclude_event         = false;
        $exdate                = '';
        $show_coordinates      = false;
        $longitude             = '';
        $latitude              = '';
        $coordinates           = '';
        $ticket_url            = '';

        $instance_id = false;
        if ( isset( $_REQUEST['instance'] ) ) {
            $instance_id = absint( $_REQUEST['instance'] );
        }
        if ( $instance_id ) {
            add_filter(
                'print_scripts_array',
                array( $this, 'disable_autosave' )
            );
        }

        try {
            // on some php version, nested try catch blocks fail and the exception would never be caught.
            // this is why we use this approach.
            $excpt = null;
            $event = null;
            try {
                $event = $this->_registry->get(
                    'model.event',
                    get_the_ID(),
                    $instance_id
                );
            } catch ( Ai1ec_Event_Not_Found_Exception $excpt ) {
                $ai1ec_localization_helper = $this->_registry
                    ->get( 'p28n.wpml' );
                $translatable_id = $ai1ec_localization_helper
                    ->get_translatable_id();
                if ( false !== $translatable_id ) {
                    $event = $this->_registry->get(
                        'model.event',
                        $translatable_id,
                        $instance_id
                    );
                }
            }
            if ( null !== $excpt ) {
                throw $excpt;
            }

            // Existing event was found. Initialize form values with values from
            // event object.
            $all_day_event    = $event->is_allday()  ? 'checked' : '';
            $instant_event    = $event->is_instant() ? 'checked' : '';

            $start            = $event->get( 'start' );
            $end              = $event->get( 'end' );
            $timezone_name    = $event->get( 'timezone_name' );

            $multi_day        = $event->is_multiday();

            $show_map         = $event->get( 'show_map' );
            $google_map       = $show_map ? 'checked="checked"' : '';

            $show_coordinates = $event->get( 'show_coordinates' );
            $coordinates      = $show_coordinates ? 'checked="checked"' : '';
            $longitude        = (float)$event->get( 'longitude', 0 );
            $latitude         = (float)$event->get( 'latitude',  0 );
            // There is a known bug in Wordpress (https://core.trac.wordpress.org/ticket/15158) that saves 0 to the DB instead of null.
            // We handle a special case here to avoid having the fields with a value of 0 when the user never inputted any coordinates
            if ( ! $show_coordinates ) {
                $longitude = '';
                $latitude  = '';
            }

            $venue            = $event->get( 'venue' );
            $country          = $event->get( 'country' );
            $address          = $event->get( 'address' );
            $city             = $event->get( 'city' );
            $province         = $event->get( 'province' );
            $postal_code      = $event->get( 'postal_code' );
            $contact_name     = $event->get( 'contact_name' );
            $contact_phone    = $event->get( 'contact_phone' );
            $contact_email    = $event->get( 'contact_email' );
            $contact_url      = $event->get( 'contact_url' );
            $cost             = $event->get( 'cost' );
            $ticket_url       = $event->get( 'ticket_url' );
            $rrule            = $event->get( 'recurrence_rules' );
            $exrule           = $event->get( 'exception_rules' );
            $exdate           = $event->get( 'exception_dates' );
            $repeating_event  = ! empty( $rrule );
            $exclude_event    = ! empty( $exrule );

            $is_free = '';
            $free = $event->is_free();
            if ( ! empty( $free ) ) {
                $is_free = 'checked="checked" ';
                $cost    = '';
            }

            if ( $repeating_event ) {
                $rrule_text = ucfirst(
                    $this->_registry->get( 'recurrence.rule' )
                    ->rrule_to_text( $rrule )
                );
            }

            if ( $exclude_event ) {
                $exrule_text = ucfirst(
                    $this->_registry->get( 'recurrence.rule' )
                    ->rrule_to_text( $exrule )
                );
            }
        } catch ( Ai1ec_Event_Not_Found_Exception $excpt ) {
            // Event does not exist.
            // Leave form fields undefined (= zero-length strings)
            $event = null;
        }

        // Time zone; display if set.
        $timezone        = '';
        $timezone_string = null;
        $date_timezone   = $this->_registry->get( 'date.timezone' );

        if (
            ! empty( $timezone_name ) &&
            $local_name = $date_timezone->get_name( $timezone_name )
        ) {
            $timezone_string = $local_name;
        }
        if ( null === $timezone_string ) {
            $timezone_string = $date_timezone->get_default_timezone();
        }

        if ( $timezone_string ) {
            $timezone = $this->_registry->get( 'date.system' )
                ->get_gmt_offset_expr( $timezone_string );
        }

        if ( empty( $timezone_name ) ) {
            /**
             * Actual Olsen timezone name is used when value is to be directly
             * exposed to user in some mean. It's possible to use named const.
             * `'sys.default'` only when passing value to date.time library.
             */
            $timezone_name = $date_timezone->get_default_timezone();
        }

        // This will store each of the accordion tabs' markup, and passed as an
        // argument to the final view.
        $boxes = array();
        $parent_event_id = null;
        if ( $event ) {
            $parent_event_id = $this->_registry->get( 'model.event.parent' )
                ->event_parent( $event->get( 'post_id' ) );
        }
        // ===============================
        // = Display event time and date =
        // ===============================
        $args = array(
            'all_day_event'      => $all_day_event,
            'instant_event'      => $instant_event,
            'start'              => $start,
            'end'                => $end,
            'repeating_event'    => $repeating_event,
            'rrule'              => $rrule,
            'rrule_text'         => $rrule_text,
            'exclude_event'      => $exclude_event,
            'exrule'             => $exrule,
            'exrule_text'        => $exrule_text,
            'timezone'           => $timezone,
            'timezone_string'    => $timezone_string,
            'timezone_name'      => $timezone_name,
            'exdate'             => $exdate,
            'parent_event_id'    => $parent_event_id,
            'instance_id'        => $instance_id,
            'timezones_list'     => $timezones_list,
        );

        $boxes[] = $theme_loader
            ->get_file( 'box_time_and_date.php', $args, true )
            ->get_content();

        // =================================================
        // = Display event location details and Google map =
        // =================================================
        $args = array(
            'select_venue'     => apply_filters( 'ai1ec_admin_pre_venue_html', '' ),
            'save_venue'       => apply_filters( 'ai1ec_admin_post_venue_html', '' ),
            'venue'            => $venue,
            'country'          => $country,
            'address'          => $address,
            'city'             => $city,
            'province'         => $province,
            'postal_code'      => $postal_code,
            'google_map'       => $google_map,
            'show_map'         => $show_map,
            'show_coordinates' => $show_coordinates,
            'longitude'        => $longitude,
            'latitude'         => $latitude,
            'coordinates'      => $coordinates,
        );
        $boxes[] = $theme_loader
            ->get_file( 'box_event_location.php', $args, true )
            ->get_content();

        // ===================================
        // = Display event ticketing options =
        // ===================================
        if ( $event ) {
            $cost_type = get_post_meta(
                $event->get( 'post_id' ),
                '_ai1ec_cost_type',
                true
            );
            if ( ! $cost_type ) {
                if ( $ticket_url || $cost ) {
                    $cost_type = 'external';
                } else {
                    $cost_type = 'free';
                }
            }
        }

        $api                   = $this->_registry->get( 'model.api.api-ticketing' );
        $api_reg               = $this->_registry->get( 'model.api.api-registration' );
        $ticketing             = $api_reg->is_signed() && $api_reg->is_ticket_available() && $api_reg->is_ticket_enabled();
        $message               = $api->get_sign_message();
        $ticket_error          = null;
        $ticket_event_imported = false;
        $tickets               = array( null );
        $tax_options           = null;

        if ( ! $api_reg->is_ticket_available() ) {
            $message = __(
                'Ticketing is currently not available for this website. Please, try again later.',
                AI1EC_PLUGIN_NAME
            );
        } else if ( ! $api_reg->is_ticket_enabled() ) {
            $message = __(
                'Timely Ticketing saves time & money. Create ticketing/registration right here and now. You do not pay any ticketing fees (other than regular PayPal transaction costs). Create as many ticketing/registration as you\'d like.<br /><br />Ticketing feature is not enabled for this website. Please sign up for Ticketing plan <a href="https://time.ly/tickets-existing-users/" target="_blank">here</a>.',
                AI1EC_PLUGIN_NAME
            );
        }

        if ( $event ) {
            $is_ticket_event       = ! is_null( $api->get_api_event_id( $event->get( 'post_id' ) ) );
            $ticket_event_account  = $api->get_api_event_account( $event->get( 'post_id' ) );
            $ticket_event_imported = $api->is_ticket_event_imported( $event->get( 'post_id' ) );
            if ( $ticketing || $ticket_event_imported ) {
                if ( 'tickets' === $cost_type ) {
                    if ( $ticket_event_imported ) {
                        $response = json_decode( $api->get_ticket_types( $event->get( 'post_id' ) ) );
                        if ( isset( $response->data )  && 0 < count( $response->data ) ) {
                            $tickets = array_merge( $tickets, $response->data );
                        }
                        if ( isset( $response->error ) ) {
                            $ticket_error = $response->error;
                        }
                    } else {
                        $response = $api->get_event( $event->get( 'post_id' ) );
                        if ( isset( $response->data ) && 0 < count( $response->data ) ) {
                            $tickets     = array_merge( $tickets, $response->data->ticket_types );
                            $tax_options = $response->data->tax_options;
                        }
                        if ( isset( $response->error ) ) {
                            $ticket_error = $response->error;
                        }
                    }
                }
                $uid = $event->get_uid();
            } else {
                $uid = $empty_event->get_uid();
            }
            $uid = $event->get_uid();
        } else {
            $is_ticket_event      = false;
            $ticket_event_account = '';
            $uid                  = $empty_event->get_uid();
        }

        if ( $ticketing ) {
            if ( $event ) {
                $ticket_currency = $api->get_api_event_currency( $event->get( 'post_id' ) );
                if ( $api->is_ticket_event_from_another_account( $event->get( 'post_id' ) ) )  {
                    $ticket_error  = sprintf(
                        __( 'This Event was created using a different account %s. Changes are not allowed.', AI1EC_PLUGIN_NAME ),
                        $api->get_api_event_account( $event->get( 'post_id' ) )
                    );
                }
            }
            if ( ! isset( $ticket_currency ) || is_null( $ticket_currency ) ) {
                //for new ticket events get the currency from the payments settings
                $payments_settings = $api->get_payment_settings();
                if ( null !== $payments_settings ) {
                    $ticket_currency = $payments_settings['currency'];
                } else {
                    $ticket_currency = 'USD';
                }
            }
        } else {
            $ticket_currency = '';
        }

        $args = array(
            'cost'                  => $cost,
            'cost_type'             => $cost_type,
            'ticket_url'            => $ticket_url,
            'event'                 => $empty_event,
            'uid'                   => $uid,
            'tickets'               => $tickets,
            'ticketing'             => $ticketing,
            'valid_payout_details'  => $api->has_payment_settings(),
            'tickets_message'       => $message,
            'start'                 => $start,
            'end'                   => $end,
            'tickets_loading_error' => $ticket_error,
            'ticket_event_imported' => $ticket_event_imported,
            'is_free'               => $is_free,
            'ticket_currency'       => $ticket_currency,
            'is_ticket_event'       => $is_ticket_event,
            'ticket_event_account'  => $ticket_event_account,
            'tax_options'            => $tax_options
        );

        $boxes[] = $theme_loader
            ->get_file( 'box_event_cost.php', $args, true )
            ->get_content();



        // =========================================
        // = Display organizer contact information =
        // =========================================
        $submitter_html = null;
        if ( $event ) {
            $submitter_info = $event->get_submitter_info();
            if (  null !== $submitter_info ) {
                if ( 1 === $submitter_info['is_organizer'] ) {
                    $submitter_html = Ai1ec_I18n::__( '<span class="ai1ec-info-text">The event was submitted by this Organizer.</span>' );
                } else if ( isset( $submitter_info['email'] ) ||
                    isset( $submitter_info['name'] ) ) {
                    $submitted_by   = '';
                    if ( false === ai1ec_is_blank ( $submitter_info['name'] ) ) {
                        $submitted_by = sprintf( '<strong>%s</strong>', htmlspecialchars( $submitter_info['name'] ) );
                    }
                    if ( false === ai1ec_is_blank( $submitter_info['email'] ) ) {
                        if ( '' !== $submitted_by ) {
                            $submitted_by .= Ai1ec_I18n::__( ', email: ' );
                        }
                        $submitted_by .= sprintf( '<a href="mailto:%s" target="_top">%s</a>', $submitter_info['email'], $submitter_info['email'] ) ;
                    }
                    $submitter_html = sprintf( Ai1ec_I18n::__( '<span class="ai1ec-info-text">The event was submitted by %s.</span>' ),
                            $submitted_by
                        );
                }
            }
        }
        $args = array(
            'contact_name'    => $contact_name,
            'contact_phone'   => $contact_phone,
            'contact_email'   => $contact_email,
            'contact_url'     => $contact_url,
            'event'           => $empty_event,
            'submitter_html'  => $submitter_html
        );
        $boxes[] = $theme_loader
            ->get_file( 'box_event_contact.php', $args, true )
            ->get_content();

        // ==========================
        // = Parent/Child relations =
        // ==========================
        if ( $event ) {
            $parent   = $this->_registry->get( 'model.event.parent' )
                ->get_parent_event( $event->get( 'post_id' ) );
            if ( $parent ) {
                try {
                    $parent = $this->_registry->get( 'model.event', $parent );
                } catch ( Ai1ec_Event_Not_Found_Exception $exception ) { // ignore
                    $parent = null;
                }
            }
            if ( $parent ) {
                $children = $this->_registry->get( 'model.event.parent' )
                    ->get_child_event_objects( $event->get( 'post_id' ) );
                $args = compact( 'parent', 'children' );
                $args['registry'] = $this->_registry;

                $boxes[] = $theme_loader->get_file(
                    'box_event_children.php',
                    $args,
                    true
                )->get_content();
            }

        }

        $boxes = apply_filters( 'ai1ec_add_new_event_boxes', $boxes, $event );
        // Display the final view of the meta box.
        $args = array(
            'boxes'          => $boxes,
        );

        echo $theme_loader
            ->get_file( 'add_new_event_meta_box.php', $args, true )
            ->get_content();
    }

    /**
     * Add Banner Image meta box to the Add/Edit Event.
     *
     * @return void
     */
    public function banner_meta_box_view( $post ) {
        $banner_image_meta = get_post_meta( $post->ID, 'ai1ec_banner_image' );
        $theme_loader      = $this->_registry->get( 'theme.loader' );
        $args = array(
            'src'         => $banner_image_meta && $banner_image_meta[0]
                ? $banner_image_meta[0] : false,
            'set_text'    => Ai1ec_I18n::__( 'Set banner image' ),
            'remove_text' => Ai1ec_I18n::__( 'Remove banner image' ),

        );
        echo $theme_loader
            ->get_file( 'banner-image.twig', $args, true )
            ->get_content();
    }

    /**
     * disable_autosave method
     *
     * Callback to disable autosave script
     *
     * @param array $input List of scripts registered
     *
     * @return array Modified scripts list
     */
    public function disable_autosave( array $input ) {
        wp_deregister_script( 'autosave' );
        $autosave_key = array_search( 'autosave', $input );
        if ( false === $autosave_key || ! is_scalar( $autosave_key ) ) {
            unset( $input[$autosave_key] );
        }
        return $input;
    }

    /**
     * Renders Bootstrap inline alert.
     *
     * @param WP_Post $post Post object.
     *
     * @return void Method does not return.
     */
    public function event_inline_alert( $post ) {
        if ( $this->_is_post_event( $post ) ) {
            $theme_loader = $this->_registry->get( 'theme.loader' );
            echo $theme_loader->get_file( 'box_inline_warning.php', null, true )
                ->get_content();
        }
    }

    private function _is_post_event( $post ) {
        return isset( $post->post_type ) && AI1EC_POST_TYPE === $post->post_type;
    }

}


==================================================
FILE PATH: ./app/view/admin/settings.php
==================================================
<?php

/**
 * The Settings page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Admin_Settings extends Ai1ec_View_Admin_Abstract {

    /**
     * @var string The nonce action
     */
    CONST NONCE_ACTION = 'ai1ec_settings_save';

    /**
     * @var string The nonce name
     */
    CONST NONCE_NAME  = 'ai1ec_settings_nonce';

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Abstract::display_page()
     */
    public function display_page() {
        $settings = $this->_registry->get( 'model.settings' );
        $args = array(
            'title' => Ai1ec_I18n::__(
                'All-in-One Event Calendar: Settings'
            ),
            'nonce' => array(
                'action'   => self::NONCE_ACTION,
                'name'     => self::NONCE_NAME,
                'referrer' => false,
            ),
            'metabox' => array(
                'screen' => $settings->get( 'settings_page' ),
                'action' => 'left',
                'object' => null
            ),
            'support' => array(
                'screen' => $settings->get( 'settings_page' ),
                'action' => 'right',
                'object' => null
            ),
            'action' =>
                ai1ec_admin_url(
                    '?controller=front&action=ai1ec_save_settings&plugin=' .
                    AI1EC_PLUGIN_NAME
                ),
        );
        $loader = $this->_registry->get( 'theme.loader' );
        $file   = $loader->get_file( 'setting/page.twig', $args, true );
        $file->render();
        if ( apply_filters( 'ai1ec_robots_install', true ) ) {
            $this->_registry->get( 'robots.helper' )->install();
        }
    }

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Abstract::add_page()
     */
    public function add_page() {
        $settings_page = add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            Ai1ec_I18n::__( 'Settings' ),
            Ai1ec_I18n::__( 'Settings' ),
            'manage_ai1ec_options',
            AI1EC_PLUGIN_NAME . '-settings',
            array( $this, 'display_page' )
        );
        $this->_registry->get( 'model.settings' )
            ->set( 'settings_page', $settings_page );
    }

    /**
     * Adds metabox to the page.
     *
     * @wp_hook admin_init
     *
     * @return void
     */
    public function add_meta_box() {
        // Add the 'General Settings' meta box.
        add_meta_box(
            'ai1ec-general-settings',
            Ai1ec_I18n::_x( 'General Settings', 'meta box' ),
            array( $this, 'display_meta_box' ),
            $this->_registry->get( 'model.settings' )->get( 'settings_page' ),
            'left',
            'default'
        );
        // Add the 'Timely' meta box.
        add_meta_box(
            'ai1ec-support',
            Ai1ec_I18n::_x( 'Timely', 'meta box', AI1EC_PLUGIN_NAME ),
            array( $this, 'support_meta_box' ),
            $this->_registry->get( 'model.settings' )->get( 'settings_page' ),
            'right',
            'default'
        );
    }

    /**
     * Renders the Timely blog meta box
     *
     * @param mixed $object
     * @param mixed $box
     */
    public function support_meta_box( $object, $box ) {
        $newsItems = $this->_registry->get( 'news.feed' )->import_feed();
        $loader    = $this->_registry->get( 'theme.loader' );
        $file      = $loader->get_file(
            'box_support.php',
            array(
                'news' => $newsItems,
            ),
            true
        );
        $file->render();
    }

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Abstract::handle_post()
     */
    public function handle_post() {
    }

    /**
     * Displays the meta box for the settings page.
     *
     * @param mixed $object
     * @param mixed $box
     */
    public function display_meta_box( $object, $box )  {
        $tabs = array(
            'viewing-events' => array(
                'name' => Ai1ec_I18n::__( 'Viewing Events' ),
            ),
            'editing-events' => array(
                'name' => Ai1ec_I18n::__( 'Adding/Editing Events' ),
            ),
            'advanced' => array(
                'name' => Ai1ec_I18n::__( 'Advanced' ),
                'items' => array(
                    'advanced'       => Ai1ec_I18n::__( 'Advanced Settings' ),
                    'embedded-views' => Ai1ec_I18n::__( 'Shortcodes' ),
                    'email'          => Ai1ec_I18n::__( 'Email Templates' ),
                    'apis'           => Ai1ec_I18n::__( 'External Services' ),
                    'cache'          => Ai1ec_I18n::__( 'Cache Report' ),
                )
            )
        );

        // let other extensions add tabs.
        $tabs             = apply_filters( 'ai1ec_add_setting_tabs', $tabs );
        $settings         = $this->_registry->get( 'model.settings' );
        $plugin_settings  = $settings->get_options();
        $tabs             = $this->_get_tabs_to_show( $plugin_settings, $tabs );
        $loader           = $this->_registry->get( 'theme.loader' );
        $api               = $this->_registry->get( 'model.api.api-registration' );
        $signup_available  = $api->is_api_sign_up_available();
        $signed_to_api     = $api->is_signed();
        $ticketing_message = $api->get_sign_message();
        $loader            = $this->_registry->get( 'theme.loader' );
        $account           = $api->get_current_account();
        $signup_args       = array(
            'api_signed'            => $signed_to_api,
            'signup_available'      => $signup_available,
            'title'                 => Ai1ec_I18n::__(
                'Please, Sign In to Timely Network.'
            ),
            'nonce'                 => array(
                'action'   => 'ai1ec_api_ticketing_signup',
                'name'     => 'ai1ec_api_ticketing_nonce',
                'referrer' => false,
            ),
            'api_action'            =>
                '?controller=front&action=ai1ec_api_ticketing_signup&plugin=' .
                AI1EC_PLUGIN_NAME,
            'required_text'         => Ai1ec_I18n::__( 'This field is required.' ),
            'register_text'         => Ai1ec_I18n::__( 'Register' ),
            'sign_in_text'          => Ai1ec_I18n::__( 'Sign in' ),
            'signed_in_text'        => Ai1ec_I18n::__(
                'You are signed in to <b>Timely Network</b> as ' . $account
            ),
            'sign_out_text'         => Ai1ec_I18n::__( 'Sign out' ),
            'can_sign_out'          => apply_filters( 'ai1ec_api_can_sign_out', true ),
            'full_name_text'        => Ai1ec_I18n::__( 'Full Name:' ),
            'hide_form_text'        => Ai1ec_I18n::__( 'Hide form' ),
            'show_form_text'        => Ai1ec_I18n::__( 'Show form' ),
            'email_text'            => Ai1ec_I18n::__( 'Email:' ),
            'password_text'         => Ai1ec_I18n::__( 'Password:' ),
            'confirm_password_text' => Ai1ec_I18n::__( 'Confirm Password:' ),
            'phone_number_text'     => Ai1ec_I18n::__( 'Phone Number:' ),
            'terms_text'            => Ai1ec_I18n::__(
                'I confirm that I have read, understand and agree with the <a href="https://time.ly/tos">terms of service</a>.'
            ),
            'sign_out_warning'      => Ai1ec_I18n::__(
                '<h4>Attention Required:</h4>If you choose to sign-out of the API Timely Network this will close all the created tickets and remove user access to them. In this case, on the event page, users will see the status Event closed.'
            ),
            'sign_out_cancel'       => Ai1ec_I18n::__( 'Cancel' ),
            'sign_out_confirm'      => Ai1ec_I18n::__( 'Sign Out' ),
            'sign_up_button_text'   => Ai1ec_I18n::__( 'Sign Up' ),
            'sign_in_button_text'   => Ai1ec_I18n::__( 'Sign In' ),
            'calendar_type_text'    => Ai1ec_I18n::__( 'Calendar Type:' ),
            'calendar_types'        => array(
                    'tourism'           => Ai1ec_I18n::__( 'Tourism' ),
                    'media'             => Ai1ec_I18n::__( 'Media' ),
                    'community_hubs'    => Ai1ec_I18n::__( 'Community Hubs' ),
                    'education'         => Ai1ec_I18n::__( 'Education' ),
                    'venue_business'    => Ai1ec_I18n::__( 'Venue/Business' ),
                    'artist_performer'  => Ai1ec_I18n::__( 'Artist/Performer' ),
                    'church_spiritual'  => Ai1ec_I18n::__( 'Church/Spiritual' ),
                    'association_group' => Ai1ec_I18n::__( 'Association/Group' ),
                    'other'             => Ai1ec_I18n::__( 'Other' )
            ),
        );
        $loader->get_file( 'setting/api-signup.twig', $signup_args, true )->render();


        $args             = array(
            'tabs'          => $tabs,
            'content_class' => 'ai1ec-form-horizontal',
            'submit'        => array(
                'id'          => 'ai1ec_save_settings',
                'value'       => '<i class="ai1ec-fa ai1ec-fa-save ai1ec-fa-fw"></i> ' .
                    Ai1ec_I18n::__( 'Save Settings' ),
                'args'        => array(
                    'class'     => 'ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg',
                ),
            ),
            'pre_tabs_markup'   => sprintf(
                '<div class="ai1ec-gzip-causes-js-failure">' .
                Ai1ec_I18n::__(
                    'If the form below is not working please follow <a href="%s">this link</a>.'
                ) .
                '</div>',
                wp_nonce_url(
                    add_query_arg( 'ai1ec_disable_gzip_compression', '1' ),
                    'ai1ec_disable_gzip_compression'
                )
            )
        );



        $file = $loader->get_file( 'setting/bootstrap_tabs.twig', $args, true );
        $file->render();

    }

    /**
     * Based on the plugin options, decides what tabs to render.
     *
     *
     *
     * @param array $plugin_settings
     * @param array $tabs
     *
     * @return array
     */
    protected function _get_tabs_to_show( array $plugin_settings, array $tabs ) {
        $index = 0;
        $renderer = $this->_registry->get( 'html.element.setting-renderer' );
        foreach ( $plugin_settings as $id => $setting ) {
            // if the setting is shown
            if ( isset ( $setting['renderer'] ) ) {
                $tab_to_use = isset( $setting['renderer']['item'] ) ?
                    $setting['renderer']['item'] :
                    $setting['renderer']['tab'];
                // check if it's the first one
                if (
                    ! isset ( $tabs[$tab_to_use]['elements'] )
                ) {
                    $tabs[$tab_to_use]['elements'] = array();
                }
                $setting['id'] = $id;
                // render the settings
                $weight = 10;
                if ( isset( $setting['renderer']['weight'] ) ) {
                    $weight = (int)$setting['renderer']['weight'];
                }
                // NOTICE: do NOT change order of two first
                // elements {weight,index}, otherwise sorting will fail.
                $tabs[$tab_to_use]['elements'][] = array(
                    'weight' => $weight,
                    'index'  => ++$index,
                    'html'   => $renderer->render( $setting ),
                );
                // if the settings has an item tab, set the item as active.
                if ( isset( $setting['renderer']['item'] ) ) {
                    if ( ! isset( $tabs[$setting['renderer']['tab']]['items_active'][$setting['renderer']['item']] ) ) {
                        $tabs[$setting['renderer']['tab']]['items_active'][$setting['renderer']['item']] = true;
                    }
                }
            }
        }
        $tabs_to_display = array();
        // now let's see what tabs to display.
        foreach ( $tabs as $name => $tab ) {
            // sort by weights
            if ( isset( $tab['elements'] ) ) {
                asort( $tab['elements'] );
            }
            // if a tab has more than one item.
            if ( isset( $tab['items'] ) ) {
                // if no item is active, nothing is shown
                if ( empty( $tab['items_active'] ) ) {
                    continue;
                }
                // if only one item is active, do not use the dropdown
                if ( count( $tab['items_active'] ) === 0 ) {
                    $name = key($tab['items_active']);
                    $tab['name'] = $tab['items'][$name];
                    unset ( $tab['items'] );
                } else {
                    // check active items for the dropdown
                    foreach ( $tab['items'] as $item => $longname ) {
                        if ( ! isset( $tab['items_active'][$item] ) ) {
                            unset( $tab['items'][$item] );
                        }
                    }
                }
                // lets make a check to avoid overriding tabs
                if ( ! isset( $tabs_to_display[$name] ) ) {
                    $tabs_to_display[$name] = $tab;
                } else {
                    $tabs_to_display[$name]['elements'] = $tab['elements'];
                }

            } else {
                // no items, just check for any element to display.
                if ( isset( $tab['elements'] ) ) {
                    // lets make a check to avoid overriding tabs
                    if ( ! isset( $tabs_to_display[$name] ) ) {
                        $tabs_to_display[$name] = $tab;
                    } else {
                        $tabs_to_display[$name]['elements'] = $tab['elements'];
                    }
                }
            }
        }
        return $tabs_to_display;
    }

}


==================================================
FILE PATH: ./app/view/admin/abstract.php
==================================================
<?php

/**
 * The abstract class for a admin page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
abstract class Ai1ec_View_Admin_Abstract extends Ai1ec_Base {

    /**
     * @var string
     */
    protected $_page_id;

    /**
     * @var string
     */
    protected $_page_suffix;

    /**
     * @var string
     */
    protected $_api_registration;

    /**
     * Standard constructor
     *
     * @param Ai1ec_Registry_Object $registry
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $exploded_class          = explode( '_', get_class( $this ) );
        $this->_page_suffix      = strtolower( end( $exploded_class ) );
        $this->_api_registration = $this->_registry->get( 'model.api.api-registration' );
    }

    /**
     * Get the url of the page
     *
     * @return string
     */
    public function get_url() {
        return add_query_arg(
            array(
                'post_type' => AI1EC_POST_TYPE,
                'page'      => AI1EC_PLUGIN_NAME . '-' . $this->_page_suffix,
            ),
            ai1ec_admin_url( 'edit.php' )
        );
    }

    public function isLoggedIn() {
        $signup_available        = $this->_api_registration->is_api_sign_up_available();
        $signed_to_api           = $this->_api_registration->is_signed();

        if ( $signup_available && ! $signed_to_api ) {
            return false;
        }

        return true;
    }

    /**
     * Adds the page to the correct menu.
     */
    abstract public function add_page();

    /**
     * Adds the page to the correct menu.
     */
    abstract public function add_meta_box();

    /**
     * Display the page html
     */
    abstract public function display_page();

    /**
     * Handle post, likely to be deprecated to use commands.
     */
    abstract public function handle_post();

}


==================================================
FILE PATH: ./app/view/admin/get-repeat-box.php
==================================================
<?php

/**
 * The get repeat box snippet.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Admin_Get_repeat_Box extends Ai1ec_Base {
    /**
     * get_repeat_box function
     *
     * @return string
     **/
    public function get_repeat_box() {
        $time_system = $this->_registry->get( 'date.system' );
        $loader = $this->_registry->get( 'theme.loader' );
        $repeat  = (int) $_REQUEST["repeat"];
        $repeat  = $repeat == 1 ? 1 : 0;
        $post_id = (int) $_REQUEST["post_id"];
        $count   = 100;
        $end     = 0;
        $until   = $time_system->current_time( true );

        // try getting the event
        try {
            $event = $this->_registry->get( 'model.event', $post_id );
            $rule = '';

            if ( $repeat ) {
                $rule = $event->get( 'recurrence_rules' )
                    ? $event->get( 'recurrence_rules' )
                    : '';
            } else {
                $rule = $event->get( 'exception_rules' ) ?
                    $event->get( 'exception_rules' )
                    : '';
            }

            $rule = $this->_registry->get( 'recurrence.rule' )->filter_rule( $rule );

            $rc = new SG_iCal_Recurrence(
                new SG_iCal_Line( 'RRULE:' . $rule )
            );

            if ( $until = $rc->getUntil() ) {
                $until = ( is_numeric( $until ) )
                ? $until
                : strtotime( $until );
                $end = 2;
            } elseif ( $count = $rc->getCount() ) {
                $count = ( is_numeric( $count ) ) ? $count : 100;
                $end = 1;
            }
        } catch( Ai1ec_Event_Not_Found_Exception $e ) {
            $rule = '';
            $rc   = new SG_iCal_Recurrence(
                new SG_iCal_Line( 'RRULE:' )
            );
        }

        $args = array(
            'row_daily'       => $this->row_daily(
                false,
                $rc->getInterval() ? $rc->getInterval() : 1
            ),
            'row_weekly'      => $this->row_weekly(
                false,
                $rc->getInterval() ? $rc->getInterval() : 1,
                is_array( $rc->getByDay() ) ? $rc->getByDay() : array()
            ),
            'row_monthly'     => $this->row_monthly(
                false,
                $rc->getInterval() ? $rc->getInterval() : 1,
                ! $this->_is_monthday_empty( $rc ),
                $rc->getByMonthDay() ? $rc->getByMonthDay() : array(),
                $rc->getByDay() ? $rc->getByDay() : array()
            ),
            'row_yearly'      => $this->row_yearly(
                false,
                $rc->getInterval() ? $rc->getInterval() : 1,
                is_array( $rc->getByMonth() ) ? $rc->getByMonth() : array()
            ),
            'row_custom'      => $this->row_custom(
                false,
                $this->get_date_array_from_rule( $rule )
            ),
            'count'           => $this->create_count_input(
                'ai1ec_count',
                $count
            ) . Ai1ec_I18n::__( 'times' ),
            'end'             => $this->create_end_dropdown( $end ),
            'until'           => $until,
            'repeat'          => $repeat,
            'ending_type'     => $end,
            'selected_tab'    => $rc->getFreq()
                ? strtolower( $rc->getFreq() )
                : 'custom',
        );
        $output = array(
            'error'   => false,
            'message' => $loader->get_file(
                'box_repeat.php',
                $args,
                true
            )->get_content(),
            'repeat'  => $repeat,
        );
        $json_strategy = $this->_registry->get( 'http.response.render.strategy.json' );
        $json_strategy->render( array( 'data' => $output ) );
    }

    /**
     * get_weekday_by_id function
     *
     * Returns weekday name in English
     *
     * @param int $day_id Day ID
     *
     * @return string
     **/
    public function get_weekday_by_id( $day_id, $by_value = false ) {
        // do not translate this !!!
        $week_days = array(
            0 => 'SU',
            1 => 'MO',
            2 => 'TU',
            3 => 'WE',
            4 => 'TH',
            5 => 'FR',
            6 => 'SA',
        );

        if ( $by_value ) {
            while ( $_name = current( $week_days ) ) {
                if ( $_name == $day_id ) {
                    return key( $week_days );
                }
                next( $week_days );
            }
            return false;
        }
        return $week_days[$day_id];
    }

    /**
     * convert_rrule_to_text method
     *
     * Convert a `recurrence rule' to text to display it on screen
     *
     * @return void
     **/
    public function convert_rrule_to_text() {
        $error   = false;
        $message = '';
        // check to see if RRULE is set
        if ( isset( $_REQUEST['rrule'] ) ) {
            // check to see if rrule is empty
            if ( empty( $_REQUEST['rrule'] ) ) {
                $error   = true;
                $message = Ai1ec_I18n::__(
                    'Recurrence rule cannot be empty.'
                );
            } else {
                //list( $rule, $value ) = explode( '=', $_REQUEST['rrule'], 2 );
                //if ( in_array( array(), $rule ) ) {
                //    $message = $this->_registry->get( 'recurrence.date' );
                //
                //} else {
                    $rrule = $this->_registry->get( 'recurrence.rule' );
                    // convert rrule to text
                    $message = ucfirst(
                        $rrule->rrule_to_text( $_REQUEST['rrule'] )
                    );
                    //}
            }
        } else {
            $error   = true;
            $message = Ai1ec_I18n::__(
                'Recurrence rule was not provided.'
            );
        }
        $output = array(
            'error'   => $error,
            'message' => ( version_compare( phpversion(), '7.4.0', '<' ) && function_exists( 'get_magic_quotes_gpc' ) && get_magic_quotes_gpc() )
            ? stripslashes( $message )
            : $message,
        );

        $json_strategy = $this->_registry->get( 'http.response.render.strategy.json' );
        $json_strategy->render( array( 'data' => $output ) );
    }

    /**
     * create_end_dropdown function
     *
     * Outputs the dropdown list for the recurrence end option.
     *
     * @param int $selected The index of the selected option, if any
     * @return void
     **/
    protected function create_end_dropdown( $selected = NULL ) {
        ob_start();

        $options = array(
            0 => Ai1ec_I18n::__( 'Never' ),
            1 => Ai1ec_I18n::__( 'After' ),
            2 => Ai1ec_I18n::__( 'On date' ),
        );

        ?>
        <select name="ai1ec_end" id="ai1ec_end">
                    <?php foreach( $options as $key => $val ): ?>
                        <option value="<?php echo $key ?>"
                <?php if( $key === $selected ) echo 'selected="selected"' ?>>
                            <?php echo $val ?>
                        </option>
                    <?php endforeach ?>
                </select>
        <?php

                $output = ob_get_contents();
                ob_end_clean();

                return $output;
    }

    /**
     * row_daily function
     *
     * Returns daily selector
     *
     * @return void
     **/
    protected function row_daily( $visible = false, $selected = 1 ) {
        $loader = $this->_registry->get( 'theme.loader' );

        $args = array(
            'visible'  => $visible,
            'count'    => $this->create_count_input(
                'ai1ec_daily_count',
                $selected,
                365
            ) . Ai1ec_I18n::__( 'day(s)' ),
        );
        return $loader->get_file( 'row_daily.php', $args, true )
            ->get_content();
    }

    /**
     * row_custom function
     *
     * Returns custom dates selector
     *
     * @return void
     **/
    protected function row_custom( $visible = false, $dates = array() ) {
        $loader = $this->_registry->get( 'theme.loader' );

        $args = array(
            'visible'        => $visible,
            'selected_dates' => implode( ',', $dates )
        );
        return $loader->get_file( 'row_custom.php', $args, true )
            ->get_content();
    }

    /**
     * Generates and returns "End after X times" input
     *
     * @param Integer|NULL $count Initial value of range input
     *
     * @return String Repeat dropdown
     */
    protected function create_count_input( $name, $count = 100, $max = 365 ) {
        ob_start();

        if ( ! $count ) {
            $count = 100;
        }
        ?>
    <input type="range" name="<?php echo $name ?>" id="<?php echo $name ?>"
        min="1" max="<?php echo $max ?>"
        <?php if ( $count ) echo 'value="' . $count . '"' ?> />
    <?php
        return ob_get_clean();
    }

    /**
     * row_weekly function
     *
     * Returns weekly selector
     *
     * @return void
     **/
    protected function row_weekly(
        $visible        = false,
        $count          = 1,
        array $selected = array()
    ) {
        global $wp_locale;
        $start_of_week = $this->_registry->get( 'model.option' )
            ->get( 'start_of_week', 1 );
        $loader = $this->_registry->get( 'theme.loader' );

        $options = array();
        // get days from start_of_week until the last day
        for ( $i = $start_of_week; $i <= 6; ++$i ) {
            $options[$this->get_weekday_by_id( $i )] = $wp_locale
                ->weekday_initial[$wp_locale->weekday[$i]];
        }

        // get days from 0 until start_of_week
        if ( $start_of_week > 0 ) {
            for ( $i = 0; $i < $start_of_week; $i++ ) {
                $options[$this->get_weekday_by_id( $i )] = $wp_locale
                    ->weekday_initial[$wp_locale->weekday[$i]];
            }
        }

        $args = array(
            'visible'    => $visible,
            'count'      => $this->create_count_input(
                'ai1ec_weekly_count',
                $count,
                52
            ) . Ai1ec_I18n::__( 'week(s)' ),
            'week_days'  => $this->create_list_element(
                'ai1ec_weekly_date_select',
                $options,
                $selected
            )
        );
        return $loader->get_file( 'row_weekly.php', $args, true )
            ->get_content();
    }

    /**
     * Creates a grid of weekday, day, or month selection buttons.
     *
     * @return string
     */
    protected function create_list_element(
        $name,
        array $options  = array(),
        array $selected = array()
    ) {
        ob_start();
        ?>
<div class="ai1ec-btn-group-grid" id="<?php echo $name; ?>">
    <?php foreach ( $options as $key => $val ) : ?>
        <div class="ai1ec-pull-left">
            <a class="ai1ec-btn ai1ec-btn-default ai1ec-btn-block
                <?php echo in_array( $key, $selected ) ? 'ai1ec-active' : ''; ?>">
                <?php echo $val; ?>
            </a>
            <input type="hidden" name="<?php echo $name . '_' . $key; ?>"
                value="<?php echo $key; ?>">
        </div class="ai1ec-pull-left">
    <?php endforeach; ?>
</div>
<input type="hidden" name="<?php echo $name; ?>"
    value="<?php echo implode( ',', $selected ) ?>">
<?php
        return ob_get_clean();
    }

    /**
     * row_monthly function
     *
     * Returns monthly selector
     *
     * @return void
     **/
    protected function row_monthly(
        $visible    = false,
        $count      = 1,
        $bymonthday = true,
        $month      = array(),
        $day        = array()
    ) {
        global $wp_locale;
        $start_of_week = $this->_registry->get( 'model.option' )
            ->get( 'start_of_week', 1 );
        $loader = $this->_registry->get( 'theme.loader' );

        $options_wd = array();
        // get days from start_of_week until the last day
        for ( $i = $start_of_week; $i <= 6; ++$i ) {
            $options_wd[$this->get_weekday_by_id( $i )] = $wp_locale
                ->weekday[$i];
        }

        // get days from 0 until start_of_week
        if ( $start_of_week > 0 ) {
            for ( $i = 0; $i < $start_of_week; $i++ ) {
                $options_wd[$this->get_weekday_by_id( $i )] = $wp_locale
                    ->weekday[$i];
            }
        }

        // get options like 1st/2nd/3rd for "day number"
        $options_dn = array( 1 => 1, 2 => 2, 3 => 3, 4 => 4, 5 => 5 );
        foreach ( $options_dn as $_dn ) {
            $options_dn[$_dn] = $this->_registry->get(
                'date.time',
                strtotime( $_dn . '-01-1998 12:00:00' )
            )->format_i18n( 'jS' );
        }
        $options_dn['-1'] = Ai1ec_I18n::__( 'last' );

        $byday_checked       = $bymonthday ? '' : 'checked';
        $byday_expanded      = $bymonthday ? 'ai1ec-collapse' : 'ai1ec-in';
        $bymonthday_checked  = $bymonthday ? 'checked' : '';
        $bymonthday_expanded = $bymonthday ? 'ai1ec-in' : 'ai1ec-collapse';

        $args = array(
            'visible'              => $visible,
            'count'                => $this->create_count_input(
                'ai1ec_monthly_count',
                $count,
                12
            ) . Ai1ec_I18n::__( 'month(s)' ),
            'month'                => $this->create_monthly_date_select(
                $month
            ),
            'day_nums'             => $this->create_select_element(
                'ai1ec_monthly_byday_num',
                $options_dn,
                $this->_get_day_number_from_byday( $day )
            ),
            'week_days'            => $this->create_select_element(
                'ai1ec_monthly_byday_weekday',
                $options_wd,
                $this->_get_day_shortname_from_byday( $day )
            ),
            'bymonthday_checked'  => $bymonthday_checked,
            'byday_checked'       => $byday_checked,
            'bymonthday_expanded' => $bymonthday_expanded,
            'byday_expanded'      => $byday_expanded,
        );
        return $loader->get_file( 'row_monthly.php', $args, true )
            ->get_content();
    }

    /**
     * Creates selector for dates in monthly repeat tab.
     *
     * @return void
     */
    protected function create_monthly_date_select( $selected = array() ) {
        $options = array();
        for ( $i = 1; $i <= 31; ++$i ) {
            $options[$i] = $i;
        }
        return $this->create_list_element(
            'ai1ec_montly_date_select',
            $options,
            $selected
        );
    }

    /**
     * create_on_the_select function
     *
     *
     *
     * @return string
     **/
    protected function create_on_the_select(
        $f_selected = false,
        $s_selected = false
    ) {
        $ret = '';

        $first_options = array(
            '0' => Ai1ec_I18n::__( 'first' ),
            '1' => Ai1ec_I18n::__( 'second' ),
            '2' => Ai1ec_I18n::__( 'third' ),
            '3' => Ai1ec_I18n::__( 'fourth' ),
            '4' => '------',
            '5' => Ai1ec_I18n::__( 'last' )
        );
        $ret = $this->create_select_element(
            'ai1ec_monthly_each_select',
            $first_options,
            $f_selected,
            array( 4 )
        );

        $second_options = array(
            '0'   => Ai1ec_I18n::__( 'Sunday' ),
            '1'   => Ai1ec_I18n::__( 'Monday' ),
            '2'   => Ai1ec_I18n::__( 'Tuesday' ),
            '3'   => Ai1ec_I18n::__( 'Wednesday' ),
            '4'   => Ai1ec_I18n::__( 'Thursday' ),
            '5'   => Ai1ec_I18n::__( 'Friday' ),
            '6'   => Ai1ec_I18n::__( 'Saturday' ),
            '7'   => '--------',
            '8'   => Ai1ec_I18n::__( 'day' ),
            '9'   => Ai1ec_I18n::__( 'weekday' ),
            '10'  => Ai1ec_I18n::__( 'weekend day' )
        );

        return $ret . $this->create_select_element(
            'ai1ec_monthly_on_the_select',
            $second_options,
            $s_selected,
            array( 7 )
        );
    }

    /**
     * create_select_element function
     *
     * Render HTML <select> element
     *
     * @param string $name          Name of element to be rendered
     * @param array  $options       Select <option> values as key=>value pairs
     * @param string $selected      Key to be marked as selected [optional=false]
     * @param array  $disabled_keys List of options to disable [optional=array]
     *
     * @return string Rendered <select> HTML element
     **/
    protected function create_select_element(
        $name,
        array $options       = array(),
        $selected            = false,
        array $disabled_keys = array()
    ) {
        ob_start();
        ?>
    <select name="<?php echo $name ?>" id="<?php echo $name ?>">
                <?php foreach( $options as $key => $val ): ?>
                    <option value="<?php echo $key ?>"
            <?php echo $key === $selected ? 'selected="selected"' : '' ?>
            <?php echo in_array( $key, $disabled_keys ) ? 'disabled' : '' ?>>
                        <?php echo $val ?>
                    </option>
                <?php endforeach ?>
            </select>
    <?php
            return ob_get_clean();
    }

    /**
     * row_yearly function
     *
     * Returns yearly selector
     *
     * @return void
     **/
    protected function row_yearly(
        $visible = false,
        $count   = 1,
        $year    = array(),
        $first   = false,
        $second  = false
    ) {
        $loader = $this->_registry->get( 'theme.loader' );

        $args = array(
            'visible'              => $visible,
            'count'                => $this->create_count_input(
                'ai1ec_yearly_count',
                $count,
                10
            ) . Ai1ec_I18n::__( 'year(s)' ),
            'year'                 => $this->create_yearly_date_select( $year ),
            'on_the_select'        => $this->create_on_the_select(
                $first,
                $second
            ),
        );
        return $loader->get_file( 'row_yearly.php', $args, true )
            ->get_content();
    }

    /**
     * create_yearly_date_select function
     *
     *
     *
     * @return void
     **/
    protected function create_yearly_date_select( $selected = array() ) {
        global $wp_locale;
        $options = array();
        for ( $i = 1; $i <= 12; ++$i ) {
            $options[$i] = $wp_locale->month_abbrev[
            $wp_locale->month[sprintf( '%02d', $i )]
            ];
        }
        return $this->create_list_element(
            'ai1ec_yearly_date_select',
            $options,
            $selected
        );
    }

    /**
     * Converts recurrence rule to array of string of dates.
     *
     * @param string $rule RUle.
     *
     * @return array Array of dates or empty array.
     * @throws Ai1ec_Bootstrap_Exception
     */
    protected function get_date_array_from_rule( $rule ) {
        if (
            'RDATE' !== substr( $rule, 0, 5 ) &&
            'EXDATE' !== substr( $rule, 0, 6 )
        ) {
            return array();
        }
        $line             = new SG_iCal_Line( 'RRULE:' . $rule );
        $dates            = $line->getDataAsArray();
        $dates_as_strings = array();
        foreach ( $dates as $date ) {
            $date = str_replace( array( 'RDATE=', 'EXDATE=' ), '', $date );
            $date = $this->_registry->get( 'date.time', $date )->set_preferred_timezone( 'UTC' );
            $dates_as_strings[] = $date->format( 'm/d/Y' );
        }
        return $dates_as_strings;
    }

    /**
     * Returns whether recurrence rule has non null ByMonthDay.
     *
     * @param SG_iCal_Recurrence $rc iCal class.
     *
     * @return bool True or false.
     */
    protected function _is_monthday_empty( SG_iCal_Recurrence $rc ) {
        return false === $rc->getByMonthDay();
    }

    /**
     * Returns day number from by day array.
     *
     * @param array $day
     *
     * @return bool|int Day of false if empty array.
     */
    protected function _get_day_number_from_byday( array $day ) {
        return isset( $day[0] ) ? (int) $day[0] : false;
    }

    /**
     * Returns string part from "ByDay" recurrence rule.
     *
     * @param array $day Element to parse.
     *
     * @return bool|string False if empty or not matched, otherwise short day
     *                     name.
     */
    protected function _get_day_shortname_from_byday( $day ) {
        if ( empty( $day ) ) {
            return false;
        }
        $value = $day[0];
        if ( preg_match('/[-]?\d([A-Z]+)/', $value, $matches ) ) {
            return $matches[1];
        }
        return false;
    }
}


==================================================
FILE PATH: ./app/view/admin/organize.php
==================================================
<?php

/**
 * The page to manage taxonomies.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Organize extends Ai1ec_Base {

    /**
     * @var array The taxonomies for events
     */
    protected $_taxonomies = array();

    /**
     * Register actions to draw the headers
     */
    public function add_taxonomy_actions() {
        $taxonomies = get_object_taxonomies( AI1EC_POST_TYPE, 'object' );
        $dispatcher = $this->_registry->get( 'event.dispatcher' );
        $taxonomy_metadata = array(
            'events_categories' => array(
                'icon' => 'ai1ec-fa ai1ec-fa-folder-open'
            ),
            'events_tags'       => array(
                'icon' => 'ai1ec-fa ai1ec-fa-tags'
            )
        );
        $taxonomy_metadata = apply_filters(
            'ai1ec_add_custom_groups',
            $taxonomy_metadata
        );
        do_action( 'ai1ec_taxonomy_management_css' );
        foreach ( $taxonomies as $taxonomy => $data ) {
            if ( true === $data->public ) {
                $active_taxonomy =
                    isset( $_GET['taxonomy'] ) &&
                    $taxonomy === $_GET['taxonomy'];
                $edit_url = $edit_label = '';
                if ( isset( $taxonomy_metadata[$taxonomy]['url'] ) ) {
                    $edit_url = $taxonomy_metadata[$taxonomy]['url'];
                    $edit_label = $taxonomy_metadata[$taxonomy]['edit_label'];
                }
                $this->_taxonomies[] = array(
                    'taxonomy_name' => $taxonomy,
                    'url'           => add_query_arg(
                        array(
                            'post_type' => AI1EC_POST_TYPE,
                            'taxonomy'  => $taxonomy
                         ),
                        admin_url( 'edit-tags.php' )
                    ),
                    'name'          => $data->labels->name,
                    'active'        => $active_taxonomy,
                    'icon'          => isset( $taxonomy_metadata[$taxonomy] ) ?
                        $taxonomy_metadata[$taxonomy]['icon'] :
                        '',
                    'edit_url'      => $edit_url,
                    'edit_label'    => $edit_label,
                );

                if ( $active_taxonomy ) {
                    $dispatcher->register_action(
                        $taxonomy . '_pre_add_form',
                        array( 'view.admin.organize', 'render_header' )
                    );
                    $dispatcher->register_action(
                        $taxonomy . '_pre_edit_form',
                        array( 'view.admin.organize', 'render_header' )
                    );
                }
            }
        }
    }

    /**
     * Render tabbed header to manage taxonomies.
     */
    public function render_header() {
        echo $this->get_header();
    }

    /**
     * Generate and return tabbed header to manage taxonomies.
     *
     * @return string HTML markup for tabbed header
     */
    public function get_header() {
        return $this->_registry->get( 'theme.loader' )->get_file(
            'organize/header.twig',
            array(
                'taxonomies' => apply_filters(
                    'ai1ec_custom_taxonomies',
                    $this->_taxonomies
                ),
                'text_title' => Ai1ec_I18n::__( 'Organize Events' ),
            ),
            true
        )->get_content();
    }
}


==================================================
FILE PATH: ./app/view/admin/get-tax-box.php
==================================================
<?php

/**
 * The get tax options box.
 *
 * @author     Time.ly Network Inc.
 * @since      2.4
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Admin_Get_Tax_Box extends Ai1ec_Base {
    /**
     * get_tax_box function
     *
     * @return string
     **/
    public function get_tax_box() {
        $api      = $this->_registry->get( 'model.api.api-ticketing' );
        $post_id  = $_POST['ai1ec_event_id'];
        $modal    = $api->get_tax_options_modal( $post_id );
        $output   = array(
            'error'   => $modal->error,
            'message' => $modal->data
        );
        $json_strategy = $this->_registry->get( 'http.response.render.strategy.json' );
        $json_strategy->render( array( 'data' => $output ) );
    }

}


==================================================
FILE PATH: ./app/view/admin/nav.php
==================================================
<?php

/**
 * Admin-side navigation elements rendering.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @package      Ai1EC
 * @subpackage   Ai1EC.View
 */
class Ai1ec_View_Admin_Navigation extends Ai1ec_Base {

    /**
     * Adds a link to Settings page in plugin list page.
     *
     * @param  array $links List of available links.
     *
     * @return array Modified links list.
     */
    public function plugin_action_links( $links ) {
        $settings_link = sprintf(
            Ai1ec_I18n::__( '<a href="%s">Settings</a>' ),
            ai1ec_admin_url( AI1EC_SETTINGS_BASE_URL )
        );
        array_unshift( $links, $settings_link );
        if ( current_user_can( 'activate_plugins' ) ) {
            $updates_link = sprintf(
                Ai1ec_I18n::__( '<a href="%s">Check for updates</a>' ),
                ai1ec_admin_url( AI1EC_FORCE_UPDATES_URL )
            );
            array_push( $links, $updates_link );
        }
        return $links;
    }

}

==================================================
FILE PATH: ./app/view/admin/widget-creator.php
==================================================
<?php

/**
 * The SuperWidget creator page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.1
 *
 * @package    AI1ECSW
 * @subpackage AI1ECSW.View
 */
class Ai1ec_View_Widget_Creator extends Ai1ec_View_Admin_Abstract {

    /**
     * Adds page to the menu.
     *
     * @wp_hook admin_menu
     *
     * @return void
     */
    public function add_page() {
        add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            __( 'Widget Creator', AI1EC_PLUGIN_NAME ),
            __( 'Widget Creator', AI1EC_PLUGIN_NAME ),
            'manage_ai1ec_feeds',
            AI1EC_PLUGIN_NAME . '-widget-creator',
            array( $this, 'display_page' )
        );
    }

    /**
     * Display this plugin's feeds page in the admin.
     *
     * @return void
     */
    public function display_page() {
        $this->_registry->get( 'css.admin' )->admin_enqueue_scripts(
            'ai1ec_event_page_all-in-one-event-calendar-settings'
        );
        $this->_registry->get( 'css.admin' )->process_enqueue(
            array(
                array( 'style', 'super-widget.css', ),
            )
        );
        $args = array(
            'title' => __(
                'Widget Creator',
                AI1EC_PLUGIN_NAME
            ),
            'metabox' => array(
                'screen' => 'ai1ec-super-widget',
                'action' => 'left',
                'object' => null
            ),
        );
        $loader = $this->_registry->get( 'theme.loader' );
        $file   = $loader->get_file( 'widget-creator/page.twig', $args, true );
        $file->render();
    }

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Settings::handle_post()
     */
    public function handle_post() {
    }

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Settings::add_meta_box()
     */
    public function add_meta_box() {
        add_meta_box(
            'ai1ec-widget-creator',
            _x( 'Widget Creator', 'meta box', AI1EC_PLUGIN_NAME ),
            array( $this, 'display_meta_box' ),
            'ai1ec-super-widget',
            'left',
            'default'
        );
    }

    /**
     * Renders the settings
     *
     * @param array $settings
     *
     * @return array
     */
    public function get_html_from_settings( array $settings ) {
        $named_elements = array();
        foreach ( $settings as $id => $setting ) {
            $named_elements[$id] = $this->_registry->get(
                'html.element.setting.' . $setting['renderer']['class'],
                array(
                    'id'       => $id,
                    'value'    => $setting['value'],
                    'renderer' => $setting['renderer'],
                )
            )->render();
        }
        return $named_elements;
    }

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Settings::display_meta_box()
     */
    public function display_meta_box( $object, $box )  {
        $widgets = $this->_registry->get( 'controller.javascript-widget' )
            ->get_widgets();
        // this is just for the Super Widget which doesn't fully implement Ai1ec_Embeddable
        $widgets = apply_filters( 'ai1ec_widget_creators_widgets', $widgets );
        $tabs = array();
        foreach ( $widgets as $widget_id => $widget_class ) {
            $widget           = $this->_registry->get( $widget_class );
            $tabs[$widget_id] = array(
                'name'         => $widget->get_name(),
                'icon'         => $widget->get_icon(),
                'requirements' => $widget->check_requirements(),
                'elements'     => $this->get_html_from_settings(
                    $widget->get_configurable_for_widget_creation()
                )
            );
        }

        $loader = $this->_registry->get( 'theme.loader' );
        $file   = $loader->get_file(
            'widget-creator/super-widget-contents.twig',
            array(
                'tabs'              => $tabs,
                'siteurl'           => trailingslashit( preg_replace( '/^.*?:/', '', ai1ec_get_site_url() ) ),
                'text_common_info'  => Ai1ec_I18n::__( 'Use this tool to generate code snippets you can add to <strong>an external website</strong> to embed new calendars and widgets.' ),
                'text_alert'        => Ai1ec_I18n::__( '<h4>Attention!</h4><p>These widgets are designed to be embedded in <strong>external sites only</strong> and may cause conflicts if used within the same WordPress site.</p>' ),
                'text_alternatives' => sprintf(
                    Ai1ec_I18n::__( '<p>Use <a href="%s"><strong>Appearance</strong> &gt; <strong>Widgets</strong></a> to add event widgets to your WordPress site as you would any other widget, or use <a href="%s" target="_blank">shortcodes</a> to embed the full calendar.</strong></p>' ),
                    admin_url( 'widgets.php' ),
                    'https://time.ly/document/user-guide/using-calendar/display-multiple-calendars-site/'
                ),
                'display_alert'     => apply_filters( 'ai1ec_display_widget_creator_warning', true ),
                'text_preview'      => Ai1ec_I18n::__( 'Preview:' ),
                'text_paste'        => Ai1ec_I18n::__( 'Paste this code onto your site:' ),
                'text_updated_code' => Ai1ec_I18n::__( 'This code will update to reflect changes made to the settings. Changing settings will not affect previously embedded widgets.' ),
            ),
            true
        );
        $file->render();
    }


}


==================================================
FILE PATH: ./app/view/admin/event-category.php
==================================================
<?php

/**
 * Event category admin view snippets renderer.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Admin
 */
class Ai1ec_View_Admin_EventCategory extends Ai1ec_Base {

    /**
     * Inserts Color element at index 2 of columns array
     *
     * @param array $columns Array with event_category columns
     *
     * @return array Array with event_category columns where Color is inserted
     * at index 2
     */
    public function manage_event_categories_columns( $columns ) {
        wp_enqueue_media();
        $this->_registry->get( 'css.admin' )
            ->process_enqueue( array(
                array( 'style', 'bootstrap.min.css' )
            ) );
        return array_splice( $columns, 0, 3 ) + // get only first element
            // insert at index 2
            array( 'cat_color' => __( 'Color', AI1EC_PLUGIN_NAME ) ) +
            // insert at index 3
            array( 'cat_image' => __( 'Image', AI1EC_PLUGIN_NAME ) ) +
            // insert rest of elements at the back
            array_splice( $columns, 0 );
    }

    /**
     * Returns the color or image of the event category.
     *
     * That will be displayed on event category lists page in the backend.
     *
     * @param $not_set
     * @param $column_name
     * @param $term_id
     * @internal param array $columns Array with event_category columns
     *
     * @return array Array with event_category columns where Color is inserted
     * at index 2
     */
    public function manage_events_categories_custom_column(
        $not_set,
        $column_name,
        $term_id
    ) {
        switch ( $column_name ) {
            case 'cat_color':
                return $this->_registry->get( 'view.event.taxonomy' )
                    ->get_category_color_square( $term_id );
            case 'cat_image':
                return $this->_registry->get( 'view.event.taxonomy' )
                    ->get_category_image_square( $term_id );
        }
    }

    /**
     * Hook to process event categories creation
     *
     * @param $term_id
     *
     * @return void Method does not return.
     */
    public function created_events_categories( $term_id ) {
        $this->edited_events_categories( $term_id );
    }

    /**
     * A callback method, triggered when `event_categories' are being edited.
     *
     * @param int $term_id ID of term (category) being edited.
     *
     * @return void Method does not return.
     */
    public function edited_events_categories( $term_id ) {
        if ( isset( $_POST['_inline_edit'] ) ) {
            return;
        }

        $tag_color_value = '';
        if ( ! empty( $_POST['tag-color-value'] ) ) {
            $tag_color_value = (string)$_POST['tag-color-value'];
        }
        $tag_image_value = '';
        if ( ! empty( $_POST['ai1ec_category_image_url'] ) ) {
            $tag_image_value = (string)$_POST['ai1ec_category_image_url'];
        }
        if ( isset( $_POST['ai1ec_category_image_url_remove'] ) ) {
            $tag_image_value = null;
        }

        $db         = $this->_registry->get( 'dbi.dbi' );
        $table_name = $db->get_table_name( 'ai1ec_event_category_meta' );
        $term       = $db->get_row( $db->prepare(
            'SELECT term_id FROM ' . $table_name .
            ' WHERE term_id = %d',
            $term_id
        ) );

        if ( null === $term ) { // term does not exist, create it
            $db->insert(
                $table_name,
                array(
                    'term_id'    => $term_id,
                    'term_color' => $tag_color_value,
                    'term_image' => $tag_image_value,
                ),
                array(
                    '%d',
                    '%s',
                    '%s',
                )
            );
        } else { // term exist, update it
            $db->update(
                $table_name,
                array(
                    'term_color' => $tag_color_value,
                    'term_image' => $tag_image_value
                ),
                array( 'term_id' => $term_id ),
                array( '%s', '%s' ),
                array( '%d' )
            );
        }
    }

    public function show_color( $term = null ) {

        $taxonomy = $this->_registry->get( 'model.taxonomy' );
        $color = '';
        if ( null !== $term ) {
            $color = $taxonomy->get_category_color( $term->term_id );
        }

        $style = '';
        $clr   = '';

        if ( $color ) {
            $style = 'style="background-color: ' . $color . '"';
            $clr   = $color;
        }

        $args = array(
            'style'       => $style,
            'color'       => $clr,
            'label'       => Ai1ec_I18n::__( 'Category Color' ),
            'description' => Ai1ec_I18n::__(
                'Events in this category will be identified by this color'
            ),
            'edit'        => true,
        );

        $loader = $this->_registry->get( 'theme.loader' );
        $loader->get_file(
            'setting/categories-color-picker.twig',
            $args,
            true
        )->render();
    }

    /**
     * Edit category form
     *
     * @param $term
     *
     * @return void
     */
    public function events_categories_edit_form_fields( $term ) {
        $this->show_color( $term );
        $taxonomy = $this->_registry->get( 'model.taxonomy' );
        $loader = $this->_registry->get( 'theme.loader' );
        $image    = $taxonomy->get_category_image( $term->term_id );

        $style = 'style="display:none"';

        if ( null !== $image ) {
            $style = '';
        }

        // Category image
        $args  = array(
            'image_src'    => $image,
            'image_style'  => $style,
            'section_name' => __( 'Category Image', AI1EC_PLUGIN_NAME ),
            'label'        => __( 'Add Image', AI1EC_PLUGIN_NAME ),
            'remove_label' => __( 'Remove Image', AI1EC_PLUGIN_NAME ),
            'description'  => __(
                'Assign an optional image to the category. Recommended size: square, minimum 400&times;400 pixels.',
                AI1EC_PLUGIN_NAME
            ),
            'edit'         => true,
        );

        $loader->get_file(
            'setting/categories-image.twig',
            $args,
            true
        )->render();
    }

    /**
     * Add category form
     *
     * @return void
     */
    public function events_categories_add_form_fields() {

        $this->show_color();

        $loader = $this->_registry->get( 'theme.loader' );

        // Category image
        $args  = array(
            'image_src'    => '',
            'image_style'  => 'style="display:none"',
            'section_name' => __( 'Category Image', AI1EC_PLUGIN_NAME ),
            'label'        => __( 'Add Image', AI1EC_PLUGIN_NAME),
            'description'  => __( 'Assign an optional image to the category. Recommended size: square, minimum 400&times;400 pixels.', AI1EC_PLUGIN_NAME ),
            'edit'         => false,
        );

        $file   = $loader->get_file(
            'setting/categories-image.twig',
            $args,
            true
        );

        $file->render();
    }

}


==================================================
FILE PATH: ./app/view/admin/calendar-feeds.php
==================================================
<?php

/**
 * The Calendar Feeds page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Calendar_Feeds extends Ai1ec_View_Admin_Abstract {

    /**
     * Adds page to the menu.
     *
     * @wp_hook admin_menu
     *
     * @return void
     */
    public function add_page() {
        // =======================
        // = Calendar Feeds Page =
        // =======================
        $calendar_feeds = add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            Ai1ec_I18n::__( 'Import Feeds' ),
            Ai1ec_I18n::__( 'Import Feeds' ),
            'manage_ai1ec_feeds',
            AI1EC_PLUGIN_NAME . '-feeds',
            array( $this, 'display_page' )
        );
        $this->_registry->get( 'model.settings' )
            ->set( 'feeds_page', $calendar_feeds );
    }

    /**
     * Adds metabox to the page.
     *
     * @wp_hook admin_init
     *
     * @return void
     */
    public function add_meta_box() {
        // Add the 'ICS Import Settings' meta box.
        add_meta_box(
            'ai1ec-feeds',
            Ai1ec_I18n::_x( 'Feed Subscriptions', 'meta box' ),
            array( $this, 'display_meta_box' ),
            $this->_registry->get( 'model.settings' )->get( 'feeds_page' ),
            'left',
            'default'
        );
    }

    /**
     * Display this plugin's feeds page in the admin.
     *
     * @return void
     */
    public function display_page() {
        $settings = $this->_registry->get( 'model.settings' );
        $loader   = $this->_registry->get( 'theme.loader' );
        $args     = array(
            'title'             => __(
                'All-in-One Event Calendar: Import Feeds',
                AI1EC_PLUGIN_NAME
            ),
            'settings_page'     => $settings->get( 'feeds_page' ),
            'calendar_settings' => false,
        );
        $file     = $loader->get_file( 'feeds_settings.php', $args, true );
        wp_enqueue_style(
            'ai1ec_samples.css',
            AI1EC_ADMIN_THEME_CSS_URL . 'samples.css',
            array(),
            AI1EC_VERSION
        );
        $file->render();
    }

    /**
     * Renders the contents of the Calendar Feeds meta box.
     *
     * @return void
     */
    public function display_meta_box( $object, $box ) {
        // register the calendar feeds page.
        $calendar_feeds = $this->_registry->get( 'controller.calendar-feeds' );
        $feeds          = array();

        array_push( $feeds, $this->_registry->get( 'calendar-feed.import' ) );
        // Check for user subscription - Discover events
        if ($this->_api_registration->has_subscription_active( 'discover-events' ) ) {
            array_push( $feeds, $this->_registry->get( 'calendar-feed.suggested' ) );
        }

        // Add ICS
        array_push( $feeds, $this->_registry->get( 'calendar-feed.ics' ) );

        $feeds          = apply_filters( 'ai1ec_calendar_feeds', $feeds );
        foreach ( $feeds as $feed ) {
            $calendar_feeds->add_plugin( $feed );
        }
        $calendar_feeds->handle_feeds_page_post();
        $loader = $this->_registry->get( 'theme.loader' );
        $file   = $loader->get_file(
            'box_feeds.php',
            array( 'calendar_feeds' => $calendar_feeds ),
            true
        );
        $file->render();
    }

    public function handle_post() {
    }

}

==================================================
FILE PATH: ./app/view/admin/theme-switching.php
==================================================
<?php

/**
 * The Theme selection page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Admin_Theme_Switching extends Ai1ec_View_Admin_Abstract {

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Abstract::display_page()
     */
    public function display_page() {
        global $ct;
        // defaults
        $activated = isset( $_GET['activated'] ) ? true : false;
        $deleted   = false;

        $_list_table = $this->_registry->get( 'theme.list' );
        $_list_table->prepare_items();

        $args = array(
            'activated'     => $activated,
            'deleted'       => $deleted,
            'ct'            => $ct,
            'wp_list_table' => $_list_table,
            'page_title'    => Ai1ec_I18n::__(
                'All-in-One Event Calendar: Themes'
            ),
        );

        add_thickbox();
        wp_enqueue_script( 'theme-preview' );
        $loader = $this->_registry->get( 'theme.loader' );

        $file   = $loader->get_file( 'themes.php', $args, true );
        return $file->render();
    }

    /* (non-PHPdoc)
     * @see Ai1ec_View_Admin_Abstract::add_page()
     */
    public function add_page() {
        global $submenu;
        // ===============
        // = Themes Page =
        // ===============
        $themes_page = add_submenu_page(
            AI1EC_ADMIN_BASE_URL,
            Ai1ec_I18n::__( 'Calendar Themes' ),
            Ai1ec_I18n::__( 'Calendar Themes' ),
            'switch_ai1ec_themes',
            AI1EC_PLUGIN_NAME . '-themes',
            array( $this, 'display_page' )
        );
    }

    public function add_meta_box() {
    }

    public function handle_post() {
    }

}


==================================================
FILE PATH: ./app/view/admin/samples.php
==================================================
<?php

/**
 * The Calendar Samples page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.1
 *
 * @package    AI1EC
 * @subpackage AI1EC.View
 */
class Ai1ec_View_Samples extends Ai1ec_View_Admin_Abstract {
	/**
	 * Adds page to the menu.
	 *
	 * @wp_hook admin_menu
	 *
	 * @return void
	 */
	public function add_page() {
		// =======================
		// = Calendar Add Ons Page =
		// =======================
	}
	/**
	 * Display Add Ons list page.
	 *
	 * @return void
	 */
	public function display_page() {
		wp_enqueue_style(
			'ai1ec_samples.css',
			AI1EC_ADMIN_THEME_CSS_URL . 'samples.css',
			array(),
			AI1EC_VERSION
		);

		$this->_registry->get( 'theme.loader' )->get_file(
			'samples.twig',
			array(),
			true
		)->render();
	}

	public function add_meta_box() {
	}

	public function display_meta_box( $object, $box ) {
	}

	public function handle_post() {
	}

}


==================================================
FILE PATH: ./app/view/event/content.php
==================================================
<?php

/**
 * This class process event content.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Content extends Ai1ec_Base {

    /**
     * Render event excerpt header.
     *
     * @param Ai1ec_Event $event Event to render excerpt for.
     *
     * @return void Content is not returned, just rendered.
     */
    public function excerpt_view( Ai1ec_Event $event ) {
        $location = $this->_registry->get( 'view.event.location' );
        $location = esc_html(
            str_replace(
                "\n",
                ', ',
                rtrim( $location->get_location( $event ) )
            )
        );
        $args = array(
            'event'      => $event,
            'location'   => $location,
            'text_when'  => __( 'When:', AI1EC_PLUGIN_NAME ),
            'text_where' => __( 'Where:', AI1EC_PLUGIN_NAME ),
        );
        $loader = $this->_registry->get( 'theme.loader' );
        echo $loader->get_file(
                'event-excerpt.twig',
                $args,
                true
        )->get_content();
    }

    /**
     * Format events excerpt view.
     *
     * @param string $text Content to excerpt.
     *
     * @return string Formatted event excerpt.
     */
    public function event_excerpt( $text ) {
        if ( ! $this->_registry->get( 'acl.aco' )->is_our_post_type() ) {
            return $text;
        }
        $event = $this->_registry->get( 'model.event', get_the_ID() );
        $post  = $this->_registry->get( 'view.event.post' );
        $ob    = $this->_registry->get( 'compatibility.ob' );
        $ob->start();
        $this->excerpt_view( $event );
        // Re-apply any filters to the post content that normally would have
        // been applied if it weren't for our interference (below).
        echo shortcode_unautop( wpautop( $post->trim_excerpt( $event ) ) );
        return $ob->get_clean();
    }

    /**
     * Avoid re-adding `wpautop` for Ai1EC instances.
     *
     * @param string $content Processed content.
     *
     * @return string Paragraphs enclosed text.
     */
    public function event_excerpt_noautop( $content ) {
        if ( ! $this->_registry->get( 'acl.aco' )->is_our_post_type() ) {
            return wpautop( $content );
        }
        return $content;
    }

    public function get_post_excerpt( Ai1ec_Event $event ) {
        $content = strip_tags(
            strip_shortcodes(
                preg_replace(
                    '#<\s*script[^>]*>.+<\s*/\s*script\s*>#x',
                    '',
                    apply_filters(
                        'ai1ec_the_content',
                        apply_filters(
                            'the_content',
                            $event->get( 'post' )->post_content
                        )
                    )
                )
            )
        );
        $content = preg_replace( '/\s+/', ' ', $content );
        $words   = explode( ' ', $content );
        if ( count( $words ) > 25 ) {
            return implode(
                ' ',
                array_slice( $words, 0, 25 )
            ) . ' [...]';
        }
        return $content;
    }

    /**
     * Generate the html for the "Calendar" button for this event.
     *
     * @return string
     */
    public function get_back_to_calendar_button_html() {
        $class     = '';
        $data_type = '';
        $href      = '';
        if ( isset( $_COOKIE['ai1ec_calendar_url'] ) ) {
            $href = json_decode(
                stripslashes( $_COOKIE['ai1ec_calendar_url'] )
            );
            setcookie( 'ai1ec_calendar_url', '', time() - 3600 );
        } else {
            $href = $this->_registry->get( 'html.element.href', array() );
            $href = $href->generate_href();
        }
        $text    = esc_attr( Ai1ec_I18n::__( 'Calendar' ) );
        $tooltip = esc_attr( Ai1ec_I18n::__( 'View all events' ) );
        $html    = <<<HTML
<a class="ai1ec-calendar-link ai1ec-btn ai1ec-btn-default ai1ec-btn-sm
        ai1ec-tooltip-trigger $class"
    href="$href"
    $data_type
    data-placement="left"
    title="$tooltip">
    <i class="ai1ec-fa ai1ec-fa-calendar ai1ec-fa-fw"></i>
    <span class="ai1ec-hidden-xs">$text</span>
</a>
HTML;
        return apply_filters( 'ai1ec_get_back_to_calendar_html', $html, $href );
    }

    /**
     * Simple regex-parse of post_content for matches of <img src="foo" />; if
     * one is found, return its URL.
     *
     * @param   null       $size           (width, height) array of returned image
     *
     * @return  string|null
     */
    public function get_content_img_url( Ai1ec_Event $event, &$size = null ) {
        preg_match(
            '/<img([^>]+)src=["\']?([^"\'\ >]+)([^>]*)>/i',
            $event->get( 'post' )->post_content,
            $matches
        );

        // Check if we have a result, otherwise a notice is issued.
        if ( empty( $matches ) ) {
            return null;
        }

        // Mark found image.
        $event->get( 'post' )->post_content = str_replace(
            '<img' . $matches[1],
            '<img' . $matches[1] . ' data-ai1ec-hidden ',
            $event->get( 'post' )->post_content
        );

        $url = $matches[2];
        $size = array( 0, 0 );

        // Try to detect width and height.
        $attrs = $matches[1] . $matches[3];
        $matches = null;
        preg_match_all(
            '/(width|height)=["\']?(\d+)/i',
            $attrs,
            $matches,
            PREG_SET_ORDER
        );
        // Check if we have a result, otherwise a notice is issued.
        if ( ! empty( $matches ) ) {
            foreach ( $matches as $match ) {
                $size[ $match[1] === 'width' ? 0 : 1 ] = $match[2];
            }
        }

        return $url;
    }

}


==================================================
FILE PATH: ./app/view/event/single.php
==================================================
<?php

/**
 * This class renders the html for the single event page.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Single extends Ai1ec_Base {

    /**
     * Renders the html of the page and returns it.
     *
     * @param Ai1ec_Event $event
     *
     * @return string the html of the page
     */
    public function get_content( Ai1ec_Event $event ) {
        $settings = $this->_registry->get( 'model.settings' );
        $rrule    = $this->_registry->get( 'recurrence.rule' );
        $taxonomy = $this->_registry->get( 'view.event.taxonomy' );
        $location = $this->_registry->get( 'view.event.location' );
        $ticket   = $this->_registry->get( 'view.event.ticket' );
        $content  = $this->_registry->get( 'view.event.content' );
        $time     = $this->_registry->get( 'view.event.time' );

        $subscribe_url = AI1EC_EXPORT_URL . '&ai1ec_post_ids=' .
            $event->get( 'post_id' );

        $event->set_runtime(
            'tickets_url_label',
            $ticket->get_tickets_url_label( $event, false )
        );
        $event->set_runtime(
            'content_img_url',
            $content->get_content_img_url( $event )
        );

        $extra_buttons = apply_filters(
            'ai1ec_rendering_single_event_actions',
            '',
            $event
        );

        $venues_html = apply_filters(
            'ai1ec_rendering_single_event_venues',
            nl2br( $location->get_location( $event ) ),
            $event
        );
        $default_tz = $this->_registry->get( 'date.timezone' )->get_default_timezone();
        $timezone_info = array(
            'show_timezone'       => $this->_registry->get( 'model.settings' )->get( 'always_use_calendar_timezone' ),
            'using_calendar_tz'   => $this->_registry->get( 'model.settings' )->get( 'always_use_calendar_timezone' ),
            'event_timezone'      => str_replace( '_', ' ', $event->get( 'timezone_name' ) ) . ' ' . __( 'Timezone', AI1EC_PLUGIN_NAME ),
            'calendar_timezone'   => str_replace( '_', ' ', $default_tz ) . ' ' . __( 'Timezone', AI1EC_PLUGIN_NAME ),
        );

        $banner_image_meta = get_post_meta( $event->get( 'post_id' ), 'ai1ec_banner_image' );
        $banner_image = $banner_image_meta ? $banner_image_meta[0] : '';

        // objects are passed by reference so an action is ok
        do_action( 'ai1ec_single_event_page_before_render', $event );

        $filter_groups_html = apply_filters( 'ai1ec_get_filter_groups_html', $event );

        $args = array(
            'event'                   => $event,
            'recurrence'              => $rrule->rrule_to_text( $event->get( 'recurrence_rules' ) ),
            'exclude'                 => $time->get_exclude_html( $event, $rrule ),
            'categories'              => $taxonomy->get_categories_html( $event ),
            'tags'                    => $taxonomy->get_tags_html( $event ),
            'location'                => html_entity_decode( $venues_html ),
            'filter_groups'           => $filter_groups_html,
            'map'                     => $location->get_map_view( $event ),
            'contact'                 => $ticket->get_contact_html( $event ),
            'back_to_calendar'        => $content->get_back_to_calendar_button_html(),
            'subscribe_url'           => $subscribe_url,
            'subscribe_url_no_html'   => $subscribe_url . '&no_html=true',
            'edit_instance_url'       => null,
            'edit_instance_text'      => null,
            'google_url'              => 'https://www.google.com/calendar/render?cid=' . urlencode( $subscribe_url ),
            'show_subscribe_buttons'  => ! $settings->get( 'turn_off_subscription_buttons' ),
            'hide_featured_image'     => $settings->get( 'hide_featured_image' ),
            'extra_buttons'           => $extra_buttons,
            'show_get_calendar'       => ! $settings->get( 'disable_get_calendar_button' ),
            'text_add_calendar'       => __( 'Add to Calendar', AI1EC_PLUGIN_NAME ),
            'subscribe_buttons_text'  => $this->_registry
                ->get( 'view.calendar.subscribe-button' )
                ->get_labels(),
            'text_get_calendar'       => Ai1ec_I18n::__( 'Get a Timely Calendar' ),
            'text_when'               => __( 'When:', AI1EC_PLUGIN_NAME ),
            'text_where'              => __( 'Where:', AI1EC_PLUGIN_NAME ),
            'text_cost'               => __( 'Cost:', AI1EC_PLUGIN_NAME ),
            'text_contact'            => __( 'Contact:', AI1EC_PLUGIN_NAME ),
            'text_tickets'            => __( 'Tickets:', AI1EC_PLUGIN_NAME ),
            'text_free'               => __( 'Free', AI1EC_PLUGIN_NAME ),
            'text_categories'         => __( 'Categories', AI1EC_PLUGIN_NAME ),
            'text_tags'               => __( 'Tags', AI1EC_PLUGIN_NAME ),
            'buy_tickets_text'        => __( 'Buy Tickets', AI1EC_PLUGIN_NAME ),
            'timezone_info'           => $timezone_info,
            'banner_image'            => $banner_image,
            'content_img_url'         => $event->get_runtime( 'content_img_url' ),
            'post_id'                 => $event->get( 'post_id' ),
            'ticket_url'              => $event->get( 'ticket_url' ),
            'tickets_url_label'       => $event->get_runtime( 'tickets_url_label' ),
            'start'                   => $event->get( 'start' ),
            'end'                     => $event->get( 'end' ),
            'cost'                    => $event->get( 'cost' ),
            'instance_id'             => $event->get( 'instance_id' ),
            'title'                   => $event->get( 'post' )->post_title,
            'description'             => $event->get( 'post' )->post_content,
        );

        if (
            ! empty( $args['recurrence'] ) &&
            $event->get( 'instance_id' ) &&
            current_user_can( 'edit_ai1ec_events' )
        ) {
            $args['edit_instance_url']  = ai1ec_admin_url(
                'post.php?post=' . $event->get( 'post_id' ) .
                '&action=edit&instance=' . $event->get( 'instance_id' )
            );
            $args['edit_instance_text'] = sprintf(
                Ai1ec_I18n::__( 'Edit this occurrence (%s)' ),
                $event->get( 'start' )->format_i18n( 'M j' )
            );
        }
        $loader = $this->_registry->get( 'theme.loader' );
        $api    = $this->_registry->get( 'model.api.api-ticketing' );
        if ( false === ai1ec_is_blank( $event->get( 'ical_feed_url' ) ) ) {
            $ticket_url             = $api->get_api_event_buy_ticket_url( $event->get( 'post_id' ) );
            if ( ! empty ( $ticket_url ) ) {
                $args['ticket_url'] = $ticket_url;
            }
        } else {
            $api_event_id = $api->get_api_event_id( $event->get( 'post_id' ) );
            if ( $api_event_id ) {
                $api                   = $this->_registry->get( 'model.api.api-ticketing' );
                $ticket_types          = json_decode( $api->get_ticket_types( $event->get( 'post_id' ), false ) );
                $args['has_tickets']   = true;
                $args['API_URL']       = AI1EC_API_URL;
                $args['tickets_block'] = $loader->get_file(
                    'tickets.twig',
                    array(
                        'tickets_checkout_url' => $api->get_api_event_buy_ticket_url( $event->get( 'post_id' ) ),
                        'tickets'              => $ticket_types->data,
                        'text_tickets'         => $args['text_tickets'],
                        'buy_tickets_text'     => $args['buy_tickets_text'],
                        'api_event_id'         => $api_event_id
                    ), false
                )->get_content();
            }
        }

        return $loader->get_file( 'event-single.twig', $args, false )
            ->get_content();
    }

    /**
     * Add meta OG tags to the event details page
     */
    public function add_meta_tags() {
        // Add tags only on Event Details page
        $aco = $this->_registry->get( 'acl.aco' );
        if ( ! $aco->is_our_post_type() ) return;

        // Get Event and process description
        $instance_id     = ( isset( $_GET[ 'instance_id' ] ) ) ? $_GET[ 'instance_id' ] : null;

        if ( !is_null( $instance_id ) ) {
            $instance_id = preg_replace( '/\D/', '', $instance_id );
        }
        $event           = $this->_registry->get( 'model.event', get_the_ID(), $instance_id );
        $avatar          = $this->_registry->get( 'view.event.avatar' );
        $content         = $this->_registry->get( 'view.event.content' );
        $desc            = $event->get( 'post' )->post_content;
        $desc            = apply_filters( 'the_excerpt', $desc );
        $desc            = strip_shortcodes( $desc );
        $desc            = str_replace( ']]>', ']]&gt;', $desc );
        $desc            = strip_tags( $desc );
        $desc            = preg_replace( '/\n+/', ' ', $desc);
        $desc            = substr( $desc, 0, 300 );
        // Get featured image
        $image           = $avatar->get_post_thumbnail_url( $event );
        if ( ! $image ) {
            $image       = $content->get_content_img_url( $event );
        }

        $og              = array(
            'url'         => home_url( esc_url( add_query_arg( null, null ) ) ),
            'title'       => htmlspecialchars(
                $event->get( 'post' )->post_title .
                ' (' . substr( $event->get( 'start' ) , 0, 10 ) . ')'
            ),
            'type'        => 'article',
            'description' => htmlspecialchars( $desc ),
            'image'       => $image,
        );
        foreach ( $og as $key => $val ) {
            echo "<meta property=\"og:$key\" content=\"$val\" />\n";
        }
        // Twitter meta tags
        $twitter         = array(
            'card'        => 'summary',
            'title'       => htmlspecialchars(
                $event->get( 'post' )->post_title .
                ' (' . substr( $event->get( 'start' ) , 0, 10 ) . ')'
                ),
            'description' => htmlspecialchars( $desc ),
            'image'       => $image,
        );
        foreach ( $twitter as $key => $val ) {
            if ( empty( $val ) && 'image' !== $key ) {
                $val = Ai1ec_I18n::__( 'No data' );
            }
            echo "<meta name=\"twitter:$key\" content=\"$val\" />\n";
        }
    }

    /**
     * @param Ai1ec_Event $event
     *
     * @return The html of the footer
     */
    public function get_footer( Ai1ec_Event $event ) {

        $text_calendar_feed = null;

        $feed_url = trim( strtolower( $event->get( 'ical_feed_url' ) ) );

        if ( strpos( $feed_url, 'http' ) === 0 ) {
            $text_calendar_feed = Ai1ec_I18n::__(
                'This post was replicated from another site\'s <a href="%s" title="iCalendar feed"><i class="ai1ec-fa ai1ec-fa-calendar"></i> calendar feed</a>.'
            );
        } else {
            $text_calendar_feed = Ai1ec_I18n::__(
                'This post was imported from a CSV/ICS file.'
            );
        }

        $loader = $this->_registry->get( 'theme.loader' );
        $text_calendar_feed = sprintf(
            $text_calendar_feed,
            esc_attr( str_replace( 'http://', 'webcal://', $event->get( 'ical_feed_url' ) ) )
        );
        $args   = array(
            'event'              => $event,
            'text_calendar_feed' => $text_calendar_feed,
            'text_view_post'     => Ai1ec_I18n::__( 'View original' ),
        );
        return $loader->get_file( 'event-single-footer.twig', $args, false )
            ->get_content();
    }

    /**
     * Render the full article for the event title, content, and footer.
     *
     * @param Ai1ec_Event $event
     * @param string      $footer Footer HTML to append to event
     */
    public function get_full_article( Ai1ec_Event $event, $footer = '' ) {
        $title         = apply_filters(
            'the_title',
            $event->get( 'post' )->post_title,
            $event->get( 'post_id' )
        );
        $event_details = $this->get_content( $event );
        $content       = wpautop(
            apply_filters(
                'ai1ec_the_content',
                apply_filters(
                    'the_content',
                    $event->get( 'post' )->post_content
                )
            )
        );
        $args = compact( 'title', 'event_details', 'content', 'footer' );
        $loader = $this->_registry->get( 'theme.loader' );
        return $loader->get_file( 'event-single-full.twig', $args, false )
            ->get_content();
    }
}


==================================================
FILE PATH: ./app/view/event/color.php
==================================================
<?php

/**
 * This class renders the html for the event colors.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Color extends Ai1ec_Base {

    /**
     * Faded version of event category color
     */
    protected function _get_color( Ai1ec_Event $event, $type ) {
            static $categories_cache = array(
                'rgba'  => array(),
                'faded' => array(),
            );
            $methods = array(
                'rgba'  => 'get_event_category_rgba_color',
                'faded' => 'get_event_category_faded_color',
            );
            $categories = $this->_registry->get( 'model.taxonomy' )
                ->get_post_categories( $event->get( 'post_id' ) );
            if ( ! empty( $categories ) ) {
                if (
                    ! isset( $categories_cache[$type][$categories[0]->term_id] )
                ) {
                    $method = $methods[$type];
                    $categories_cache[$type][$categories[0]->term_id] = $this
                        ->$method( $categories[0]->term_id );
                }
                return $categories_cache[$type][$categories[0]->term_id];
            }
            return '';
    }
    public function get_faded_color( Ai1ec_Event $event ) {
        return $this->_get_color( $event, 'faded' );
    }

    /**
     * rgba() format of faded category color.
     *
     * @return  string
     */
    public function get_rgba_color( Ai1ec_Event $event ) {
        return $this->_get_color( $event, 'rgba' );
    }
    /**
     * Returns a faded version of the event's category color in hex format.
     *
     * @param int $term_id The Event Category's term ID
     *
     * @return string
     */
    public function get_event_category_faded_color( $term_id ) {
        $taxonomy = $this->_registry->get( 'model.taxonomy' );
        $color = $taxonomy->get_category_color( $term_id );
        if( ! is_null( $color ) && ! empty( $color ) ) {

            $color1 = substr( $color, 1 );
            $color2 = 'ffffff';

            $c1_p1 = hexdec( substr( $color1, 0, 2 ) );
            $c1_p2 = hexdec( substr( $color1, 2, 2 ) );
            $c1_p3 = hexdec( substr( $color1, 4, 2 ) );

            $c2_p1 = hexdec( substr( $color2, 0, 2 ) );
            $c2_p2 = hexdec( substr( $color2, 2, 2 ) );
            $c2_p3 = hexdec( substr( $color2, 4, 2 ) );

            $m_p1 = dechex( round( $c1_p1 * 0.5 + $c2_p1 * 0.5 ) );
            $m_p2 = dechex( round( $c1_p2 * 0.5 + $c2_p2 * 0.5 ) );
            $m_p3 = dechex( round( $c1_p3 * 0.5 + $c2_p3 * 0.5 ) );

            return '#' . $m_p1 . $m_p2 . $m_p3;
        }

        return '';
    }

    /**
     * Returns the rgba() format of the event's category color, with '%s' in place
     * of the opacity (to be substituted by sprintf).
     *
     * @param int $term_id The Event Category's term ID
     *
     * @return string
     */
    public function get_event_category_rgba_color( $term_id ) {
        $taxonomy = $this->_registry->get( 'model.taxonomy' );
        $color = $taxonomy->get_category_color( $term_id );
        if ( ! is_null( $color ) && ! empty( $color ) ) {
            $p1 = hexdec( substr( $color, 1, 2 ) );
            $p2 = hexdec( substr( $color, 3, 2 ) );
            $p3 = hexdec( substr( $color, 5, 2 ) );
            return "rgba($p1, $p2, $p3, %s)";
        }

        return '';
    }
}


==================================================
FILE PATH: ./app/view/event/avatar.php
==================================================
<?php

/**
 * This class renders the html for the event avatar.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Avatar extends Ai1ec_Base {

    /**
     * Get HTML markup for the post's "avatar" image according conditional
     * fallback model.
     *
     * Accepts an ordered array of named avatar $fallbacks. Also accepts a string
     * of space-separated classes to add to the default classes.
     * @param   Ai1ec_Event $event          The event to get the avatar for
     * @param   array|null  $fallback_order Order of fallback in searching for
     *                                      images, or null to use default
     * @param   string      $classes        A space-separated list of CSS classes
     *                                      to apply to the outer <div> element.
     * @param   boolean     $wrap_permalink Whether to wrap the element in a link
     *                                      to the event details page.
     *
     * @return  string                   String of HTML if image is found
     */
    public function get_event_avatar(
        Ai1ec_Event $event,
        $fallback_order = null,
        $classes        = '',
        $wrap_permalink = true
    ) {
        $source = $size = null;
        $url    = $this->get_event_avatar_url(
            $event,
            $fallback_order,
            $source,
            $size
        );

        if ( empty( $url ) ) {
            return '';
        }

        $url     = esc_attr( $url );
        $classes = esc_attr( $classes );

        // Set the alt tag (helpful for SEO).
        $alt      = $event->get( 'post' )->post_title;
        $location = $this->_registry->get( 'view.event.location' )->get_short_location( $event );
        if ( ! empty( $location ) ) {
            $alt .= ' @ ' . $location;
        }

        $alt       = esc_attr( $alt );
        $size_attr = $size[0] ? "width=\"$size[0]\" height=\"$size[1]\"" : "";
        $html      = '<img src="' . $url . '" alt="' . $alt . '" ' .
            $size_attr . ' />';

        if ( $wrap_permalink ) {
            $permalink = add_query_arg(
                'instance_id',
                $event->get( 'instance_id' ),
                get_permalink( $event->get( 'post_id' ) )
            );
            $html = '<a href="' . $permalink . '">' . $html . '</a>';
        }

        $classes .= ' ai1ec-' . $source;
        $classes .= ( $size[0] > $size[1] )
            ? ' ai1ec-landscape'
            : ' ai1ec-portrait';
        $html     = '<div class="ai1ec-event-avatar timely ' . $classes . '">' .
            $html . '</div>';

        return $html;
    }

    /**
     * Get the post's "avatar" image url according conditional fallback model.
     *
     * Accepts an ordered array of named methods for $fallback order. Returns
     * image URL or null if no image found. Also returns matching fallback in the
     * $source reference.
     *
     * @param   array|null $fallback_order Order of fallbacks in search for images
     * @param   null       $source         Fallback that returned matching image,
     *                                     returned format is string
     * @param   null       $size           (width, height) array of returned image
     *
     * @return  string|null
     */
    public function get_event_avatar_url(
        Ai1ec_Event $event,
        $fallback_order = null,
        &$source        = null,
        &$size          = null
    ) {
        if ( empty( $fallback_order ) ) {
            $fallback_order = array(
                'post_thumbnail',
                'content_img',
                'category_avatar',
                'default_avatar',
            );
        }

        $valid_fallbacks = $this->_get_valid_fallbacks();

        foreach ( $fallback_order as $fallback ) {
            if ( ! isset( $valid_fallbacks[$fallback] ) ) {
                continue;
            }

            $function = $valid_fallbacks[$fallback];
            $url      = null;
            if (
                ! is_array( $function ) &&
                method_exists( $this, $function )
            ) {
                $url = $this->$function( $event, $size );
            } else if ( is_callable( $function ) ) {
                $url = call_user_func_array( $function, array( $event, &$size ) );
            }
            if ( null !== $url ) {
                $source = $fallback;
                break;
            }
        }

        if ( empty( $url ) ) {
            return null;
        }
        return $url;
    }

    /**
     * Read post meta for post-thumbnail and return its URL as a string.
     *
     * @param Ai1ec_Event $event Event object.
     * @param null        $size  (width, height) array of returned image.
     *
     * @return  string|null
     */
    public function get_post_thumbnail_url( Ai1ec_Event $event, &$size = null ) {
        return $this->_get_post_attachment_url(
            $event,
            array(
                'medium',
                'large',
                'full',
            ),
            $size
        );
    }

    /**
     * Read post meta for post-image and return its URL as a string.
     *
     * @param Ai1ec_Event $event Event object.
     * @param null        $size  (width, height) array of returned image.
     *
     * @return  string|null
     */
    public function get_post_image_url( Ai1ec_Event $event, &$size = null ) {
        return $this->_get_post_attachment_url(
            $event,
            array(
                'full',
                'large',
                'medium'
            ),
            $size
        );
    }

    /**
     * Read post meta for featured image and return its URL as a string.
     *
     * @param Ai1ec_Event $event Event object.
     * @param null        $size  (width, height) array of returned image.
     *
     * @return  string|null
     */
    public function get_featured_image_url( Ai1ec_Event $event, &$size = null ) {
         $featured_image = get_post_meta(  $event->get( 'post_id' ) , '_featured_image', true );
         if ( empty( $featured_image ) ) {
            return $this->_get_post_attachment_url(
                $event,
                array(
                    'full',
                    'large',
                    'medium'
                ),
                $size
            );
        } else {
            $priority_order = array( 'large', 'full', 'medium', 'thumbnail' );
            $url            = null;
            foreach ( $priority_order as $priority ) {
                foreach ( $featured_image as $values_arr ) {
                    if ( $values_arr[0] === $priority ) {
                        $url  = $values_arr[1];
                        $size = array( $values_arr[2], $values_arr[3] );
                        break;
                    }
                }
                if ( null !== $url ) {
                    break;
                }
            }
            return $url;
        }
    }

    /**
     * Remove the avatar url from the event content
     */
    public function remove_avatar_url( $content ) {
        return preg_replace( '/<div[^<>]+class=[\'"]?ai1ec-event-avatar[^<>]*[\'"]?[^<>]+>.+<\/div>[.\s]*/'
                , ''
                , $content );
    }

    /**
     * Simple regex-parse of post_content for matches of <img src="foo" />; if
     * one is found, return its URL.
     *
     * @param   Ai1ec_Event $event
     * @param   null        $size           (width, height) array of returned image
     *
     * @return  string|null
     */
    public function get_content_img_url( Ai1ec_Event $event, &$size = null ) {
        $matches = $this->get_image_from_content(
            $event->get( 'post' )->post_content
        );
        // Check if we have a result, otherwise a notice is issued.
        if ( empty( $matches ) ) {
            return null;
        }

        $url = $matches[2];
        $size = array( 0, 0 );

        // Try to detect width and height.
        $attrs = $matches[1] . $matches[3];
        $matches = null;
        preg_match_all(
            '/(width|height)=["\']?(\d+)/i',
            $attrs,
            $matches,
            PREG_SET_ORDER
        );
        // Check if we have a result, otherwise a notice is issued.
        if ( ! empty( $matches ) ) {
            foreach ( $matches as $match ) {
                $size[ $match[1] === 'width' ? 0 : 1 ] = $match[2];
            }
        }
        return $url;
    }

    /**
     * Get an image tag from an html string
     *
     * @param string $content
     *
     * @return array
     */
    public function get_image_from_content( $content ) {
        preg_match(
            '/<img([^>]+)src=["\']?([^"\'\ >]+)([^>]*)>/i',
            $content,
            $matches
        );
        return $matches;
    }
    /**
     * Returns default avatar image (normally when no other ones are available).
     *
     * @param   null       $size           (width, height) array of returned image
     *
     * @return  string|null
     */
    public function get_default_avatar_url( &$size = null ) {
        $loader = $this->_registry->get( 'theme.loader' );
        $file = $loader->get_file( 'default-event-avatar.png', array(), false );
        $size = array( 256, 256 );
        return $file->get_url();
    }

    /**
     * Returns avatar image for event's deepest category, if any.
     *
     * @param Ai1ec_Event $event Avatar requester.
     * @param void        $size  Unused argument.
     *
     * @return string|null Avatar's HTML or null if none.
     */
    public function get_category_avatar_url( Ai1ec_Event $event, &$size = null ) {
        $db =  $this->_registry->get( 'dbi.dbi' );

        $terms = $this->_registry->get( 'model.taxonomy' )->get_post_categories(
            $event->get( 'post_id' )
        );
        if ( empty( $terms ) ) {
            return null;
        }

        $terms_by_id = array();
        // Key $terms by term_id rather than arbitrary int.
        foreach ( $terms as $term ) {
            $terms_by_id[$term->term_id] = $term;
        }

        // Array to store term depths, sorted later.
        $term_depths = array();
        foreach ( $terms_by_id as $term ) {
            $depth = 0;
            $ancestor = $term;
            while ( ! empty( $ancestor->parent ) ) {
                $depth++;
                if ( ! isset( $terms_by_id[$ancestor->parent] ) ) {
                    break;
                }
                $ancestor = $terms_by_id[$ancestor->parent];
            }
            // Store negative depths for asort() to order from deepest to shallowest.
            $term_depths[$term->term_id] = -$depth;
        }
        // Order term IDs by depth.
        asort( $term_depths );

        $url = '';
        $model = $this->_registry->get( 'model.taxonomy' );
        // Starting at deepest depth, find the first category that has an avatar.
        foreach ( $term_depths as $term_id => $depth ) {
            $term_image = $model->get_category_image( $term_id );
            if ( $term_image ) {
                $url = $term_image;
                break;
            }
        }
        return empty( $url ) ? null : $url;
    }

    /**
     * Read post meta for post-attachment and return its URL as a string.
     *
     * @param Ai1ec_Event $event             Event object.
     * @param array       $ordered_img_sizes Image sizes order.
     * @param null        $size              (width, height) array of returned
     *                                       image.
     *
     * @return  string|null
     */
    protected function _get_post_attachment_url(
        Ai1ec_Event $event,
        array $ordered_img_sizes,
        &$size = null
    ) {
        // Since WP does will return null if the wrong size is targeted,
        // we iterate over an array of sizes, breaking if a URL is found.
        foreach ( $ordered_img_sizes as $size ) {
            $attributes = wp_get_attachment_image_src(
                get_post_thumbnail_id( $event->get( 'post_id' ) ), $size
            );
            if ( $attributes ) {
                $url = array_shift( $attributes );
                $size = $attributes;
                break;
            }
        }

        return empty( $url ) ? null : $url;
    }

    /**
     * Returns list of valid fallbacks.
     *
     * @return array List of valid fallbacks.
     */
    protected function _get_valid_fallbacks() {
        static $fallbacks;
        if ( null === $fallbacks ) {
            $fallbacks = apply_filters(
                'ai1ec_avatar_valid_callbacks',
                array(
                    'post_image'      => 'get_post_image_url',
                    'post_thumbnail'  => 'get_post_thumbnail_url',
                    'content_img'     => 'get_content_img_url',
                    'category_avatar' => 'get_category_avatar_url',
                    'default_avatar'  => 'get_default_avatar_url',
                    'featured_image'  => 'get_featured_image_url'
                )
            );
        }
        return $fallbacks;
    }

}


==================================================
FILE PATH: ./app/view/event/post.php
==================================================
<?php

/**
 * This class renders the html for the event colors.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Post extends Ai1ec_Base {

    /**
     * Add event-specific messages to be used when one is modified in dashboard.
     *
     * @wp_hook post_updated_messages
     *
     * @param  array $messages List of messages.
     *
     * @return array Modified list of messages.
     */
    public function post_updated_messages( $messages ) {
        global $post, $post_ID;

        $messages[AI1EC_POST_TYPE] = array(
            0 => '', // Unused. Messages start at index 1.
            1 => sprintf(
                Ai1ec_I18n::__( 'Event updated. <a href="%s">View event</a>' ),
                esc_url( get_permalink( $post_ID ) )
            ),
            2 => Ai1ec_I18n::__( 'Custom field updated.' ),
            3 => Ai1ec_I18n::__( 'Custom field deleted.' ),
            4 => Ai1ec_I18n::__( 'Event updated.' ),
            /* translators: %s: date and time of the revision */
            5 => isset( $_GET['revision'] )
                ? sprintf(
                    Ai1ec_I18n::__( 'Event restored to revision from %s' ),
                    wp_post_revision_title( (int) $_GET['revision'], false )
                )
                : false,
            6 => sprintf(
                Ai1ec_I18n::__( 'Event published. <a href="%s">View event</a>' ),
                esc_url( get_permalink($post_ID) )
            ),
            7 => Ai1ec_I18n::__( 'Event saved.' ),
            8 => sprintf(
                Ai1ec_I18n::__( 'Event submitted. <a target="_blank" href="%s">Preview event</a>' ),
                esc_url( add_query_arg( 'preview', 'true', get_permalink( $post_ID ) ) )
            ),
            9 => sprintf(
                Ai1ec_I18n::__( 'Event scheduled for: <strong>%1$s</strong>. <a target="_blank" href="%2$s">Preview event</a>' ),
                // translators: Publish box date format, see http://php.net/date
                $this->_registry->get( 'date.time', $post->post_date )->format_i18n( Ai1ec_I18n::__( 'M j, Y @ G:i' ) ),
                esc_url( get_permalink($post_ID) )
            ),
            10 => sprintf(
                Ai1ec_I18n::__( 'Event draft updated. <a target="_blank" href="%s">Preview event</a>' ),
                esc_url( add_query_arg( 'preview', 'true', get_permalink( $post_ID ) ) )
            ),
        );

        return $messages;
    }

    /**
     * Generates an excerpt from the given content string.
     *
     * Adapted from WordPress's `wp_trim_excerpt' function that is not useful
     * for applying to custom content.
     *
     * @param string $text The content to trim.
     *
     * @return string The excerpt.
     */
    public function trim_excerpt( Ai1ec_Event $event, $length = 35, $more = '[...]' ) {
        global $post;
        $original_post = $post;
        $post          = $event->get( 'post' );
        $raw_excerpt    = $event->get( 'post' )->post_content;
        if ( ! isset( $raw_excerpt[0] ) ) {
            $raw_excerpt = '&nbsp;';
        }

        $text           = preg_replace(
            '#<\s*script[^>]*>.+<\s*/\s*script\s*>#x',
            '',
            apply_filters(
                'the_excerpt',
                $raw_excerpt
            )
        );
        $text           = strip_shortcodes( $text );
        $text           = str_replace( ']]>', ']]&gt;', $text );
        $text           = strip_tags( $text );

        $excerpt_length = apply_filters( 'excerpt_length', $length );
        $excerpt_more   = apply_filters( 'excerpt_more', $more );
        $words          = preg_split(
            '/\s+/',
            $text,
            $excerpt_length + 1,
            PREG_SPLIT_NO_EMPTY
        );
        if ( count( $words ) > $excerpt_length ) {
            array_pop( $words );
            $text = implode( ' ', $words );
            $text = $text . $excerpt_more;
        } else {
            $text = implode( ' ', $words );
        }
        $post = $original_post;
        return apply_filters( 'wp_trim_excerpt', $text, $raw_excerpt );
    }

}

==================================================
FILE PATH: ./app/view/event/taxonomy.php
==================================================
<?php

/**
 * This class renders the html for the event taxonomy.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Taxonomy extends Ai1ec_Base {

    /**
     * @var Ai1ec_Taxonomy Taxonomy abstraction layer.
     */
    protected $_taxonomy_model = null;

    /**
     * @var array Caches the color evaluated for each event.
     */
    protected $_event_color_map = array();

    /**
     * @var array Caches the color squares HTML evaluated for each event.
     */
    protected $_event_color_squares_map = array();

    /**
     * Returns style attribute for events rendered in Month, Week, or Day view.
     *
     * @param  Ai1ec_Event $event Event object.
     *
     * @return string             Color style attribute.
     */
    public function get_color_style( Ai1ec_Event $event ) {
        $color = $this->get_color_for_event( $event );

        // Convert to style attribute.
        if ( $color ) {
            $color = $event->is_allday() || $event->is_multiday()
                ? 'background-color: ' . $color . ';'
                : 'color: ' . $color . ' !important;';
        } else {
            $color = '';
        }

        return $color;
    }

    /**
     * Returns HTML of category color swatches for this event.
     *
     * @param  Ai1ec_Event $event Event object.
     *
     * @return string             HTML of the event's category color swatches.
     */
    public function get_category_colors( Ai1ec_Event $event ) {
        $post_id = $event->get( 'post_id' );

        if ( ! isset( $this->_event_color_squares_map[$post_id] ) ) {
            $squares = '';
            $categories = $this->_taxonomy_model->get_post_categories( $post_id );

            if ( false !== $categories ) {
                $squares = $this->get_event_category_colors( $categories );
            }

            // Allow add-ons to modify/add to category color swatch HTML.
            $squares = apply_filters(
                'ai1ec_event_color_squares',
                $squares,
                $event
            );

            $this->_event_color_squares_map[$post_id] = $squares;
        }

        return $this->_event_color_squares_map[$post_id];
    }

    /**
     * Returns the HTML markup for the category color square.
     *
     * @param int $term_id The term ID of event category
     *
     * @return string
     */
    public function get_category_color_square( $term_id ) {
        $color = $this->_taxonomy_model->get_category_color( $term_id );
        $event_taxonomy = $this->_registry->get( 'model.event.taxonomy' );
        if ( null !== $color ) {
            $taxonomy = $event_taxonomy->get_taxonomy_for_term_id( $term_id );
            $cat = get_term( $term_id, $taxonomy->taxonomy );
            return '<span class="ai1ec-color-swatch ai1ec-tooltip-trigger" ' .
                'style="background:' . $color . '" title="' .
                esc_attr( $cat->name ) . '"></span>';
        }
        return '';
    }

    /**
     * Returns the HTML markup for the category image square.
     *
     * @param int $term_id The term ID of event category.
     *
     * @return string HTML snippet to use for category image.
     */
    public function get_category_image_square( $term_id ) {
        $image = $this->_taxonomy_model->get_category_image( $term_id );
        if ( null !== $image ) {
            return '<img src="' . $image . '" alt="' .
                Ai1ec_I18n::__( 'Category image' ) .
                '" class="ai1ec_category_small_image_preview" />';
        }
        return '';
    }

    /**
     * Returns category color squares for the list of Event Category objects.
     *
     * @param array $cats The Event Category objects as returned by get_terms()
     *
     * @return string
     */
    public function get_event_category_colors( array $cats ) {
        $sqrs = '';
        foreach ( $cats as $cat ) {
            $tmp = $this->get_category_color_square( $cat->term_id );
            if ( ! empty( $tmp ) ) {
                $sqrs .= $tmp;
            }
        }
        return $sqrs;
    }

    /**
     * Style attribute for event background color.
     *
     * @param  Ai1ec_Event $event Event object.
     *
     * @return string             Color to assign to event background.
     */
    public function get_category_bg_color( Ai1ec_Event $event ) {
        $color = $this->get_color_for_event( $event );

        // Convert to HTML attribute.
        if ( $color ) {
            $color = 'style="background-color: ' . $color . ';"';
        } else {
            $color = '';
        }

        return $color;
    }

    /**
     * Style attribute for event multi-date divider color.
     *
     * @param  Ai1ec_Event $event Event object.
     *
     * @return string Color to assign to event background.
     */
    public function get_category_divider_color( Ai1ec_Event $event ) {
        $color = $this->get_color_for_event( $event );

        // Convert to HTML attribute.
        if ( $color ) {
            $color = 'style="border-color: ' . $color . ' transparent transparent transparent;"';
        } else {
            $color = '';
        }

        return $color;
    }

    /**
     * Style attribute for event text color.
     *
     * @param  Ai1ec_Event $event Event object.
     *
     * @return string Color to assign to event text (foreground).
     */
    public function get_category_text_color( Ai1ec_Event $event ) {
        $color = $this->get_color_for_event( $event );

        // Convert to HTML attribute.
        if ( $color ) {
            $color = 'style="color: ' . $color . ';"';
        } else {
            $color = '';
        }

        return $color;
    }

    /**
     * Caches color for event having the given post ID.
     *
     * @param  int    $post_id Event's post ID.
     *
     * @return string Color associated with event.
     */
    public function get_color_for_event( $event ) {
        $post_id = $event->get( 'post_id' );

        // If color for this event is uncached, populate cache.
        if ( ! isset( $this->_event_color_map[$post_id] ) ) {
            // Find out if an add-on has provided its own color for the event.
            $color = apply_filters( 'ai1ec_event_color', '', $event );

            // If none provided, fall back to event categories.
            if ( empty( $color ) ) {
                $categories = $this->_taxonomy_model->get_post_categories( $post_id );
                // Find the first category of this post that defines a color.
                foreach ( $categories as $category ) {
                    $color = $this->_taxonomy_model->get_category_color(
                        $category->term_id
                    );
                    if ( $color ) {
                        break;
                    }
                }
            }
            $this->_event_color_map[$post_id] = $color;
        }

        return $this->_event_color_map[$post_id];
    }

    /**
     * Categories as HTML, either as blocks or inline.
     *
     * @param Ai1ec_Event $event  Rendered Event.
     * @param string      $format Return 'blocks' or 'inline' formatted result.
     *
     * @return string String of HTML for category blocks.
     */
    public function get_categories_html(
        Ai1ec_Event $event,
        $format = 'blocks'
    ) {
        $categories = $this->_taxonomy_model->get_post_categories(
            $event->get( 'post_id' )
        );
        foreach ( $categories as &$category ) {
            $href = $this->_registry->get(
                'html.element.href',
                array( 'cat_ids' => $category->term_id )
            );

            $class = $data_type = $title = '';
            if ( $category->description ) {
                $title = 'title="' .
                    esc_attr( $category->description ) . '" ';
            }

            $html        = '';
            $class      .= ' ai1ec-category';
            $color_style = '';
            if ( $format === 'inline' ) {
                $taxonomy = $this->_registry->get( 'model.taxonomy' );
                $color_style = $taxonomy->get_category_color(
                    $category->term_id
                );
                if ( $color_style !== '' ) {
                    $color_style = 'style="color: ' . $color_style . ';" ';
                }
                $class .= '-inline';
            }

            $html .= '<a ' . $data_type . ' class="' . $class .
            ' ai1ec-term-id-' . $category->term_id . ' p-category" ' .
            $title . $color_style . 'href="' . $href->generate_href() . '">';

            if ( $format === 'blocks' ) {
                $html .= $this->get_category_color_square(
                    $category->term_id
                ) . ' ';
            } else {
                $html .=
                '<i ' . $color_style .
                    'class="ai1ec-fa ai1ec-fa-folder-open"></i>';
            }

            $html .= esc_html( $category->name ) . '</a>';
            $category = $html;
        }
        return implode( ' ', $categories );
    }

    /**
     * Tags as HTML
     */
    public function get_tags_html( Ai1ec_Event $event ) {
        $tags = $this->_taxonomy_model->get_post_tags(
            $event->get( 'post_id' )
        );
        if ( ! $tags ) {
            $tags = array();
        }
        foreach ( $tags as &$tag ) {
            $href = $this->_registry->get(
                'html.element.href',
                array( 'tag_ids' => $tag->term_id )
            );
            $class = '';
            $data_type = '';
            $title = '';
            if ( $tag->description ) {
                $title = 'title="' . esc_attr( $tag->description ) . '" ';
            }
            $tag = '<a ' . $data_type . ' class="ai1ec-tag ' . $class .
                ' ai1ec-term-id-' . $tag->term_id . '" ' . $title .
                'href="' . $href->generate_href() . '">' .
                '<i class="ai1ec-fa ai1ec-fa-tag"></i>' .
                esc_html( $tag->name ) . '</a>';
        }
        return implode( ' ', $tags );
    }

    /**
     * Filter Groups as HTML, either as blocks or inline.
     *
     * @param Ai1ec_Event  $event  Rendered Event.
     * @param array        $filter_group Filter Group (Option Model)
     * @param string       $format Return 'blocks' or 'inline' formatted result.
     *
     * @return string String of HTML for filter group blocks.
     */
    public function get_filter_group_html(
        Ai1ec_Event $event,
        $filter_group,
        $format = 'blocks'
    ) {

        $filter_groups = $this->_taxonomy_model->get_post_taxonomy(
            $event->get( 'post_id' ), $filter_group['taxonomy_name']
        );

        $icon_name = '';
        if ( 'ai1eccfgi-null' !== $filter_group['icon'] ) {
            $icon_name = $filter_group['icon'];
        } else {
            $icon_name = 'ai1ec-icon-timely';
        }

        foreach ( $filter_groups as &$group ) {
            $href = $this->_registry->get(
                'html.element.href',
                array( $filter_group['taxonomy_name'] . '_ids' => $group->term_id )
            );

            $class = $data_type = $title = '';
            if ( $group->description ) {
                $title = 'title="' .
                    esc_attr( $group->description ) . '" ';
            }

            $html        = '';
            $class      .= ' ai1ec-category';
            $color_style = '';
            if ( 'inline' === $format ) {
                $taxonomy = $this->_registry->get( 'model.taxonomy' );
                $color_style = $taxonomy->get_category_color(
                    $group->term_id
                );
                if ( $color_style !== '' ) {
                    $color_style = 'style="color: ' . $color_style . ';" ';
                }
                $class .= '-inline';
            }

            $html .= '<a ' . $data_type . ' class="' . $class .
            ' ai1ec-term-id-' . $group->term_id . ' p-category" ' .
            $title . $color_style . 'href="' . $href->generate_href() . '">';

            if ( 'blocks' === $format ) {
                $html .= $this->get_category_color_square($group->term_id) . ' ';
            } else {
                $html = $html
                      . '<i ' . $color_style . ' class="ai1ec-fa '
                      . $icon_name . '"></i>';
            }

            $html .= esc_html( $group->name ) . '</a>';
            $group = $html;
        }

        return implode( ' ', $filter_groups );
    }

    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $this->_taxonomy_model = $this->_registry->get( 'model.taxonomy' );
    }

}


==================================================
FILE PATH: ./app/view/event/ticket.php
==================================================
<?php

/**
 * This class renders the html for the event ticket.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Ticket {

    /**
     * Create readable content for buy tickets/register link
     *
     * @param bool $long Set to false to use short message version
     *
     * @return string Message to be rendered on buy tickets link
     */
    public function get_tickets_url_label( Ai1ec_Event $event, $long = true ) {
        if ( $event->is_free() ) {
            return ( $long )
            ? __( 'Register Now', AI1EC_PLUGIN_NAME )
            : __( 'Register', AI1EC_PLUGIN_NAME );
        }
        $output = '';
        if ( $long ) {
            $output = apply_filters(
                'ai1ec_buy_tickets_url_icon',
                '<i class="ai1ec-fa ai1ec-fa-shopping-cart"></i>'
            );
            if ( ! empty( $output ) ) {
                $output .= ' ';
            }
        }
        $output .= ( $long )
            ? __( 'Buy Tickets', AI1EC_PLUGIN_NAME )
            : __( 'Tickets', AI1EC_PLUGIN_NAME );
        return $output;
    }

    /**
     * Contact info as HTML
     */
    public function get_contact_html( Ai1ec_Event $event ) {
        $contact      = '<div class="h-card">';
        $has_contents = false;
        if ( $event->get( 'contact_name' ) ) {
            $contact     .=
            '<div class="ai1ec-contact-name p-name">' .
            '<i class="ai1ec-fa ai1ec-fa-fw ai1ec-fa-user"></i> ' .
            esc_html( $event->get( 'contact_name' ) ) .
            '</div> ';
            $has_contents = true;
        }
        if ( $event->get( 'contact_phone' ) ) {
            $contact     .=
            '<div class="ai1ec-contact-phone p-tel">' .
            '<i class="ai1ec-fa ai1ec-fa-fw ai1ec-fa-phone"></i> ' .
            esc_html( $event->get( 'contact_phone' ) ) .
            '</div> ';
            $has_contents = true;
        }
        if ( $event->get( 'contact_email' ) ) {
            $contact     .=
            '<div class="ai1ec-contact-email">' .
            '<a class="u-email" href="mailto:' .
            esc_attr( $event->get( 'contact_email' ) ) . '">' .
            '<i class="ai1ec-fa ai1ec-fa-fw ai1ec-fa-envelope-o"></i> ' .
            __( 'Email', AI1EC_PLUGIN_NAME ) . '</a></div> ';
            $has_contents = true;
        }
        if ( $event->get( 'contact_url' ) ) {
            $contact     .=
            '<div class="ai1ec-contact-url">' .
            '<a class="u-url" target="_blank" href="' .
            esc_attr( $event->get( 'contact_url' ) ) .
            '"><i class="ai1ec-fa ai1ec-fa-fw ai1ec-fa-link"></i> ' .
            apply_filters(
                'ai1ec_contact_url',
                __( 'Event website', AI1EC_PLUGIN_NAME )
            ) .
            ' <i class="ai1ec-fa ai1ec-fa-external-link"></i></a></div>';
            $has_contents = true;
        }
        $contact .= '</div>';
        return $has_contents ? $contact : '';
    }
}


==================================================
FILE PATH: ./app/view/event/location.php
==================================================
<?php

/**
 * This class renders the html for the event location.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Location extends Ai1ec_Base {

    /**
     * Return location details in brief format, separated by | characters.
     *
     * @return $string Short location string
     */
    public function get_short_location( Ai1ec_Event $event ) {
        $location_items = array();
        foreach ( array( 'venue', 'city', 'province', 'country' ) as $field ) {
            if ( $event->get( $field ) !== '' ) {
                $location_items[] = $event->get( $field );
            }
        }
        return implode( ' | ', $location_items );
    }

    /*
     * Return any available location details separated by newlines
    */
    public function get_location( Ai1ec_Event $event ) {
        $location = '';
        $venue    = $event->get( 'venue' );
        if ( $venue ) {
            $location .= $venue . "\n";
        }
        $address = $event->get( 'address' );
        if ( $address ) {
            $bits = explode( ',', $address );
            $bits = array_map( 'trim', $bits );

            // If more than three comma-separated values, treat first value as
            // the street address, last value as the country, and everything
            // in the middle as the city, state, etc.
            if ( count( $bits ) >= 3 ) {
                // Append the street address
                $street_address = array_shift( $bits ) . "\n";
                if ( $street_address ) {
                    $location .= $street_address;
                }
                // Save the country for the last line
                $country = array_pop( $bits );
                // Append the middle bit(s) (filtering out any zero-length strings)
                $bits = array_filter( $bits, 'strval' );
                if ( $bits ) {
                    $location .= join( ', ', $bits ) . "\n";
                }
                if ( $country ) {
                    $location .= $country . "\n";
                }
            } else {
                // There are two or less comma-separated values, so just append
                // them each on their own line (filtering out any zero-length strings)
                $bits      = array_filter( $bits, 'strval' );
                $location .= join( "\n", $bits );
            }
        }
        return $location;
    }

    /**
     * get_map_view function
     *
     * Returns HTML markup displaying a Google map of the given event, if the event
     * has show_map set to true. Returns a zero-length string otherwise.
     *
     * @return void
     **/
    function get_map_view( Ai1ec_Event $event ) {
        $settings = $this->_registry->get( 'model.settings' );
        $loader = $this->_registry->get( 'theme.loader' );
        if( ! $event->get( 'show_map' ) ) {
            return '';
        }

        $location = $this->get_latlng( $event );
        if ( ! $location ) {
            $location = $event->get( 'address' );
        }

        $args = array(
            'address'                 => $location,
            'gmap_url_link'           => $this->get_gmap_url( $event, false ),
            'hide_maps_until_clicked' => $settings->get( 'hide_maps_until_clicked' ),
            'text_view_map'           => __( 'Click to view map', AI1EC_PLUGIN_NAME ),
            'text_full_map'           => __( 'View Full-Size Map', AI1EC_PLUGIN_NAME ),
        );
        return $loader->get_file( 'event-map.twig', $args, false )->get_content();
    }

    /**
     * Returns the latitude/longitude coordinates as a textual string
     * parsable by the Geocoder API.
     *
     * @param  Ai1ec_Event &$event The event to return data from
     *
     * @return string              The latitude & longitude string, or null
     */
    public function get_latlng( Ai1ec_Event $event ) {
        // If the coordinates are set, use those, otherwise use the address.
        $location = NULL;
        // If the coordinates are set by hand use them.
        if ( $event->get( 'show_coordinates' ) ) {
            $longitude = floatval( $event->get( 'longitude' ) );
            $latitude  = floatval( $event->get( 'latitude' ) );
            $location  = $latitude . ',' . $longitude;
        }
        return $location;
    }

    /**
     * Returns the URL to the Google Map for the given event object.
     *
     * @param Ai1ec_Event $event  The event object to display a map for
     *
     * @return string
     */
    public function get_gmap_url( Ai1ec_Event $event ) {
        $lang     = $this->_registry->get( 'p28n.wpml' )->get_language();
        $location = $this->get_latlng( $event );
        if ( ! $location ) {
            $location = $event->get( 'address' );
        }
        return 'https://www.google.com/maps?f=q&hl=' . urlencode( $lang ) .
            '&source=embed&q=' . urlencode( $location );
    }

}

==================================================
FILE PATH: ./app/view/event/time.php
==================================================
<?php

/**
 * This class renders the html for the event time.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.View.Event
 */
class Ai1ec_View_Event_Time extends Ai1ec_Base {

    /**
     * Returns timespan expression for the event.
     *
     * Properly handles:
     *     - instantaneous events
     *     - all-day events
     *     - multi-day events
     * Display of start date can be hidden (non-all-day events only) or full
     * date. All-day status, if any, is enclosed in a span.ai1ec-allday-badge
     * element.
     *
     * @param Ai1ec_Event $event              Rendered event.
     * @param string      $start_date_display Can be one of 'hidden', 'short',
     *                                        or 'long'.
     *
     * @return string Formatted timespan HTML element.
     */
    public function get_timespan_html(
        Ai1ec_Event $event,
        $start_date_display = 'long'
    ) {
        // Makes no sense to hide start date for all-day events, so fix argument
        if ( 'hidden' === $start_date_display && $event->is_allday() ) {
            $start_date_display = 'short';
        }

        // Localize time.
        $start = $this->_registry->get( 'date.time', $event->get( 'start' ) );
        $end   = $this->_registry->get( 'date.time', $event->get( 'end'   ) );

        // All-day events need to have their end time shifted by 1 second less
        // to land on the correct day.
        $end_offset = 0;
        if ( $event->is_allday() ) {
            $end->set_time(
                $end->format( 'H' ),
                $end->format( 'i' ),
                $end->format( 's' ) - 1
            );
        }

        // Get timestamps of start & end dates without time component.
        $start_ts = $this->_registry->get( 'date.time', $start )
            ->set_time( 0, 0, 0 )
            ->format();
        $end_ts = $this->_registry->get( 'date.time', $end )
            ->set_time( 0, 0, 0 )
            ->format();

        $break_years = $start->format( 'Y' ) !== $end->format( 'Y' );
        $output = '';

        // Display start date, depending on $start_date_display.
        switch ( $start_date_display ) {
            case 'hidden':
                break;
            case 'short':
            case 'long':
                $property = $start_date_display . '_date';
                $output .= $this->{'get_' . $property}( $start, $break_years );
                break;
            default:
                $start_date_display = 'long';
        }

        // Output start time for non-all-day events.
        if ( ! $event->is_allday() ) {
            if ( 'hidden' !== $start_date_display ) {
                $output .= apply_filters(
                    'ai1ec_get_timespan_html_time_separator',
                    Ai1ec_I18n::_x( ' @ ', 'Event time separator' )
                );
            }
            $output .= $this->get_short_time( $start );
        }

        // Find out if we need to output the end time/date. Do not output it for
        // instantaneous events and all-day events lasting only one day.
        if (
            ! (
                $event->is_instant() ||
                ( $event->is_allday() && $start_ts === $end_ts )
            )
        ) {
            $output .= apply_filters(
                'ai1ec_get_timespan_html_date_separator',
                Ai1ec_I18n::_x( '  ', 'Event start/end separator' )
            );

            // If event ends on a different day, output end date.
            if ( $start_ts !== $end_ts ) {
                // for short date, use short display type
                if ( 'short' === $start_date_display ) {
                    $output .= $this->get_short_date( $end, $break_years );
                } else {
                    $output .= $this->get_long_date( $end );
                }
            }

            // Output end time for non-all-day events.
            if ( ! $event->is_allday() ) {
                if ( $start_ts !== $end_ts ) {
                    $output .= apply_filters(
                        'ai1ec_get_timespan_html_time_separator',
                        Ai1ec_I18n::_x( ' @ ', 'Event time separator' )
                    );
                }
                $output .= $this->get_short_time( $end );
            }
        }

        $output = esc_html( $output );

        // Add all-day label.
        if ( $event->is_allday() ) {
            $output .= apply_filters(
                'ai1ec_get_timespan_html_allday_badge',
                ' <span class="ai1ec-allday-badge">' .
                Ai1ec_I18n::__( 'all-day' ) .
                '</span>'
            );
        }
        return apply_filters(
            'ai1ec_get_timespan_html',
            $output,
            $event,
            $start_date_display
        );
    }

    /**
     * Get the html for the exclude dates and exception rules.
     *
     * @param Ai1ec_Event $event
     * @param Ai1ec_Recurrence_Rule $rrule
     * @return string
     */
    public function get_exclude_html(
        Ai1ec_Event $event,
        Ai1ec_Recurrence_Rule $rrule
    ) {
        $excludes        = array();
        $exception_rules = $event->get( 'exception_rules' );
        $exception_dates = $event->get( 'exception_dates' );
        if ( $exception_rules ) {
            $excludes[] =
            $rrule->rrule_to_text( $exception_rules );
        }
        if ( $exception_dates && 0 !== strpos( $exception_rules, 'EXDATE' ) ) {
            $excludes[] =
            $rrule->exdate_to_text( $exception_dates );
        }
        return implode( Ai1ec_I18n::__( ', and ' ), $excludes );
    }

    /**
     * Get the short date
     *
     * @param Ai1ec_Date_Time $time
     * @param bool            $add_year Whether to add year or not.
     *
     * @return string
     */
    public function get_short_date( Ai1ec_Date_Time $time, $add_year = false ) {
        $months = apply_filters( 'ai1ec_i18n_months', array() );
        $m      = $time->format_i18n( 'M' );
        $m      = array_key_exists( $m, $months ) ? $months[$m] : $m;
        if ( $add_year ) {
            return $m . ' ' . $time->format_i18n( 'j Y' );
        }
        return $m . ' ' . $time->format_i18n( 'j' );
    }

    /**
     * Format a long-length date for use in other views (e.g., single event).
     *
     * @param Ai1ec_Date_Time $time   Object to format.
     *
     * @return string Formatted date time [default: `l, M j, Y`].
     */
    public function get_long_date( Ai1ec_Date_Time $time ) {
        $date_format = $this->_registry->get( 'model.option' )->get(
            'date_format',
            'l, M j, Y'
        );
        return $time->format_i18n( $date_format );
    }

    /**
     * Format a short-form time for use in compressed (e.g. month) views.
     *
     * @param Ai1ec_Date_Time $time   Object to format.
     *
     * @return string Formatted date time [default: `g:i a`].
     */
    public function get_short_time( Ai1ec_Date_Time $time ) {
        $time_format = $this->_registry->get( 'model.option' )->get(
            'time_format',
            'g:i a'
        );
        return $time->format_i18n( $time_format );
    }

}

==================================================
FILE PATH: ./app/controller/content-filter.php
==================================================
<?php

/**
 * Handles strict_compatibility_content_filtering.
 *
 * @author     Time.ly Network Inc.
 * @since      2.1
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
class Ai1ec_Controller_Content_Filter extends Ai1ec_Base {

    /**
     * Content filters lib.
     * @var Ai1ec_Content_Filters
     */
    protected $_content_filter;

    /**
     * Setting _strict_compatibility_content_filtering.
     * @var bool
     */
    protected $_strict_compatibility_content_filtering;

    /**
     * Constructor.
     *
     * @param Ai1ec_Registry_Object $registry Registry object.
     *
     * @return void Method does not return.
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $this->_content_filter = $registry->get( 'content.filter' );
        $this->_strict_compatibility_content_filtering =
            $registry->get( 'model.settings' )
                ->get( 'strict_compatibility_content_filtering' );
    }

    /**
     * Clears all the_content filters excluding few defaults.
     *
     * @return void Method does not return.
     */
    public function clear_the_content_filters() {
        if ( $this->_strict_compatibility_content_filtering ) {
            $this->_content_filter->clear_the_content_filters();
        }
    }

    /**
     * Restores the_content filters.
     *
     * @return void Method does not return.
     */
    public function restore_the_content_filters() {
        if ( $this->_strict_compatibility_content_filtering ) {
            $this->_content_filter->restore_the_content_filters();
        }
    }
}

==================================================
FILE PATH: ./app/controller/extension.php
==================================================
<?php

/**
 * Basic extension controller.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
abstract class Ai1ec_Base_Extension_Controller {

    /**
     * @var Ai1ec_Registry_Object
     */
    protected $_registry;

    /**
     * @var array
     */
    protected $_settings;

    /**
     * @var Ai1ec_Registry_Object
     */
    protected static $_registry_static;

    /**
     * @var array
     */
    protected static $_settings_static;

    /**
     * @var array
     */
    protected static $_schema;

    /**
     * Get the long name of the extension
     */
    abstract public function get_name();

    /**
     * Get the machine name of the extension
     */
    abstract public function get_machine_name();

    /**
     * Get the version of the extension
     */
    abstract public function get_version();

    /**
     * Get the name of the main plugin file
     */
    abstract public function get_file();

    /**
     * Add extension specific settings
     */
    abstract protected function _get_settings();

    /**
     * Register action/filters/shortcodes for the extension
     *
     * @param Ai1ec_Event_Dispatcher $dispatcher
     */
    abstract protected function _register_actions(
        Ai1ec_Event_Dispatcher $dispatcher
    );

    /**
     * Perform the basic compatibility check.
     *
     * @param string $ai1ec_version
     *
     * @return boolean
     */
    public function check_compatibility( $ai1ec_version ) {
        return version_compare(
            $ai1ec_version,
            $this->minimum_core_required(),
            '>='
        );
    }

    /**
     * @return string
     */
    public function minimum_core_required() {
        return '2.0.7';
    }
    /**
     * Removes options when uninstalling the plugin.
     */
    public static function on_uninstall() {
        global $wpdb;
        if ( ! current_user_can( 'activate_plugins' ) ) {
            return;
        }
        $settings = self::$_registry_static->get( 'model.settings' );
        foreach ( self::$_settings_static as $name => $params ) {
            $settings->remove_option( $name );
        }
        $schema = self::$_schema;
        foreach ( $schema['tables'] as $table_name ) {
            // Delete table events
            $wpdb->query( 'DROP TABLE IF EXISTS ' . $table_name );
        }
    }

    /**
     * Public constructor
     */
    public function __construct() {
        global $wpdb;
        self::$_schema          = $this->_get_schema( $wpdb->prefix );
        $settings               = $this->_get_settings();
        $this->_settings        = $settings;
        self::$_settings_static = $settings;
    }

    /**
     * initialize the extension.
     */
    public function init( Ai1ec_Registry_Object $registry ) {
        $this->_registry        = $registry;
        // static properties are needed as uninstall hook must be static
        // http://wpseek.com/register_uninstall_hook/
        self::$_registry_static = $registry;
        register_deactivation_hook(
            $this->get_file(),
            array( $this, 'on_deactivation' )
        );

        $this->_install_schema( $registry );
        $this->_register_actions( $registry->get( 'event.dispatcher' ) );
        $this->_add_settings( $registry->get( 'model.settings' ) );
        $this->_perform_upgrade( $registry );
        if ( method_exists( $this, 'initialize_licence_actions' ) ) {
            $this->initialize_licence_actions();
        }
    }

    /**
     * Hides settings on deactivation.
     */
    public function on_deactivation() {
        if ( ! current_user_can( 'activate_plugins' ) ) {
            return;
        }
        $plugin        = isset( $_REQUEST['plugin'] ) ? $_REQUEST['plugin'] : '';
        $referer       = 'deactivate-plugin_' . $plugin;
        // if we are disabling the plugin in the exception handler, this can't be done.
        // but i want to disable options
        if ( function_exists( '_get_list_table' ) ) {
            $wp_list_table = _get_list_table( 'WP_Plugins_List_Table' );
            $action        = $wp_list_table->current_action();
            if ( 'deactivate-selected' === $action ) {
                $referer = 'bulk-plugins';
            }
            check_admin_referer( $referer );
        }
        $settings = $this->_registry->get( 'model.settings' );
        foreach ( $this->_settings as $name => $params ) {
            $settings->hide_option( $name );
        }
    }

    /**
     * Show the settings
     */
    public function show_settings( Ai1ec_Registry_Object $registry ) {
        $settings = $registry->get( 'model.settings' );
        foreach ( $this->_settings as $name => $params ) {
            if ( isset( $params['renderer'] ) ) {
                $settings->show_option( $name, $params['renderer'] );
            }
        }
        $settings->set( 'allow_statistics', true );
    }

    /**
     * If extensions need to add tables, they will need to override the function to add a schema.
     *
     * @param string $prefix Database prefix to use for table names.
     *
     * @return array An array with two keys, schema and tables which are used
     *               for installing and dropping the table.
     */
    protected static function _get_schema( $prefix ) {
        return array(
            'tables' => array(),
            'schema' => '',
        );
    }

    /**
     * Performe upgarde actions based on extension version
     *
     * @param Ai1ec_Registry_Object $registry
     */
    protected function _perform_upgrade( Ai1ec_Registry_Object $registry ) {
        $version_variable = 'ai1ec_' . $this->get_machine_name() .
            '_version';
        $option  = $registry->get( 'model.option' );
        $version = $option->get( $version_variable );
        if ( $version !== $this->get_version() ) {
            $registry->get( 'model.settings' )->perform_upgrade_actions();
            $this->_perform_upgrade_actions();
            $option->set( $version_variable, $this->get_version(), true );
        }
    }

    /**
     * Function called on add on upgrade.
     * Can be overridden by add ons for extra behaviour
     */
    protected function _perform_upgrade_actions() {

    }

    /**
     * Since the call the to the uninstall hook it's static, if a different behaviour
     * is needed also this call must be overridden.
     */
    protected function _register_uninstall_hook() {
        register_uninstall_hook(
            $this->get_file(),
            array( get_class( $this ), 'on_uninstall' )
        );
    }

    /**
     * Adds extension settings
     *
     * @param Ai1ec_Settings $settings
     */
    protected function _add_settings( Ai1ec_Settings $settings ) {
        foreach ( $this->_settings as $name => $params ) {
            $renderer = null;
            if ( isset( $params['renderer'] ) ) {
                $renderer = $params['renderer'];
            }
            $settings->register(
                $name,
                $params['value'],
                $params['type'],
                $renderer,
                $this->get_version()
            );
        }
    }

    /**
     * Check if the schema needs to be updated
     *
     * @param Ai1ec_Registry_Object $registry
     * @throws Ai1ec_Database_Update_Exception
     */
    protected function _install_schema( Ai1ec_Registry_Object $registry ) {
        $option = $registry->get( 'model.option' );
        $schema = self::$_schema;
        if (
            is_admin() &&
            ! empty( $schema['schema'] )
        ) {
            $db_version_variable = 'ai1ec_' . $this->get_machine_name() .
                '_db_version';
            $version = sha1( $schema['schema'] );
            if (
                $option->get( $db_version_variable ) !== $version
            ) {
                if (
                    $registry->get( 'database.helper' )->apply_delta(
                        $schema['schema']
                )
                ) {
                    $option->set( $db_version_variable, $version );
                } else {
                    throw new Ai1ec_Database_Update_Exception(
                        'Database upgrade for ' . $this->get_name() .
                        ' failed'
                    );
                }
            }
        }
    }

}

==================================================
FILE PATH: ./app/controller/extension-license.php
==================================================
<?php

/**
 * Abstract class for extensions which are sold.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
abstract class Ai1ec_Base_License_Controller extends Ai1ec_Base_Extension_Controller {

    /**
     * @var string Settings entry name for license key.
     */
    protected $_licence;

    /**
     * @var string Settings entry name for license status output.
     */
    protected $_licence_status;

    /**
     * @var string Licensing API endpoint URI.
     */
    protected $_store = 'https://time.ly/';

    /**
     * Get label to be used for license input field.
     *
     * @return string Localized label field.
     */
    abstract public function get_license_label();

    /**
     * @param Ai1ec_Registry_Object $registry
     */
    public function initialize_licence_actions() {
        $this->_register_licence_actions();
        $this->_register_licence_fields();
    }

    /**
     * Add the extension tab if not present
     *
     * @param array $tabs
     * @return array
     */
    public function add_tabs( array $tabs ) {
        if ( ! isset( $tabs['extensions'] ) ) {
            $tabs['extensions'] = array(
                'name'  => Ai1ec_I18n::__( 'Add-ons' ),
                'items' => array(),
            );
        }

        return $tabs;
    }

    /**
     * Register action for licences.
     */
    protected function _register_licence_actions() {
        $dispatcher = $this->_registry->get( 'event.dispatcher' );
        // we need the super class so we use get_class()
        $class      = explode( '_', get_class( $this ) );
        $controller = strtolower( end( $class ) );
        $dispatcher->register_filter(
            'ai1ec_add_setting_tabs',
            array( 'controller.' . $controller, 'add_tabs' )
        );
    }

    /**
     * Register fields for licence
     */
    protected function _register_licence_fields() {
        $plugin_id             = $this->get_machine_name();
        $this->_licence        = 'ai1ec_licence_' . $plugin_id;
        $this->_licence_status = 'ai1ec_licence_status_' . $plugin_id;
        $options               = array(
            $this->_licence => array(
                'type' => 'string',
                'version'  => $this->get_version(),
                'renderer' => array(
                    'class'       => 'input',
                    'group-class' => 'ai1ec-col-sm-7',
                    'tab'         => 'extensions',
                    'item'        => 'licenses',
                    'type'        => 'normal',
                    'label'       => $this->get_license_label(),
                    'status'      => $this->_licence_status,
                ),
                'default'  => '',
            ),
            $this->_licence_status => array(
                'type'     => 'string',
                'version'  => $this->get_version(),
                'default'  => 'invalid',
            ),
        );
        $settings = $this->_registry->get( 'model.settings' );
        foreach ( $options as $key => $option ) {
            $renderer = null;
            if ( isset( $option['renderer'] ) ) {
                $renderer = $option['renderer'];
            }
            $settings->register(
                $key,
                $option['default'],
                $option['type'],
                $renderer,
                $option['version']
            );
        }
    }

}


==================================================
FILE PATH: ./app/controller/shutdown.php
==================================================
<?php

/**
 * Controller that handles shutdown functions.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
class Ai1ec_Shutdown_Controller {

    /**
     * @var array Map of object names and class names they represent to preserve
     */
    protected $_preserve        = array(
        'wpdb'            => 'wpdb',
        'wp_object_cache' => 'WP_Object_Cache',
    );

    /**
     * @var array Map of object names and their representation from global scope
     */
    protected $_restorables     = array();

    /**
     * @var array List of callbacks to be executed during shutdown sequence
     */
    protected $_callbacks       = array();


    /**
     * Destructor
     *
     * Here processing of globals is made - values are replaced, callbacks
     * are executed and globals are restored to the previous state.
     *
     * @return void Destructor does not return
     */
    public function __destruct() {
        // replace globals from our internal store
        $restore = array();
        foreach ( $this->_preserve as $name => $class ) {
            if (
                ! isset( $GLOBALS[$name] ) ||
                ! ( $GLOBALS[$name] instanceof $class )
            ) {
                $restore[$name] = NULL;
                if ( isset( $GLOBALS[$name] ) ) {
                    $restore[$name] = $GLOBALS[$name];
                }
                $GLOBALS[$name] = $this->_restorables[$name];
            }
        }
        // execute callbacks
        foreach ( $this->_callbacks as $callback ) {
            call_user_func( $callback );
        }
        // restore globals to previous state
        foreach ( $restore as $name => $object ) {
            if ( NULL === $object ) {
                unset( $GLOBALS[$name] );
            } else {
                $GLOBALS[$name] = $object;
            }
        }
        // destroy local references
        foreach ( $this->_restorables as $name => $object ) {
            unset( $object, $this->_restorables[$name] );
        }
        if ( AI1EC_DEBUG ) {
            // __destruct is called twice if facebook extension is installed
            // still can't find the reason, this fixes it but prevent other plugins
            // __destruct() so let's just use it in dev until we fix this.
            exit();
        }
    }

    /**
     * Register a callback to be executed during shutdown sequence
     *
     * @param callback $callback Valid PHP callback
     *
     * @return Ai1ec_Shutdown_Utility Self instance for chaining
     */
    public function register( $callback ) {
        $this->_callbacks[] = $callback;
        return $this;
    }

    /**
     * Constructor
     *
     * Here global variables are referenced locally to ensure their preservation
     *
     * @return void Constructor does not return
     */
    public function __construct() {
        foreach ( $this->_preserve as $name => $class ) {
            $this->_restorables[$name] = $GLOBALS[$name];
        }
    }

}

==================================================
FILE PATH: ./app/controller/exception/file-not-found.php
==================================================
<?php

/**
 * The exception thrown when an engine is not set..
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller.Exception
 */
class Ai1ec_File_Not_Found_Exception extends Ai1ec_Exception {
}

==================================================
FILE PATH: ./app/controller/exception/engine-not-set.php
==================================================
<?php

/**
 * The exception thrown when an engine is not set..
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller.Exception
 */
class Ai1ec_Engine_Not_Set_Exception extends Ai1ec_Exception {
}

==================================================
FILE PATH: ./app/controller/import-export.php
==================================================
<?php

/**
 * The controller which handles import/export.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
class Ai1ec_Import_Export_Controller {

    /**
     * @var array The registered engines.
     */
    protected $_engines = array();


    /**
     * @var Ai1ec_Registry_Object
     */
    protected $_registry;

    /**
     * @var array Import / export params.
     */
    protected $_params;

    /**
     * This controller is instanciated only if we need to import/export something.
     *
     * When it is instanciated it allows other engines to be injected through a
     * filter. If we do not plan to ship core engines, let's skip the
     * $core_engines param.
     *
     * @param Ai1ec_Registry_Object $registry
     * @param array $core_engines
     * @param array $params
     */
    public function __construct(
            Ai1ec_Registry_Object $registry,
            array $core_engines = array( 'ics', 'api-ics' ),
            array $params = array()
    ) {
        $this->_registry = $registry;
        $known_engines   = apply_filters(
            'ai1ec_register_import_export_engines',
            $core_engines
        );
        $this->_params   = $params;
        foreach ( $known_engines as $engine ) {
            $this->register( $engine );
        }
    }

    /**
     * Register an import-export engine.
     *
     * @param string $engine
     */
    public function register( $engine ) {
        $this->_engines[$engine] = true;
    }

    /**
     * Import events into the calendar.
     *
     * @param string $engine
     * @param array $args
     *
     * @throws Ai1ec_Engine_Not_Set_Exception If the engine is not set.
     * @throws Ai1ec_Parse_Exception          If an error happens during parse.
     *
     * @return int The number of imported events
     */
    public function import_events( $engine, array $args ) {
        if ( ! isset( $this->_engines[$engine] ) ) {
            throw new Ai1ec_Engine_Not_Set_Exception(
                'The engine ' . $engine . 'is not registered.'
            );
        }
        // external engines must register themselves into the registry.
        $engine    = $this->_registry->get( 'import-export.' . $engine );
        $exception = null;
        try {
            return $engine->import( $args );
        } catch ( Ai1ec_Parse_Exception $parse_exception ) {
            $exception = $parse_exception;
        }
        throw $exception;
    }

    /**
     * Export the events using the specified engine.
     *
     * @param string $engine
     * @param array $args
     *
     * @throws Ai1ec_Engine_Not_Set_Exception
     */
    public function export_events( $engine, array $args ) {
        if ( ! isset( $this->_engines[$engine] ) ) {
            throw new Ai1ec_Engine_Not_Set_Exception(
                'The engine ' . $engine . 'is not registered.'
            );
        }
        // external engines must register themselves into the registry.
        $engine = $this->_registry->get( 'import-export.' . $engine );
        return $engine->export( $args, $this->_params );
    }
}

==================================================
FILE PATH: ./app/controller/javascript-widget.php
==================================================
<?php

/**
 * Handles Super Widget.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Javascript
 */
class Ai1ec_Controller_Javascript_Widget extends Ai1ec_Base {

    const WIDGET_PARAMETER = 'ai1ec_js_widget';
    const LEGACY_WIDGET_PARAMETER = 'ai1ec_super_widget';
    const WIDGET_JS_CACHE_FILE = '/public/js_cache/ai1ec_js_widget.js';

    protected $_widgets = array();


    public function add_widget( $widget_id, $widget_class ) {
        $this->_widgets[$widget_id] = $widget_class;
    }

    public function get_widgets() {
        return $this->_widgets;
    }

    /**
     * Adds Super Widget JS to admin screen.
     *
     * @param array  $files
     * @param string $page_to_load
     *
     * @return array
     */
    public function add_js( array $files, $page_to_load ) {
        if ( 'admin_settings.js' === $page_to_load ) {
            $files[] = AI1ECSW_PATH . '/public/js/pages/admin_settings.js';
        }
        return $files;
    }

    /**
     * @param array $data
     * @return array
     */
    public function add_js_translation( array $data ) {
        $data['set_calendar_page'] = __(
            'You must choose the Calendar page before using the Super Widget',
            AI1EC_PLUGIN_NAME
        );
        return $data;
    }

    /**
     * Sets the flag to revalidate cached js files on next render.
     */
    public function revalidate_cache() {
        $this->_registry->get( 'model.option' )->set( 'jswidgetupdated', '0' );
    }

    /**
     * Renders everything that's needed for the embedded widget.
     */
    public function render_js_widget() {

        if ( isset( $_GET['render'] ) && 'true' === $_GET['render'] ) {
            if ( isset( $_GET[self::WIDGET_PARAMETER] ) ){
                $widget = $_GET[self::WIDGET_PARAMETER];
            } else if ( isset( $_GET[self::LEGACY_WIDGET_PARAMETER] ) ) {
                $widget = $_GET[self::LEGACY_WIDGET_PARAMETER];
            }
            $widget_class = null;
            if ( isset( $this->_widgets[$widget] ) ) {
                $widget_class = $this->_widgets[$widget];
            }
            if ( null === $widget_class ) {
                return;
            }
            $widget_instance = $this->_registry->get( $widget_class );
            $this->render_content( $widget_instance );
        } else {
            if (
                ! $this->_registry->get( 'model.settings' )->get( 'cache_dynamic_js' ) ||
                '1' != $this->_registry->get( 'model.option' )->get( 'jswidgetupdated' ) ||
                ! $this->_registry->get( 'filesystem.checker' )->check_file_exists(
                    AI1EC_PATH . self::WIDGET_JS_CACHE_FILE,
                    true
                )
            ) {
                $this->render_javascript();
            } else {
                header(
                    'Location: '
                        . plugin_dir_url( 'all-in-one-event-calendar/public/js_cache/.' )
                        . 'ai1ec_js_widget.js'
                );
                exit( 0 );
            }
        }
    }

    public function render_javascript() {

        header( 'Content-Type: application/javascript' );
        header(
            'Expires: ' . gmdate( 'D, d M Y H:i:s', time() + 31536000 ) . ' GMT'
        );
        header( 'Cache-Control: public, max-age=31536000' );

        $jscontroller   = $this->_registry->get( 'controller.javascript' );
        $css_controller = $this->_registry->get( 'css.frontend' );
        $require_main   = AI1EC_ADMIN_THEME_JS_PATH . DIRECTORY_SEPARATOR . 'require.js';
        $widget_file    = AI1EC_PATH . '/public/js/widget/common_widget.js';
        $translation    = $jscontroller->get_frontend_translation_data();
        $page_id        = $this->_registry->get(
            'model.settings'
        )->get( 'calendar_page_id' );
        $permalink      = get_permalink(
            $page_id
        );
        $full_permalink = $this->_registry->get(
            'template.link.helper'
        )->get_full_permalink( $page_id );
        // load the css to hardcode, saving a call
        $css_rules        = $css_controller->get_compiled_css();
        $css_rules = addslashes( $css_rules );
        $translation['permalinks_structure'] = $this->
            _registry->get( 'model.option' )->get( 'permalink_structure' );
        $translation['calendar_url']      = preg_replace( '/^https?:/', '', $permalink );
        $translation['full_calendar_url'] = preg_replace( '/^https?:/', '', $full_permalink );
        // Let extensions add their scripts.
        // look at Extended Views or Super Widget for examples
        $extension_urls = array();
        $extension_urls = apply_filters(
            'ai1ec_render_js',
            $extension_urls,
            'ai1ec_widget.js'
        );
        // Removing http:// or https:// from extension URLs
        foreach ( $extension_urls as &$extension_url ) {
            $extension_url = preg_replace( '/https?:/', '', $extension_url );
        }

        $translation['extension_urls'] = $extension_urls;
        // the single event page js is loaded dinamically.
        $translation['event_page'] = array(
            'id' => 'ai1ec_event',
            'url' => preg_replace( '/^https?:/', '', AI1EC_URL ) . '/public/js/pages/event.js',
        );
        $translation_module = $jscontroller->create_require_js_module(
            Ai1ec_Javascript_Controller::FRONTEND_CONFIG_MODULE,
            $translation
        );
        // get requirejs
        $require = file_get_contents( $require_main );
        $main_widget = file_get_contents( $widget_file );
        $require_config = $jscontroller->create_require_js_config_object();
        $config         = $jscontroller->create_require_js_module(
            'ai1ec_config',
            $jscontroller->get_translation_data()
        );
        // get jquery
        $jquery = $jscontroller->get_jquery_version_based_on_browser(
            isset( $_SERVER['HTTP_USER_AGENT'] )
                ? $_SERVER['HTTP_USER_AGENT']
                : ''
        );

        $domready = $jscontroller->get_module(
            'domReady.js'
        );
        $frontend = $jscontroller->get_module(
            'scripts/common_scripts/frontend/common_frontend.js'
        );

        // compress data if possible
        $compatibility_ob = $this->_registry->get( 'compatibility.ob' );
        $js = <<<JS
        /******** Called once Require.js has loaded ******/

        (function() {

            var timely_css = document.createElement( 'style' );
            timely_css.innerHTML = '$css_rules';
            ( document.getElementsByTagName( "head" )[0] || document.documentElement ).appendChild( timely_css );
            // bring in requires
            $require
            // make timely global
            window.timely = timely;
            $require_config
            // Load other modules
            $translation_module
            $config
            $jquery
            $frontend

            // start up the widget
            $main_widget
        })(); // We call our anonymous function immediately
JS;
            $compatibility_ob->gzip_if_possible( $js );

        if (
            $this->_registry->get( 'model.settings' )->get( 'cache_dynamic_js' ) &&
            (
                '0' === $this->_registry->get( 'model.option' )->get( 'jswidgetupdated' ) ||
                ! $this->_registry->get( 'filesystem.checker' )->check_file_exists(
                    AI1EC_PATH . self::WIDGET_JS_CACHE_FILE,
                    true
                )
            )
        ) {
            try {
                $js_path  = AI1EC_ADMIN_THEME_JS_PATH . DIRECTORY_SEPARATOR;
                $js_saved = file_put_contents(
                    $js_path . '../js_cache/ai1ec_js_widget.js',
                    $js
                );
                if ( $js_saved ) {
                    $this->_registry->get( 'model.option' )->set( 'jswidgetupdated', '1' );
                }
            } catch ( Exception $e ) {
                $this->_registry->get( 'model.settings' )->set( 'cache_dynamic_js', false );
            }
        }
        exit( 0 );
    }

    public function render_content( Ai1ec_Embeddable $widget_instance ) {
        $args = array();
        $defaults = $widget_instance->get_js_widget_configurable_defaults();
        foreach ( $defaults as $id => $value ) {
            if ( isset( $_GET[$id] ) ) {
                $args[$id] = $_GET[$id];
            }
        }
        $html = $widget_instance->javascript_widget( $args );
        $jsonp = $this->_registry->get( 'http.response.render.strategy.jsonp' );
        $jsonp->render(
            array(
                'data' => array( 'html' => $html )
            )
        );
    }

}


==================================================
FILE PATH: ./app/controller/javascript.php
==================================================
<?php
/**
 * Controller that handles javascript related functions.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
class Ai1ec_Javascript_Controller {

    // The js handle used when enqueueing
    const JS_HANDLE = 'ai1ec_requirejs';

    // The namespace for require.js functions
    const REQUIRE_NAMESPACE = 'timely';

    // the name of the configuration module for the frontend
    const FRONTEND_CONFIG_MODULE = 'ai1ec_calendar';

    //the name of the get parameter we use for loading js
    const LOAD_JS_PARAMETER = 'ai1ec_render_js';

    // just load backend scripts
    const LOAD_ONLY_BACKEND_SCRIPTS = 'common_backend';

    // just load backend scripts
    const LOAD_ONLY_FRONTEND_SCRIPTS = 'common_frontend';

    // Are we in the backend
    const IS_BACKEND_PARAMETER = 'is_backend';

    // Are we on the calendar page
    const IS_CALENDAR_PAGE = 'is_calendar_page';

    // this is the value of IS_BACKEND_PARAMETER which triggers loading of backend script
    const TRUE_PARAM = 'true';

    // the javascript file for event page
    const EVENT_PAGE_JS = 'event.js';

    // the javascript file for calendar page
    const CALENDAR_PAGE_JS = 'calendar.js';

    // the file for the calendar feedsa page
    const CALENDAR_FEEDS_PAGE = 'calendar_feeds.js';

    // add new event page js
    const ADD_NEW_EVENT_PAGE = 'add_new_event.js';

    // event category page js
    const EVENT_CATEGORY_PAGE = 'event_category.js';

    // less variable editing page
    const LESS_VARIBALES_PAGE = 'less_variables_editing.js';

    // settings page
    const SETTINGS_PAGE = 'admin_settings.js';

    //widget creator page
    const WIDGET_CREATOR = 'widget-creator.js';

    //ticketing page
    const TICKETING = 'ticketing.js';

    //cache file
    const CALENDAR_JS_CACHE_FILE = '/public/js_cache/calendar.js';

    /**
     * @var Ai1ec_Registry_Object
     */
    private $_registry;

    /**
     * The core js pages to load.
     * Used to avoid errors when extensions add pages.
     *
     * @var array
     */
    private $_core_pages = array(
        self::CALENDAR_FEEDS_PAGE => true,
        self::ADD_NEW_EVENT_PAGE  => true,
        self::EVENT_CATEGORY_PAGE => true,
        self::LESS_VARIBALES_PAGE => true,
        self::SETTINGS_PAGE       => true,
        self::EVENT_PAGE_JS       => true,
        self::CALENDAR_PAGE_JS    => true,
        self::WIDGET_CREATOR      => true,
        self::TICKETING           => true,
    );

    /**
     * Holds an instance of the settings object
     *
     * @var Ai1ec_Settings
     */
    private $_settings;

    /**
     * @var Ai1ec_Locale
     */
    private $_locale;

    /**
     * @var Ai1ec_Scripts
     */
    private $_scripts_helper;

    /**
     * @var Ai1ec_Acl_Aco
     */
    private $_aco;

    /**
     * @var Ai1ec_Template_Link_Helper
     */
    private $_template_link_helper;

    /**
     * @var bool
     */
    protected $_frontend_scripts_loaded = false;

    /**
     * Public constructor.
     *
     * @param Ai1ec_Registry_Object $registry
     *
     * @return void
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        $this->_registry             = $registry;
        $this->_settings             = $registry->get( 'model.settings' );
        $this->_locale               = $registry->get( 'p28n.wpml' );
        $this->_aco                  = $registry->get( 'acl.aco' );
        $this->_template_link_helper = $registry->get( 'template.link.helper' );
        // this will need to be modified
        $this->_scripts_helper       = $registry->get( 'script.helper' );
    }

    /**
     * Load javascript files for frontend pages.
     *
     * @wp-hook ai1ec_load_frontend_js
     *
     * @param $is_calendar_page boolean Whether we are displaying the main
     *                                  calendar page or not
     *
     * @return void
     */
    public function load_frontend_js( $is_calendar_page, $is_shortcode = false ) {
        $page = null;

        // ======
        // = JS =
        // ======
        if( $this->_are_we_accessing_the_single_event_page() === true ) {
            $page = self::EVENT_PAGE_JS;
        }
        if( $is_calendar_page === true ) {
            $page = self::CALENDAR_PAGE_JS;
        }
        if( null !== $page ) {
            $this->add_link_to_render_js( $page, false );
        }
    }

    /**
     * Render the javascript for the appropriate page.
     *
     * @return void
     */
    public function render_js() {
        $js_path   = AI1EC_ADMIN_THEME_JS_PATH . DIRECTORY_SEPARATOR;
        $common_js = '';
        $js_cache  = $this->_settings->get( 'cache_dynamic_js' );

        if ( ! isset( $_GET[self::LOAD_JS_PARAMETER] ) ) {
            return null;
        }
        $page_to_load = $_GET[self::LOAD_JS_PARAMETER];
        $scripts_updated = $this->_registry->get( 'model.option' )->get( 'calendarjsupdated' );

        if (
            $js_cache &&
            $page_to_load === self::CALENDAR_PAGE_JS &&
            '1' === $scripts_updated &&
            $this->_registry->get( 'filesystem.checker' )->check_file_exists(
                AI1EC_PATH . self::CALENDAR_JS_CACHE_FILE,
                true
            )
        ) {
            Ai1ec_Http_Response_Helper::stop( 0 );
            return;
        }

        if (
            isset( $_GET[self::IS_BACKEND_PARAMETER] ) &&
            $_GET[self::IS_BACKEND_PARAMETER] === self::TRUE_PARAM
        ) {
            $common_js = file_get_contents( $js_path . 'pages/common_backend.js' );
        } else if (
            $page_to_load === self::EVENT_PAGE_JS ||
            $page_to_load === self::CALENDAR_PAGE_JS ||
            $page_to_load === self::LOAD_ONLY_FRONTEND_SCRIPTS
        ) {
            if (
                $page_to_load === self::LOAD_ONLY_FRONTEND_SCRIPTS &&
                true === $this->_frontend_scripts_loaded
            ) {
                return;
            }
            if ( false === $this->_frontend_scripts_loaded ) {
                $common_js = file_get_contents(
                    $js_path . 'pages/common_frontend.js'
                );
                $this->_frontend_scripts_loaded = true;
            }
        }

        // Create the config object for Require.js.
        $require_config = $this->create_require_js_config_object();

        // Load Require.js script.
        $require = file_get_contents( $js_path . 'require.js' );

        // Load appropriate jQuery script based on browser.
        $jquery = $this->get_jquery_version_based_on_browser(
            isset( $_SERVER['HTTP_USER_AGENT'] )
                ? $_SERVER['HTTP_USER_AGENT']
                : ''
        );

        // Load the main script for the page.
        $page_js = '';
        if ( isset( $this->_core_pages[$page_to_load] ) ) {
            $page_js = file_get_contents( $js_path . 'pages/' . $page_to_load );
        }

        // Load translation module.
        $translation    = $this->get_frontend_translation_data();
        $permalink      = $this->_template_link_helper
            ->get_permalink( $this->_settings->get( 'calendar_page_id' ) );
        $full_permalink = $this->_template_link_helper
            ->get_full_permalink( $this->_settings->get( 'calendar_page_id' ) );
        $translation['calendar_url']      = $permalink;
        $translation['full_calendar_url'] = $full_permalink;
        $translation_module = $this->create_require_js_module(
            self::FRONTEND_CONFIG_MODULE,
            $translation
        );

        // Load Ai1ec config script.
        $config = $this->create_require_js_module(
            'ai1ec_config',
            $this->get_translation_data()
        );

        // Let extensions add their scripts.
        $extension_files = array();
        $extension_files = apply_filters(
            'ai1ec_render_js',
            $extension_files,
            $page_to_load
        );
        $ext_js = '';

        foreach ( $extension_files as $file ) {
            $ext_js .= file_get_contents( $file );
        }

        // Finally, load the page_ready script to execute code that must run after
        // all scripts have been loaded.
        $page_ready = file_get_contents(
            $js_path . 'scripts/common_scripts/page_ready.js'
        );

        $javascript = $require . $require_config . $translation_module .
            $config . $jquery . $common_js . $ext_js . $page_js . $page_ready;
        // add to blank spaces to fix issues with js
        // being truncated onn some installs
        $javascript .= '  ';

        if (
            $js_cache &&
            $page_to_load === self::CALENDAR_PAGE_JS &&
            (
                '0' === $scripts_updated ||
                ! $this->_registry->get( 'filesystem.checker' )->check_file_exists(
                    AI1EC_PATH . self::CALENDAR_JS_CACHE_FILE,
                    true
                )
            )
        ) {
            $js_saved = false;
            try {
                $js_saved = file_put_contents(
                    $js_path . '../js_cache/' . self::CALENDAR_PAGE_JS,
                    $javascript
                );
                if ( $js_saved ) {
                    $this->_registry->get( 'model.option' )->set( 'calendarjsupdated', '1' );
                }
            } catch ( Exception $e ) {
                $this->_settings->set( 'cache_dynamic_js', false );
            }
        }

        $this->_echo_javascript( $javascript );
    }


    /**
     * Sets the flag to revalidate cached js files on next render.
     */
    public function revalidate_cache() {
        $this->_registry->get( 'model.option' )->set( 'calendarjsupdated', '0' );
    }

    /**
     * Get a compiled javascript file ( used by extensions )
     *
     * @param string $name
     *
     * @return string
     */
    public function get_module( $name ) {
        $js_path = AI1EC_ADMIN_THEME_JS_PATH . DIRECTORY_SEPARATOR;
        return file_get_contents( $js_path . $name );
    }

    /**
     * Check what file needs to be loaded and add the correct link.
     *
     * @wp-hook init
     *
     * @return void
     */
    public function load_admin_js() {
        // Initialize dashboard view

        $script_to_load = FALSE;
        if ( $this->are_we_on_calendar_feeds_page() === TRUE ) {
            // Load script for the importer plugins
            $script_to_load[] = self::CALENDAR_FEEDS_PAGE;
        }
        // Start the scripts for the event category page
        if ( $this->_are_we_editing_event_categories() === TRUE ) {
            // Load script required when editing categories
            $script_to_load[] = self::EVENT_CATEGORY_PAGE;
        }
        if ( $this->_are_we_editing_less_variables() === TRUE ) {
            // Load script required when editing categories
            $script_to_load[] = self::LESS_VARIBALES_PAGE;
        }
        // Load the js needed when you edit an event / add a new event
        if (
            true === $this->_are_we_creating_a_new_event() ||
            true === $this->_are_we_editing_an_event()
        ) {
            // Load script for adding / modifying events
            $script_to_load[] = self::ADD_NEW_EVENT_PAGE;
        }
        if ( true === $this->_are_we_accessing_the_calendar_settings_page() ) {
            $script_to_load[] = self::SETTINGS_PAGE;
        }
        if ( true === $this->_are_we_creating_widgets() ) {
            $script_to_load[] = self::WIDGET_CREATOR;
        }
        if (
            true === $this->_are_we_managing_tickets() ||
            true === $this->_are_we_managing_events_list()
        ) {
            $script_to_load[] = self::TICKETING;
        }
        if ( false === $script_to_load ) {
            $script_to_load[] = apply_filters( 'ai1ec_backend_js', self::LOAD_ONLY_BACKEND_SCRIPTS );
        }
        foreach ($script_to_load as $value) {
            $this->add_link_to_render_js( $value, true );
        }
    }

    /**
     * Loads version 1.9 or 2.0 of jQuery based on user agent.
     * If $user_agent is null (due to lack of HTTP header) we always serve
     * jQuery 2.0.
     *
     * @param string $user_agent
     *
     * @return string
     */
    public function get_jquery_version_based_on_browser( $user_agent ) {
        $js_path = AI1EC_ADMIN_THEME_JS_PATH . DIRECTORY_SEPARATOR;
        $jquery  = 'jquery_timely20.js';

        preg_match( '/MSIE (.*?);/', $user_agent, $matches );
        if ( count( $matches ) > 1 ) {
            //Then we're using IE
            $version = (int) $matches[1];
            if ( $version <= 8 ) {
                //IE 8 or under!
                $jquery = 'jquery_timely19.js';
            }
        }
        return file_get_contents( $js_path . $jquery );
    }

    /**
     * Creates a requirejs module that can be used for translations
     *
     * @param string $object_name
     * @param array $data
     *
     * @return string
     */
    public function create_require_js_module( $object_name, array $data ) {
        foreach ( (array) $data as $key => $value ) {
            if ( ! is_scalar( $value ) )
                continue;
            $data[$key] = html_entity_decode( (string) $value, ENT_QUOTES, 'UTF-8');
        }
        $json_data = json_encode( $data );
        $prefix = self::REQUIRE_NAMESPACE;
        $script = "$prefix.define( '$object_name', $json_data );";

        return $script;
    }

    /**
     * Create the array needed for translation and passing other settings to JS.
     *
     * @return $data array the dynamic data array
     */
    public function get_translation_data() {

        $force_ssl_admin = force_ssl_admin();
        if ( $force_ssl_admin && ! is_ssl() ) {
            force_ssl_admin( false );
        }
        $ajax_url        = ai1ec_admin_url( 'admin-ajax.php' );
        force_ssl_admin( $force_ssl_admin );
        $settings        = $this->_registry->get( 'model.settings' );
        $locale          = $this->_registry->get( 'p28n.wpml' );
        $blog_timezone   = $this->_registry->get( 'model.option' )
            ->get( 'gmt_offset' );
        $application = $this->_registry->get( 'bootstrap.registry.application' );
        $data            = array(
            'calendar_feeds_nonce'           => wp_create_nonce( 'ai1ec_ics_feed_nonce'),
            // ICS feed error messages
            'duplicate_feed_message'         => esc_html(
                Ai1ec_I18n::__( 'This feed is already being imported.' )
            ),
            'invalid_url_message'            => esc_html(
                Ai1ec_I18n::__( 'Please enter a valid iCalendar URL.' )
            ),
            'invalid_website_message'        => esc_html(
                Ai1ec_I18n::__( 'Please enter a valid Website URL.' )
            ),
            'invalid_registration_message'   => esc_html(
                Ai1ec_I18n::__( 'Please enter a valid Registration URL, starting with https:// or http://.' )
            ),
            'invalid_email_message'          => esc_html(
                Ai1ec_I18n::__( 'Please enter a valid email address.' )
            ),
            'choose_image_message'           => Ai1ec_I18n::__( 'Choose Image' ),
            'now'                            => $this->_registry->get( 'date.system' )
                ->current_time(),
            'size_less_variable_not_ok'      => Ai1ec_I18n::__(
                'The value you have entered is not a valid CSS length.'
            ),
            'confirm_reset_theme'            => Ai1ec_I18n::__(
                'Are you sure you want to reset your theme options to their default values?'
            ),
            'error_message_not_valid_lat'    => Ai1ec_I18n::__(
                'Please enter a valid latitude. A valid latitude is comprised between +90 and -90.'
            ),
            'error_message_not_valid_long'   => Ai1ec_I18n::__(
                'Please enter a valid longitude. A valid longitude is comprised between +180 and -180.'
            ),
            'error_message_not_entered_lat'  => Ai1ec_I18n::__(
                'When the "Input coordinates" checkbox is checked, "Latitude" is a required field.'
            ),
            'error_message_not_entered_long' => Ai1ec_I18n::__(
                'When the "Input coordinates" checkbox is checked, "Longitude" is a required field.'
            ),
            'ai1ec_contact_url_not_valid'         => Ai1ec_I18n::__(
                'The URL you have entered in the <b>Organizer Contact Info</b> &gt; <b>Website URL</b> seems to be invalid.'
            ),
            'ai1ec_ticket_ext_url_not_valid'           => Ai1ec_I18n::__(
                'The URL you have entered in the <b>Event Cost and Tickets</b> &gt; <b>Tickets or Registration URL</b> seems to be invalid.'
            ),
            'ai1ec_contact_email_not_valid'         => Ai1ec_I18n::__(
                'The Email you have entered in the <b>Organizer Contact Info</b> &gt; <b>E-mail</b> seems to be invalid.'
            ),
            'general_url_not_valid'          => Ai1ec_I18n::__(
                'Please remember that URLs must start with either "http://" or "https://".'
            ),
            'calendar_loading'               => Ai1ec_I18n::__(
                'Loading&hellip;'
            ),
            'ticketing_required_fields'      => Ai1ec_I18n::__(
                '<b>Required or incorrect fields for Ticketing are outlined red.</b>'
            ),
            'ticketing_repeat_not_supported' => Ai1ec_I18n::__( '<b>The Repeat option was selected but recurrence is not supported by Event with Tickets.</b>'
            ),
            'ticketing_no_tickets_included'  => Ai1ec_I18n::__( '<b>
                The Event has the cost option Tickets selected but no ticket was included.</b>'
            ),
            'discovery_event_success'         => Ai1ec_I18n::__(
                'Event was imported successfully.'
            ),
            'discovery_event_error'          => Ai1ec_I18n::__(
                'An error occurred when importing event. Please, try later.'
            ),
            'language'                       => $this->_registry->get( 'p28n.wpml' )->get_lang(),
            'ajax_url'                       => $ajax_url,
            // 24h time format for time pickers
            'twentyfour_hour'                => $settings->get( 'input_24h_time' ),
            // Date format for date pickers
            'date_format'                    => $settings->get( 'input_date_format' ),
            // Names for months in date picker header (escaping is done in wp_localize_script)
            'month_names'                    => $locale->get_localized_month_names(),
            // Names for days in date picker header (escaping is done in wp_localize_script)
            'day_names'                      => $locale->get_localized_week_names(),
            // Start the week on this day in the date picker
            'week_start_day'                 => $settings->get( 'week_start_day' ),
            'week_view_starts_at'            => $settings->get( 'week_view_starts_at' ),
            'week_view_ends_at'              => $settings->get( 'week_view_ends_at' ),
            'google_maps_api_key'            => $settings->get( 'google_maps_api_key' ),
            'blog_timezone'                  => $blog_timezone,
            'affix_filter_menu'              => $settings->get( 'affix_filter_menu' ),
            'affix_vertical_offset_md'       => $settings->get( 'affix_vertical_offset_md' ),
            'affix_vertical_offset_lg'       => $settings->get( 'affix_vertical_offset_lg' ),
            'affix_vertical_offset_sm'       => $settings->get( 'affix_vertical_offset_sm' ),
            'affix_vertical_offset_xs'       => $settings->get( 'affix_vertical_offset_xs' ),
            'calendar_page_id'               => $settings->get( 'calendar_page_id' ),
            'region'                         => ( $settings->get( 'geo_region_biasing' ) ) ? $locale->get_region() : '',
            'site_url'                       => trailingslashit(
                ai1ec_get_site_url()
            ),
            'javascript_widgets'             => array(),
            'widget_creator'                 => array(
                'preview'         => Ai1ec_I18n::__( 'Preview:' ),
                'preview_loading' => Ai1ec_I18n::__(
                    'Loading preview&nbsp;<i class="ai1ec-fa ai1ec-fa-spin ai1ec-fa-spinner"></i>'
                )
            ),
            'ticketing'                       => array(
                'details'         => Ai1ec_I18n::__( 'Ticketing Details' ),
                'hide_details'    => Ai1ec_I18n::__( 'Hide Ticketing Details' ),
                'loading_details' => Ai1ec_I18n::__( 'Loading tickets details...' ),
                'type_and_price'  => Ai1ec_I18n::__( 'Type and price' ),
                'info'            => Ai1ec_I18n::__( 'Info' ),
                'information'     => Ai1ec_I18n::__( 'Information' ),
                'report'          => Ai1ec_I18n::__( 'Report' ),
                'sale_dates'      => Ai1ec_I18n::__( 'Sale dates' ),
                'limits'          => Ai1ec_I18n::__( 'Limits' ),
                'actions'         => Ai1ec_I18n::__( 'Actions' ),
                'sold'            => Ai1ec_I18n::__( 'Sold:' ),
                'left'            => Ai1ec_I18n::__( 'Left:' ),
                'start'           => Ai1ec_I18n::__( 'Start:' ),
                'end'             => Ai1ec_I18n::__( 'End:' ),
                'min'             => Ai1ec_I18n::__( 'Min:' ),
                'max'             => Ai1ec_I18n::__( 'Max:' ),
                'attendees'       => Ai1ec_I18n::__( 'Attendees' ),
                'hide_attendees'  => Ai1ec_I18n::__( 'Hide Attendees' ),
                'attendees_list'  => Ai1ec_I18n::__( 'Attendees List' ),
                'guest_name'      => Ai1ec_I18n::__( 'Guest Name' ),
                'status'          => Ai1ec_I18n::__( 'Status' ),
                'email'           => Ai1ec_I18n::__( 'Email' ),
                'no_attendees'    => Ai1ec_I18n::__( 'No attendees for this ticket type.' ),
                'edit'            => Ai1ec_I18n::__( 'Edit' ),
                'code'            => Ai1ec_I18n::__( 'Code' ),
                'unlimited'       => Ai1ec_I18n::__( 'Unlimited' ),
                'open_for_sale'   => Ai1ec_I18n::__( 'Open for sale' ),
                'no_delete_text'  => Ai1ec_I18n::__( 'You have sold tickets for this ticket type. Please change it\'s status to "Canceled" and make refunds to all users that purchased tickets.' ),
                'cancel_message'  => Ai1ec_I18n::__( 'You have sold tickets for this ticket type. Please make refunds to all users that purchased tickets' )
            ),
            'load_views_error'                 => Ai1ec_I18n::__(
                'Something went wrong while fetching events.<br>The request status is: %STATUS% <br>The error thrown was: %ERROR%'
            ),
            'load_views_error_popup_title'   => Ai1ec_I18n::__( 'Response text received from server' ),
            'load_views_error_link_popup'    => Ai1ec_I18n::__( 'Click here for technical details' ),
            'cookie_path'                    => $this->_registry->get(
                'cookie.utility'
            )->get_path_for_cookie(),
            'disable_autocompletion'         => $settings->get( 'disable_autocompletion' ),
            'end_must_be_after_start'        => __( 'The end date can\'t be earlier than the start date.', AI1EC_PLUGIN_NAME ),
            'show_at_least_six_hours'        => __( 'For week and day view, you must select an interval of at least 6 hours.', AI1EC_PLUGIN_NAME ),
            'ai1ec_permalinks_enabled'       => $application->get( 'permalinks_enabled' ),
        );
        return apply_filters( 'ai1ec_js_translations', $data );
    }

    /**
     * Get the array with translated data for the frontend
     *
     * @return array
     */
    public function get_frontend_translation_data() {
        $data = array(
            'export_url' => AI1EC_EXPORT_URL,
        );

        // Replace desired CSS selector with calendar, if selector has been set
        $calendar_selector = $this->_settings->get( 'calendar_css_selector' );
        if( $calendar_selector ) {
            $page             = get_post(
                $this->_settings->get( 'calendar_page_id' )
            );
            $data['selector'] = $calendar_selector;
            $data['title']    = $page->post_title;
        }

        // DEPRECATED: Only still here for backwards compatibility with Ai1ec 1.x.
        $data['fonts'] = array();
        $fonts_dir = AI1EC_DEFAULT_THEME_URL . 'font_css/';
        $data['fonts'][] = array(
            'name' => 'League Gothic',
            'url'  => $fonts_dir . 'font-league-gothic.css',
        );
        $data['fonts'][] = array(
            'name' => 'fontawesome',
            'url'  => $fonts_dir . 'font-awesome.css',
        );
        return $data;
    }

    /**
     * Echoes the Javascript if not cached.
     *
     * Echoes the javascript with the correct content.
     * Since the content is dinamic, i use the hash function.
     *
     * @param string $javascript
     *
     * @return void
     */
    private function _echo_javascript( $javascript ) {
        $conditional_get = new HTTP_ConditionalGet( array(
            'contentHash' => md5( $javascript )
            )
        );
        $conditional_get->sendHeaders();
        if ( ! $conditional_get->cacheIsValid ) {
            $http_encoder = $this->_registry->get(
                'http.encoder',
                array(
                    'content' => $javascript,
                    'type' => 'text/javascript'
                )
            );
            $compression_level = null;
            if ( $this->_registry->get( 'model.settings' )->get( 'disable_gzip_compression' ) ) {
                // set the compression level to 0 to disable it.
                $compression_level = 0;
            }
            $http_encoder->encode( $compression_level );
            $http_encoder->sendAll();
        }
        Ai1ec_Http_Response_Helper::stop( 0 );
    }

    /**
     * Create the config object for requirejs.
     *
     * @return string
     */
    public function create_require_js_config_object() {
        $js_url    = AI1EC_ADMIN_THEME_JS_URL;
        $version   = AI1EC_VERSION;
        $namespace = self::REQUIRE_NAMESPACE;
        $config    = <<<JSC
        $namespace.require.config( {
            waitSeconds : 15,
            urlArgs     : 'ver=$version',
            baseUrl     : '$js_url'
        } );
JSC;
        return $config;
    }

    /**
     *    Check if we are in the calendar feeds page
     *
     * @return boolean TRUE if we are in the calendar feeds page FALSE otherwise
     */
    public function are_we_on_calendar_feeds_page() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $post_type = isset( $_GET['post_type'] ) ? $_GET['post_type'] : FALSE;
        $page = isset( $_GET['page'] ) ? $_GET['page'] : FALSE;
        if( $post_type === FALSE || $page === FALSE ) {
            return FALSE;
        }
        $is_calendar_feed_page = $path_details['basename'] === 'edit.php' &&
                                 $post_type                === 'ai1ec_event' &&
                                 $page                     === 'all-in-one-event-calendar-feeds';
        return $is_calendar_feed_page;
    }

    /**
     * Add the link to render the javascript
     *
     * @param string $page
     * @param boolean $backend
     *
     * @return void
     */
    public function add_link_to_render_js( $page, $backend ) {
        $load_backend_script = 'false';
        if ( true === $backend ) {
            $load_backend_script = self::TRUE_PARAM;
        }
        $is_calendar_page = false;
        if(
            true === is_page( $this->_settings->get( 'calendar_page_id' ) ) ||
            self::CALENDAR_PAGE_JS === $page
        ) {
            $is_calendar_page = self::TRUE_PARAM;
        }

        $url = add_query_arg(
            array(
                // Add the page to load
                self::LOAD_JS_PARAMETER    => $page,
                // If we are in the backend, we must load the common scripts
                self::IS_BACKEND_PARAMETER => $load_backend_script,
                // If we are on the calendar page we must load the correct option
                self::IS_CALENDAR_PAGE     => $is_calendar_page,
            ),
            trailingslashit( ai1ec_get_site_url() )
        );
        if (
            $this->_settings->get( 'cache_dynamic_js' ) &&
            $is_calendar_page &&
            '1' === $this->_registry->get( 'model.option' )->get( 'calendarjsupdated' ) &&
            $this->_registry->get( 'filesystem.checker' )->check_file_exists(
                AI1EC_PATH . self::CALENDAR_JS_CACHE_FILE,
                true
            )
        ) {
            $url = plugin_dir_url( 'all-in-one-event-calendar/public/js_cache/.' ) . $page;
        }

        if ( true === $backend ) {
            $this->_scripts_helper->enqueue_script(
                    self::JS_HANDLE,
                    $url,
                    array( 'postbox' ),
                    true
            );
        } else {
            $this->_scripts_helper->enqueue_script(
                    self::JS_HANDLE,
                    $url,
                    array(),
                    false
            );
        }
    }

    /**
     * check if we are editing an event
     *
     * @return boolean TRUE if we are editing an event FALSE otherwise
     */
    private function _are_we_editing_an_event() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $post_id = isset( $_GET['post'] ) ? $_GET['post'] : FALSE;
        $action = isset( $_GET['action'] ) ? $_GET['action'] : FALSE;
        if( $post_id === FALSE || $action === FALSE ) {
            return FALSE;
        }

        $editing = (
            'post.php' === $path_details['basename'] &&
            'edit'     === $action &&
            $this->_aco->is_our_post_type( $post_id )
        );
        return $editing;
    }

    /**
     * check if we are viewing events list
     *
     * @return boolean TRUE if we are on the events list FALSE otherwise
     */
    private function _are_we_managing_events_list() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $post_type    = isset( $_GET['post_type'] ) ? $_GET['post_type'] : FALSE;
        if ( FALSE === $post_type ) {
            return FALSE;
        }
        $page = isset( $_GET['page'] ) ? $_GET['page'] : '';
        $events_list = (
            'edit.php'    === $path_details['basename'] &&
            'ai1ec_event' === $post_type &&
            ai1ec_is_blank( $page )
        );
        return $events_list;
    }

    /**
     * check if we are creating a new event
     *
     * @return boolean TRUE if we are creating a new event FALSE otherwise
     */
    private function _are_we_creating_a_new_event() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $post_type = isset( $_GET['post_type'] ) ? $_GET['post_type'] : '';
        return $path_details['basename'] === 'post-new.php' &&
                $post_type === AI1EC_POST_TYPE;
    }

    /**
     * Check if we are accessing the settings page
     *
     * @return boolean TRUE if we are accessing the settings page FALSE otherwise
     */
    private function _are_we_accessing_the_calendar_settings_page() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $page = isset( $_GET['page'] ) ? $_GET['page'] : '';
        return $path_details['basename'] === 'edit.php' &&
                $page === AI1EC_PLUGIN_NAME . '-settings';
    }

    protected function _are_we_creating_widgets() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $page = isset( $_GET['page'] ) ? $_GET['page'] : '';
        return $path_details['basename'] === 'edit.php' &&
            $page === AI1EC_PLUGIN_NAME . '-widget-creator';
    }

    protected function _are_we_managing_tickets() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $page = isset( $_GET['page'] ) ? $_GET['page'] : '';
        return $path_details['basename'] === 'edit.php' &&
            $page === AI1EC_PLUGIN_NAME . '-tickets';
    }

    /**
     * Check if we are editing less variables
     *
     * @return boolean TRUE if we are accessing a single event page FALSE otherwise
     */
    private function _are_we_editing_less_variables() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $page = isset( $_GET['page'] ) ? $_GET['page'] : '';
        return $path_details['basename'] === 'edit.php' && $page === AI1EC_PLUGIN_NAME . '-edit-css';
    }

    /**
     * Check if we are accessing the events category page
     *
     * @return boolean TRUE if we are accessing the events category page FALSE otherwise
     */
    private function _are_we_editing_event_categories() {
        if ( !isset( $_SERVER['SCRIPT_NAME'] ) ) {
            return FALSE;
        }

        $path_details = pathinfo( $_SERVER['SCRIPT_NAME'] );
        $post_type = isset( $_GET['post_type'] ) ? $_GET['post_type'] : '';
        return (
            $path_details['basename'] === 'edit-tags.php' ||
            $path_details['basename'] === 'term.php'
        )  && $post_type === AI1EC_POST_TYPE;
    }

    /**
     * Check if we are accessing a single event page
     *
     * @return boolean TRUE if we are accessing a single event page FALSE otherwise
     */
    private function _are_we_accessing_the_single_event_page() {
        return $this->_aco->is_our_post_type();
    }

}


==================================================
FILE PATH: ./app/controller/front.php
==================================================
<?php

/**
 * The front controller of the plugin.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
class Ai1ec_Front_Controller {

    /**
     * @var Ai1ec_Registry_Object The Object registry.
     */
    protected $_registry;

    /**
     * @var bool Whether the domain has alredy been loaded or not.
     */
    protected $_domain_loaded = false;

    /**
     * @var string The pagebase used by Ai1ec_Href_Helper.
     */
    protected $_pagebase_for_href;

    /**
     * @var Ai1ec_Request_Parser Instance of the request pa
     */
    protected $_request;

    /**
     * @var array
     */
    protected $_default_theme;

    /**
     * Initializes the default theme property.
     */
    public function __construct() {
        // Initialize default theme.
        $this->_default_theme = array(
            'theme_dir'  => AI1EC_DEFAULT_THEME_PATH,
            'theme_root' => AI1EC_DEFAULT_THEME_ROOT,
            'theme_url'  => AI1EC_THEMES_URL . '/' . AI1EC_DEFAULT_THEME_NAME,
            'stylesheet' => AI1EC_DEFAULT_THEME_NAME,
            'legacy'     => false,
        );
    }

    /**
     * Initialize the controller.
     *
     * @param Ai1ec_Loader $ai1ec_loader Instance of Ai1EC classes loader
     *
     * @return void
     */
    public function initialize( $ai1ec_loader ) {
        ai1ec_start();
        $this->_init( $ai1ec_loader );
        $this->_initialize_dispatcher();
        $lessphp = $this->_registry->get( 'less.lessphp' );
        $lessphp->initialize_less_variables_if_not_set();
        $this->_registry->get( 'controller.shutdown' )
            ->register( 'ai1ec_stop' );
        add_action( 'plugins_loaded', array( $this, 'register_extensions' ), 1 );
        add_action( 'after_setup_theme', array( $this, 'register_themes' ), 1 );
        add_action( 'init', array( $lessphp, 'invalidate_css_cache_if_requested' ) );
        add_shortcode( 'timely-calendar', array( $this, 'embed_calendar' ) );
    }

    public function embed_calendar() {
		return is_string( get_option( 'timely_embed_calendar_script' ) ) ?
			get_option( 'timely_embed_calendar_script' ) :
			'';
	}
    
    /**
     * Let other objects access default theme
     *
     * @return array
     */
    public function get_default_theme() {
        return $this->_default_theme;
    }

    /**
     * Remove unwanted menus
     */
    public function admin_menu() {
        remove_submenu_page(
            'edit.php?post_type=ai1ec_event',
            'edit-tags.php?taxonomy=events_tags&amp;post_type=ai1ec_event'
        );
    }

    /**
     * Notify extensions and pass them instance of objects registry.
     *
     * @return void
     */
    public function register_extensions() {
        do_action( 'ai1ec_loaded', $this->_registry );
    }

    /**
     * Notify themes and pass them instance of objects registry.
     *
     * @return void
     */
    public function register_themes() {
        do_action( 'ai1ec_after_themes_setup', $this->_registry );
    }

    /**
     * Returns the registry object
     *
     * @param mixed $discard not used. Always return the registry.
     *
     * @return Ai1ec_Registry_Object
     */
    public function return_registry( $discard ) {
        return $this->_registry;
    }

    /**
     * If WIDGET_PARAMETER is set.
     *
     * @return boolean
     */
    protected function is_widget() {
        return isset(
            $_GET[Ai1ec_Controller_Javascript_Widget::WIDGET_PARAMETER]
        );
    }

    /**
     * If Advanced JS cache enabled.
     *
     * @return boolean
     */
    protected function if_js_cache_enabled() {
        $settings = $this->_registry->get( 'model.settings' );
        return $settings->get( 'cache_dynamic_js' );
    }

    /**
     * If LEGACY_WIDGET_PARAMETER is set.
     *
     * @return boolean
     */
    protected function is_legacy_widget() {
        return isset(
            $_GET[Ai1ec_Controller_Javascript_Widget::LEGACY_WIDGET_PARAMETER]
        );
    }

    /**
     * Execute commands if our plugin must handle the request.
     *
     * @wp_hook init
     *
     * @return void
     */
    public function route_request() {
        $this->_process_request();
        // get the resolver
        $resolver = $this->_registry->get(
            'command.resolver',
            $this->_request
        );
        // get the command
        $commands = $resolver->get_commands();
        // if we have a command
        if ( ! empty( $commands ) ) {
            foreach( $commands as $command ) {
                $result = $command->execute();
                if ( $command->stop_execution() ) {
                    return $result;
                }
            }
        }
    }

    /**
     * Initializes the URL router used by our plugin.
     *
     * @wp_hook init
     *
     * @return void
     */
    public function initialize_router() {
        /* @var $cal_state Ai1ec_Calendar_State */
        $cal_state              = $this->_registry->get( 'calendar.state' );
        $cal_state->set_routing_initialization( true );
        $settings               = $this->_registry->get( 'model.settings' );
        $cal_page               = $settings->get( 'calendar_page_id' );

        if (
            ! $cal_page ||
            $cal_page < 1
        ) { // Routing may not be affected in any way if no calendar page exists.
            $cal_state->set_routing_initialization( false );
            return null;
        }
        $router              = $this->_registry->get( 'routing.router' );
        $localization_helper = $this->_registry->get( 'p28n.wpml' );
        $page_base          = '';
        $clang              = '';

        if ( $localization_helper->is_wpml_active() ) {
            $trans = $localization_helper
                ->get_wpml_translations_of_page(
                    $cal_page,
                    true
                );
            $clang = $localization_helper->get_language();
            if ( isset( $trans[$clang] ) ) {
                $cal_page = $trans[$clang];
            }
        }
        $template_link_helper = $this->_registry->get( 'template.link.helper' );

        if ( ! get_post( $cal_page ) ) {
            $cal_state->set_routing_initialization( false );
            return null;
        }

        $page_base = $template_link_helper->get_page_link(
            $cal_page
        );

        $page_base = Ai1ec_Wp_Uri_Helper::get_pagebase( $page_base );
        $page_link = 'index.php?page_id=' .
            $cal_page;
        $pagebase_for_href = Ai1ec_Wp_Uri_Helper::get_pagebase_for_links(
            get_page_link( $cal_page ),
            $clang
        );

        // save the pagebase to set up the factory later
        $application = $this->_registry->get( 'bootstrap.registry.application' );
        $application->set( 'calendar_base_page', $pagebase_for_href );
        $option = $this->_registry->get( 'model.option' );

        // If the calendar is set as the front page, disable permalinks.
        // They would not be legal under a Windows server. See:
        // https://issues.apache.org/bugzilla/show_bug.cgi?id=41441

        if (
            $option->get( 'permalink_structure' ) &&
            ( int ) get_option( 'page_on_front' ) !==
            ( int ) $cal_page
        ) {
            $application->set( 'permalinks_enabled', true );
        }

        $router->asset_base( $page_base )
            ->register_rewrite( $page_link );
        $cal_state->set_routing_initialization( false );
    }

    /**
     * Initialize the system.
     *
     * Perform all the inizialization needed for the system.
     * Throws some uncatched exception for critical failures.
     * Plugin will be disabled by the exception handler on those failures.
     *
     * @param Ai1ec_Loader $ai1ec_loader Instance of Ai1EC classes loader
     *
     * @throws Ai1ec_Constants_Not_Set_Exception
     * @throws Ai1ec_Database_Update_Exception
     * @throws Ai1ec_Database_Schema_Exception
     *
     * @return void Method does not return
     */
    protected function _init( $ai1ec_loader ) {
        $exception = null;
        // Load the textdomain
        try {
            // Initialize the registry object
            $this->_initialize_registry( $ai1ec_loader );
            $this->_registry->get( 'event.dispatcher' )->register_filter(
                'ai1ec_perform_scheme_update',
                array( 'database.datetime-migration', 'filter_scheme_update' )
            );
            // Procedures to take when upgrading plugin version
            $this->_plugin_upgrade_procedures();
            // Load the css if needed
            $this->_load_css_if_needed();
            // Initialize the crons
            $this->_install_crons();
            // Register the activation hook
            $this->_initialize_schema();
            // set the default theme if not set
            $this->_add_default_theme_if_not_set();
        } catch ( Ai1ec_Constants_Not_Set_Exception $e ) {
            // This is blocking, throw it and disable the plugin
            $exception = $e;
        } catch ( Ai1ec_Database_Update_Exception $e ) {
            // Blocking throw it so that the plugin is disabled
            $exception = $e;
        } catch ( Ai1ec_Database_Schema_Exception $e ) {
            // Blocking throw it so that the plugin is disabled
            $exception = $e;
        } catch ( Ai1ec_Scheduling_Exception $e ) {
            // not blocking
        }

        if ( null !== $exception ) {
            throw $exception;
        }
    }

    /**
     * Set the default theme if no theme is set, or populate theme info array if
     * insufficient information is currently being stored.
     *
     * @uses apply_filters() Calls 'ai1ec_pre_save_current_theme' hook to allow
     *       overwriting of theme information before being stored.
     */
    protected function _add_default_theme_if_not_set() {
        $option = $this->_registry->get( 'model.option' );
        $theme  = $option->get( 'ai1ec_current_theme', array() );
        $update = false;
        // Theme setting is undefined; default to Vortex.
        if ( empty( $theme ) ) {
            $theme  = $this->_default_theme;
            $update = true;
        }
        // Legacy settings; in 1.x the active theme was stored as a bare string,
        // and they were located in a different folder than they are now.
        else if ( is_string( $theme ) ) {
            $theme_name  = strtolower( $theme );
            $core_themes = explode( ',', AI1EC_CORE_THEMES );
            $legacy      = ! in_array( $theme_name, $core_themes );

            if ( $legacy ) {
                $root = WP_CONTENT_DIR . DIRECTORY_SEPARATOR . AI1EC_THEME_FOLDER;
                $url  = WP_CONTENT_URL . '/' . AI1EC_THEME_FOLDER . '/' . $theme_name;
            } else {
                $root = AI1EC_DEFAULT_THEME_ROOT;
                $url  = AI1EC_THEMES_URL . '/' . $theme_name;
            }
            // if it's from 1.x, move folders to avoid confusion
            if ( apply_filters( 'ai1ec_move_themes_to_backup', true ) ) {
                $this->_registry->get( 'theme.search' )
                    ->move_themes_to_backup( $core_themes );
            }
            // Ensure existence of theme directory.
            if ( ! is_dir( $root . DIRECTORY_SEPARATOR . $theme_name ) ) {
                // It's missing; something is wrong with this theme. Reset theme to
                // Vortex and warn the user accordingly.
                $option->set( 'ai1ec_current_theme', $this->_default_theme );
                $notification = $this->_registry->get( 'notification.admin' );
                $notification->store(
                    sprintf(
                        Ai1ec_I18n::__(
                            'Your active calendar theme could not be properly initialized. The default theme has been activated instead. Please visit %s and try reactivating your theme manually.'
                        ),
                        '<a href="' . ai1ec_admin_url( AI1EC_THEME_SELECTION_BASE_URL ) . '">' .
                        Ai1ec_I18n::__( 'Calendar Themes' ) . '</a>'
                    ),
                    'error',
                    1
                );
            }

            $theme = array(
                'theme_dir'  => $root . DIRECTORY_SEPARATOR . $theme_name,
                'theme_root' => $root,
                'theme_url'  => $url,
                'stylesheet' => $theme_name,
                'legacy'     => $legacy,
            );
            $update = true;
        }
        // Ensure 'theme_url' is defined, as this property was added after the first
        // public beta release.
        else if ( ! isset( $theme['theme_url'] ) ) {
            if ( $theme['legacy'] ) {
                $theme['theme_url'] = WP_CONTENT_URL . '/' . AI1EC_THEME_FOLDER . '/' .
                    $theme['stylesheet'];
            } else {
                $theme['theme_url'] = AI1EC_THEMES_URL . '/' . $theme['stylesheet'];
            }
            $update = true;
        }

        if ( $update ) {
            $theme = apply_filters( 'ai1ec_pre_save_current_theme', $theme );
            $option->set( 'ai1ec_current_theme', $theme );
        }
    }

    /**
     * Adds actions handled by the front controller.
     */
    protected function _add_front_controller_actions() {
        // Initialize router. I use add_action as the dispatcher would just add
        // overhead.
        add_action(
            'init',
            array( $this, 'initialize_router' ),
            PHP_INT_MAX - 1
        );
        add_action(
            'widgets_init',
            array( 'Ai1ec_View_Admin_Widget', 'register_widget' )
        );

        if (
            $this->is_widget() ||
            $this->is_legacy_widget()
        ) {
            $this->_registry->get( 'event.dispatcher' )->register_action(
                'init',
                array( 'controller.javascript-widget', 'render_js_widget' ),
                PHP_INT_MAX
            );
        }

        // Route the request.
        $action = 'template_redirect';
        if ( is_admin() ) {
            $action = 'init';
            add_action( 'admin_menu', array( $this, 'admin_menu' ) );
        }
        add_action( $action, array( $this, 'route_request' ) );
        add_filter( 'ai1ec_registry', array( $this, 'return_registry' ) );
    }

    /**
     * Initialize the dispatcher.
     *
     * Complete this when writing the dispatcher.
     *
     * @return void
     */
    protected function _initialize_dispatcher() {
        $dispatcher = $this->_registry->get( 'event.dispatcher' );
        $dispatcher->register_action(
            'init',
            array( 'post.custom-type', 'register' )
        );
        $this->_add_front_controller_actions();
        if ( isset( $_GET[Ai1ec_Javascript_Controller::LOAD_JS_PARAMETER] ) ) {
            $dispatcher->register_action(
                'wp_loaded',
                array( 'controller.javascript', 'render_js' )
            );
        }
        $dispatcher->register_action(
            'before_delete_post',
            array( 'model.event.trashing', 'before_delete_post' ),
            0,
            3
        );
        $dispatcher->register_action(
            'delete_post',
            array( 'model.event.trashing', 'delete' )
        );
        $dispatcher->register_action(
            'wp_trash_post',
            array( 'model.event.trashing', 'trash_post' )
        );
        $dispatcher->register_action(
            'trashed_post',
            array( 'model.event.trashing', 'trashed_post' )
        );
        $dispatcher->register_action(
            'untrash_post',
            array( 'model.event.trashing', 'untrash_post' )
        );
        $dispatcher->register_action(
            'untrashed_post',
            array( 'model.event.trashing', 'untrashed_post' )
        );
        $dispatcher->register_action(
            'pre_http_request',
            array( 'http.request', 'pre_http_request' ),
            10,
            3
        );
        $dispatcher->register_action(
            'http_request_args',
            array( 'http.request', 'init_certificate' ),
            10,
            2
        );
        // add the filter to let the organize page work
        $dispatcher->register_action(
            'admin_init',
            array( 'view.admin.organize', 'add_taxonomy_actions' ),
            10000
        );
        $dispatcher->register_action(
            'plugins_loaded',
            array( 'theme.loader', 'clean_cache_on_upgrade' ),
            PHP_INT_MAX
        );
        $dispatcher->register_filter(
            'get_the_excerpt',
            array( 'view.event.content', 'event_excerpt' ),
            11
        );
        remove_filter( 'the_excerpt', 'wpautop', 10 );
        $dispatcher->register_filter(
            'the_excerpt',
            array( 'view.event.content', 'event_excerpt_noautop' ),
            11
        );
        $dispatcher->register_filter(
            'robots_txt',
            array( 'robots.helper', 'rules' ),
            10,
            2
        );
        $dispatcher->register_filter(
            'ai1ec_dbi_debug',
            array( 'http.request', 'debug_filter' )
        );
        $dispatcher->register_filter(
            'ai1ec_dbi_debug',
            array( 'compatibility.cli', 'disable_db_debug' )
        );
        // editing a child instance
        if ( isset( $_SERVER['SCRIPT_NAME'] ) && basename( $_SERVER['SCRIPT_NAME'] ) === 'post.php' ) {
            $dispatcher->register_action(
                'admin_action_editpost',
                array( 'model.event.parent', 'admin_init_post' )
            );
            $dispatcher->register_filter(
                'user_has_cap',
                array( 'content.filter', 'display_trash_link' ),
                10,
                2
            );
        }
        // post row action for parent/child
        $dispatcher->register_action(
            'post_row_actions',
            array( 'model.event.parent', 'post_row_actions' ),
            100,
            2
        );
        // Category colors
        $dispatcher->register_action(
            'events_categories_add_form_fields',
            array( 'view.admin.event-category', 'events_categories_add_form_fields' )
        );
        $dispatcher->register_action(
            'events_categories_edit_form_fields',
            array( 'view.admin.event-category', 'events_categories_edit_form_fields' )
        );
        $dispatcher->register_action(
            'created_events_categories',
            array( 'view.admin.event-category', 'created_events_categories' )
        );
        $dispatcher->register_action(
            'edited_events_categories',
            array( 'view.admin.event-category', 'edited_events_categories' )
        );
        $dispatcher->register_action(
            'manage_edit-events_categories_columns',
            array( 'view.admin.event-category', 'manage_event_categories_columns' )
        );
        $dispatcher->register_action(
            'manage_events_categories_custom_column',
            array( 'view.admin.event-category', 'manage_events_categories_custom_column' ),
            10,
            3
        );

        // register ICS cron action
        $dispatcher->register_action(
            Ai1ecIcsConnectorPlugin::HOOK_NAME,
            array( 'calendar-feed.ics', 'cron' )
        );
        $dispatcher->register_shortcode(
            'ai1ec',
            array( 'view.calendar.shortcode', 'shortcode' )
        );
        $dispatcher->register_action(
            'updated_option',
            array( 'model.settings', 'wp_options_observer' ),
            PHP_INT_MAX - 1,
            3
        );

        $dispatcher->register_action(
            'ai1ec_settings_updated',
            array( 'compatibility.check', 'ai1ec_settings_observer' ),
            PHP_INT_MAX - 1,
            2
        );
        if ( $this->if_js_cache_enabled() ) {
            $dispatcher->register_action(
                'ai1ec_settings_updated',
                array( 'controller.javascript', 'revalidate_cache' ),
                PHP_INT_MAX - 1
            );
            $dispatcher->register_action(
                'ai1ec_settings_updated',
                array( 'controller.javascript-widget', 'revalidate_cache' ),
                PHP_INT_MAX - 1
            );
        }

        if ( is_admin() ) {
            // Import suggested event
            $dispatcher->register_action(
                'wp_ajax_ai1ec_import_suggested_event',
                array( 'calendar-feed.ics', 'add_discover_events_feed_subscription' )
            );
            // Remove suggested event
            $dispatcher->register_action(
                'wp_ajax_ai1ec_remove_suggested_event',
                array( 'calendar-feed.ics', 'delete_individual_event_subscription' )
            );
            // Search for events
            $dispatcher->register_action(
                'wp_ajax_ai1ec_search_events',
                array( 'calendar-feed.suggested', 'search_events' )
            );
            // get the repeat box
            $dispatcher->register_action(
                'wp_ajax_ai1ec_get_repeat_box',
                array( 'view.admin.get-repeat-box', 'get_repeat_box' )
            );
            // get the tax options box
            $dispatcher->register_action(
                'wp_ajax_ai1ec_get_tax_box',
                array( 'view.admin.get-tax-box', 'get_tax_box' )
            );
            // add dismissable notice handler
            $dispatcher->register_action(
                'wp_ajax_ai1ec_dismiss_notice',
                array( 'notification.admin', 'dismiss_notice' )
            );
            // save rrurle and convert it to text
            $dispatcher->register_action(
                'wp_ajax_ai1ec_rrule_to_text',
                array( 'view.admin.get-repeat-box', 'convert_rrule_to_text' )
            );
            // display ticketing details in the events list
            $dispatcher->register_action(
                'wp_ajax_ai1ec_show_ticket_details',
                array( 'view.admin.all-events', 'show_ticket_details' )
            );
            // display attendees list
            $dispatcher->register_action(
                'wp_ajax_ai1ec_show_attendees',
                array( 'view.admin.all-events', 'show_attendees' )
            );
            // CSS and templates for ticketing options
            $dispatcher->register_action(
                'restrict_manage_posts',
                array( 'view.admin.all-events', 'add_ticketing_styling' )
            );
            // taxonomy filter
            $dispatcher->register_action(
                'restrict_manage_posts',
                array( 'view.admin.all-events', 'taxonomy_filter_restrict_manage_posts' )
            );
            $dispatcher->register_action(
                'parse_query',
                array( 'view.admin.all-events', 'taxonomy_filter_post_type_request' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.calendar-feeds', 'add_page' )
            );
            $dispatcher->register_action(
                'current_screen',
                array( 'view.admin.calendar-feeds', 'add_meta_box' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.add-ons', 'add_page' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.theme-switching', 'add_page' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.theme-options', 'add_page' )
            );
            $dispatcher->register_action(
                'current_screen',
                array( 'view.admin.theme-options', 'add_meta_box' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.settings', 'add_page' )
            );
            $dispatcher->register_action(
                'current_screen',
                array( 'view.admin.settings', 'add_meta_box' )
            );
            $dispatcher->register_action(
                'init',
                array( 'controller.javascript', 'load_admin_js' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.samples', 'add_page' ),
                100,
                1
            );
            $dispatcher->register_action(
                'wp_ajax_ai1ec_add_ics',
                array( 'calendar-feed.ics', 'add_ics_feed' )
            );
            $dispatcher->register_action(
                'wp_ajax_ai1ec_delete_ics',
                array( 'calendar-feed.ics', 'delete_feeds_and_events' )
            );
            $dispatcher->register_action(
                'wp_ajax_ai1ec_update_ics',
                array( 'calendar-feed.ics', 'update_ics_feed' )
            );
            $dispatcher->register_action(
                'wp_ajax_ai1ec_feeds_page_post',
                array( 'calendar-feed.ics', 'handle_feeds_page_post' )
            );
            $dispatcher->register_action(
                'network_admin_notices',
                array( 'notification.admin', 'send' )
            );
            $dispatcher->register_action(
                'admin_notices',
                array( 'notification.admin', 'send' )
            );
            $dispatcher->register_action(
                'admin_footer-edit.php',
                array( 'clone.renderer-helper', 'duplicate_custom_bulk_admin_footer' )
            );
            $dispatcher->register_filter(
                'post_row_actions',
                array( 'clone.renderer-helper', 'ai1ec_duplicate_post_make_duplicate_link_row' ),
                100,
                2
            );
            $dispatcher->register_action(
                'add_meta_boxes',
                array( 'view.admin.add-new-event', 'event_meta_box_container' )
            );
            $dispatcher->register_action(
                'edit_form_after_title',
                array( 'view.admin.add-new-event', 'event_inline_alert' )
            );
            $dispatcher->register_action(
                'save_post',
                array( 'model.event.creating', 'save_post' ),
                10,
                3
            );
            $dispatcher->register_action(
                'pre_post_update',
                array( 'model.event.creating', 'pre_post_update' ),
                0,
                2
            );
            $dispatcher->register_action(
                'wp_insert_post_data',
                array( 'model.event.creating', 'wp_insert_post_data' )
            );
            $dispatcher->register_action(
                'manage_ai1ec_event_posts_custom_column',
                array( 'view.admin.all-events', 'custom_columns' ),
                10,
                2
            );
            $dispatcher->register_filter(
                'manage_ai1ec_event_posts_columns',
                array( 'view.admin.all-events', 'change_columns' )
            );
            $dispatcher->register_filter(
                'manage_edit-ai1ec_event_sortable_columns',
                array( 'view.admin.all-events', 'sortable_columns' )
            );
            $dispatcher->register_filter(
                'posts_orderby',
                array( 'view.admin.all-events', 'orderby' ),
                10,
                2
            );
            $dispatcher->register_filter(
                'ai1ec_count_future_events',
                array( 'view.admin.all-events', 'count_future_events' ),
                10,
                1
            );
            $dispatcher->register_filter(
                'post_updated_messages',
                array( 'view.event.post', 'post_updated_messages' )
            );
            add_action( 'admin_head', array( $this, 'admin_head' ) );
            $dispatcher->register_action(
                'plugin_action_links_' . AI1EC_PLUGIN_BASENAME,
                array( 'view.admin.nav', 'plugin_action_links' )
            );
            $dispatcher->register_action(
                'wp_ajax_ai1ec_rescan_cache',
                array( 'twig.cache', 'rescan' )
            );
            $dispatcher->register_action(
                'admin_init',
                array( 'environment.check', 'run_checks' )
            );
            $dispatcher->register_action(
                'activated_plugin',
                array( 'environment.check', 'check_addons_activation' )
            );
            $dispatcher->register_filter(
                'upgrader_post_install',
                array( 'environment.check', 'check_bulk_addons_activation' )
            );
            if ( $this->if_js_cache_enabled() ) {
                $dispatcher->register_action(
                    'activated_plugin',
                    array( 'controller.javascript', 'revalidate_cache' )
                );
                $dispatcher->register_action(
                    'deactivated_plugin',
                    array( 'controller.javascript', 'revalidate_cache' )
                );
                $dispatcher->register_action(
                    'upgrader_post_install',
                    array( 'controller.javascript', 'revalidate_cache' )
                );
                $dispatcher->register_action(
                    'activated_plugin',
                    array( 'controller.javascript-widget', 'revalidate_cache' )
                );
                $dispatcher->register_action(
                    'deactivated_plugin',
                    array( 'controller.javascript-widget', 'revalidate_cache' )
                );
                $dispatcher->register_action(
                    'upgrader_post_install',
                    array( 'controller.javascript-widget', 'revalidate_cache' )
                );

            }
            // Widget Creator
            $dispatcher->register_action(
                'admin_enqueue_scripts',
                array( 'css.admin', 'admin_enqueue_scripts' )
            );
            $dispatcher->register_action(
                'current_screen',
                array( 'view.admin.widget-creator', 'add_meta_box' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.widget-creator', 'add_page' )
            );
            $dispatcher->register_filter(
                'pre_set_site_transient_update_plugins',
                array( 'calendar.updates', 'check_updates' )
            );
            $dispatcher->register_filter(
                'plugins_api',
                array( 'calendar.updates', 'plugins_api_filter' ),
                10,
                3
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.tickets', 'add_page' )
            );
            $dispatcher->register_action(
                'admin_menu',
                array( 'view.admin.activate', 'add_page' )
            );
        } else { // ! is_admin()
            $dispatcher->register_action(
                'after_setup_theme',
                array( 'theme.loader', 'execute_theme_functions' )
            );
            $dispatcher->register_action(
                'the_post',
                array( 'post.content', 'check_content' ),
                PHP_INT_MAX
            );
            $dispatcher->register_action(
                'send_headers',
                array( 'request.redirect', 'handle_categories_and_tags' )
            );
            $dispatcher->register_action(
                'wp_head',
                array( 'view.event.single', 'add_meta_tags' )
            );
        }
    }
    /**
     * Outputs menu icon between head tags
     */
    public function admin_head() {
        global $wp_version;
        $argv = array(
            'before_font_icons'    => version_compare( $wp_version, '3.8', '<' ),
            'admin_theme_img_url'  => AI1EC_ADMIN_THEME_IMG_URL,
            'admin_theme_font_url' => AI1EC_ADMIN_THEME_FONT_URL,
        );
        $this->_registry->get( 'theme.loader' )
            ->get_file( 'timely-menu-icon.twig', $argv, true )
            ->render();
    }

    /**
     * _add_defaults method
     *
     * Add (merge) default options to given query variable.
     *
     * @param string settingsquery variable to ammend
     *
     * @return string|NULL Modified variable values or NULL on failure
     *
     * @global    Ai1ec_Settings $ai1ec_settings Instance of settings object
     *                                           to pull data from
     * @staticvar array          $mapper         Mapping of query names to
     *                                           default in settings
     */
    protected function _add_defaults( $name ) {
        $settings = $this->_registry->get( 'model.settings' );
        static $mapper = array(
            'cat' => 'categories',
            'tag' => 'tags',
        );
        $rq_name = 'ai1ec_' . $name . '_ids';
        if (
            ! isset( $mapper[$name] ) ||
            ! is_array( $this->_request ) ||
            ! array_key_exists( $rq_name, $this->_request )
        ) {
            return NULL;
        }
        $options  = explode( ',', $this->_request[$rq_name] );
        $property = 'default_' . $mapper[$name];
        $options  = array_merge(
            $options,
            $settings->get( $property )
        );
        $filtered = array();
        foreach ( $options as $item ) { // avoid array_filter + is_numeric
            $item = (int)$item;
            if ( $item > 0 ) {
                $filtered[] = $item;
            }
        }
        unset( $options );
        if ( empty( $filtered ) ) {
            return NULL;
        }
        return implode( ',', $filtered );
    }

    /**
     * Process_request function.
     *
     * Initialize/validate custom request array, based on contents of $_REQUEST,
     * to keep track of this component's request variables.
     *
     * @return void
     **/
    protected function _process_request() {
        $settings       = $this->_registry->get( 'model.settings' );
        $this->_request = $this->_registry->get( 'http.request.parser' );
        $aco            = $this->_registry->get( 'acl.aco' );
        $page_id        = $settings->get( 'calendar_page_id' );
        if (
            ! $aco->is_admin() &&
            $page_id &&
            is_page( $page_id )
        ) {
            foreach ( array( 'cat', 'tag' ) as $name ) {
                $implosion = $this->_add_defaults( $name );
                if ( $implosion ) {
                    $this->request['ai1ec_' . $name . '_ids'] = $implosion;
                    $_REQUEST['ai1ec_' . $name . '_ids']      = $implosion;
                }
            }
        }
    }

    /**
     * Initialize cron functions.
     *
     * @throws Ai1ec_Scheduling_Exception
     *
     * @return void
     */
    protected function _install_crons() {
        $scheduling = $this->_registry->get( 'scheduling.utility' );
        $hook_name  = 'ai1ec_n_cron';
        $scheduling->delete( $hook_name );
    }

    /**
     * Initialize the registry object.
     *
     * @param Ai1ec_Loader $ai1ec_loader Instance of Ai1EC classes loader
     *
     * @return void Method does not return
     */
    protected function _initialize_registry( $ai1ec_loader ) {
        global $ai1ec_registry;
        $this->_registry = new Ai1ec_Registry_Object( $ai1ec_loader );
        Ai1ec_Time_Utility::set_registry( $this->_registry );
        $ai1ec_registry  = $this->_registry;
    }

    /**
     * Loads the CSS for the plugin
     *
     */
    protected function _load_css_if_needed() {
        // ==================================
        // = Add the hook to render the css =
        // ==================================
        if ( isset( $_GET[Ai1ec_Css_Frontend::QUERY_STRING_PARAM] ) ) {
            // we need to wait for the extension to be registered if the css
            // needs to be compiled. Will find a better way when compiling css.
            $css_controller = $this->_registry->get( 'css.frontend' );
            add_action( 'plugins_loaded', array( $css_controller, 'render_css' ), 2 );
        }
    }

    /**
     * Load the texdomain for the plugin.
     *
     * @wp_hook plugins_loaded
     *
     * @return void
     */
    public function load_textdomain() {
        if ( false === $this->_domain_loaded ) {
            load_plugin_textdomain(
                AI1EC_PLUGIN_NAME, false, AI1EC_LANGUAGE_PATH
            );
            $this->_domain_loaded = true;
        }
    }

    /**
     * Check if the schema is up to date.
     *
     * @throws Ai1ec_Database_Schema_Exception
     * @throws Ai1ec_Database_Update_Exception
     *
     * @return void
     */
    protected function _initialize_schema() {
        $option     = $this->_registry->get( 'model.option' );
        $schema_sql = $this->get_current_db_schema();
        $version    = sha1( $schema_sql );
        // If existing DB version is not consistent with current plugin's version,
        // or does not exist, then create/update table structure using dbDelta().
        if ( $option->get( 'ai1ec_db_version' ) != $version ) {

            $errors = $this->_registry->get( 'database.applicator' )
                ->check_db_consistency_for_date_migration() ;
            if ( ! empty( $errors ) ) {
                $message = Ai1ec_I18n::__(
                    'Your database is found to be corrupt. Likely previous update has failed. Please restore All-in-One Event Calendar tables from a backup and retry.<br>Following errors were found:<br>%s'
                );
                $message = sprintf( $message, implode( $errors, '<br>' ) );
                throw new Ai1ec_Database_Update_Exception( $message );
            }
            $this->_registry->get( 'database.applicator' )
                ->remove_instance_duplicates();

            if (
                apply_filters( 'ai1ec_perform_scheme_update', true ) &&
                $this->_registry->get( 'database.helper' )->apply_delta(
                    $schema_sql
                )
            ) {
                $option->set( 'ai1ec_db_version', $version );
            } else {
                throw new Ai1ec_Database_Update_Exception();
            }

            // If the schema structure upgrade is complete move contents
            $categories_key = 'ai1ec_category_meta_ported';
            if ( ! $option->get( $categories_key ) ) {
                $this->_migrate_categories_meta();
                $option->set( $categories_key, true );
            }
        }
    }

    /**
     * Transform categories meta information.
     *
     * Use new `meta` table instead of legacy `colors` table.
     *
     * @return void Method does not return.
     */
    protected  function _migrate_categories_meta() {
        $db         = $this->_registry->get( 'dbi.dbi' );
        $table_name = $db->get_table_name( 'ai1ec_event_category_colors' );
        $db_h       = $this->_registry->get( 'database.helper' );
        if ( $db_h->table_exists( $table_name ) ) { // if old table exists otherwise ignore it
            // Migrate color information
            $dest_table = $db->get_table_name( 'ai1ec_event_category_meta' );
            $colors     = $db->select(
                $table_name,
                array( 'term_id', 'term_color'),
                ARRAY_A
            );
            if ( ! empty( $colors ) ) {
                foreach ( $colors as $color ) {
                    $db->insert( $dest_table, $color );
                }
            }
            // Drop the old table
            $db->query( 'DROP TABLE IF EXISTS ' . $table_name );
        }
    }

    /**
     * Procedures to take when upgrading plugin version
     *
     * @return void
     */
    protected function _plugin_upgrade_procedures() {
        $option     = $this->_registry->get( 'model.option' );
        $version    = AI1EC_VERSION;

        if ( $option->get( 'ai1ec_version' ) != $version ) {
            try {
                // Force regeneration of JS cache
                $this->_registry->get( 'controller.javascript' )->revalidate_cache();
                $this->_registry->get( 'controller.javascript-widget' )->revalidate_cache();

                // Run upgrade commands
                $settings = $this->_registry->get( 'model.settings' );
                $settings->perform_upgrade_actions();
            } catch ( Exception $e ) {
            }

            // Update plugin version
            $option->set( 'ai1ec_version', $version );
        }
    }

    /**
     * Get current database schema as a multi SQL statement.
     *
     * @return string Multiline SQL statement.
     */
    public function get_current_db_schema() {
        $dbi = $this->_registry->get( 'dbi.dbi' );
        // =======================
        // = Create table events =
        // =======================
        $table_name = $dbi->get_table_name( 'ai1ec_events' );
        $sql = "CREATE TABLE $table_name (
                post_id bigint(20) NOT NULL,
                start int(10) UNSIGNED NOT NULL,
                end int(10) UNSIGNED,
                timezone_name varchar(50),
                allday tinyint(1) NOT NULL,
                instant_event tinyint(1) NOT NULL DEFAULT 0,
                recurrence_rules longtext,
                exception_rules longtext,
                recurrence_dates longtext,
                exception_dates longtext,
                venue varchar(255),
                country varchar(255),
                address varchar(255),
                city varchar(255),
                province varchar(255),
                postal_code varchar(32),
                show_map tinyint(1),
                contact_name varchar(255),
                contact_phone varchar(32),
                contact_email varchar(128),
                contact_url varchar(255),
                cost varchar(255),
                ticket_url varchar(255),
                ical_feed_url varchar(255),
                ical_source_url varchar(255),
                ical_organizer varchar(255),
                ical_contact varchar(255),
                ical_uid varchar(255),
                show_coordinates tinyint(1),
                latitude decimal(20,15),
                longitude decimal(20,15),
                force_regenerate tinyint(1) NOT NULL DEFAULT 0,
                PRIMARY KEY  (post_id),
                KEY feed_source (ical_feed_url)
                ) CHARACTER SET utf8;";

        // ==========================
        // = Create table instances =
        // ==========================
        $table_name = $dbi->get_table_name( 'ai1ec_event_instances' );
        $sql .= "CREATE TABLE $table_name (
                id bigint(20) NOT NULL AUTO_INCREMENT,
                post_id bigint(20) NOT NULL,
                start int(10) UNSIGNED NOT NULL,
                end int(10) UNSIGNED NOT NULL,
                PRIMARY KEY  (id),
                UNIQUE KEY evt_instance (post_id,start)
                ) CHARACTER SET utf8;";

        // ================================
        // = Create table category colors =
        // ================================
        $table_name = $dbi->get_table_name( 'ai1ec_event_category_meta' );
        $sql .= "CREATE TABLE $table_name (
            term_id bigint(20) NOT NULL,
            term_color varchar(255) NOT NULL,
            term_image varchar(254) NULL DEFAULT NULL,
            PRIMARY KEY  (term_id)
            ) CHARACTER SET utf8;";

        return $sql;
    }
}


==================================================
FILE PATH: ./app/controller/calendar-feeds.php
==================================================
<?php

/**
 * Feeds (import and export streams) mediator.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Controller
 */
class Ai1ec_Controller_Calendar_Feeds extends Ai1ec_Base {

    /**
     * @var array Holds the instances of registered plugins.
     */
    protected $_plugins = array();

    /**
     * Add plugin to the internal array.
     *
     * This assure us that the plugins extends our base abstract class.
     *
     * @param Ai1ec_Connector_Plugin $plugin Plugin to add.
     *
     * @return void
     */
    public function add_plugin( Ai1ec_Connector_Plugin $plugin ) {
        $plugin->initialize_settings_if_not_set();
        $this->_plugins[] = $plugin;
    }

    /**
     * Get an instance of a plugin class
     *
     * @param string $class
     * @throws Exception
     * @return Ai1ec_Connector_Plugin
     */
    public function get_plugin_instance( $class ) {
        foreach ( $this->_plugins as $plugin ) {
            if( get_class( $plugin ) === $class ) {
                return $plugin;
            }
        }
        throw new Exception( "Class not found" );
    }

    /**
     * Give the plugins the possibility to handle data posted in the calendar feeds page
     *
     * @return void
     */
    public function handle_feeds_page_post() {
        // Iterate over the plugins and call the methods
        foreach ( $this->_plugins as $plugin ) {
            $plugin->handle_feeds_page_post();
        }
    }

    /**
     * Render the tab header for each plugin
     *
     * @param $active_feed
     *   The tab that should be visualized
     */
    public function render_tab_headers() {
        foreach ( $this->_plugins as $plugin ) {
            $plugin->render_tab_header();
        }
    }
    /**
     * Render the tab body for each plugin
     *
     * @param $active_feed
     *   The tab that should be visualized
     */
    public function render_tab_contents() {
        foreach ( $this->_plugins as $plugin ) {
            $plugin->render_tab_content();
        }
    }

}

==================================================
FILE PATH: ./app/model/settings/exception.php
==================================================
<?php

/**
 * Exception occuring during settings modification.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Html
 */
class Ai1ec_Settings_Exception extends Ai1ec_Exception {
}

==================================================
FILE PATH: ./app/model/event.php
==================================================
<?php

/**
 * Model representing an event or an event instance.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @instantiator Ai1ec_Factory_Event.create_event_instance
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */
class Ai1ec_Event extends Ai1ec_Base {

    /**
     * @var Ai1ec_Event_Entity Data store object reference.
     */
    protected $_entity    = null;

    /**
     * @var array Map of fields that require special care during set/get
     *            operations. Values have following meanings:
     *            [0]  - both way care required;
     *            [1]  - only `set` operations require care;
     *            [-1] - only `get` (for storage) operations require care.
     */
    protected $_swizzable = array(
        'cost'             => 0,
        'start'            => -1,
        'end'              => -1,
        'timezone_name'    => -1,
        'recurrence_dates' => 1,
        'exception_dates'  => 1,
    );

    /**
     * @var array Runtime properties
     */
    protected $_runtime_props = array();

    /**
     * @var bool|null Boolean cache-definition indicating if event is multiday.
     */
    protected $_is_multiday = null;

    /**
     * Wrapper to get property value.
     *
     * @param string $property Name of property to get.
     * @param mixed  $default  Default value to return.
     *
     * @return mixed Actual property.
     */
    public function get( $property, $default = null ) {
        return $this->_entity->get( $property, $default );
    }

    /**
     * Get properties generated at runtime
     *
     * @param string $property
     *
     * @return string
     */
    public function get_runtime( $property, $default = '' ) {
        return isset( $this->_runtime_props[$property] ) ?
            $this->_runtime_props[$property] :
            $default;
    }

    /**
     * Set properties generated at runtime
     *
     * @param string $property
     * @param string $value
     */
    public function set_runtime( $property, $value ) {
        $this->_runtime_props[$property] = $value;
    }

    /**
     * Handle property initiation.
     *
     * Decides, how to extract value stored in permanent storage.
     *
     * @param string $property Name of property to handle
     * @param mixed  $value    Value, read from permanent storage
     *
     * @return bool Success
     */
    public function set( $property, $value ) {
        if (
            isset( $this->_swizzable[$property] ) &&
            $this->_swizzable[$property] >= 0
        ) {
            $method = '_handle_property_construct_' . $property;
            $value  = $this->{$method}( $value );
        }
        $this->_entity->set( $property, $value );
        return $this;
    }

    /**
     * Set the event is all day, during the specified number of days
     *
     * @param number $length
     */
    public function set_all_day( $length = 1 ) {
        // set allday as true
        $this->set( 'allday', true );
        $start = $this->get( 'start' );
        // reset time component
        $start->set_time( 0, 0, 0 );
        $end = $this->_registry->get( 'date.time', $start );
        // set the correct length
        $end->adjust_day( $length );
        $this->set( 'end', $end );
    }

    /**
     * Set the event as if it has no end time
     */
    public function set_no_end_time() {
        $this->set( 'instant_event', true );
        $start = $this->get( 'start' );
        $end   = $this->_registry->get( 'date.time', $start );
        $end->set_time(
            $start->format( 'H' ),
            $start->format( 'i' ) + 15,
            $start->format( 's' )
        );
        $this->set( 'end', $end );
    }

    /**
     * Set object fields from arbitrary array.
     *
     * @param array $data Supposedly map of fields to initiate.
     *
     * @return Ai1ec_Event Instance of self for chaining.
     */
    public function initialize_from_array( array $data ) {

        // =======================================================
        // = Assign each event field the value from the database =
        // =======================================================
        foreach ( $this->_entity->list_properties() as $property ) {
            if ( 'post' !== $property && isset( $data[$property] ) ) {
                $this->set( $property, $data[$property] );
                unset( $data[$property] );
            }
        }
        if ( isset( $data['post'] ) ) {
            $this->set( 'post', (object)$data['post'] );
        } else {
            // ========================================
            // = Remaining fields are the post fields =
            // ========================================
            $this->set( 'post', (object)$data );
        }
        return $this;
    }

    /**
     * Delete the events from all tables
     */
    public function delete() {
        // delete post (this will trigger deletion of cached events, and
        // remove the event from events table)
        wp_delete_post( $this->get( 'post_id' ), true );
    }

    /**
     * Initialize object from ID.
     *
     * Attempts to retrieve entity from database and if succeeds - uses
     * {@see self::initialize_from_array} to initiate actual values.
     *
     * @param int      $post_id  ID of post (event) to initiate.
     * @param int|bool $instance ID of event instance, false for base event.
     *
     * @return Ai1ec_Event Instance of self for chaining.
     *
     * @throws Ai1ec_Event_Not_Found_Exception If entity is not locatable.
     */
    public function initialize_from_id( $post_id, $instance = false ) {
        $post = get_post( $post_id );
        if ( ! $post || $post->post_status == 'auto-draft' ) {
            throw new Ai1ec_Event_Not_Found_Exception(
                'Post with ID \'' . $post_id .
                '\' could not be retrieved from the database.'
            );
        }
        $post_id = (int)$post_id;
        $dbi     = $this->_registry->get( 'dbi.dbi' );

        $left_join  = '';
        $select_sql = '
            e.post_id,
            e.timezone_name,
            e.recurrence_rules,
            e.exception_rules,
            e.allday,
            e.instant_event,
            e.recurrence_dates,
            e.exception_dates,
            e.venue,
            e.country,
            e.address,
            e.city,
            e.province,
            e.postal_code,
            e.show_map,
            e.contact_name,
            e.contact_phone,
            e.contact_email,
            e.contact_url,
            e.cost,
            e.ticket_url,
            e.ical_feed_url,
            e.ical_source_url,
            e.ical_organizer,
            e.ical_contact,
            e.ical_uid,
            e.longitude,
            e.latitude,
            e.show_coordinates,
            GROUP_CONCAT( ttc.term_id ) AS categories,
            GROUP_CONCAT( ttt.term_id ) AS tags
        ';

        if (
            false !== $instance &&
            is_numeric( $instance ) &&
            $instance > 0
        ) {
            $select_sql .= ', IF( aei.start IS NOT NULL, aei.start, e.start ) as start,' .
                           '  IF( aei.start IS NOT NULL, aei.end,   e.end )   as end ';

            $instance = (int)$instance;
            $this->set( 'instance_id', $instance );
            $left_join = 'LEFT JOIN ' . $dbi->get_table_name( 'ai1ec_event_instances' ) .
                ' aei ON aei.id = ' . $instance . ' AND e.post_id = aei.post_id ';
        } else {
            $select_sql .= ', e.start as start, e.end as end, e.allday ';
            if ( -1 === (int)$instance ) {
                $select_sql .= ', aei.id as instance_id ';
                $left_join   = 'LEFT JOIN ' .
                    $dbi->get_table_name( 'ai1ec_event_instances' ) .
                    ' aei ON e.post_id = aei.post_id ' .
                    'AND e.start = aei.start AND e.end = aei.end ';
            }
        }

        // =============================
        // = Fetch event from database =
        // =============================
        $query = 'SELECT ' . $select_sql . '
            FROM ' . $dbi->get_table_name( 'ai1ec_events' ) . ' e
                LEFT JOIN ' .
                    $dbi->get_table_name( 'term_relationships' ) . ' tr
                    ON ( e.post_id = tr.object_id )
                LEFT JOIN ' . $dbi->get_table_name( 'term_taxonomy' ) . ' ttc
                    ON (
                        tr.term_taxonomy_id = ttc.term_taxonomy_id AND
                        ttc.taxonomy = \'events_categories\'
                    )
                LEFT JOIN ' . $dbi->get_table_name( 'term_taxonomy' ) . ' ttt
                    ON (
                        tr.term_taxonomy_id = ttt.term_taxonomy_id AND
                        ttt.taxonomy = \'events_tags\'
                    )
                ' . $left_join . '
            WHERE e.post_id = ' . $post_id . '
            GROUP BY e.post_id';

        $event = $dbi->get_row( $query, ARRAY_A );
        if ( null === $event || null === $event['post_id'] ) {
            throw new Ai1ec_Event_Not_Found_Exception(
                'Event with ID \'' . $post_id .
                '\' could not be retrieved from the database.'
            );
        }

        $event['post'] = $post;
        return $this->initialize_from_array( $event );
    }

    public function getenddate() {
        $end = $this->get( 'end' );
        if ( $this->is_allday() ) {
            $end->set_time(
                $end->format( 'H' ),
                $end->format( 'i' ),
                $end->format( 's' ) - 1
            );
        }
        return $end;
    }
    /**
     * Returns enddate specific info.
     *
     * @return array Date info structure.
     */
    public function getenddate_info() {
        $end = $this->getenddate();
        return array(
            'month'   => $this->get( 'end' )->format_i18n( 'M' ),
            'day'     => $this->get( 'end' )->format_i18n( 'j' ),
            'weekday' => $this->get( 'end' )->format_i18n( 'D' ),
            'year'    => $this->get( 'end' )->format_i18n( 'Y' ),
        );
    }

    /**
     * Create new event object, using provided data for initialization.
     *
     * @param Ai1ec_Registry_Object $registry  Injected object registry.
     * @param int|array|null        $data      Look up post with id $data, or
     *                                         initialize fields with associative
     *                                         array $data containing both post
     *                                         and event fields.
     * @param int|bool              $instance  Optionally instance ID. When ID
     *                                         value is -1 then it is
     *                                         retrieved from db.
     *
     * @throws Ai1ec_Invalid_Argument_Exception When $data is not one
     *                                          of int|array|null.
     * @throws Ai1ec_Event_Not_Found_Exception  When $data relates to
     *                                          non-existent ID.
     *
     */
    function __construct(
        Ai1ec_Registry_Object $registry,
        $data     = null,
        $instance = false
    ) {
        parent::__construct( $registry );
        $this->_entity = $this->_registry->get( 'model.event.entity' );
        if ( null === $data ) {
            return; // empty object
        } else if ( is_numeric( $data ) ) {
            $this->initialize_from_id( $data, $instance );
        } else if ( is_array( $data ) ) {
            $this->initialize_from_array( $data );
        } else {
            throw new Ai1ec_Invalid_Argument_Exception(
                'Argument to constructor must be integer, array or null' .
                ', not ' . var_export( $data, true )
            );
        }

        if ( $this->is_allday() ) {
            try {
                $timezone = $this->_registry->get( 'date.timezone' )
                    ->get( $this->get( 'timezone_name' ) );
                $this->_entity->set_preferred_timezone( $timezone );
            } catch ( Exception $excpt ) {
                //  ignore
            }
        }
    }

    /**
     * Twig method for retrieving avatar.
     *
     * @param  bool   $wrap_permalink Whether to wrap avatar in <a> element or not
     *
     * @return string Avatar markup
     */
    public function getavatar( $wrap_permalink = true ) {
        return $this->_registry->
            get( 'view.event.avatar' )->get_event_avatar(
                $this,
                $this->_registry->get( 'view.calendar.fallbacks' )->get_all(),
                '',
                $wrap_permalink
            );
    }

    /**
     * Returns whether Event has geo information.
     *
     * @return bool True or false.
     */
    public function has_geoinformation() {
        $latitude  = floatval( $this->get( 'latitude') );
        $longitude = floatval( $this->get( 'longitude' ) );
        return (
            (
                $latitude >= 0.000000000000001 ||
                $latitude <= -0.000000000000001
            ) &&
            (
                $longitude >= 0.000000000000001 ||
                $longitude <= -0.000000000000001
            )
        );
    }

    protected function _handle_property_construct_recurrence_dates( $value ) {
        if ( $value ) {
            $this->_entity->set( 'recurrence_rules', 'RDATE=' . $value );
        }
        return $value;
    }

    protected function _handle_property_construct_exception_dates( $value ) {
        if ( $value ) {
            $this->_entity->set( 'exception_rules', 'EXDATE=' . $value );
        }
        return $value;
    }

    /**
     * Handle `cost` value reading from permanent storage.
     *
     * @param string $value Value stored in permanent storage
     *
     * @return bool Success: true, always
     */
    protected function _handle_property_construct_cost( $value ) {
        $test_value = false;
        if (
            isset( $value[1] ) && (
                ':' === $value[1] || ';' === $value[1]
            )
        ) {
            $test_value = unserialize( $value );
        }
        $cost = $is_free = NULL;
        if ( false === $test_value ) {
            $cost    = trim( $value );
            $is_free = false;
        } else {
            extract( $test_value, EXTR_IF_EXISTS );
        }
        $this->_entity->set( 'is_free', (bool)$is_free );
        return (string)$cost;
    }

    public function get_uid_pattern() {
        static $format = null;
        if ( null === $format ) {
            $site_url = parse_url( ai1ec_get_site_url() );
            $format   = 'ai1ec-%d@' . $site_url['host'];
            if ( isset( $site_url['path'] ) ) {
                $format .= $site_url['path'];
            }
        }
        return $format;
    }

    /**
     * Get UID to be used for current event.
     *
     * The generated format is cached in static variable within this function
     * to re-use when generating UIDs for different entries.
     *
     * @return string Generated UID.
     *
     * @staticvar string $format Cached format.
     */
    public function get_uid() {
        $ical_uid = $this->get( 'ical_uid' );
        if ( ! empty( $ical_uid ) ) {
            return $ical_uid;
        }
        return sprintf( $this->get_uid_pattern(), $this->get( 'post_id' ) );
    }

    /**
     * Check if event is free.
     *
     * @return bool Free status.
     */
    public function is_free() {
        return (bool)$this->get( 'is_free' );
    }

    /**
     * Check if event is taking all day.
     *
     * @return bool True for all-day long events.
     */
    public function is_allday() {
        return (bool)$this->get( 'allday' );
    }

    /**
     * Check if event has virtually no time.
     *
     * @return bool True for instant events.
     */
    public function is_instant() {
        return (bool)$this->get( 'instant_event' );
    }

    /**
     * Check if event is taking multiple days.
     *
     * Uses object-wide variable {@see self::$_is_multiday} to store
     * calculated value after first call.
     *
     * @return bool True for multiday events.
     */
    public function is_multiday() {
        if ( null === $this->_is_multiday ) {
            $start = $this->get( 'start' );
            $end   = $this->get( 'end' );
            $diff  = $end->diff_sec( $start );
            $this->_is_multiday = $diff > 86400 &&
                $start->format( 'Y-m-d' ) !== $end->format( 'Y-m-d' );
        }
        return $this->_is_multiday;
    }

    /**
     * Get the duration of the event
     *
     * @return number
     */
    public function get_duration() {
        $duration = $this->get_runtime( 'duration', null );
        if ( null === $duration ) {
            $duration = $this->get( 'end' )->format() -
                $this->get( 'start' )->format();
            $this->set_runtime( 'duration', $duration );
        }
        return $duration;
    }

    /**
     * Create/update entity representation.
     *
     * Saves the current event data to the database. If $this->post_id exists,
     * but $update is false, creates a new record in the ai1ec_events table of
     * this event data, but does not try to create a new post. Else if $update
     * is true, updates existing event record. If $this->post_id is empty,
     * creates a new post AND record in the ai1ec_events table for this event.
     *
     * @param  bool  $update  Whether to update an existing event or create a
     *                        new one
     * @param  bool  $backward_compatibility The (wpdb) ofr the new wordpress 4.4
     * now inserts NULL as null values. The previous version, if you insert a NULL
     * value in an int value, the values saved would be 0 instead of null.
     * @return int            The post_id of the new or existing event.
     */
    function save( $update = false, $backward_compatibility = true ) {
        do_action( 'ai1ec_pre_save_event', $this, $update );
        if ( ! $update ) {
            $response = apply_filters( 'ai1ec_event_save_new', $this );
            if ( is_wp_error( $response ) ) {
                throw new Ai1ec_Event_Create_Exception(
                    'Failed to create event: ' . $response->get_error_message()
                );
            }
        }

        $dbi        = $this->_registry->get( 'dbi.dbi' );
        $columns    = $this->prepare_store_entity();
        $format     = $this->prepare_store_format( $columns, $backward_compatibility );
        $table_name = $dbi->get_table_name( 'ai1ec_events' );
        $post_id    = $columns['post_id'];

        if ( $this->get( 'end' )->is_empty() ) {
            $this->set_no_end_time();
        }
        if ( $post_id ) {
            $success = false;
            if ( ! $update ) {
                $success = $dbi->insert(
                    $table_name,
                    $columns,
                    $format
                );
            } else {
                $success = $dbi->update(
                    $table_name,
                    $columns,
                    array( 'post_id' => $columns['post_id'] ),
                    $format,
                    array( '%d' )
                );
            }
            if ( false === $success ) {
                return false;
            }

        } else {
            // ===================
            // = Insert new post =
            // ===================
            $post_id = wp_insert_post( $this->get( 'post' ), false );
            if ( 0 === $post_id ) {
                return false;
            }
            $this->set( 'post_id', $post_id );
            $columns['post_id'] = $post_id;

            // =========================
            // = Insert new event data =
            // =========================
            if ( false === $dbi->insert( $table_name, $columns, $format ) ) {
                return false;
            }
        }

        $taxonomy = $this->_registry->get(
            'model.event.taxonomy',
            $post_id
        );
        $cats = $this->get( 'categories' );
        if (
            is_array( $cats ) &&
            ! empty( $cats )
        ) {
            $taxonomy->set_categories( $cats );
        }
        $tags = $this->get( 'tags' );
        if (
            is_array( $tags ) &&
            ! empty( $tags )
        ) {
            $taxonomy->set_tags( $tags );
        }

        if (
            $feed = $this->get( 'feed' ) &&
            isset( $feed->feed_id )
        ) {
            $taxonomy->set_feed( $feed );
        }

        // give other plugins / extensions the ability to do things
        // when saving, like fetching authors which i removed as it's not core.
        do_action( 'ai1ec_save_event' );

        $instance_model = $this->_registry->get( 'model.event.instance' );
        $instance_model->recreate( $this );

        do_action( 'ai1ec_event_saved', $post_id, $this, $update );
        return $post_id;
    }

    /**
     * Prepare fields format flags to use in database operations.
     *
     * @param array $columns Array of columns with data to insert.
     *
     * @return array List of format flags to use in integrations with DBI.
     */
    public function prepare_store_format( array &$columns, $backward_compatibility = true ) {
        $format = array(
            '%d',  // post_id
            '%d',  // start
            '%d',  // end
            '%s',  // timezone_name
            '%d',  // allday
            '%d',  // instant_event
            '%s',  // recurrence_rules
            '%s',  // exception_rules
            '%s',  // recurrence_dates
            '%s',  // exception_dates
            '%s',  // venue
            '%s',  // country
            '%s',  // address
            '%s',  // city
            '%s',  // province
            '%s',  // postal_code
            '%d',  // show_map
            '%s',  // contact_name
            '%s',  // contact_phone
            '%s',  // contact_email
            '%s',  // contact_url
            '%s',  // cost
            '%s',  // ticket_url
            '%s',  // ical_feed_url
            '%s',  // ical_source_url
            '%s',  // ical_uid
            '%d',  // show_coordinates
            '%f',  // latitude
            '%f',  // longitude
        );

        if ( $backward_compatibility ) {
            $columns_count = count( $columns );
            if ( count( $format ) !== $columns_count ) {
                throw new Ai1ec_Event_Not_Found_Exception(
                    'Data columns count differs from format columns count'
                );
            }
            $index = 0;
            foreach ( $columns as $key => $value ) {
                if ( '%d' === $format[ $index ] ) {
                    if ( is_null( $value ) ) {
                        $columns[ $key ] = 0;
                    }
                }
                $index++;
            }
        }

        return $format;
    }

    /**
     * Prepare event entity {@see self::$_entity} for persistent storage.
     *
     * Creates an array of database fields and corresponding values.
     *
     * @return array Map of fields to store.
     */
    public function prepare_store_entity() {
        $entity = array(
            'post_id'          => $this->storage_format( 'post_id' ),
            'start'            => $this->storage_format( 'start' ),
            'end'              => $this->storage_format( 'end' ),
            'timezone_name'    => $this->storage_format( 'timezone_name' ),
            'allday'           => $this->storage_format( 'allday' ),
            'instant_event'    => $this->storage_format( 'instant_event' ),
            'recurrence_rules' => $this->storage_format( 'recurrence_rules' ),
            'exception_rules'  => $this->storage_format( 'exception_rules' ),
            'recurrence_dates' => $this->storage_format( 'recurrence_dates' ),
            'exception_dates'  => $this->storage_format( 'exception_dates' ),
            'venue'            => $this->storage_format( 'venue' ),
            'country'          => $this->storage_format( 'country' ),
            'address'          => $this->storage_format( 'address' ),
            'city'             => $this->storage_format( 'city' ),
            'province'         => $this->storage_format( 'province' ),
            'postal_code'      => $this->storage_format( 'postal_code' ),
            'show_map'         => $this->storage_format( 'show_map' ),
            'contact_name'     => $this->storage_format( 'contact_name' ),
            'contact_phone'    => $this->storage_format( 'contact_phone' ),
            'contact_email'    => $this->storage_format( 'contact_email' ),
            'contact_url'      => $this->storage_format( 'contact_url' ),
            'cost'             => $this->storage_format( 'cost' ),
            'ticket_url'       => $this->storage_format( 'ticket_url' ),
            'ical_feed_url'    => $this->storage_format( 'ical_feed_url' ),
            'ical_source_url'  => $this->storage_format( 'ical_source_url' ),
            'ical_uid'         => $this->storage_format( 'ical_uid' ),
            'show_coordinates' => $this->storage_format( 'show_coordinates' ),
            'latitude'         => $this->storage_format( 'latitude',  '' ),
            'longitude'        => $this->storage_format( 'longitude', '' ),
        );
        return $entity;
    }

    /**
     * Compact field for writing to persistent storage.
     *
     * @param string $field   Name of field to compact.
     * @param mixed  $default Default value to use for undescribed fields.
     *
     * @return mixed Value or $default.
     */
    public function storage_format( $field, $default = null ) {
        $value = $this->_entity->get( $field, $default );
        if (
            isset( $this->_swizzable[$field] ) &&
            $this->_swizzable[$field] <= 0
        ) {
            $value = $this->{ '_handle_property_destruct_' . $field }( $value );
        }
        return $value;
    }

    /**
     * Allow properties to be modified after cloning.
     *
     * @return void
     */
    public function __clone() {
        $this->_entity = clone $this->_entity;
    }

    /**
     * Decode timezone to use for event.
     *
     * Following algorythm is used to detect a value:
     *     - take value provided in input;
     *     - if empty - take value associated with start time;
     *     - if empty - take current environment timezone.
     *
     * @param string $timezone_name Timezone provided in input.
     *
     * @return string Timezone name to use for event in future.
     */
    protected function _handle_property_destruct_timezone_name(
        $timezone_name
    ) {
        if ( empty( $timezone_name ) ) {
            $timezone_name = $this->get( 'start' )->get_timezone();
            if ( empty( $timezone_name ) ) {
                $timezone_name = $this->_registry->get( 'date.timezone' )
                    ->get_default_timezone();
            }
        }
        return $timezone_name;
    }

    /**
     * Format datetime to UNIX timestamp for storage.
     *
     * @param Ai1ec_Date_Time $start Datetime object to compact.
     *
     * @return int UNIX timestamp.
     */
    protected function _handle_property_destruct_start( Ai1ec_Date_Time $start ) {
        return $start->format_to_gmt();
    }

    /**
     * Format datetime to UNIX timestamp for storage.
     *
     * @param Ai1ec_Date_Time $end Datetime object to compact.
     *
     * @return int UNIX timestamp.
     */
    protected function _handle_property_destruct_end( Ai1ec_Date_Time $end ) {
        return $end->format_to_gmt();
    }

    /**
     * Handle `cost` writing to permanent storage.
     *
     * @param string $cost Value of cost.
     *
     * @return string Serialized value to store.
     */
    protected function _handle_property_destruct_cost( $cost ) {
        $cost = array(
            'cost'    => $cost,
            'is_free' => false,
        );
        if ( $this->get( 'is_free' ) ) {
            $cost['is_free'] = true;
        }
        return serialize( $cost );
    }

    /**
     * Get the submitter information array
     * @return array (
     *    is_organizer => 1 if the organizer is the submitter,
     *    email => if is_organizer is 0, them this property has the email of the submitter,
     *    name => if is_organizer is 0, them this property has the name of the submitter
     * )
     */
    public function get_submitter_info() {
        $post_id        = $this->get( 'post_id' );
        if ( empty( $post_id ) ) {
            return null;
        }
        $submitter_info = get_post_meta(
            $post_id,
            '_submitter_info',
            true
        );
        if ( false == ai1ec_is_blank( $submitter_info ) ) {
            $submitter_info = json_decode( $submitter_info, true );
            if ( is_array( $submitter_info ) ) {
                return $submitter_info;
            }
        }
        return null;
    }

    /**
     * Save the submitter information into post metadata
     */
    public function save_submitter_info( $is_submitter, $submitter_email, $submitter_name ) {
        $post_id        = $this->get( 'post_id' );
        if ( empty( $post_id ) ) {
            throw new Exception( 'Post id empty' );
        }
        $save = false;
        if ( 1 === intval( $is_submitter ) ) {
            $submitter_info['is_organizer'] = 1;
            if ( false === ai1ec_is_blank( $this->get( 'contact_email' ) ) ) {
                $save = true;
            }
        } else {
            $submitter_info['is_organizer'] = 0;
            if ( false === ai1ec_is_blank( $submitter_email ) ) {
                $submitter_info['email'] = trim( $submitter_email );
                $submitter_info['name']  = trim( $submitter_name );
                $save                    = true;
            }
        }
        if ( $save ) {
            update_post_meta( $post_id, '_submitter_info', json_encode( $submitter_info ) );
        }
    }

}


==================================================
FILE PATH: ./app/model/app.php
==================================================
<?php

/**
 * Base application model.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_App extends Ai1ec_Base {

    /**
     * Initiate base objects.
     *
     * @param Ai1ec_Registry_Object $registry
     * @internal param \Ai1ec_Registry_Object $system Injectable system object.
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $this->_initialize();
    }

    /**
     * Post construction routine.
     *
     * Override this method to perform post-construction tasks.
     *
     * @return void Return from this method is ignored.
     */
    protected function _initialize() {}


}

==================================================
FILE PATH: ./app/model/option.php
==================================================
<?php

/**
 * Options management class.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Option extends Ai1ec_App {

    /**
     * @var Ai1ec_Cache_Memory In-memory cache storage engine for fast access.
     */
    protected $_cache = null;

    /**
     * @var Ai1ec_Registry_Object instance of the registry object.
     */
    protected $_registry;

    /**
     * Add cache instance to object scope.
     *
     * @param Ai1ec_Registry_Object $registry Registry object.
     *
     * @return Ai1ec_Option
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        $this->_registry = $registry;
        $this->_cache    = $registry->get( 'cache.memory' );
    }

    /**
     * Create an option if it does not exist.
     *
     * @param string $name     Key to put value under.
     * @param mixed  $value    Value to put to storage.
     * @param bool   $autoload Set to true to load on start.
     *
     * @return bool Success.
     */
    public function add( $name, $value, $autoload = false ) {
        $autoload = $this->_parse_autoload( $autoload );
        if ( ! add_option( $name, $value, '', $autoload ) ) {
            return false;
        }
        $this->_cache->set( $name, $value );
        return true;
    }

    /**
     * Create an option if it does not exist, or update existing.
     *
     * @param string $name     Key to put value under.
     * @param mixed  $value    Value to put to storage.
     * @param bool   $autoload Set to true to load on start.
     *
     * @return bool Success.
     */
    public function set( $name, $value, $autoload = false ) {
        $comparator = "\0t\0";
        if ( $this->get( $name, $comparator ) === $comparator ) {
            return $this->add( $name, $value, $autoload );
        }
        if ( ! update_option( $name, $value ) ) {
            return false;
        }
        $this->_cache->set( $name, $value );
        return true;
    }

    /**
     * Get a value from storage.
     *
     * @param string $name    Key to retrieve.
     * @param mixed  $default Value to return if key was not set previously.
     *
     * @return mixed Value from storage or {$default}.
     */
    public function get( $name, $default = null ) {
        $value = $this->_cache->get( $name, $default );
        if ( $default === $value ) {
            $value = get_option( $name, $default );
            $this->_cache->set( $name, $value );
        }
        return $value;
    }

    /**
     * Delete value from storage.
     *
     * @param string $name Key to delete.
     *
     * @wp_hook deleted_option Fire after deletion.
     *
     * @return bool Success.
     */
    public function delete( $name ) {
        $this->_cache->delete( $name );
        if ( 'deleted_option' === current_filter() ) {
            return true; // avoid loops
        }
        return delete_option( $name );
    }


    /**
     * Convert autoload flag input to value recognized by WordPress.
     *
     * @param bool $input Autoload flag value.
     *
     * @return string Autoload identifier.
     */
    protected function _parse_autoload( $input ) {
        return $input ? 'yes' : 'no';
    }

}


==================================================
FILE PATH: ./app/model/settings.php
==================================================
<?php

/**
 * Model used for storing/retrieving plugin options.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Settings extends Ai1ec_App {

    /**
     * @constant string Name of WordPress options key used to store settings.
     */
    const WP_OPTION_KEY          = 'ai1ec_settings';

    /**
     * @var array Map of value names and their representations.
     */
    protected $_options          = array();

    /**
     * @var bool Indicator for modified object state.
     */
    protected $_updated          = false;

    /**
     * @var array The core options of the plugin.
     */
    protected $_standard_options;

    /**
     * Register new option to be used.
     *
     * @param string $option   Name of option.
     * @param mixed  $value    The value.
     * @param string $type     Option type to be used for validation.
     * @param string $renderer Name of class to render the option.
     *
     * @return Ai1ec_Settings Instance of self for chaining.
     */
    public function register(
        $option,
        $value,
        $type,
        $renderer,
        $version = '2.0.0'
    ) {

        if ( 'deprecated' === $type ) {
            unset( $this->_options[$option] );
        } else if (
            ! isset( $this->_options[$option] ) ||
            ! isset( $this->_options[$option]['version'] ) ||
            (string)$this->_options[$option]['version'] !== (string)$version ||
            (
                isset( $renderer['label'] ) &&
                isset( $this->_options[$option]['renderer'] ) &&
                (string)$this->_options[$option]['renderer']['label'] !== (string)$renderer['label']
            ) ||
            (
                isset( $renderer['help'] ) &&
                ( ! isset( $this->_options[$option]['renderer']['help'] ) || // handle the case when you are adding help
                (string)$this->_options[$option]['renderer']['help'] !== (string)$renderer['help'] )
            )
        ) {
            $this->_options[$option] = array(
                'value'    => ( isset( $this->_options[$option] ) )
                    ? $this->_options[$option]['value']
                    : $value,
                'type'     => $type,
                'legacy'   => false,
                'version'  => $version,
            );
            if ( null !== $renderer ) {
                $this->_options[$option]['renderer'] = $renderer;
            }
        }
        return $this;
    }

    /**
     * Gets the options.
     *
     * @return array:
     */
    public function get_options() {
        return $this->_options;
    }

    /**
     * Get field options as registered.
     *
     * @param string $option Name of option field to describe.
     *
     * @return array|null Description or null if nothing is found.
     */
    public function describe( $option ) {
        if ( ! isset( $this->_options[$option] ) ) {
            return null;
        }
        return $this->_options[$option];
    }

    /**
     * Get value for option.
     *
     * @param string $option  Name of option to get value for.
     * @param mixed  $default Value to return if option is not found.
     *
     * @return mixed Value or $default if none is found.
     */
    public function get( $option, $default = null ) {
        // notice, that `null` is not treated as a value
        if ( ! isset( $this->_options[$option] ) ) {
            return $default;
        }
        return $this->_options[$option]['value'];
    }

    /**
     * Set new value for previously initialized option.
     *
     * @param string $option Name of option to update.
     * @param mixed  $value  Actual value to be used for option.
     *
     * @throws Ai1ec_Settings_Exception
     *
     * @return Ai1ec_Settings Instance of self for chaining.
     */
    public function set( $option, $value ) {
        if ( ! isset( $this->_options[$option] ) ) {
            throw new Ai1ec_Settings_Exception(
                'Option "' . $option . '" was not registered'
            );
        }
        if ( 'array' === $this->_options[$option]['type'] ) {
            if (
                ! is_array( $this->_options[$option]['value'] ) ||
                ! is_array( $value ) ||
                $value != $this->_options[$option]['value']
            ) {
                $this->_options[$option]['value'] = $value;
                $this->_change_update_status ( true );
            }
        } else if (
            (string)$value !== (string)$this->_options[$option]['value']
        ) {
            $this->_options[$option]['value'] = $value;
            $this->_change_update_status ( true );
        }
        return $this;
    }

    /**
     * Parse legacy values into new structure.
     *
     * @param mixed $values Expected legacy representation.
     *
     * @return array Parsed values representation, or input cast as array.
     */
    protected function _parse_legacy( Ai1ec_Settings $values ) {
        $variables        = get_object_vars( $values );
        $default_tags_cat = array();
        $legacy           = array();
        foreach ( $variables as $key => $value ) {
            if ( 'default_categories' === $key ) {
                $default_tags_cat['categories'] = $value;
                continue;
            }
            if ( 'default_tags' === $key ) {
                $default_tags_cat['tags'] = $value;
                continue;
            }
            $type = 'string';
            if ( is_array( $value ) ) {
                $type = 'array';
            } elseif ( is_bool( $value ) ) {
                $type = 'bool';
            } elseif ( is_int( $value ) ) {
                $type = 'int';
            }
            if ( isset( $this->_options[$key] ) ) {
                $this->_options[$key]['value'] = $value;
            } else {
                $legacy[$key] = array(
                    'value'    => $value,
                    'type'     => $type,
                    'legacy'   => true,
                    'version'  => AI1EC_VERSION
                );
            }
        }
        $this->_options['default_tags_categories']['value'] = $default_tags_cat;
        $this->_options['legacy_options'] = $legacy;
    }

    /**
     * Write object representation to persistence layer.
     *
     * Upon successful write to persistence layer the objects internal
     * state {@see self::$_updated} is updated respectively.
     *
     * @return bool Success.
     */
    public function persist() {
        $success = $this->_registry->get( 'model.option' )
            ->set( self::WP_OPTION_KEY, $this->_options );
        if ( $success ) {
            $this->_change_update_status( false );
        }
        return $success;
    }

    /**
     * Remove an option if is set.
     *
     * @param string $option
     */
    public function remove_option( $option ) {
        if ( isset( $this->_options[$option] ) ) {
            unset( $this->_options[$option] );
            $this->_change_update_status( true );
        }
    }

    /**
     * Do things needed on every plugin upgrade.
     */
    public function perform_upgrade_actions() {
        update_option( 'ai1ec_force_flush_rewrite_rules',      true );
        update_option( 'ai1ec_invalidate_css_cache',           true );
        update_option( Ai1ec_Theme_Loader::OPTION_FORCE_CLEAN, true );
    }

    /**
     * Hide an option by unsetting it's renderer
     *
     * @param string $option
     */
    public function hide_option( $option ) {
        if ( isset( $this->_options[$option] ) ) {
            unset( $this->_options[$option]['renderer'] );
            $this->_change_update_status( true );
        }
    }

    /**
     * Show an option by setting it's renderer
     *
     * @param string $option
     */
    public function show_option( $option, array $renderer ) {
        if ( isset( $this->_options[$option] ) ) {
            $this->_options[$option]['renderer'] = $renderer;
            $this->_change_update_status( true );
        }
    }

    /**
     * Check object state and update it's database representation as needed.
     *
     * @return void Destructor does not return.
     */
    public function shutdown() {
        if ( $this->_updated ) {
            $this->persist();
        }
    }

    /**
     * Observes wp_options changes. If any matches related setting then
     * updates that setting.
     *
     * @param string $option    Name of the updated option.
     * @param mixed  $old_value The old option value.
     * @param mixed  $value     The new option value.
     *
     * @return void Method does not return.
     */
    public function wp_options_observer( $option, $old_value, $value ) {
        $options = $this->get_options();
        if (
            self::WP_OPTION_KEY === $option ||
            empty( $options )
        ) {
            return;
        }

        if (
            isset( $options[$option] ) &&
            'wp_option' === $options[$option]['type'] &&
            $this->get( $option ) !== $value
        ) {
            $this->set( $option, $value );
        }
    }

    /**
     * Initiate options map from storage.
     *
     * @return void Return from this method is ignored.
     */
    protected function _initialize() {
        $this->_set_standard_values();
        $values       = $this->_registry->get( 'model.option' )
            ->get( self::WP_OPTION_KEY, array() );
        $this->_change_update_status( false );
        $test_version = false;
        if ( is_array( $values ) ) { // always assign existing values, if any
            $this->_options = $values;
            if ( isset( $values['calendar_page_id'] ) ) {
                $test_version = $values['calendar_page_id']['version'];
            }
        }
        // check for updated translations
        $this->_register_standard_values();
        if ( // process meta updates changes
            empty( $values ) || (
                false !== $test_version &&
                AI1EC_VERSION !== $test_version
            )
        ) {
            $this->_register_standard_values();
            $this->_update_name_translations();
            $this->_change_update_status( true );
        } else if ( $values instanceof Ai1ec_Settings ) { // process legacy
            $this->_parse_legacy( $values );
            $this->_change_update_status( true );
        }
        $this->_registry->get( 'controller.shutdown' )->register(
            array( $this, 'shutdown' )
        );
    }

    /**
     * Set the standard values for the options of the core plugin.
     *
     */
    protected function _set_standard_values() {
       $this->_standard_options = array(
            'enabling_ticket_invitation_page' => array(
                   'type'                     => 'string',
                   'default'                  => false,
            ),
            'ai1ec_api'       => array(
                    'type'    => 'boolean',
                    'default' => false,
            ),
            'ai1ec_db_version' => array(
                'type' => 'int',
                'default'  => false,
            ),
            'feeds_page' => array(
                'type' => 'string',
                'default'  => false,
            ),
            'settings_page' => array(
                'type' => 'string',
                'default'  => false,
            ),
            'less_variables_page' => array(
                'type' => 'string',
                'default'  => false,
            ),
            'input_date_format' => array(
                'type' => 'string',
                'default'  => 'd/m/yyyy',
            ),
            'plugins_options' => array(
                'type' => 'array',
                'default'  => array(),
            ),
            'show_tracking_popup' => array(
                'type'    => 'deprecated',
                'default' => true,
            ),
            'ticketing_message' => array(
                'type'    => 'string',
                'default' => false,
            ),
            'ticketing_token' => array(
                'type'    => 'string',
                'default' => '',
            ),
            'ticketing_enabled' => array(
                'type'    => 'boolean',
                'default' => false,
            ),
            'ticketing_calendar_id' => array(
                'type'    => 'int',
                'default' => 0,
            ),
            'calendar_page_id' => array(
                'type' => 'mixed',
                'renderer' => array(
                    'class' => 'calendar-page-selector',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__( 'Calendar page' )
                ),
                'default'  => false,
            ),
            'week_start_day' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'   => 'select',
                    'tab'     => 'viewing-events',
                    'item'    => 'viewing-events',
                    'label'   => Ai1ec_I18n::__( 'Week starts on' ),
                    'options' => 'get_weekdays',
                ),
                'default'  => $this->_registry->get( 'model.option' )->get(
                    'start_of_week'
                ),
            ),
            'enabled_views' => array(
                'type' => 'array',
                'renderer' => array(
                    'class' => 'enabled-views',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__( 'Available views' ),
                ),
                'default'  => array(
                    'agenda' => array(
                        'enabled'        => true,
                        'default'        => true,
                        'enabled_mobile' => true,
                        'default_mobile' => true,
                        'longname'       => _n_noop(
                            'Agenda',
                            'Agenda',
                            AI1EC_PLUGIN_NAME
                        ),
                    ),
                    'oneday' => array(
                        'enabled'        => true,
                        'default'        => false,
                        'enabled_mobile' => true,
                        'default_mobile' => false,
                        'longname'       => _n_noop(
                            'Day',
                            'Day',
                            AI1EC_PLUGIN_NAME
                        ),
                    ),
                    'month' => array(
                        'enabled'        => true,
                        'default'        => false,
                        'enabled_mobile' => true,
                        'default_mobile' => false,
                        'longname'       => _n_noop(
                            'Month',
                            'Month',
                            AI1EC_PLUGIN_NAME
                        ),
                    ),
                    'week' => array(
                        'enabled'        => true,
                        'default'        => false,
                        'enabled_mobile' => true,
                        'default_mobile' => false,
                        'longname'       => _n_noop(
                            'Week',
                            'Week',
                            AI1EC_PLUGIN_NAME
                        ),
                    ),
                ),
            ),
            'timezone_string' => array(
                'type' => 'wp_option',
                'renderer' => array(
                    'class'     => 'select',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     => Ai1ec_I18n::__( 'Timezone' ),
                    'options'   => 'Ai1ec_Date_Timezone:get_timezones',
                ),
                'default'  => $this->_registry->get( 'model.option' )->get(
                    'timezone_string'
                ),
            ),
            'default_tags_categories' => array(
                'type' => 'array',
                'renderer' => array(
                    'class' => 'tags-categories',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__( 'Preselected calendar filters' ),
                    'help'  => Ai1ec_I18n::__(
                        'To clear, hold &#8984;/<abbr class="initialism">CTRL</abbr> and click selection.'
                    )
                ),
                'default'  => array(
                    'categories' => array(),
                    'tags' => array(),
                ),
            ),
            'exact_date' => array(
                'type' => 'string',
                'renderer' => array(
                    'class' => 'input',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__( 'Default calendar start date (optional)' ),
                    'type'  => 'date',
                ),
                'default'  => '',
            ),
            'agenda_events_per_page' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     => Ai1ec_I18n::__( 'Agenda pages show at most' ),
                    'type'      => 'append',
                    'append'    => 'events',
                    'validator' => 'numeric',
                ),
                'default'  => 10,
            ),
            'week_view_starts_at' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     => Ai1ec_I18n::__( 'Week/Day view starts at' ),
                    'type'      => 'append',
                    'append'    => 'hrs',
                    'validator' => 'numeric',
                ),
                'default'  => 8,
            ),
            'week_view_ends_at' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     => Ai1ec_I18n::__( 'Week/Day view ends at' ),
                    'type'      => 'append',
                    'append'    => 'hrs',
                    'validator' => 'numeric',
                ),
                'default'  => 24,
            ),
            'google_maps_api_key' => array(
                'type' => 'string',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     => Ai1ec_I18n::__(
                                    '<span class="ai1ec-tooltip-toggle"
                                    data-original-title="Google may request for an API key in order to show the map">
                                    Google Maps API Key</span> (<a target="_blank" href="https://developers.google.com/maps/documentation/javascript/get-api-key#get-an-api-key">Get an API key</a>)'
                    ),
                    'type'      => 'normal'
                ),
                'default'  => '',
            ),
            'month_word_wrap' => array(
                'type'     => 'bool',
                'renderer' => array(
                    'class'  => 'checkbox',
                    'tab'    => 'viewing-events',
                    'item'   => 'viewing-events',
                    'label'  => Ai1ec_I18n::__(
                        '<strong>Word-wrap event stubs</strong> in Month view'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Only applies to events that span a single day.'
                    ),
                ),
                'default'  => false,
            ),
            'agenda_include_entire_last_day' => array(
                'type'     => 'bool',
                'renderer' => array(
                    'class'  => 'checkbox',
                    'tab'    => 'viewing-events',
                    'item'   => 'viewing-events',
                    'label'  => Ai1ec_I18n::__(
                        'In <span class="ai1ec-tooltip-toggle"
                        data-original-title="These include Agenda view,
                        the Upcoming Events widget, and some extended views.">
                        Agenda-like views</span>, <strong>include all events
                        from last day shown</strong>'
                    )
                ),
                'default'  => false,
            ),
            'agenda_events_expanded' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        'Keep all events <strong>expanded</strong> in Agenda view'
                    )
                ),
                'default'  => false,
            ),
            'show_year_in_agenda_dates' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        '<strong>Show year</strong> in calendar date labels'
                    )
                ),
                'default'  => false,
            ),
            'show_location_in_title' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        '<strong>Show location in event titles</strong> in calendar views'
                    )
                ),
                'default'  => true,
            ),
            'exclude_from_search' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        '<strong>Exclude</strong> events from search results'
                    )
                ),
                'default'  => false,
            ),
            'turn_off_subscription_buttons' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        'Hide <strong>Subscribe</strong>/<strong>Add to Calendar</strong> buttons in calendar and single event views '
                    )
                ),
                'default'  => false,
            ),
            'disable_get_calendar_button' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        'Hide <strong>Get a Timely Calendar</strong> button'
                    )
                ),
                'default'  => true,
            ),
            'hide_maps_until_clicked' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        ' Hide <strong>Google Maps</strong> until clicked'
                    )
                ),
                'default'  => false,
            ),
            'affix_filter_menu' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        ' <strong>Affix filter menu</strong> to top of window when it scrolls out of view'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Only applies to first visible calendar found on the page.'
                    ),
                ),
                'default'  => false,
            ),
            'affix_vertical_offset_md' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     => Ai1ec_I18n::__( 'Offset affixed filter bar vertically by' ),
                    'type'      => 'append',
                    'append'    => 'pixels',
                    'validator' => 'numeric',
                ),
                'default'  => 0,
            ),
            'affix_vertical_offset_lg' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     =>
                        '<i class="ai1ec-fa ai1ec-fa-lg ai1ec-fa-fw ai1ec-fa-desktop"></i> ' .
                        Ai1ec_I18n::__( 'Wide screens only (&#8805; 1200px)' ),
                    'type'      => 'append',
                    'append'    => 'pixels',
                    'validator' => 'numeric',
                ),
                'default'  => 0,
            ),
            'affix_vertical_offset_sm' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     =>
                        '<i class="ai1ec-fa ai1ec-fa-lg ai1ec-fa-fw ai1ec-fa-tablet"></i> ' .
                        Ai1ec_I18n::__( 'Tablets only (< 980px)' ),
                    'type'      => 'append',
                    'append'    => 'pixels',
                    'validator' => 'numeric',
                ),
                'default'  => 0,
            ),
            'affix_vertical_offset_xs' => array(
                'type' => 'int',
                'renderer' => array(
                    'class'     => 'input',
                    'tab'       => 'viewing-events',
                    'item'      => 'viewing-events',
                    'label'     =>
                        '<i class="ai1ec-fa ai1ec-fa-lg ai1ec-fa-fw ai1ec-fa-mobile"></i> ' .
                        Ai1ec_I18n::__( 'Phones only (< 768px)' ),
                    'type'      => 'append',
                    'append'    => 'pixels',
                    'validator' => 'numeric',
                ),
                'default'  => 0,
            ),
            'strict_compatibility_content_filtering' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        'Strict compatibility content filtering'
                    ),
                ),
                'default'  => false,
            ),
            'hide_featured_image' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'viewing-events',
                    'item'  => 'viewing-events',
                    'label' => Ai1ec_I18n::__(
                        ' <strong>Hide featured image</strong> from event details page'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        "Select this option if your theme already displays each post's featured image."
                    ),
                ),
                'default'  => false,
            ),
            'input_date_format' => array(
                'type' => 'string',
                'renderer' => array(
                    'class'   => 'select',
                    'tab'     => 'editing-events',
                    'label'   => Ai1ec_I18n::__(
                        'Input dates in this format'
                    ),
                    'options' => array(
                        array(
                            'text' => Ai1ec_I18n::__( 'Default (d/m/yyyy)' ),
                            'value' => 'def'
                         ),
                        array(
                            'text' => Ai1ec_I18n::__( 'US (m/d/yyyy)' ),
                            'value' => 'us'
                        ),
                        array(
                            'text' => Ai1ec_I18n::__( 'ISO 8601 (yyyy-m-d)' ),
                            'value' => 'iso'
                        ),
                        array(
                            'text' => Ai1ec_I18n::__( 'Dotted (m.d.yyyy)' ),
                            'value' => 'dot'
                         ),
                    ),
                ),
                'default'  => 'def',
            ),
            'input_24h_time' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'editing-events',
                    'label' => Ai1ec_I18n::__(
                        ' Use <strong>24h time</strong> in time pickers'
                    )
                ),
                'default'  => false,
            ),
            'disable_autocompletion' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'editing-events',
                    'label' => Ai1ec_I18n::__(
                        '<strong>Disable address autocomplete</strong> function'
                    )
                ),
                'default'  => false,
            ),
            'geo_region_biasing' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'editing-events',
                    'label' => Ai1ec_I18n::__(
                        'Use the configured <strong>region</strong> (WordPress locale) to bias the address autocomplete function '
                    )
                ),
                'default'  => false,
            ),
            'show_publish_button' => array(
                'type'     => 'deprecated',
                'renderer' => null,
                'default'  => false,
            ),
            'show_create_event_button' => array(
                'type' => 'bool',
                'renderer' => array(
                     'class' => 'checkbox',
                     'tab'   => 'extensions',
                     'label' => Ai1ec_I18n::__(
                         ' Show the old <strong>Post Your Event</strong> button above the calendar to privileged users'
                     ),
                     'help'  => Ai1ec_I18n::__(
                         'Install the <a target="_blank" href="https://time.ly/">Interactive Frontend Extension</a> for the <strong>frontend Post Your Event form</strong>.'
                     ),
                 ),
                'default'  => true,
                ),
            'embedding' => array(
                'type' => 'html',
                'renderer' => array(
                    'class' => 'html',
                    'tab'   => 'advanced',
                    'item'  => 'embedded-views',
                ),
                'default'  => null,
            ),
            'calendar_css_selector' => array(
                'type' => 'deprecated',
                'renderer' => array(
                    'class' => 'input',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => Ai1ec_I18n::__( 'Move calendar into this DOM element' ),
                    'type'  => 'normal',
                    'help'  => Ai1ec_I18n::__(
                        'Optional. Use this JavaScript-based shortcut to place the
                        calendar a DOM element other than the usual page content container
                        if you are unable to create an appropriate page template
                         for the calendar page. To use, enter a
                        <a target="_blank" href="https://api.jquery.com/category/selectors/">
                        jQuery selector</a> that evaluates to a single DOM element.
                        Any existing markup found within the target will be replaced
                        by the calendar.'
                    ),
                ),
                'default'  => '',
            ),
            'skip_in_the_loop_check' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => Ai1ec_I18n::__(
                        '<strong>Skip <tt>in_the_loop()</tt> check </strong> that protects against multiple calendar output'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Try enabling this option if your calendar does not appear on the calendar page. It is needed for compatibility with a small number of themes that call <tt>the_content()</tt> from outside of The Loop. Leave disabled otherwise.'
                    ),
                ),
                'default'  => false,
            ),
            'disable_gzip_compression' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => Ai1ec_I18n::__(
                        'Disable <strong>gzip</strong> compression.'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Use this option if calendar is unresponsive. <a target="_blank" href="https://time.ly/document/user-guide/troubleshooting/disable-gzip-compression/">Read more</a> about the issue. (From version 2.1 onwards, gzip is disabled by default for maximum compatibility.)'
                    ),
                ),
                'default'  => true,
            ),
            'ai1ec_use_frontend_rendering' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => Ai1ec_I18n::__(
                        'Use frontend rendering.'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Renders calendar views on the client rather than the server; can improve performance.'
                    ),
                ),
                'default'  => true,
            ),
            'cache_dynamic_js' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => Ai1ec_I18n::__(
                        'Use advanced JS cache.'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Cache dynamically generated JS files. Improves performance.'
                    ),
                ),
                'default'  => true,
            ),
            'render_css_as_link' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => Ai1ec_I18n::__(
                        '<strong>Link CSS</strong> in <code>&lt;head&gt;</code> section when file cache is unavailable.'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'Use this option if file cache is unavailable and you would prefer to serve CSS as a link rather than have it output inline.'
                    ),
                ),
                'default'  => false,
            ),
            'edit_robots_txt' => array(
                'type' => 'string',
                'renderer' => array(
                    'class'    => 'textarea',
                    'tab'      => 'advanced',
                    'item'     => 'advanced',
                    'label'    => Ai1ec_I18n::__( 'Current <strong>robots.txt</strong> on this site' ),
                    'type'     => 'normal',
                    'rows'     => 6,
                    'readonly' => 'readonly',
                    'help'     => Ai1ec_I18n::__(
                        'The Robot Exclusion Standard, also known as the Robots Exclusion Protocol or
                        <code><a href="https://en.wikipedia.org/wiki/Robots.txt" target="_blank">robots.txt</a></code>
                        protocol, is a convention for cooperating web crawlers and other web robots
                        about accessing all or part of a website that is otherwise publicly viewable.
                        You can change it manually by editing <code>robots.txt</code> in your root WordPress directory.'
                    ),
                ),
                'default'  => '',
            ),
            'allow_statistics' => array(
                'type' => 'bool',
                'renderer' => array(
                    'class' => 'checkbox',
                    'tab'   => 'advanced',
                    'item'  => 'advanced',
                    'label' => sprintf(
                        Ai1ec_I18n::__(
                            '<strong>Publicize, promote, and share my events</strong> marked as public on the Timely network. (<a href="%s" target="_blank">Learn more &#187;</a>)'
                        ),
                        'https://time.ly/event-search-calendar'
                    ),
                ),
                'default'  => false,
            ),
            'legacy_options' => array(
                'type'     => 'legacy_options',
                'default'  => null,
            ),
            'ics_cron_freq' => array(
                'type'    => 'string',
                'default' => 'hourly',
            ),
            'twig_cache' => array(
                'type' => 'string',
                'renderer' => array(
                    'class' => 'cache',
                    'tab'   => 'advanced',
                    'item'  => 'cache',
                    'label' => sprintf(
                        Ai1ec_I18n::__(
                            'Templates cache improves site performance'
                        )
                    ),
                ),
                'default' => '',
            ),
            'always_use_calendar_timezone' => array(
                'type'     => 'bool',
                'renderer' => array(
                    'class'  => 'checkbox',
                    'tab'    => 'viewing-events',
                    'item'   => 'viewing-events',
                    'label'  => Ai1ec_I18n::__(
                        'Display events in <strong>calendar time zone</strong>'
                    ),
                    'help'  => Ai1ec_I18n::__(
                        'If this box is checked events will appear in the calendar time zone with time zone information displayed on the event details page.'
                    ),
                ),
                'default'  => false,
            ),
        );
    }

    /**
     * Register the standard setting values.
     *
     * @return void Method doesn't return.
     */
    protected function _register_standard_values() {
        foreach ( $this->_standard_options as $key => $option ) {
            $renderer = null;
            $value    = $option['default'];
            if ( isset( $option['renderer'] ) ) {
                $renderer = $option['renderer'];
            }
            $this->register(
                $key,
                $value,
                $option['type'],
                $renderer,
                AI1EC_VERSION
            );
        }
    }

    /**
     * Update translated strings, after introduction of `_noop` functions.
     *
     * @return void
     */
    protected function _update_name_translations() {
        $translations = $this->_standard_options['enabled_views']['default'];
        $current      = $this->get( 'enabled_views' );
        foreach ( $current as $key => $view ) {
            if ( isset( $translations[$key] ) ) {
                $current[$key]['longname'] = $translations[$key]['longname'];
            }
        }
        $this->set( 'enabled_views', $current );
    }

    /**
     * Change `updated` flag value.
     *
     * @param bool $new_status Status to change to.
     *
     * @return bool Previous status flag value.
     */
    protected function _change_update_status( $new_status ) {
        $previous = $this->_updated;
        $this->_updated = (bool)$new_status;
        return $previous;
    }

}


==================================================
FILE PATH: ./app/model/settings-view.php
==================================================
<?php

/**
 * Settings extension for managing view-related settings.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Settings_View extends Ai1ec_App {

    /**
     * @var string Name of settings option to use for views map.
     */
    const SETTING_VIEWS_MAP = 'enabled_views';

    /**
     * @var Ai1ec_Settings Instance
     */
    protected $_settings = null;

    /**
     * Acquire Settings model instance for future reference.
     *
     * @return void
     */
    protected function _initialize() {
        $this->_settings = $this->_registry->get( 'model.settings' );
    }

    /**
     * Add a view if not set.
     *
     * @param array $view
     */
    public function add( array $view ) {
        $enabled_views = $this->_get();
        if ( isset( $enabled_views[$view['name']] ) ) {
            if ( $enabled_views[$view['name']]['longname'] === $view['longname'] ) {
                return;
            }
            $enabled_views[$view['name']]['longname'] = $view['longname'];
        } else {
            // Copy relevant settings to local view array; account for possible missing
            // mobile settings during upgrade (assign defaults).
            $enabled_views[$view['name']] = array(
                'enabled'        => $view['enabled'],
                'default'        => $view['default'],
                'enabled_mobile' => isset( $view['enabled_mobile'] ) ?
                                    $view['enabled_mobile'] : $view['enabled'],
                'default_mobile' => isset( $view['default_mobile'] ) ?
                                    $view['default_mobile'] : $view['default'],
                'longname'       => $view['longname'],
            );
        }
        $this->_set( $enabled_views );
    }

    /**
     * Remove a view.
     *
     * @param string $view
     */
    public function remove( $view ) {
        $enabled_views = $this->_get();
        if ( isset( $enabled_views[$view] ) ) {
            unset( $enabled_views[$view] );
            $this->_set( $enabled_views );
        }
    }

    /**
     * Retrieve all configured views.
     *
     * @return array Map of configured view aliases and their details.
     */
    public function get_all() {
        return $this->_get();
    }

    /**
     * Get name of view to be rendered for requested alias.
     *
     * @param string $view Name of view requested.
     *
     * @return string Name of view to be rendered.
     *
     * @throws Ai1ec_Settings_Exception If no views are configured.
     */
    public function get_configured( $view ) {
        $enabled_views = $this->_get();
        if ( empty( $enabled_views ) ) {
            throw new Ai1ec_Settings_Exception( 'No view is enabled' );
        }
        if (
            isset( $enabled_views[$view] ) &&
            isset( $enabled_views[$view]['enabled' . ( wp_is_mobile() ? '_mobile' : '' ) ] ) &&
            $enabled_views[$view]['enabled' . ( wp_is_mobile() ? '_mobile' : '' ) ]
        ) {
            return $view;
        }
        return $this->get_default();
    }

    /**
     * Get default view to render.
     *
     *
     * @return
     */
    public function get_default() {
        $enabled_views = $this->_get();
        $default       = null;
        // Check mobile settings first, if in mobile mode.
        if (
            ! $this->_registry->get( 'compatibility.cli' )->is_cli() &&
            wp_is_mobile()
        ) {
            foreach ( $enabled_views as $view => $details ) {
                if (
                    isset( $details['default_mobile'] ) &&
                    $details['default_mobile'] &&
                    $details['enabled_mobile']
                ) {
                    $default = $view;
                    break;
                }
            }
        }
        // Either not in mobile mode or no mobile settings available; look up
        // desktop settings.
        if ( null === $default ) {
            foreach ( $enabled_views as $view => $details ) {
                if ( $details['default'] && $details['enabled'] ) {
                    $default = $view;
                    break;
                }
            }
        }
        // No enabled view found, but we need to pick one, so pick the first view.
        if ( null === $default ) {
            $default = (string)current( array_keys( $enabled_views ) );
        }
        return $default;
    }

    /**
     * Retrieve views maps from storage.
     *
     * @return array Current views map.
     */
    protected function _get() {
        return (array)$this->_settings->get( self::SETTING_VIEWS_MAP, array() );
    }

    /**
     * Update views map.
     *
     * @param array $enabled_views Map of enabled views.
     *
     * @return bool Success.
     */
    protected function _set( array $enabled_views ) {
        return $this->_settings->set( self::SETTING_VIEWS_MAP, $enabled_views );
    }

}


==================================================
FILE PATH: ./app/model/taxonomy.php
==================================================
<?php

/**
 * Model used for storing/retrieving taxonomy.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Html
 */
class Ai1ec_Taxonomy extends Ai1ec_Base {

    /**
     * @var array Map of taxonomy values.
     */
    protected $_taxonomy_map = array(
        'events_categories' => array(),
        'events_tags' => array(),
    );

    /**
     * Callback to pre-populate taxonomies before exporting ics.
     * All taxonomies which are not tags are exported as event_categories
     *
     * @param array $post_ids List of Post IDs to inspect.
     *
     * @return void
     */
    public function prepare_meta_for_ics( array $post_ids ) {
        $taxonomies = get_object_taxonomies( AI1EC_POST_TYPE );
        $categories = array();
        $excluded_categories = array(
            'events_tags'  => true,
            'events_feeds' => true
        );
        foreach ( $taxonomies as $taxonomy ) {
            if ( isset( $excluded_categories[$taxonomy] ) ) {
                continue;
            }
            $categories[] = $taxonomy;
        }
        foreach ( $post_ids as $post_id ) {
            $post_id = (int)$post_id;
            $this->_taxonomy_map['events_categories'][$post_id] = array();
            $this->_taxonomy_map['events_tags'][$post_id] = array();
        }
        $tags = wp_get_object_terms(
            $post_ids,
            array( 'events_tags' ),
            array( 'fields' => 'all_with_object_id' )
        );
        foreach ( $tags as $term ) {
            $this->_taxonomy_map[$term->taxonomy][$term->object_id][] = $term;
        }
        $category_terms = wp_get_object_terms(
            $post_ids,
            $categories,
            array( 'fields' => 'all_with_object_id' )
        );
        foreach ( $category_terms as $term ) {
            $this->_taxonomy_map['events_categories'][$term->object_id][] = $term;
        }
    }

    /**
     * Callback to pre-populate taxonomies before processing.
     *
     * @param array $post_ids List of Post IDs to inspect.
     *
     * @return void
     */
    public function update_meta( array $post_ids ) {
        foreach ( $post_ids as $post_id ) {
            $post_id = (int)$post_id;
            $this->_taxonomy_map['events_categories'][$post_id] = array();
            $this->_taxonomy_map['events_tags'][$post_id] = array();
        }
        $terms = wp_get_object_terms(
            $post_ids,
            array( 'events_categories', 'events_tags' ),
            array( 'fields' => 'all_with_object_id' )
        );
        foreach ( $terms as $term ) {
            $this->_taxonomy_map[$term->taxonomy][$term->object_id][] = $term;
        }
    }

    /**
     * Re-fetch category entries map from database.
     *
     * @return array Map of category entries.
     */
    public function fetch_category_map() {
        $category_map = array();
        $records      = (array)$this->_registry->get( 'dbi.dbi' )->select(
            'ai1ec_event_category_meta',
            array( 'term_id', 'term_image', 'term_color' )
        );
        foreach ( $records as $row ) {
            $image = $color = null;
            if ( $row->term_image ) {
                $image = $row->term_image;
            }
            if ( $row->term_color ) {
                $color = $row->term_color;
            }
            $category_map[(int)$row->term_id] = compact( 'image', 'color' );
        }
        return $category_map;
    }

    /**
     * Get taxonomy values for specified post.
     *
     * @param int    $post_id  Actual Post ID to check.
     * @param string $taxonomy Name of taxonomy to retrieve values for.
     *
     * @return array List of terms (stdClass'es) associated with post.
     */
    public function get_post_taxonomy( $post_id, $taxonomy ) {
        $post_id = (int)$post_id;
        if ( ! isset( $this->_taxonomy_map[$taxonomy][$post_id] ) ) {
            $definition = wp_get_post_terms( $post_id, $taxonomy );
            if ( empty( $definition ) || is_wp_error( $definition ) ) {
                $definition = array();
            }
            $this->_taxonomy_map[$taxonomy][$post_id] = $definition;
        }
        return $this->_taxonomy_map[$taxonomy][$post_id];
    }

    /**
     * Get post (event) categories taxonomy.
     *
     * @param int $post_id Checked post ID.
     *
     * @return array List of categories (stdClass'es) associated with event.
     */
    public function get_post_categories( $post_id ) {
        return $this->get_post_taxonomy( $post_id, 'events_categories' );
    }

    /**
     * Get post (event) tags taxonomy.
     *
     * @param int $post_id Checked post ID.
     *
     * @return array List of tags (stdClass'es) associated with event.
     */
    public function get_post_tags( $post_id ) {
        return $this->get_post_taxonomy( $post_id, 'events_tags' );
    }

    /**
     * Get cached category description field.
     *
     * @param int    $term_id Category ID.
     * @param string $field   Name of field, one of 'image', 'color'.
     *
     * @return string|null Field value or null if entry is not found.
     */
    public function get_category_field( $term_id, $field ) {
        static $category_meta = null;
        if ( null === $category_meta ) {
            $category_meta = $this->fetch_category_map();
        }
        $term_id = (int)$term_id;
        if ( ! isset( $category_meta[$term_id] ) ) {
            return null;
        }
        return $category_meta[$term_id][$field];
    }

    /**
     * Returns the color of the Event Category having the given term ID.
     *
     * @param int $term_id The ID of the Event Category.
     *
     * @return string|null Color to use
     */
    public function get_category_color( $term_id ) {
        return $this->get_category_field( $term_id, 'color' );
    }

    /**
     * Returns the image of the Event Category having the given term ID.
     *
     * @param int $term_id The ID of the Event Category.
     *
     * @return string|null Image url to use.
     */
    public function get_category_image( $term_id ) {
        return $this->get_category_field( $term_id, 'image' );
    }

}

==================================================
FILE PATH: ./app/model/meta-post.php
==================================================
<?php

/**
 * Post meta entries management.
 *
 * Meta entries management based on {@see Ai1ec_Meta} class.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Meta_Post extends Ai1ec_Meta {

}

==================================================
FILE PATH: ./app/model/meta.php
==================================================
<?php

/**
 * Abstract class for meta entries management.
 *
 * Via use of cache allows object-based access to meta entries.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
abstract class Ai1ec_Meta extends Ai1ec_App {

    /**
     * @var string Name of base object for storage.
     */
    protected $_object = '';

    /**
     * @var Ai1ec_Cache_Memory In-memory cache operator.
     */
    protected $_cache = null;

    /**
     * Initialize instance-specific in-memory cache storage.
     *
     * @return void Method does not return.
     */
    protected function _initialize() {
        $class = get_class( $this );
        $this->_object = strtolower(
            substr( $class, strlen( __CLASS__ ) + 1  )
        );
        $this->_cache = $this->_registry->get( 'cache.memory' );
    }

    /**
     * Create new entry if it does not exist and cache provided value.
     *
     * @param string $object_id ID of object to store.
     * @param string $key       Key particle for ID to store.
     * @param mixed  $value     Serializable value to store.
     *
     * @return bool Success.
     */
    final public function add( $object_id, $key, $value ) {
        if ( ! $this->_add( $object_id, $key, $value ) ) {
            return false;
        }
        $this->_cache->set( $this->_cache_key( $object_id, $key ), $value );
        return true;
    }

    /**
     * Update existing entry and cache it's value.
     *
     * @param string $object_id ID of object to store.
     * @param string $key       Key particle for ID to store.
     * @param mixed  $value     Serializable value to store.
     *
     * @return bool Success.
     */
    final public function update( $object_id, $key, $value ) {
        if ( ! $this->_update( $object_id, $key, $value ) ) {
            return false;
        }
        $this->_cache->set( $this->_cache_key( $object_id, $key ), $value );
        return true;
    }

    /**
     * Get object value - from cache or actual store.
     *
     * @param string $object_id ID of object to get.
     * @param string $key       Key particle for ID to get.
     * @param mixed  $default   Value to return if nothing found.
     *
     * @return mixed Value stored or {$default}.
     */
    final public function get( $object_id, $key, $default = null ) {
        $cache_key = $this->_cache_key( $object_id, $key );
        $value     = $this->_cache->get( $cache_key, $default );
        if ( $default === $value ) {
            $value = $this->_get( $object_id, $key );
            $this->_cache->set( $cache_key, $value );
        }
        return $value;
    }

    /**
     * Create or update an entry cache new value.
     *
     * @param string $object_id ID of object to store.
     * @param string $key       Key particle for ID to store.
     * @param mixed  $value     Serializable value to store.
     *
     * @return bool Success.
     */
    final public function set( $object_id, $key, $value ) {
        if ( ! $this->get( $object_id, $key ) ) {
            if ( ! $this->_add( $object_id, $key, $value ) ) {
                return false;
            }
        } else {
            if ( ! $this->_update( $object_id, $key, $value ) ) {
                return false;
            }
        }
        $this->_cache->set( $this->_cache_key( $object_id, $key ), $value );
        return true;
    }

    /**
     * Remove object entry based on ID and key.
     *
     * @param string $object_id ID of object to remove.
     * @param string $key       Key particle for ID to remove.
     *
     * @return bool Success.
     */
    final public function delete( $object_id, $key ) {
        $this->_cache->delete( $this->_cache_key( $object_id, $key ) );
        return $this->_delete( $object_id, $key );
    }

    /**
     * Get object value from actual store.
     *
     * @param string $object_id ID of object to get.
     * @param string $key       Key particle for ID to get.
     *
     * @return mixed Value as found.
     */
    protected function _get( $object_id, $key ) {
        $function = 'get_' . $this->_object . '_meta';
        return $function( $object_id, $key, true );
    }

    /**
     * Create new entry if it does not exist.
     *
     * @param string $object_id ID of object to store.
     * @param string $key       Key particle for ID to store.
     * @param mixed  $value     Serializable value to store.
     *
     * @return bool Success.
     */
    protected function _add( $object_id, $key, $value ) {
        $function = 'add_' . $this->_object . '_meta';
        return $function( $object_id, $key, $value, true );
    }

    /**
     * Update existing entry.
     *
     * @param string $object_id ID of object to store.
     * @param string $key       Key particle for ID to store.
     * @param mixed  $value     Serializable value to store.
     *
     * @return bool Success.
     */
    protected function _update( $object_id, $key, $value ) {
        $function = 'update_' . $this->_object . '_meta';
        return $function( $object_id, $key, $value );
    }

    /**
     * Remove object entry based on ID and key.
     *
     * @param string $object_id ID of object to remove.
     * @param string $key       Key particle for ID to remove.
     *
     * @return bool Success.
     */
    protected function _delete( $object_id, $key ) {
        $function = 'delete_' . $this->_object . '_meta';
        return $function( $object_id, $key );
    }

    /**
     * Generate key for use with cache engine.
     *
     * @param string $object_id ID of object.
     * @param string $key       Key particle for ID.
     *
     * @return string Single identifier for given keys.
     */
    protected function _cache_key( $object_id, $key ) {
        static $separator = "\0";
        return $object_id . $separator . $key;
    }

}

==================================================
FILE PATH: ./app/model/event-compatibility.php
==================================================
<?php

/**
 * Model representing an event or an event instance.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.1
 * @instantiator Ai1ec_Factory_Event.create_event_instance
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */
class Ai1ec_Event_Compatibility extends Ai1ec_Event {

    /**
     * Getter.
     *
     * @param string $name Property name.
     *
     * @return mixed Property value.
     */
    public function __get( $name ) {
        $value = $this->get( $name );
        if ( null !== $value ) {
            return $value;
        }
        return $this->get_runtime( $name );
    }

    /**
     * Isset magic function.
     *
     * @param string $name Property name.
     *
     * @return bool True of false.
     */
    public function __isset( $name ) {
        $method_name = 'get' . $name;
        if ( method_exists( $this, $method_name ) ) {
            return false;
        }
        return ( null !== $this->$name );
    }

    /**
     * Twig timespan short method.
     *
     * @return string Value.
     */
    public function gettimespan_short() {
        return $this->_registry->get( 'view.event.time' )
            ->get_timespan_html( $this, 'short' );
    }

    /**
     * Twig is_allday method.
     *
     * @return bool Value.
     */
    public function getis_allday() {
        return $this->is_allday();
    }

    /**
     * Twig is_multiday method.
     *
     * @return bool Value.
     */
    public function getis_multiday() {
        return $this->is_multiday();
    }

    /**
     * Returns Event instance permalink for FER compatibility.
     *
     * @return string Event instance permalink.
     */
    public function getpermalink() {
        return $this->get_runtime( 'instance_permalink' );
    }

    /**
     * Returns Event timespan for popup.
     *
     * @return string
     */
    public function getpopup_timespan() {
        return $this->_registry->get( 'twig.ai1ec-extension' )
            ->timespan( $this, 'short' );
    }

    /**
     * Returns Avatar not wrapped in <a> tag.
     *
     * @return string
     */
    public function getavatar_not_wrapped() {
         return $this->getavatar( false );
    }

    /**
     * Returns Event avatar URL.
     *
     * @return string Event avatar URL.
     * @throws Ai1ec_Bootstrap_Exception
     */
    public function getavatar_url() {
        return $this->_registry->get(
            'view.event.avatar'
        )->get_event_avatar_url( $this );
    }
}


==================================================
FILE PATH: ./app/model/api/api-registration.php
==================================================
<?php

/**
 * Class for Timely API communication for Registration.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.4
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Api_Registration extends Ai1ec_Api_Abstract {

    /**
     * Post construction routine.
     *
     * Override this method to perform post-construction tasks.
     *
     * @return void Return from this method is ignored.
     */
    protected function _initialize() {
        parent::_initialize();
    }

    /**
     * @return object Response body in JSON.
     */
    public function signin() {
        $body['email']         = $_POST['ai1ec_email'];
        $body['password']      = $_POST['ai1ec_password'];
        $body['calendar_type'] = $_POST['ai1ec_calendar_type'];
        $response              = $this->request_api( 'POST', AI1EC_API_URL . 'auth/authenticate', $body, true, array( 'Authorization' => null ) );
        if ( $this->is_response_success( $response ) ) {
            $response_body = (array) $response->body;
            // Save calendar ID as 0 first, otherwise the auth data won't be saved in the database before creating/finding the calendar
            $this->save_ticketing_settings( $response_body['message'], true, $response_body['auth_token'], 0, $body['email'] );
            // Now save the calendar ID
            $this->save_calendar_id( $this->_get_ticket_calendar() );
            $this->has_payment_settings();
            $this->get_subscriptions( true );
            $this->sync_api_settings();
        } else {
            $error_message = $this->save_error_notification( $response, __( 'We were unable to Sign you In for Time.ly Network', AI1EC_PLUGIN_NAME ) );
            $this->save_ticketing_settings( $error_message, false, '', 0, null );
        }
        return $response;
    }

    /**
     * @return object Response body in JSON.
     */
    public function signup() {
        $body['name']                  = $_POST['ai1ec_name'];
        $body['email']                 = $_POST['ai1ec_email'];
        $body['password']              = $_POST['ai1ec_password'];
        $body['password_confirmation'] = $_POST['ai1ec_password_confirmation'];
        $body['phone']                 = $_POST['ai1ec_phone'];
        $body['calendar_type']         = $_POST['ai1ec_calendar_type'];
        $body['terms']                 = $_POST['ai1ec_terms'];
        $response                      = $this->request_api( 'POST', AI1EC_API_URL . 'auth/register', $body, true );
        if ( $this->is_response_success( $response ) ) {
            $response_body = (array) $response->body;
            // Save calendar ID as 0 first, otherwise the auth data won't be saved in the database before creating the calendar
            $this->save_ticketing_settings( $response_body['Registration'], true, $response_body['auth_token'] , 0, $body['email'] );
            // Now save the calendar ID
            $this->save_calendar_id( $this->_create_calendar() );
            $this->has_payment_settings();
            $this->get_subscriptions( true );
            $this->sync_api_settings();
        } else {
            $error_message = $this->save_error_notification( $response, __( 'We were unable to Sign you Up for Time.ly Network', AI1EC_PLUGIN_NAME ) );
            $this->save_ticketing_settings( $error_message, false, '', 0, null );
        }
        return $response;
    }

    /**
     * @return object Response body in JSON.
     */
    protected function availability() {
        $api_features = get_transient( 'ai1ec_api_features' );

        if ( false === $api_features || ( defined( 'AI1EC_DEBUG' ) && AI1EC_DEBUG ) ) {
            $response = $this->request_api( 'GET', AI1EC_API_URL . 'feature/availability', null, true );

            if ( $this->is_response_success( $response ) ) {
                $api_features = (array) $response->body;
            } else {
                $api_features = array();
            }

            // Save for 5 minutes
            $minutes = 5;
            set_transient( 'ai1ec_api_features', $api_features, $minutes * 60 );
        }

        return $api_features;
    }

    protected function is_feature_available( $feature_code ) {
        $availability = $this->availability();

        if ( ! is_null( $availability ) ) {
            foreach ( $availability as $value ) {
                if ( isset( $value->code ) && $feature_code === $value->code
                    && isset( $value->available ) && true === $value->available ) {
                    return true;
                }
            }
        }
        return false;
    }

    /**
     * @return object Response body in JSON.
     */
    protected function settings() {
        $calendar_settings = get_transient( 'ai1ec_calendar_settings' );

        if ( false === $calendar_settings || ( defined( 'AI1EC_DEBUG' ) && AI1EC_DEBUG ) ) {
            $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars/' . $this->_get_ticket_calendar() . '/settings', null, true );

            if ( $this->is_response_success( $response ) ) {
                $calendar_settings = (array) $response->body;
            } else {
                $calendar_settings = array();
            }

            // Save for 5 minutes
            $minutes = 5;
            set_transient( 'ai1ec_calendar_settings', $calendar_settings, $minutes * 60 );
        }

        return $calendar_settings;
    }

    public function is_api_sign_up_available() {
        return $this->is_feature_available( Ai1ec_Api_Features::CODE_API_ACCESS );
    }

    public function is_ticket_available() {
        return $this->is_feature_available( Ai1ec_Api_Features::CODE_TICKETING );
    }

    public function is_ticket_enabled() {
        return $this->has_subscription_active( Ai1ec_Api_Features::CODE_TICKETING );
    }

     /**
     * Clean the ticketing settings on WP database only
     */
    public function signout() {
        $calendar_id = $this->_get_ticket_calendar( false );
        if ( 0 >= $calendar_id ) {
            $this->clear_ticketing_settings();
            return false;
        }
        $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars/' . $calendar_id . '/signout', null, true );
        // Consider "Unauthorized" status (401) a valid response
        if ( $this->is_response_success( $response ) || 401 === wp_remote_retrieve_response_code( $response->raw ) ) {
            $this->clear_ticketing_settings();
            return array( 'message' => '' );
        } else {
            $error_message = $this->save_error_notification( $response, __( 'We were unable to Sign you Out of Time.ly Network', AI1EC_PLUGIN_NAME ) );
            return array( 'message' => $error_message );
        }
    }

    /**
     * @return object Response body from API.
     */
    public function save_payment_preferences() {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            return false;
        }
        $settings  = array(
            'payment_method' => $_POST['ai1ec_payment_method'],
            'paypal_email'   => $_POST['ai1ec_paypal_email'],
            'first_name'     => $_POST['ai1ec_first_name'],
            'last_name'      => $_POST['ai1ec_last_name'],
            'currency'       => $_POST['ai1ec_currency']
        );
        $custom_headers['content-type'] = 'application/x-www-form-urlencoded';
        $response = $this->request_api( 'PUT', AI1EC_API_URL . 'calendars/' . $calendar_id . '/payment',
            $settings,
            true, //decode response body
            $custom_headers
        );
        if ( $this->is_response_success( $response ) ) {
            $this->save_payment_settings( $settings );
            $notification  = $this->_registry->get( 'notification.admin' );
            $notification->store(
                __( 'Payment preferences were saved.', AI1EC_PLUGIN_NAME ),
                'updated',
                0,
                array( Ai1ec_Notification_Admin::RCPT_ADMIN ),
                false
            );
            return $response->body;
        } else {
            $this->save_error_notification( $response,
                __( 'Payment preferences were not saved.', AI1EC_PLUGIN_NAME )
            );
            return false;
        }
    }

    public function _order_comparator( $order1, $order2 ) {
        return strcmp( $order1->created_at, $order2->created_at ) * -1;
    }

    /**
     * @return object Response body in JSON.
     */
    public function get_purchases() {
        $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars/' . $this->_get_ticket_calendar() . '/sales',
            null, //body
            true //decode response body
            );
        if ( $this->is_response_success( $response ) ) {
            $result = $response->body;
            if ( isset( $result->orders ) ) {
                usort( $result->orders, array( "Ai1ec_Api_Registration", "_order_comparator" ) );
                return $result->orders;
            } else {
                return array();
            }
        } else {
            $this->save_error_notification( $response,
                __( 'We were unable to get the Sales information from Time.ly Network', AI1EC_PLUGIN_NAME )
            );
            return array();
        }
    }

    /**
     * Sync settings from API after signing in
     */
    public function sync_api_settings() {
        // Sync feeds subscriptions
        try {
            $api_feed = $this->_registry->get( 'model.api.api-feeds' );
            $api_feed->get_and_sync_feed_subscriptions();
        } catch ( Exception $e ) {
            $error_message = 'Some feeds were not imported to Time.ly Network. Error: ' . $e->getMessage();

            $notification  = $this->_registry->get( 'notification.admin' );
            $notification->store( $error_message, 'error', 0, array( Ai1ec_Notification_Admin::RCPT_ADMIN ), false );
        }
    }

    /**
     * Save login info
     */
    public function saveLoginInfo( $message, $authToken, $email ) {
        $successful = false;

        // Save calendar ID as 0 first, otherwise the auth data won't be saved in the database before creating/finding the calendar
        $this->save_ticketing_settings( $message, true, $authToken, 0, $email );

        // Check for calendar registration
        $calendar_id = $this->_get_ticket_calendar();
        // Error - No calendar id found
        if ( $calendar_id <= 0 ) {
            $this->clear_ticketing_settings();
        } else {
            $this->has_payment_settings();
            $this->get_subscriptions( true );
            $this->sync_api_settings();

            $successful = true;
        }

        return $successful;
    }
}


==================================================
FILE PATH: ./app/model/api/api-settings.php
==================================================
<?php
class Ai1ec_Api_Settings {
    const FACEBOOK_API_KEY = 'facebook_api_key';
}


==================================================
FILE PATH: ./app/model/api/api-abstract.php
==================================================
<?php

/**
 * Common class for Timely API communication.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.4
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
abstract class Ai1ec_Api_Abstract extends Ai1ec_App {

    const WP_OPTION_KEY   = 'ai1ec_api_settings';
    const DEFAULT_TIMEOUT = 30;

    protected $_settings;

    /**
     * Post construction routine.
     *
     * Override this method to perform post-construction tasks.
     *
     * @return void Return from this method is ignored.
     */
    protected function _initialize() {
        $this->_settings = $this->_registry->get( 'model.settings' );
    }

    protected function get_ticketing_settings( $find_attribute = null, $default_value_attribute = null ) {
        $api_settings = get_option( self::WP_OPTION_KEY, null );
        if ( ! is_array( $api_settings ) ) {
            $api_settings = array(
                'enabled'              => $this->_settings->get( 'ticketing_enabled' ),
                'message'              => $this->_settings->get( 'ticketing_message' ),
                'token'                => $this->_settings->get( 'ticketing_token' ),
                'calendar_id'          => $this->_settings->get( 'ticketing_calendar_id' )
            );
            update_option( self::WP_OPTION_KEY, $api_settings );
            $this->_settings->set( 'ticketing_message'    , '' );
            $this->_settings->set( 'ticketing_enabled'    , false );
            $this->_settings->set( 'ticketing_token'      , '' );
            $this->_settings->set( 'ticketing_calendar_id', null );
        }
        if ( is_null( $find_attribute ) ) {
            return $api_settings;
        } else {
            if ( isset( $api_settings[$find_attribute] ) ) {
                return $api_settings[$find_attribute];
            } else {
                return $default_value_attribute;
            }
        }
    }

    /**
     * @param String $message last message received from the Sign up or Sign in process
     * @param bool $enabled true or false is ticket is enabled
     * @param string $token autenthication token
     * @param int @calendar_id remote id of the calendar
     * @param string $account Email used to create the account
     */
    protected function save_ticketing_settings( $message, $enabled, $token, $calendar_id, $account ) {
        $api_settings = $this->get_ticketing_settings();
        $api_settings['message']     = $message;
        $api_settings['enabled']     = $enabled;
        $api_settings['token']       = $token;
        $api_settings['calendar_id'] = $calendar_id;
        $api_settings['account']     = $account;
        return update_option( self::WP_OPTION_KEY, $api_settings );
    }

    protected function clear_ticketing_settings() {
        delete_option( self::WP_OPTION_KEY );

        // Clear transient API data
        delete_transient( 'ai1ec_api_feeds_subscriptions' );
        delete_transient( 'ai1ec_api_subscriptions' );
        delete_transient( 'ai1ec_api_features' );
        delete_transient( 'ai1ec_api_checked' );

        $this->check_settings();
    }

    /**
     * Save the Payment settings localy (same saved on the API)
     * @param array Preferences to save
     */
    public function save_payment_settings( array $values ) {
        $api_settings = $this->get_ticketing_settings();
        if ( null !== $values ) {
            $api_settings['payment_settings'] = $values;
        } else {
            unset( $api_settings['payment_settings'] );
        }
        return update_option( self::WP_OPTION_KEY, $api_settings );
    }

    /**
     * Get the saved payments settings (the same saved on the API)
     */
    public function get_payment_settings() {
        return $this->get_ticketing_settings( 'payment_settings' );
    }

    /**
     * Check if the current WP instance has payments settings configured
     */
    public function has_payment_settings() {
        $payment_settings = $this->get_payment_settings();
        if ( null === $payment_settings ) {
            //code to migrate the settings save on ticketing api and
            //bring them to the core side
            $payment_settings = $this->get_payment_preferences();
            if ( is_object( $payment_settings ) ) {
                $payment_settings = (array) $payment_settings;
            }
            $this->save_payment_settings( (array) $payment_settings );
        }
        return ( null !== $payment_settings &&
            'paypal' === $payment_settings['payment_method'] &&
            false === ai1ec_is_blank( $payment_settings['paypal_email'] ) ) ;
    }


    /**
     * @return object Response from API, or empty defaults
     */
    public function get_payment_preferences() {
        $calendar_id = $this->_get_ticket_calendar();
        $settings    = null;
        if ( 0 < $calendar_id ) {
            $response = $this->request_api( 'GET', AI1EC_API_URL . "calendars/$calendar_id/payment",
                null, //no body
                true //decode response body
            );
            if ( $this->is_response_success( $response ) ) {
                $settings = $response->body;
            }
        }
        if ( is_null( $settings ) ) {
            return (object) array( 'payment_method'=>'paypal', 'paypal_email'=> '', 'first_name'=>'',  'last_name'=>'', 'currency'=> 'USD' );
        } else {
            if ( ! isset( $settings->currency ) ) {
                $settings->currency = 'USD';
            }
            return $settings;
        }
    }


    public function get_timely_token() {
        return $this->get_ticketing_settings( 'token' );
    }

    protected function save_calendar_id ( $calendar_id ) {
        $api_settings = $this->get_ticketing_settings();
        $api_settings['calendar_id'] = $calendar_id;
        return update_option( self::WP_OPTION_KEY, $api_settings );
    }

    /**
     * Get the header array with authorization token
     */
    protected function _get_headers( $custom_headers = null ) {
        $headers  = array(
            'Content-Type' => 'application/x-www-form-urlencoded'
        );
        $headers['Authorization'] = 'Basic ' . $this->get_ticketing_settings( 'token', '' );
        if ( null !== $custom_headers ) {
            foreach ( $custom_headers as $key => $value ) {
                if ( null === $value ) {
                    unset( $headers[$key] );
                } else {
                    $headers[$key] = $value;
                }
            }
        }
        return $headers;
    }

    /**
     * Create a standarized message to return
     * 1) If the API respond with http code 400 and with a JSON body, so, we will consider the API message to append in the base message.
     * 2) If the API does not responde with http code 400 or does not have a valid a JSON body, we will show the API URL and the http message error.
     */
    protected function _transform_error_message( $base_message, $response, $url, $ask_for_reload = false ) {
        $api_error = $this->get_api_error_msg( $response );
        $result    = null;
        if ( false === ai1ec_is_blank( $api_error ) ) {
            $result = sprintf(
                __( '%s.<br/>Detail: %s.', AI1EC_PLUGIN_NAME ),
                $base_message, $api_error
            );
        } else {
            if ( is_wp_error( $response ) ) {
                $error_message = sprintf(
                    __( 'API URL: %s.<br/>Detail: %s', AI1EC_PLUGIN_NAME ),
                    $url,
                    $response->get_error_message()
                );
            } else {
                $error_message = sprintf(
                    __( 'API URL: %s.<br/>Detail: %s - %s', AI1EC_PLUGIN_NAME ),
                    $url,
                    wp_remote_retrieve_response_code( $response ),
                    wp_remote_retrieve_response_message( $response )
                );
                $mailto = '<a href="mailto:labs@time.ly" target="_top">labs@time.ly</a>';
                if ( true === $ask_for_reload ) {
                    $result = sprintf(
                        __( '%s. Please reload this page to try again. If this error persists, please contact us at %s. In your report please include the information below.<br/>%s.', AI1EC_PLUGIN_NAME ),
                        $base_message,
                        $mailto,
                        $error_message
                    );
                } else {
                    $result = sprintf(
                        __( '%s. Please try again. If this error persists, please contact us at %s. In your report please include the information below.<br/>%s.', AI1EC_PLUGIN_NAME ),
                        $base_message,
                        $mailto,
                        $error_message
                    );
                }
            }
        }
        $result = trim( $result );
        $result = str_replace( '..', '.', $result );
        $result = str_replace( '.,', '.', $result );
        return $result;
    }


    /**
     * Search for the API message error
     */
    public function get_api_error_msg( $response ) {
        if ( isset( $response ) && false === is_wp_error( $response ) ) {
            $response_body = json_decode( $response['body'], true );
            if ( is_array( $response_body ) &&
                isset( $response_body['errors'] ) ) {
                $errors = $response_body['errors'];
                if ( false === is_array( $errors )) {
                    $errors = array( $errors );
                }
                $messages = null;
                foreach ($errors as $key => $value) {
                    if ( false === ai1ec_is_blank( $value ) ) {
                        if ( is_array( $value ) ) {
                            $value = implode ( ', ', $value );
                        }
                        $messages[] = $value;
                    }
                }
                if ( null !== $messages && false === empty( $messages ) ) {
                    return implode ( ', ', $messages);
                }
            }
        }
        return null;
    }

    /**
     * Get the ticket calendar from settings, if the calendar does not exists in
     * settings, then we will try to find on the API
     * @return string JSON.
     */
    protected function _get_ticket_calendar( $createIfNotExists = true ) {
        $ticketing_calendar_id = $this->get_ticketing_settings( 'calendar_id', 0 );
        if ( 0 < $ticketing_calendar_id ) {
            return $ticketing_calendar_id;
        } else {
            if ( ! $createIfNotExists ) {
                return 0;
            }
            // Try to find the calendar in the API
            $ticketing_calendar_id = $this->_find_user_calendar();
            if ( 0 < $ticketing_calendar_id ) {
                $this->save_calendar_id( $ticketing_calendar_id );

                return $ticketing_calendar_id;
            } else {
                // If the calendar doesn't exist in the API, create a new one
                $ticketing_calendar_id = $this->_create_calendar();
                if ( 0 < $ticketing_calendar_id ) {
                    $this->save_calendar_id( $ticketing_calendar_id );

                    return $ticketing_calendar_id;
                } else {
                    return 0;
                }
            }
        }
    }

    /**
     * Find the existent calendar when the user is signing in
     */
    protected function _find_user_calendar() {
        $body = array(
            'title' => get_bloginfo( 'name' ),
            'url'   => ai1ec_site_url()
        );
        $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars', $body );
        if ( $this->is_response_success( $response ) ) {
            if ( is_array( $response->body ) ) {
                return $response->body[0]->id;
            } else {
                return $response->body->id;
            }
        } else {
            return 0;
        }
    }

    /**
     * Create a calendar when the user is signup
     */
    protected function _create_calendar() {
        $body = array(
            'title'    => get_bloginfo( 'name' ),
            'url'      => ai1ec_site_url(),
            'timezone' => $this->_settings->get( 'timezone_string' )
            );
        $response = $this->request_api( 'POST', AI1EC_API_URL . 'calendars', $body );
        if ( $this->is_response_success( $response ) ) {
            return $response->body->id;
        } else {
            $this->log_error( $response, 'Created calendar' );
            return 0;
        }
    }

    /**
     * Check if the current WP instance is signed into the API
     */
    public function is_signed() {
        return ( true === $this->get_ticketing_settings( 'enabled', false ) );
    }

    public function check_settings( $force = false ) {
        $checked = get_transient( 'ai1ec_api_checked' );

        if ( false === $checked || $force ) {
            require_once( ABSPATH . 'wp-admin/includes/plugin.php' );

            $failList = array();
            foreach ( Ai1ec_Api_Features::$features as $key => $value ) {
                if ( empty( $value ) ) {
                    continue;
                }
                if ( ( ! $this->is_signed() || ! $this->has_subscription_active( $key ) ) && call_user_func( 'is'.'_'.'pl'.'ug'.'in'.'_'.'ac'.'ti'.'ve', $value ) ) {
                    $failList[] = $value;
                }
            }

            if ( count( $failList ) > 0 ) {
                call_user_func( 'de'.'act'.'iv'.'ate'.'_'.'pl'.'ug'.'ins', $failList );

                $message = 'Your ' .
                            'All-in-One Event Calendar ' .
                            'has the ' .
                            'following ' .
                            'plugins ' .
                            'installed ' .
                            'but they are ' .
                            'disabled. '.
                            'To keep ' .
                            'them ' .
                            'enabled'.
                            ', simply '.
                            'keep ' .
                            'your calendar ' .
                            'logged in ' .
                            'to your '.
                            'Timely account.' .
                            '<br /><br />';

                foreach ( $failList as $failed ) {
                    $pieces = explode( '/', $failed );
                    $message .= '- ' . $pieces[0] . '<br />';
                }

                $this->show_error( $message );
            }

            set_transient( 'ai1ec_api_checked', true, 5 * 60 );
        }
    }

    /**
     * Get the current email account
     */
    public function get_current_account() {
        return $this->get_ticketing_settings( 'account', '' );
    }

    /**
     * Get the current calendar id
     */
    public function get_current_calendar() {
        return $this->get_ticketing_settings( 'calendar_id', 0 );
    }

    /**
     * Get the last message return by Signup or Signup process
     */
    public function get_sign_message() {
        return $this->get_ticketing_settings( 'message', '' );
    }

    /**
     * Clear the last message return by Signup or Signup process
     */
    public function clear_sign_message() {
        $api_settings            = $this->get_ticketing_settings();
        $api_settings['message'] = '';
        return update_option( self::WP_OPTION_KEY, $api_settings );
    }

    /**
     * @return array List of subscriptions and limits
     */
    protected function get_subscriptions( $force_refresh = false ) {
        $subscriptions = get_transient( 'ai1ec_api_subscriptions' );

        if ( false === $subscriptions || $force_refresh || ( defined( 'AI1EC_DEBUG' ) && AI1EC_DEBUG ) ) {
            $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars/' . $this->_get_ticket_calendar() . '/subscriptions',
                null,
                true
                );
            if ( $this->is_response_success( $response ) ) {
                $subscriptions = (array) $response->body;
            } else {
                $subscriptions = array();
            }

            // Save for 5 minutes
            $minutes = 5;
            set_transient( 'ai1ec_api_subscriptions', $subscriptions, $minutes * 60 );
        }

        return $subscriptions;
    }

    /**
     * Check if calendar should have a specific feature enabled
     */
    public function has_subscription_active( $feature ) {
        $subscriptions = $this->get_subscriptions();

        return array_key_exists( $feature, $subscriptions );
    }

    /**
     * Check if feature has reached its limit
     */
    public function subscription_has_reached_limit( $feature ) {
        $has_reached_limit = true;

        $provided = $this->subscription_get_quantity_limit( $feature );
        $used     = $this->subscription_get_used_quantity( $feature );

        if ( $provided - $used > 0 ) {
            $has_reached_limit = false;
        }

        return $has_reached_limit;
    }

    /**
     * Get feature quantity limit
     */
    public function subscription_get_quantity_limit( $feature ) {
        $provided = 0;

        $subscriptions = $this->get_subscriptions();

        if ( array_key_exists( $feature, $subscriptions ) ) {
            $quantity = (array) $subscriptions[$feature];

            $provided = $quantity['provided'];
        }

        return $provided;
    }

    /**
     * Get feature used quantity
     */
    public function subscription_get_used_quantity( $feature ) {
        $used = 0;

        $subscriptions = $this->get_subscriptions();

        if ( array_key_exists( $feature, $subscriptions ) ) {
            $quantity = (array) $subscriptions[$feature];

            $used = $quantity['used'];
        }

        return $used;
    }

    /**
     * Make the request to the API endpons
     * @param $url The end part of the url to make the request.
     *        $body The body to send the message
     *        $method POST | GET | PUT, etc
     *        or send a customized message to be showed in case of error
     *        $decode_response_body TRUE (default) to decode the body response
     * @return stdClass with the the fields:
     *         is_error TRUE or FALSE
     *         error in case of is_error be true
     *         body in case of is_error be false
     */
    protected function request_api(  $method, $url, $body = null, $decode_response_body = true, $custom_headers = null ) {
        $request = array(
            'method'  => $method,
            'accept'  => 'application/json',
            'headers' => $this->_get_headers( $custom_headers ),
            'timeout' => self::DEFAULT_TIMEOUT
        );
        if ( ! is_null( $body ) ) {
            $request['body'] = $body;
        }
        $response    = wp_remote_request( $url, $request );
        $result      = new stdClass();
        $result->url = $url;
        $result->raw = $response;
        if ( is_wp_error( $response ) ) {
            $result->is_error = true;
            $result->error    = $response->get_error_message();
        } else {
            $result->response_code = wp_remote_retrieve_response_code( $response );
            if ( 200 === $result->response_code ) {
                if ( true === $decode_response_body ) {
                    $result->body     = json_decode( $response['body'] );
                    if ( false === is_null( $result->body ) ) {
                        $result->is_error = false;
                    } else {
                        $result->is_error = true;
                        $result->error    = __( 'Error decoding the response', AI1EC_PLUGIN_NAME );
                        unset( $result->body );
                    }
                } else {
                    $result->is_error = false;
                    $result->body     = $response['body'];
                }
            } else {
                $result->is_error = true;
                $result->error    = wp_remote_retrieve_response_message( $response );
            }
        }
        return $result;
    }

    /**
     * Make a post request to the api
     * @param rest_endpoint Partial URL that can include {calendar_id} that will be replaced by the current calendar signed
     */
    public function call_api( $method, $endpoint, $body = null, $decode_response_body = true, $custom_headers = null ) {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            return false;
        }
        $url  = AI1EC_API_URL . str_replace( '{calendar_id}', $calendar_id, $endpoint );
        return $this->request_api( $method, $url, $body, $decode_response_body, $custom_headers );
    }

    /**
     * Save an error notification to be showed to the user on WP header of the page
     * @param $response The response got from request_api method.
     *        $custom_error_message The custom message to show before the detailed message
     * @return full error message
     */
    protected function save_error_notification( $response, $custom_error_response ) {
        $error_message = $this->_transform_error_message(
            $custom_error_response,
            $response->raw,
            $response->url,
            true
        );
        $response->error_message = $error_message;
        $notification            = $this->_registry->get( 'notification.admin' );
        $notification->store( $error_message, 'error', 0, array( Ai1ec_Notification_Admin::RCPT_ADMIN ), false );
        error_log( $custom_error_response . ': ' . $error_message . ' - raw error: ' . print_r( $response->raw, true ) );
        return $error_message;
    }

    /**
     * Save an error notification to be showed to the user on WP header of the page
     * @param $response The response got from request_api method.
     *        $custom_error_message The custom message to show before the detailed message
     * @return full error message
     */
    protected function log_error( $response, $custom_error_response ) {
        $error_message = $this->_transform_error_message(
            $custom_error_response,
            $response->raw,
            $response->url,
            true
        );
        error_log( $custom_error_response . ': ' . $error_message . ' - raw error: ' . print_r( $response->raw, true ) );
        return $error_message;
    }

    protected function show_error( $error_message ) {
        $notification            = $this->_registry->get( 'notification.admin' );
        $notification->store( $error_message, 'error', 0, array( Ai1ec_Notification_Admin::RCPT_ADMIN ), false );
        error_log( $error_message);
        return $error_message;
    }

    /**
     * Useful method to check if the response of request_api is a successful message
     */
    public function is_response_success( $response ) {
        return $response != null &&
            ( !isset( $response->is_error ) || ( isset( $response->is_error ) && false === $response->is_error ) );
    }

    public function sendEvent( $eventId ) {
        try {
            if ( ! $this->is_signed() ) {
                return;
            }

            $sendEvent = false;
            foreach ( Ai1ec_Api_Features::$features as $key => $value ) {
                if ( empty( $value ) && $key !== Ai1ec_Api_Features::CODE_TICKETING ) {
                    continue;
                }
                if ( $this->has_subscription_active( $key ) ) {
                    $sendEvent = true;
                    break;
                }
            }
            if ( ! $sendEvent ) {
                return;
            }

            $api_settings = $this->get_ticketing_settings();

            $email = null;
            if ( $api_settings && isset( $api_settings['account'] ) ) {
                $email = trim( $api_settings['account'] );
            }
            if ( ! $email ) {
                return;
            }

            if ( ! function_exists( 'curl_init' ) ) {
                return;
            }

            $ch = curl_init();
            curl_setopt( $ch, CURLOPT_URL, 'https://track.hubspot.com/v1/event?_n=' . $eventId . '&_a=3832990&email=' . $email );
            curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
            curl_exec( $ch );
            curl_close( $ch );
        } catch ( Exception $e ) {}
    }
}


==================================================
FILE PATH: ./app/model/api/api-feeds.php
==================================================
<?php

/**
 * Class for Timely API communication related to Discover Events and Feeds.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.4
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Api_Feeds extends Ai1ec_Api_Abstract {

    // Feed status
    // c = Feed not migrated yet to API
    // a = Feed migrated to API (all events)
    // b = Feed migrated to API (individual events were selected)
    public static $FEED_NOT_MIGRATED_CODE    = 'c';
    public static $FEED_API_ALL_EVENTS_CODE  = 'a';
    public static $FEED_API_SOME_EVENTS_CODE = 'b';

    /**
     * Post construction routine.
     *
     * Override this method to perform post-construction tasks.
     *
     * @return void Return from this method is ignored.
     */
    protected function _initialize() {
        parent::_initialize();
    }

    /**
     * Get static var (for PHP 5.2 compatibility)
     *
     * @param String $var
     */
    public function getStaticVar($var) {
        return self::$$var;
    }

    /**
     * Getting a suggested events list.
     * @return stClass Response using the following format:
     * [total] => 10
     * [per_page] => 8
     * [current_page] => 1
     * [last_page] => 2
     * [next_page_url] =>
     * [prev_page_url] =>
     * [from] => 1
     * [to] => 8
     * [data] => Array list of suggested events
     */
    public function get_suggested_events() {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            throw new Exception( 'Calendar ID not found' );
        }

        $body = null;
        if (
            isset( $_POST[ 'lat' ] ) &&
            isset( $_POST[ 'lng' ] ) &&
            isset( $_POST[ 'radius' ] )
        ) {
            $body = array(
                'lat'    => $_POST[ 'lat' ],
                'lng'    => $_POST[ 'lng' ],
                'radius' => $_POST[ 'radius' ]
            );
        }

        $page     = isset( $_POST[ 'page' ] ) ? $_POST[ 'page' ] : 1;
        $max      = isset( $_POST[ 'max' ] ) ? $_POST[ 'max' ] : 8;
        $term     = isset( $_POST[ 'term' ] ) && $_POST[ 'term' ]
            ? urlencode( $_POST[ 'term' ] )
            : '*';
        $location = isset( $_POST[ 'location' ] ) && $_POST[ 'location' ]
            ? '&location=' . urlencode( $_POST[ 'location' ] )
            : '';

        $url      = AI1EC_API_URL .
            "calendars/$calendar_id/discover/events?page=$page&max=$max&term=$term" .
            $location;

        $response = $this->request_api( 'GET', $url,
            $body,
            true //decode body response
        );

        if ( $this->is_response_success( $response ) ) {
            return $response->body;
        }  else {
            $this->save_error_notification(
                $response,
                __( 'We were unable to get the Suggested Events from Time.ly Network', AI1EC_PLUGIN_NAME )
            );
            throw new Exception( 'We were unable to get the Suggested Events from Time.ly Network' );
        }
    }

    /**
     * Call the API to Process and Import the Feed
     */
    public function import_feed( $entry ) {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            throw new Exception( 'Calendar ID not found' );
        }
        $response = $this->request_api( 'POST', AI1EC_API_URL . 'calendars/' . $calendar_id . '/feeds/import',
            array(
                'url'                           => $entry['feed_url'],
                'categories'                    => $entry['feed_category'],
                'tags'                          => $entry['feed_tags'],
                'allow_comments'                => $entry['comments_enabled'],
                'show_maps'                     => $entry['map_display_enabled'],
                'import_any_tag_and_categories' => $entry['keep_tags_categories'],
                'preserve_imported_events'      => $entry['keep_old_events'],
                'assign_default_utc'            => $entry['import_timezone']
            )
        );

        if ( $this->is_response_success( $response ) ) {
            // Refresh list of subscriptions and limits
            $this->get_subscriptions( true );

            return $response->body;
        } else {
            $this->save_error_notification(
                $response,
                __( 'We were unable to import feed', AI1EC_PLUGIN_NAME )
            );
            throw new Exception( $this->get_api_error_msg( $response->raw ) );
        }
    }

    /**
     * Call the API to get the feed
     */
    public function get_feed( $feed_id ) {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            throw new Exception( 'Calendar ID not found' );
        }
        $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars/' . $calendar_id . '/feeds/get/' . $feed_id,
            array( 'max' => '9999' )
        );

        if ( $this->is_response_success( $response ) ) {
            return $response->body;
        } else {
            $this->save_error_notification(
                $response,
                __( 'We were unable to get feed data', AI1EC_PLUGIN_NAME )
            );
            throw new Exception( $this->get_api_error_msg( $response->raw ) );
        }
    }

    /**
     * Call the API to get list of feed subscriptions
     */
    public function get_feed_subscriptions( $force_refresh = false ) {
        $feeds_subscriptions = get_transient( 'ai1ec_api_feeds_subscriptions' );

        if ( $force_refresh || false === $feeds_subscriptions ) {
            $response = $this->request_api( 'GET', AI1EC_API_URL . 'calendars/' . $this->_get_ticket_calendar() . '/feeds/list',
                null,
                true
            );

            if ( $this->is_response_success( $response ) ) {
                $feeds_subscriptions = (array) $response->body;
            } else {
                $feeds_subscriptions = array();
            }

            // Save for 5 minutes
            $minutes = 5;
            set_transient( 'ai1ec_api_feeds_subscriptions', $feeds_subscriptions, $minutes * 60 );
        }

        return $feeds_subscriptions;
    }

    /**
     * Sync feed subscriptions
     */
    public function get_and_sync_feed_subscriptions() {
        $feeds_subscriptions = $this->get_feed_subscriptions();

        $db = $this->_registry->get( 'dbi.dbi' );
        $table_name = $db->get_table_name( 'ai1ec_event_feeds' );

        // Select all feeds
        $rows = $db->select(
            $table_name,
            array(
                'feed_id',
                'feed_url',
                'feed_name',
                'feed_category',
                'feed_tags',
                'comments_enabled',
                'map_display_enabled',
                'keep_tags_categories',
                'keep_old_events',
                'import_timezone'
            )
        );

        // Iterate over API response
        foreach( $feeds_subscriptions as $api_feed ) {
            $found           = false;

            foreach ( $rows as $row ) {
                // Check if URL is the same
                if ( trim( $row->feed_url ) === trim( $api_feed->url ) ) {
                    $found = true;

                    // Update feed
                    $db->update(
                        $table_name,
                        array(
                            'comments_enabled'     => $api_feed->allow_comments,
                            'map_display_enabled'  => $api_feed->show_maps,
                            'keep_tags_categories' => $api_feed->import_any_tag_and_categories,
                            'keep_old_events'      => $api_feed->preserve_imported_events,
                            'import_timezone'      => $api_feed->assign_default_utc,
                            'feed_name'            => $api_feed->feed_id
                        ),
                        array(
                            'feed_id'              => $row->feed_id
                        )
                    );
                }
            }

            // Not found in local database.. Insert
            if ( ! $found ) {
                $entry = array(
                    'feed_url'             => $api_feed->url,
                    'feed_name'            => $api_feed->feed_id,
                    'feed_category'        => $api_feed->categories,
                    'feed_tags'            => $api_feed->tags,
                    'comments_enabled'     => $api_feed->allow_comments,
                    'map_display_enabled'  => $api_feed->show_maps,
                    'keep_tags_categories' => $api_feed->import_any_tag_and_categories,
                    'keep_old_events'      => $api_feed->preserve_imported_events,
                    'import_timezone'      => $api_feed->assign_default_utc
                );
                $format = array( '%s', '%s', '%s', '%s', '%d', '%d', '%d', '%d', '%d' );
                $db->insert(
                    $table_name,
                    $entry,
                $format
                );
            }
        }
    }

    /**
     * Call the API to subscribe feed
     */
    public function subscribe_feed( $feed_id, $feed_event_uid = '' ) {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            throw new Exception( 'Calendar ID not found' );
        }

        $response = $this->request_api( 'POST', AI1EC_API_URL . 'calendars/' . $calendar_id . '/feeds/subscribe',
            array(
                'feed_id'        => $feed_id,
                'feed_event_uid' => $feed_event_uid
            )
        );

        // Refresh list of subscriptions and limits
        $this->get_subscriptions( true );

        if ( $this->is_response_success( $response ) ) {
            return $response->body;
        } else {
            $this->save_error_notification(
                $response,
                __( 'We were unable to subscribe feed', AI1EC_PLUGIN_NAME )
            );
            throw new Exception( $this->get_api_error_msg( $response->raw ) );
        }
    }

    /**
     * Call the API to unsubscribe feed
     */
    public function unsubscribe_feed( $feed_id, $feed_event_uid = '' ) {
        $calendar_id = $this->_get_ticket_calendar();
        if ( 0 >= $calendar_id ) {
            throw new Exception( 'Calendar ID not found' );
        }

        $response = $this->request_api( 'POST', AI1EC_API_URL . 'calendars/' . $calendar_id . '/feeds/unsubscribe',
            array(
                'feed_id'        => $feed_id,
                'feed_event_uid' => $feed_event_uid
            )
        );

        // Refresh list of subscriptions and limits
        $this->get_subscriptions( true );

        if ( $this->is_response_success( $response ) ) {
            return $response->body;
        } else {
            $this->save_error_notification(
                $response,
                __( 'We were unable to unsubscribe feed', AI1EC_PLUGIN_NAME )
            );
            throw new Exception( $this->get_api_error_msg( $response->raw ) );
        }
    }
}


==================================================
FILE PATH: ./app/model/api/api-ticketing.php
==================================================
<?php

/**
 * Class for Timely API communication for Ticketing.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.4
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Api_Ticketing extends Ai1ec_Api_Abstract {

    const API_EVENT_DATA            = '_ai1ec_api_event_id';

    const ATTR_EVENT_ID             = 'api_event_id';
    const ATTR_THUMBNAIL_ID         = 'thumbnail_id';
    const ATTR_ICS_CHECKOUT_URL     = 'ics_checkout_url';
    const ATTR_ICS_API_URL          = 'ics_api_url';
    const ATTR_ACCOUNT              = 'account';
    const ATTR_CALENDAR_ID          = 'calendar_id';
    const ATTR_CURRENCY             = 'currency';

    const MAX_TICKET_TO_BUY_DEFAULT = 25;

    /**
     * Post construction routine.
     *
     * Override this method to perform post-construction tasks.
     *
     * @return void Return from this method is ignored.
     */
    protected function _initialize() {
        parent::_initialize();
    }

    /**
     * Count the valid Tickets Types (not removed) included inside the Ticket Event
     */
    private function _count_valid_tickets( $post_ticket_types ) {
        if (false === isset( $post_ticket_types ) || 0 === count( $post_ticket_types ) ) {
            return 0;
        } else {
            $count = 0;
            foreach ( $post_ticket_types as $ticket_type_ite ) {
                if ( !isset( $ticket_type_ite['remove'] ) ) {
                    $count++;
                }
            }
            return $count;
        }
    }

    /**
     * Return an error if the Ticket Event is not owned by the Current account
     */
    private function _prevent_update_ticket_event( Ai1ec_Event $event, $ajax_action = false ) {
        if ( $this->is_ticket_event_imported( $event->get( 'post_id' ) ) )  {
            //prevent changes on Ticket Events that were imported
            $error        = __( 'This Event was replicated from another site. Changes are not allowed.', AI1EC_PLUGIN_NAME );
            if ( ! $ajax_action ) {
                $notification = $this->_registry->get( 'notification.admin' );
                $notification->store(
                    $error,
                    'error',
                    0,
                    array( Ai1ec_Notification_Admin::RCPT_ADMIN ),
                    false
                );
            }
            return $error;
        }
        if ( $this->is_ticket_event_from_another_account( $event->get( 'post_id' ) ) )  {
            //prevent changes on Ticket Events that were imported
            $error        = sprintf(
                        __( 'This Event was created using a different account %s. Changes are not allowed.', AI1EC_PLUGIN_NAME ),
                        $this->get_api_event_account( $event->get( 'post_id' ) )
                    );
            if ( ! $ajax_action ) {
                $notification = $this->_registry->get( 'notification.admin' );
                $notification->store(
                    $error,
                    'error',
                    0,
                    array( Ai1ec_Notification_Admin::RCPT_ADMIN ),
                    false
                );
            }
            return $error;
        }
        return null;
    }

    /**
     * Run some validations inside the _POST request to check if the Event
     * submmited is a valid event for Tickets
     * @return NULL in case of success or a Message in case of error
     */
    private function _is_valid_post( Ai1ec_Event $event, $updating ) {
        $message = null;
        if ( ( isset( $_POST['ai1ec_rdate'] ) && ! empty( $_POST['ai1ec_rdate'] ) ) ||
             ( isset( $_POST['ai1ec_repeat'] ) && ! empty( $_POST['ai1ec_repeat'] ) )
             ) {
            $message = __( 'The Repeat option was selected but recurrence is not supported by Event with Tickets.', AI1EC_PLUGIN_NAME );
        } else if ( isset( $_POST['ai1ec_tickets_loading_error'] ) ) {
            //do not update tickets because is unsafe. There was a problem to load the tickets,
            //the customer received the same message when the event was loaded.
            $message = $_POST['ai1ec_tickets_loading_error'];
        } else if ( false === ai1ec_is_blank( $event->get( 'ical_feed_url' ) ) ) {
            //prevent ticket creating inside Regular Events Imported events
            $message = __( 'This Event was replicated from another site. Any changes on Tickets were discarded.', AI1EC_PLUGIN_NAME );
        } else {
            $error = $this->_prevent_update_ticket_event( $event );
            if ( null !== $error ) {
                $message = $error;
            } else if ( ! isset( $_POST['ai1ec_tickets'] ) || 0 === $this->_count_valid_tickets( $_POST['ai1ec_tickets'] ) ) {
                $message      = __( 'The Event has the cost option Ticket selected but no ticket was included.', AI1EC_PLUGIN_NAME );
            } else if ( false === $this->has_payment_settings() ) {
                $message = __( 'You need to save the payments settings to create ticket events.', AI1EC_PLUGIN_NAME );
            } else if ( ! isset( $_POST['tax_options'] ) && ! $updating ) {
                $message =     __( 'Tax and Invoice options are required.', AI1EC_PLUGIN_NAME );
            }
        }
        if ( null !== $message ) {
            $notification = $this->_registry->get( 'notification.admin' );
            $notification->store( $message, 'error', 0, array( Ai1ec_Notification_Admin::RCPT_ADMIN ), false );
            return $message;
        }
        return null;
    }

    /**
    *  Create or update a Ticket Event on API server
     * @return object Response body in JSON.
     */
    public function store_event( Ai1ec_Event $event, WP_Post $post, $updating ) {

        $error = $this->_is_valid_post( $event, $updating );
        if ( null !== $error ) {
            return $error;
        }
        $api_event_id = $this->get_api_event_id( $event->get( 'post_id' ) );
        $is_new       = ! $api_event_id;
        $fields       = array( 'visibility' => $_POST['visibility'] );
        if ( isset( $_POST['tax_options'] ) ) {
            $fields['tax_options'] = $_POST['tax_options'];
        }
        $body_data    = $this->parse_event_fields_to_api_structure(
            $event,
            $post,
            $_POST['ai1ec_tickets'],
            $fields
        );
        $url = AI1EC_API_URL . 'events';
        if ( $api_event_id ) {
            $url = $url . '/' . $api_event_id;
        }

        //get the thumbnail id saved previously
        $api_data = $this->get_api_event_data( $event->get( 'post_id' ) );
        if ( isset( $api_data[self::ATTR_THUMBNAIL_ID] ) ) {
            $event_thumbnail_id = $api_data[self::ATTR_THUMBNAIL_ID];
        } else {
            $event_thumbnail_id = 0;
        }
        //get the current thumbnail id
        $post_thumbnail_id  = get_post_thumbnail_id( $event->get( 'post_id' ) );
        if ( false === isset( $post_thumbnail_id ) ) {
            $post_thumbnail_id = 0;
        }
        $update_image   = ( $event_thumbnail_id !== $post_thumbnail_id );
        $payload        = '';
        $custom_headers = null;

        if ( true === $update_image && 0 < $post_thumbnail_id ) {
            $boundary                       = wp_generate_password( 24 );
            $custom_headers['Content-Type'] = 'multipart/form-data; boundary=' . $boundary;
            $body_data['update_image']      = '1';
            foreach ($body_data as $key => $value) {
                if ( is_array( $value ) ) {
                    $index = 0;
                    foreach ( $value as $arr_key => $arr_value ) {
                        if ( is_array( $arr_value ) ) {
                            foreach ( $arr_value as $child_key => $child_value ) {
                                $payload .= '--' . $boundary;
                                $payload .= "\r\n";
                                $payload .= 'Content-Disposition: form-data; name="' . $key . '[' . $index . '][' . $child_key . ']"' . "\r\n";
                                $payload .= "\r\n";
                                $payload .= $child_value;
                                $payload .= "\r\n";
                            }
                        } else {
                            $payload .= '--' . $boundary;
                            $payload .= "\r\n";
                            $payload .= 'Content-Disposition: form-data; name="tax_options[' . $arr_key . ']"' . "\r\n";
                            $payload .= "\r\n";
                            $payload .= $arr_value;
                            $payload .= "\r\n";
                        }
                        $index++;
                    }
                } else {
                    $payload .= '--' . $boundary;
                    $payload .= "\r\n";
                    $payload .= 'Content-Disposition: form-data; name="' . $key . '"' . "\r\n";
                    $payload .= "\r\n";
                    $payload .= $value;
                    $payload .= "\r\n";
                }
            }
            $file_path = get_attached_file ( $post_thumbnail_id );
            $file_type = wp_check_filetype ( $file_path );
            $payload  .= '--' . $boundary;
            $payload  .= "\r\n";
            $payload  .= 'Content-Disposition: form-data; name="image_id"; filename="' . basename( $file_path ) . '"' . "\r\n";
            $payload  .= 'Content-Type: ' . $file_type['type'] . "\r\n";
            $payload  .= "\r\n";
            $payload  .= file_get_contents( $file_path );
            $payload  .= "\r\n";
            $payload  .= '--' . $boundary . '--';
        } else {
            $body_data['update_image'] = (true === $update_image) ? '1' : '0';
            $payload                   = $body_data;
        }
        $response = $this->request_api( 'POST', $url, $payload,
            true, //true to decode response body
            $custom_headers
            );
        if ( $this->is_response_success( $response ) ) {
            $api_event_id = $response->body->id;
            if ( isset( $response->body->currency ) ) {
                $currency = $response->body->currency;
            } else {
                $currency = 'USD';
            }
            $currency     = $response->body->currency;
            if ( $post_thumbnail_id <= 0 ) {
                $post_thumbnail_id = null;
            }
            $this->save_api_event_data( $event->get( 'post_id') , $api_event_id,  null, null, $currency, $post_thumbnail_id );
            return true;
        } else {
            $error_message = '';
            if ( $is_new ) {
                $error_message = __( 'We were unable to create the Event on Time.ly Ticketing', AI1EC_PLUGIN_NAME );
            } else {
                $error_message = __( 'We were unable to update the Event on Time.ly Ticketing', AI1EC_PLUGIN_NAME );
            }
            return $this->save_error_notification( $response, $error_message );
        }
    }

    /**
     * Parse the fields of an Event to the structure used by API
     */
    public function parse_event_fields_to_api_structure( Ai1ec_Event $event , WP_Post $post, $post_ticket_types, $api_fields_values  ) {
        $calendar_id = $this->_get_ticket_calendar();
        if ( $calendar_id <= 0 ) {
            return null;
        }

        //fields of ai1ec events table used by API
        $body['latitude']         = $event->get( 'latitude' );
        $body['longitude']        = $event->get( 'longitude' );
        $body['post_id']          = $event->get( 'post_id' );
        $body['calendar_id']      = $calendar_id;
        $body['dtstart']          = $event->get( 'start' )->format_to_javascript();
        $body['dtend']            = $event->getenddate()->format_to_javascript();
        $body['timezone']         = $event->get( 'timezone_name' );
        $body['venue_name']       = $event->get( 'venue' );
        $body['address']          = $event->get( 'address' );
        $body['city']             = $event->get( 'city' );
        $body['province']         = $event->get( 'province' );
        $body['postal_code']      = $event->get( 'postal_code' );
        $body['country']          = $event->get( 'country' );
        $body['contact_name']     = $event->get( 'contact_name' );
        $body['contact_phone']    = $event->get( 'contact_phone' );
        $body['contact_email']    = $event->get( 'contact_email' );
        $body['contact_website']  = $event->get( 'contact_url' );
        $body['uid']              = $event->get_uid();
        $body['title']            = $post->post_title;
        $body['description']      = $post->post_content;
        $body['url']              = get_permalink( $post->ID );
        $body['status']           = $post->post_status;

        $utc_current_time         = $this->_registry->get( 'date.time')->format_to_javascript();
        $body['created_at']       = $utc_current_time;
        $body['updated_at']       = $utc_current_time;

        //removing blank values
        foreach ($body as $key => $value) {
            if ( ai1ec_is_blank( $value ) ) {
                unset( $body[ $key ] );
            }
        }

        if ( is_null( $api_fields_values ) || 0 == count( $api_fields_values ) ) {
            $api_fields_values = array( 'status' => 'closed', 'ai1ec_version' => AI1EC_VERSION );
        } else {
            if ( ! isset( $api_fields_values['ai1ec_version'] ) ) {
                $api_fields_values['ai1ec_version'] = AI1EC_VERSION;
            }
            foreach ( $api_fields_values as $key => $value ) {
                $body[$key] = $api_fields_values[$key];
                if ( 'visibility' === $key ) {
                    if ( 0 === strcasecmp( 'private', $value ) ) {
                        $body['status'] = 'private';
                    } else if ( 0 === strcasecmp( 'password', $value ) ) {
                        $body['status'] = 'password';
                    }
                }
            }
        }

        $tickets_types = array();
        if ( ! is_null( $post_ticket_types ) ) {
            $index         = 0;
            foreach ( $post_ticket_types as $ticket_type_ite ) {
                if ( false === isset( $ticket_type_ite['id'] ) &&
                     isset( $ticket_type_ite['remove'] ) ) {
                    //ignoring new tickets that didn't go to api yet
                    continue;
                }
                $tickets_types[$index++] = $this->_parse_tickets_type_post_to_api_structure(
                    $ticket_type_ite,
                    $event
                );
            }
        }
        $body['ticket_types'] = $tickets_types;

        return $body;
    }

    /**
     * Parse the fields of a Ticket Type to the structure used by API
     */
    protected function _parse_tickets_type_post_to_api_structure( $ticket_type_ite, $event ) {
        $utc_current_time = $this->_registry->get( 'date.time' )->format_to_javascript();
        if ( isset( $ticket_type_ite['id'] ) ) {
            $ticket_type['id']          = $ticket_type_ite['id'];
            $ticket_type['created_at']     = $ticket_type_ite['created_at'];
        } else {
            $ticket_type['created_at']     = $utc_current_time;
        }
        if ( isset( $ticket_type_ite['remove'] ) ) {
            $ticket_type['deleted_at']     = $utc_current_time;
        }
        $ticket_type['name']        = $ticket_type_ite['ticket_name'];
        $ticket_type['description'] = $ticket_type_ite['description'];
        $ticket_type['price']       = $ticket_type_ite['ticket_price'];
        if ( 0 === strcasecmp( 'on',  $ticket_type_ite['unlimited'] ) ) {
            $ticket_type['quantity'] = null;
        } else {
            $ticket_type['quantity'] = $ticket_type_ite['quantity'];
        }
        $ticket_type['buy_min_qty']   = $ticket_type_ite['buy_min_limit'];
        if ( ai1ec_is_blank( $ticket_type_ite['buy_max_limit'] ) ) {
            $ticket_type['buy_max_qty'] = null;
        } else {
            $ticket_type['buy_max_qty'] = $ticket_type_ite['buy_max_limit'];
        }
        if ( 0 === strcasecmp( 'on',  $ticket_type_ite['availibility'] ) ) {
            //immediate availability
            $timezone_start_time            = $this->_registry->get( 'date.time' );
            $timezone_start_time->set_timezone( $event->get('timezone_name') );
            $ticket_type['immediately']     = true;
            $ticket_type['sale_start_date'] = $timezone_start_time->format_to_javascript( $event->get('timezone_name') );
            $ticket_type['sale_end_date']   = $event->get( 'end' )->format_to_javascript();
        } else {
            $ticket_type['immediately']     = false;
            $ticket_type['sale_start_date'] =  $ticket_type_ite['ticket_sale_start_date'];
            $ticket_type['sale_end_date']   =  $ticket_type_ite['ticket_sale_end_date'];
        }
        $ticket_type['updated_at'] = $utc_current_time;
        $ticket_type['status']     = $ticket_type_ite['ticket_status'];
        return $ticket_type;
    }

    /**
     * Unparse the fields of API structure to the Ticket Type
     */
    protected function _unparse_tickets_type_from_api_structure( $ticket_type_api ) {
        $ticket_type                         = $ticket_type_api;
        $ticket_type->ticket_name            = $ticket_type_api->name;
        $ticket_type->ticket_price           = $ticket_type_api->price;
        $ticket_type->buy_min_limit          = $ticket_type_api->buy_min_qty;
        if ( null === $ticket_type_api->buy_max_qty ) {
            $ticket_type->buy_max_limit = self::MAX_TICKET_TO_BUY_DEFAULT;
        } else {
            $ticket_type->buy_max_limit = $ticket_type_api->buy_max_qty;
        }
        if ( true === ( ( bool ) $ticket_type_api->immediately ) ) {
            $ticket_type->availibility = 'on';
        } else {
            $ticket_type->availibility = 'off';
        }
        $ticket_type->ticket_sale_start_date = $ticket_type_api->sale_start_date; //YYYY-MM-YY HH:NN:SS
        $ticket_type->ticket_sale_end_date   = $ticket_type_api->sale_end_date; //YYYY-MM-YY HH:NN:SS
        $ticket_type->ticket_status          = $ticket_type_api->status;
        if ( 'open' === $ticket_type_api->status ) {
            $ticket_type->ticket_status_label = __( 'Open for sale', AI1EC_PLUGIN_NAME );
        } else if ( 'closed' === $ticket_type_api->status )  {
            $ticket_type->ticket_status_label = __( 'Sale ended', AI1EC_PLUGIN_NAME );
        } else if ( 'canceled' === $ticket_type_api->status ) {
            $ticket_type->ticket_status_label = __( 'Canceled', AI1EC_PLUGIN_NAME );
        } else {
            $ticket_type->ticket_status_label = $ticket_type_api->status;
        }
        if ( false === isset( $ticket_type_api->quantity ) ||
            null === $ticket_type_api->quantity ) {
             $ticket_type->unlimited          = 'on';
        } else {
             $ticket_type->unlimited          = 'off';
        }
        $ticket_type->ticket_type_id = $ticket_type_api->id;
        $ticket_type->available      = $ticket_type_api->available;
        $ticket_type->availability   = $this->_parse_availability_message( $ticket_type_api->availability );

        //derived property to set the max quantity of dropdown
        if ( $ticket_type->available !== null ) {
            if ( $ticket_type->available > $ticket_type->buy_max_limit ) {
                $ticket_type->buy_max_available = $ticket_type->buy_max_limit;
            } else {
                $ticket_type->buy_max_available = $ticket_type->available;
            }
        } else {
            $ticket_type->buy_max_available = $ticket_type->buy_max_limit;
        }
        return $ticket_type;
    }

    public function _parse_availability_message( $availability ){
        if ( ai1ec_is_blank ( $availability ) ) {
            return null;
        } else {
            switch ($availability) {
                case 'past_event':
                    return __( 'Past Event' );
                case 'event_closed':
                    return __( 'Event closed' );
                case 'not_available_yet':
                    return __( 'Not available yet' );
                case 'sale_closed':
                    return __( 'Sale closed' );
                case 'sold_out':
                    return __( 'Sold out' );
                default:
                    return __( 'Not available' );
            }
        }
    }

    public function get_event( $post_id ) {
        $api_event_id = $this->get_api_event_id( $post_id );
        if ( ! $api_event_id ) {
            return (object) array( 'data' => array() );
        }
        $response = $this->request_api( 'GET', $this->get_api_event_url( $post_id ) . 'events/' . $api_event_id . '/edit' );
        if ( $this->is_response_success( $response ) ) {
            if ( isset( $response->body->ticket_types ) ) {
                 foreach ( $response->body->ticket_types as $ticket_api ) {
                     $this->_unparse_tickets_type_from_api_structure( $ticket_api );
                }
            }
            return (object) array( 'data' => $response->body );
        } else {
            $error_message = $this->_transform_error_message(
                __( 'We were unable to get the Event Details from Time.ly Ticketing', AI1EC_PLUGIN_NAME ),
                $response->raw, $response->url,
                true
            );
            return (object) array( 'data' => array(), 'error' => $error_message );
        }
    }

    /**
     * @return string JSON.
     */
    public function get_ticket_types( $post_id, $get_canceled = true ) {
        $api_event_id = $this->get_api_event_id( $post_id );
        if ( ! $api_event_id ) {
            return json_encode( array( 'data' => array() ) );
        }
        $response = $this->request_api( 'GET', $this->get_api_event_url( $post_id ) . 'events/' . $api_event_id . '/ticket_types',
            array( 'get_canceled' => ( true === $get_canceled ? 1 : 0 ) )
        );
        if ( $this->is_response_success( $response ) ) {
            if ( isset( $response->body->ticket_types ) ) {
                 foreach ( $response->body->ticket_types as $ticket_api ) {
                     $this->_unparse_tickets_type_from_api_structure( $ticket_api );
                }
                return json_encode( array( 'data' => $response->body->ticket_types ) );
            } else {
                return json_encode( array( 'data' => array() ) );
            }
        } else {
            $error_message = $this->_transform_error_message(
                __( 'We were unable to get the Tickets Details from Time.ly Ticketing', AI1EC_PLUGIN_NAME ),
                $response->raw, $response->url,
                true
            );
            return json_encode( array( 'data' => array(), 'error' => $error_message ) );
        }
    }

    /**
     * @return object Response body in JSON.
     */
    public function get_tickets( $post_id ) {
        $api_event_id = $this->get_api_event_id( $post_id );
        if ( ! $api_event_id ) {
            return json_encode( array( 'data' => array() ) );
        }
        $request  = array(
            'headers' => $this->_get_headers(),
            'timeout' => parent::DEFAULT_TIMEOUT
            );
        $url           = $this->get_api_event_url( $post_id ) . 'events/' . $api_event_id . '/tickets';
        $response      = wp_remote_get( $url, $request );
        $response_code = wp_remote_retrieve_response_code( $response );
        if ( 200 === $response_code ) {
            return $response['body'];
        } else {
            $error_message = $this->_transform_error_message(
                __( 'We were unable to get the Tickets Attendees from Time.ly Ticketing', AI1EC_PLUGIN_NAME ),
                $response, $url,
                true
            );
            return json_encode( array( 'data' => array(), 'error' => $error_message ) );
        }
    }

    /**
     * Check if a Ticket Event was imported from an ICS Feed
     */
    public function is_ticket_event_imported( $post_id ) {
        $data    = $this->get_api_event_data( $post_id );
        if (  isset( $data[self::ATTR_EVENT_ID] ) && isset( $data[self::ATTR_ICS_API_URL] ) ) {
            return ( ! ai1ec_is_blank ( $data[self::ATTR_ICS_API_URL] ) );
        } else {
            return false;
        }

    }

    /**
     * Check if the Ticket Event was created using a different account
     * The user probably created the event from one account, signed out and
     * is currently signed in with a new account
     */
    public function is_ticket_event_from_another_account( $post_id ) {
        $data    = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            if ( isset( $data[self::ATTR_ACCOUNT] ) ) {
                return ( $this->get_current_account() != $data[self::ATTR_ACCOUNT] );
            } else {
                return false;
            }
        } else {
            return false;
        }
    }

    /**
     * Get the API account where the event was created
     * @param int $post_id Post ID
     * @param bool $default_null True to return NULL if the value does not exist, false to return the configured API URL
     */
    public function get_api_event_account( $post_id ) {
        $data    = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            if ( isset( $data[self::ATTR_ACCOUNT] ) ) {
                return $data[self::ATTR_ACCOUNT];
            } else {
                return null;
            }
        } else {
            return null;
        }
    }

    /**
     * Check if the response that came from the API is the event not found
     */
    private function _is_event_notfound_error( $response ) {
        if ( isset( $response->response_code ) && 404 === $response->response_code ) {
            if ( isset( $response->body ) ) {
                if ( is_array( $response->body ) &&
                    isset( $response->body['message'] ) ) {
                    if ( false !== stripos( $response->body['message'], 'event not found') ) {
                        return true;
                    }
                }
            }
        }
        return false;
    }

    /**
     * @return NULL in case of success or an error string in case of error
     */
    public function update_api_event_fields( WP_Post $post, $api_fields_values, $post_action = 'trash', $ajax_action = false ) {
        $post_id      = $post->ID;
           $api_event_id = $this->get_api_event_id( $post_id );
        if ( ! $api_event_id ) {
            return null;
        }
        try {
            $event =  $this->_registry->get( 'model.event', $post_id );
        } catch ( Ai1ec_Event_Not_Found_Exception $excpt ) {
            $message      = __( 'Event not found inside the database.', AI1EC_PLUGIN_NAME );
            $notification = $this->_registry->get( 'notification.admin' );
            $notification->store( $message, 'error', 0, array( Ai1ec_Notification_Admin::RCPT_ADMIN ), false );
            return $message;
        }
        if ( 'update' === $post_action ) {
            $error = $this->_prevent_update_ticket_event( $event, $ajax_action );
            if ( null !== $error ) {
                return $error;
            }
        } else {
            if ( $this->is_ticket_event_imported( $post_id ) )  {
                return null;
            }
            if ( $this->is_ticket_event_from_another_account( $post_id ) )  {
                return null;
            }
        }
        $headers   = $this->_get_headers();
        $body_data = $this->parse_event_fields_to_api_structure(
            $event,
            $post,
            null, //does not update ticket types, just chaging the api fields specified
            $api_fields_values
        );
        $response = $this->request_api( 'POST',
            AI1EC_API_URL . 'events/' . $api_event_id,
            $body_data,
            true //true to decode response body
            );
        if ( ! $this->is_response_success( $response ) ) {
            if ( $this->_is_event_notfound_error( $response ) ) {
                if ( isset( $api_fields_values['status'] ) &&
                    'trash' === $api_fields_values['status'] ) {
                    //this is an exception, the event was deleted on API server, but for some reason
                    //the metada was not unset, in this case leave the event be
                    //move to trash
                    return null;
                }
            }
            $message = $this->save_error_notification( $response, __( 'We were unable to Update the Event on Time.ly Network', AI1EC_PLUGIN_NAME ) );
            return $message;
        } else {
            return null;
        }
    }

    /**
     * Deletes the API event
     * @return NULL in case of success or an error string in case of error
     */
    public function delete_api_event( $post_id, $post_action = 'delete', $ajax_action = false ) {
        $api_event_id = $this->get_api_event_id( $post_id );
        if ( ! $api_event_id ) {
            return null;
        }
        if ( 'update' === $post_action ) {
            try {
                $event =  $this->_registry->get( 'model.event', $post_id );
            } catch ( Ai1ec_Event_Not_Found_Exception $excpt ) {
                $message      = __( 'Event not found inside the database.', AI1EC_PLUGIN_NAME );
                $notification = $this->_registry->get( 'notification.admin' );
                $notification->store( $message, 'error', 0, array( Ai1ec_Notification_Admin::RCPT_ADMIN ), false );
                return $message;
            }
            $error = $this->_prevent_update_ticket_event( $event, $ajax_action );
            if ( null !== $error ) {
                return $error;
            }
        } else {
            if ( $this->is_ticket_event_imported( $post_id ) )  {
                $this->clear_event_metadata( $post_id );
                return null;
            }
            if ( $this->is_ticket_event_from_another_account( $post_id ) )  {
                $this->clear_event_metadata( $post_id );
                return null;
            }
        }
        $response = $this->request_api( 'DELETE',
            AI1EC_API_URL . 'events/' . $api_event_id,
            true //true to decode response body
            );
        if ( $this->is_response_success( $response ) ) {
            $this->clear_event_metadata( $post_id );
            return null;
        } else {
            if ( $this->_is_event_notfound_error( $response ) ) {
                $this->clear_event_metadata( $post_id );
                return null;
            }
            $message = $this->save_error_notification( $response, __( 'We were unable to remove the Event on Time.ly Network', AI1EC_PLUGIN_NAME ) );
            return $message;
        }
    }

    /**
     * Clear the event metadata used by Event from the post id
     * @param int $post_id Post ID
     */
    public function clear_event_metadata( $post_id ) {
        delete_post_meta( $post_id, self::API_EVENT_DATA );
    }

    public function get_api_event_data( $post_id ) {
        $data = get_post_meta(
            $post_id,
            self::API_EVENT_DATA,
            true
        );
        if ( ai1ec_is_blank ( $data ) ) {
            return null;
        } else if ( is_numeric( $data ) ) {
            //migrate the old metadata into one
            $new_data[self::ATTR_EVENT_ID] = $data;
            $value = get_post_meta( $post_id, '_ai1ec_thumbnail_id', true );
            if ( false === ai1ec_is_blank( $value ) ) {
                $new_data[self::ATTR_THUMBNAIL_ID] = $value;
            }
            $value = get_post_meta( $post_id, '_ai1ec_ics_checkout_url', true );
            if ( false === ai1ec_is_blank( $value ) ) {
                $new_data[self::ATTR_ICS_CHECKOUT_URL] = $value;
            }
            $value = get_post_meta( $post_id, '_ai1ec_ics_api_url'     , true );
            if ( ai1ec_is_blank( $value ) ) {
                //not imported ticket event
                $new_data[self::ATTR_ACCOUNT]          = $this->get_current_account();
                $new_data[self::ATTR_CALENDAR_ID]      = $this->get_current_calendar();
            } else {
                $new_data[self::ATTR_ICS_API_URL] = $value;
            }
            $new_data[self::ATTR_CURRENCY] = 'USD';
            update_post_meta( $post_id, self::API_EVENT_DATA, $new_data );
            return $new_data;
        } else if ( is_array( $data ) ) {
            return $data;
        } else {
            wp_die( 'Error geting the api data' );
        }
    }

    /**
     * Get the id of the event on the API
     * @param int $post_id Post ID
     */
    public function get_api_event_id( $post_id ) {
        $data = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            return $data[self::ATTR_EVENT_ID];
        } else {
            return null;
        }
    }

    /**
     * Get the API URL of the event
     * @param int $post_id Post ID
     * @param bool $default_null True to return NULL if the value does not exist, false to return the configured API URL
     */
    public function get_api_event_url ( $post_id ) {
        $data    = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            if ( isset( $data[self::ATTR_ICS_API_URL] ) ) {
                return $data[self::ATTR_ICS_API_URL];
            } else {
                return AI1EC_API_URL;
            }
        } else {
            return null;
        }
    }

    /**
     * Get the Currency of the event
     * @param int $post_id Post ID
     */
    public function get_api_event_currency ( $post_id ) {
        $data    = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            if ( isset( $data[self::ATTR_CURRENCY] ) ) {
                return $data[self::ATTR_CURRENCY];
            } else {
                return 'USD';
            }
        } else {
            return null;
        }
    }

    /**
     * Get the Checkout url of the event
     * @param int $post_id Post ID
     */
    public function get_api_event_checkout_url ( $post_id ) {
        $data = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            if ( isset( $data[self::ATTR_ICS_CHECKOUT_URL] ) ) {
                return $data[self::ATTR_ICS_CHECKOUT_URL];
            } else {
                return AI1EC_TICKETS_CHECKOUT_URL;
            }
        } else {
            return null;
        }
    }

    /**
     * Get the Buy Ticket URL of the event
     * @param int $post_id Post ID
     */
    public function get_api_event_buy_ticket_url ( $post_id ) {
        $data = $this->get_api_event_data( $post_id );
        if ( isset( $data[self::ATTR_EVENT_ID] ) ) {
            $api_event_id = $data[self::ATTR_EVENT_ID];
            if ( isset( $data[self::ATTR_ICS_CHECKOUT_URL] ) ) {
                $checkout_url = $data[self::ATTR_ICS_CHECKOUT_URL];
            } else {
                $checkout_url = AI1EC_TICKETS_CHECKOUT_URL;
            }
            return str_replace( '{event_id}', $api_event_id, $checkout_url );
        } else {
            return null;
        }
    }

     /**
     * Get tax options modal
     * @param int $event_id Event ID (optional)
     */
     public function get_tax_options_modal( $post_id = null ) {
         $calendar_id = $this->_get_ticket_calendar();
         $event_id    = $this->get_api_event_id( $post_id );
         $response    = $this->request_api( 'GET',
            AI1EC_API_URL . 'calendars/' . $calendar_id . '/tax_options' .
            ( is_null( $event_id ) ? '' : '?event_id=' . $event_id )
         );
         return (object) array( 'data' => $response->raw, 'error' => false );
    }

     /**
     * Get tax options modal
     * @param int $event_id Event ID (optional)
     */
     public function get_tax_options_modal_ep() {
         $calendar_id = $this->_get_ticket_calendar();
         $response    = $this->request_api( 'GET',
            AI1EC_API_URL . 'eventpromote/' . $calendar_id . '/tax_options'
         );
         return (object) array( 'data' => $response->raw, 'error' => false );
    }

     /**
      * Save the API event data
      * @param int $post_id Post ID
      * @param int $api_event_id (optional) Id of the event on the API
      * @param string $ics_api_url (optional) API URL of the event on the API (used when importing an ICS feed)
      * @param string $ics_checkout_url (optional) API CHECKOUT URL of the event on the API (used when importing an ICS feed)
     * @param string $currency (optional) Currency code of the event
     * @param string $thumbnail_id (optional) Id of the Thumbnail (Featured Image id)
      */
    public function save_api_event_data( $post_id, $api_event_id, $ics_api_url = null, $ics_checkout_url = null, $currency = null, $thumbnail_id = null ) {
        if ( ai1ec_is_blank( $api_event_id ) ) {
            throw new Error( 'Api event id should never be null' );
        }
        $api_data[self::ATTR_EVENT_ID]         = $api_event_id;
        $api_data[self::ATTR_ICS_API_URL]      = $ics_api_url;
        $api_data[self::ATTR_ICS_CHECKOUT_URL] = $ics_checkout_url;
        $api_data[self::ATTR_CURRENCY]         = $currency;
        $api_data[self::ATTR_THUMBNAIL_ID]     = $thumbnail_id;
        if ( ai1ec_is_blank( $ics_api_url ) ) {
            $api_data[self::ATTR_ACCOUNT]          = $this->get_current_account();
            $api_data[self::ATTR_CALENDAR_ID]      = $this->get_current_calendar();
        }
        $previous_data = $this->get_api_event_data( $post_id );
        $new_data      = array();
        if ( is_array( $previous_data ) ) {
            foreach ( $previous_data as $key => $value) {
                $new_data[$key] = $value;
            }
        }
        foreach ( $api_data as $key => $value ) {
            if ( ai1ec_is_blank( $value ) ) {
                unset( $new_data[$key] );
            } else {
                $new_data[$key] = $api_data[$key];
            }
        }
        return update_post_meta( $post_id, self::API_EVENT_DATA, $new_data, $previous_data );
    }

}

==================================================
FILE PATH: ./app/model/api/api-features.php
==================================================
<?php
class Ai1ec_Api_Features {

    const CODE_API_ACCESS           = 'api-access';
    const CODE_TICKETING            = 'ticketing';
    const CODE_TWITTER              = 'twitter';
    const CODE_FRONTEND_SUBMISSIONS = 'frontend-submissions';
    const CODE_CSV_IMPORT           = 'csv-import';
    const CODE_SUPER_WIDGET         = 'super-widget';
    const CODE_EXTENDED_VIEWS       = 'extended-views';
    const CODE_BIG_FILTERING        = 'big-filtering';
    const CODE_CUSTOM_FILTERS       = 'custom-filter-groups';
    const CODE_DISCOVER_EVENTS      = 'discover-events';
    const CODE_EVENT_PROMOTE        = 'event-promote';
    const CODE_FACEBOOK_INTEGRATION = 'facebook-integration';
    const CODE_FEATURED_EVENTS      = 'featured-events';
    const CODE_MAILCHIMP            = 'mailchimp';
    const CODE_PHRASE_OVERRIDE      = 'phrase-override';
    const CODE_POPOVERS             = 'popovers';
    const CODE_SAVE_AND_SHARE       = 'save-and-share';
    const CODE_VENUES               = 'venues';
    const CODE_IMPORT_FEEDS         = 'import-feeds';

    public static $features = array(
        self::CODE_API_ACCESS           => '',
        self::CODE_TICKETING            => '',
        self::CODE_TWITTER              => 'all-in-one-event-calendar-twitter-integration/all-in-one-event-calendar-twitter-integration.php',
        self::CODE_FRONTEND_SUBMISSIONS => 'all-in-one-event-calendar-frontend-submissions/all-in-one-event-calendar-frontend-submissions.php',
        self::CODE_CSV_IMPORT           => 'all-in-one-event-calendar-csv-feed/all-in-one-event-calendar-csv-feed.php',
        self::CODE_SUPER_WIDGET         => 'all-in-one-event-calendar-super-widget/all-in-one-event-calendar-super-widget.php',
        self::CODE_EXTENDED_VIEWS       => 'all-in-one-event-calendar-extended-views/all-in-one-event-calendar-extended-views.php',
        self::CODE_BIG_FILTERING        => 'all-in-one-event-calendar-big-filtering/all-in-one-event-calendar-big-filtering.php',
        self::CODE_CUSTOM_FILTERS       => 'all-in-one-event-calendar-custom-filter-groups/all-in-one-event-calendar-custom-filter-groups.php',
        self::CODE_DISCOVER_EVENTS      => '',
        self::CODE_EVENT_PROMOTE        => 'all-in-one-event-calendar-event-promote/all-in-one-event-calendar-event-promote.php',
        self::CODE_FACEBOOK_INTEGRATION => 'all-in-one-event-calendar-facebook-integration/all-in-one-event-calendar-facebook-integration.php',
        self::CODE_FEATURED_EVENTS      => 'all-in-one-event-calendar-featured-events/all-in-one-event-calendar-featured-events.php',
        self::CODE_MAILCHIMP            => 'all-in-one-event-calendar-mailchimp/all-in-one-event-calendar-mailchimp.php',
        self::CODE_PHRASE_OVERRIDE      => 'all-in-one-event-calendar-phrase-override/all-in-one-event-calendar-phrase-override.php',
        self::CODE_POPOVERS             => 'all-in-one-event-calendar-popovers/all-in-one-event-calendar-popovers.php',
        self::CODE_SAVE_AND_SHARE       => 'all-in-one-event-calendar-save-and-share/all-in-one-event-calendar-save-and-share.php',
        self::CODE_VENUES               => 'all-in-one-event-calendar-venue/all-in-one-event-calendar-venue.php',
        self::CODE_IMPORT_FEEDS         => '',
    );
}


==================================================
FILE PATH: ./app/model/meta-user.php
==================================================
<?php

/**
 * User meta entries management.
 *
 * Meta entries management based on {@see Ai1ec_Meta} class.
 *
 * @author     Time.ly Network, Inc.
 * @since      2.0
 * @package    Ai1EC
 * @subpackage Ai1EC.Model
 */
class Ai1ec_Meta_User extends Ai1ec_Meta {

    /**
     * Get meta value for current user.
     *
     * @param string $meta_key Name of meta entry to get for current user.
     * @param mixed  $default  Value to return if no entry found.
     *
     * @return mixed Current user's option or $default if none found.
     */
    public function get_current( $meta_key, $default = null ) {
        $user_id = 0;
        if ( is_callable( 'wp_get_current_user' ) ) {
            $user    = wp_get_current_user();
            $user_id = (int)$user->ID;
            unset( $user );
        }
        if ( $user_id <= 0 ) {
            return $default;
        }
        return $this->get( $user_id, $meta_key, $default );
    }

    /**
     * user_selected_tz method
     *
     * Get/set user selected (preferred) timezone.
     * If only {@see $user_id} is provided - method acts as getter.
     * Otherwise it acts as setter.
     *
     * @param int    $user_id      ID of user whose timezone is being checked/changed
     * @param string $new_value    New timezone string value to set user preferrence
     * @param bool   $force_update Set to true to force value update instead of add
     *
     * @return mixed Return value depends on activity:
     *     - [getter] string User preferred timezone name (might be empty string)
     *     - [setter] bool   Success of preferrence change
     */
    public function user_selected_tz(
        $user_id,
        $new_value    = NULL,
        $force_update = false
    ) {
        $meta_key  = 'ai1ec_timezone';
        $user_id   = (int)$user_id;
        $old_value = $this->get(
            $user_id,
            $meta_key,
            NULL,
            true
        );
        if ( NULL !== $new_value ) {
            if ( ! in_array( $new_value, timezone_identifiers_list() ) ) {
                return false;
            }
            $success = false;
            if ( true === $force_update || ! empty( $old_value ) ) {
                $success = update_user_meta(
                    $user_id,
                    $meta_key,
                    $new_value,
                    $old_value
                );
            } else {
                $success = add_user_meta(
                    $user_id,
                    $meta_key,
                    $new_value,
                    true
                );
                if ( false === $success ) {
                    return $this->user_selected_tz(
                        $user_id,
                        $new_value,
                        true
                    );
                }
            }
            return $success;
        }
        return $old_value;
    }

}

==================================================
FILE PATH: ./app/model/search.php
==================================================
<?php

/**
 * Search Event.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.search
 */
class Ai1ec_Event_Search extends Ai1ec_Base {

    /**
     * @var Ai1ec_Dbi instance
     */
    private $_dbi = null;

    /**
     * Caches the ids of the last 'between' query
     *
     * @var array
     */
    protected $_ids_between_cache = array();

    /**
     * Creates local DBI instance.
     */
    public function __construct( Ai1ec_Registry_Object $registry ){
        parent::__construct( $registry );
        $this->_dbi = $this->_registry->get( 'dbi.dbi' );
    }

    /**
     * @return array
     */
    public function get_cached_between_ids() {
        return $this->_ids_between_cache;
    }

    /**
     * Fetches the event object with the given post ID.
     *
     * Uses the WP cache to make this more efficient if possible.
     *
     * @param int      $post_id     The ID of the post associated.
     * @param bool|int $instance_id Instance ID, to fetch post details for.
     *
     * @return Ai1ec_Event The associated event object.
     */
    public function get_event( $post_id, $instance_id = false ) {
        $post_id     = (int)$post_id;
        $instance_id = (int)$instance_id;
        if ( $instance_id < 1 ) {
            $instance_id = false;
        }
        return $this->_registry->get( 'model.event', $post_id, $instance_id );
    }

    /**
     * Return events falling within some time range.
     *
     * Return all events starting after the given start time and before the
     * given end time that the currently logged in user has permission to view.
     * If $spanning is true, then also include events that span this
     * period. All-day events are returned first.
     *
     * @param Ai1ec_Date_Time $start Limit to events starting after this.
     * @param Ai1ec_Date_Time $end   Limit to events starting before this.
     * @param array $filter          Array of filters for the events returned:
     *                                   ['cat_ids']      => list of category IDs;
     *                                   ['tag_ids']      => list of tag IDs;
     *                                   ['post_ids']     => list of post IDs;
     *                                   ['auth_ids']     => list of author IDs;
     *                                   ['instance_ids'] => list of events
     *                                                       instance ids;
     * @param bool $spanning         Also include events that span this period.
     * @param bool $single_day       This parameter is added for oneday view.
     *                               Query should find events lasting in
     *                               particular day instead of checking dates
     *                               range. If you need to call this method
     *                               with $single_day set to true consider
     *                               using method get_events_for_day. This
     *                               parameter matters only if $spanning is set
     *                               to false.
     *
     * @return array List of matching event objects.
     */
    public function get_events_between(
        Ai1ec_Date_Time $start,
        Ai1ec_Date_Time $end,
        array $filter = array(),
        $spanning     = false,
        $single_day   = false
    ) {
        // Query arguments
        $args = array(
            $start->format_to_gmt(),
            $end->format_to_gmt(),
        );

        // Get post status Where snippet and associated SQL arguments
        $where_parameters  = $this->_get_post_status_sql();
        $post_status_where = $where_parameters['post_status_where'];
        $args              = array_merge( $args, $where_parameters['args'] );

        // Get the Join (filter_join) and Where (filter_where) statements based
        // on $filter elements specified
        $filter = $this->_get_filter_sql( $filter );

        $ai1ec_localization_helper = $this->_registry->get( 'p28n.wpml' );

        $wpml_join_particle = $ai1ec_localization_helper
            ->get_wpml_table_join( 'p.ID' );

        $wpml_where_particle = $ai1ec_localization_helper
            ->get_wpml_table_where();

        if ( $spanning ) {
            $spanning_string = 'i.end > %d AND i.start < %d ';
        } elseif ( $single_day ) {
            $spanning_string = 'i.end >= %d AND i.start <= %d ';
        } else {
            $spanning_string = 'i.start BETWEEN %d AND %d ';
        }

        $sql = '
            SELECT
                `p`.*,
                `e`.`post_id`,
                `i`.`id` AS `instance_id`,
                `i`.`start` AS `start`,
                `i`.`end` AS `end`,
                `e`.`timezone_name` AS `timezone_name`,
                `e`.`allday` AS `event_allday`,
                `e`.`recurrence_rules`,
                `e`.`exception_rules`,
                `e`.`recurrence_dates`,
                `e`.`exception_dates`,
                `e`.`venue`,
                `e`.`country`,
                `e`.`address`,
                `e`.`city`,
                `e`.`province`,
                `e`.`postal_code`,
                `e`.`instant_event`,
                `e`.`show_map`,
                `e`.`contact_name`,
                `e`.`contact_phone`,
                `e`.`contact_email`,
                `e`.`contact_url`,
                `e`.`cost`,
                `e`.`ticket_url`,
                `e`.`ical_feed_url`,
                `e`.`ical_source_url`,
                `e`.`ical_organizer`,
                `e`.`ical_contact`,
                `e`.`ical_uid`,
                `e`.`longitude`,
                `e`.`latitude`
            FROM
                ' . $this->_dbi->get_table_name( 'ai1ec_events' ) . ' e
                INNER JOIN
                    ' . $this->_dbi->get_table_name( 'posts' ) . ' p
                        ON ( `p`.`ID` = `e`.`post_id` )
                ' . $wpml_join_particle . '
                INNER JOIN
                    ' . $this->_dbi->get_table_name( 'ai1ec_event_instances' ) . ' i
                    ON ( `e`.`post_id` = `i`.`post_id` )
                ' . $filter['filter_join'] . '
            WHERE
                post_type = \'' . AI1EC_POST_TYPE . '\'
                ' . $wpml_where_particle . '
            AND
                ' . $spanning_string . '
                ' . $filter['filter_where'] . '
                ' . $post_status_where . '
            GROUP BY
                `i`.`id`
            ORDER BY
                `e` . `allday`     DESC,
                `i` . `start`      ASC,
                `p` . `post_title` ASC';

        $query  = $this->_dbi->prepare( $sql, $args );
        $events = $this->_dbi->get_results( $query, ARRAY_A );

        $id_list = array();
        $id_instance_list = array();
        foreach ( $events as $event ) {

            if ( ! in_array( $event['post_id'], $id_list, true ) ) {
                $id_list[] = $event['post_id'];
            }

            $id_instance_list[] = array(
                'id'          => $event['post_id'],
                'instance_id' => $event['instance_id'],
            );
        }

        if ( ! empty( $id_list ) ) {
            update_meta_cache( 'post', $id_list );
            $this->_ids_between_cache = $id_instance_list;
        }

        foreach ( $events as &$event ) {
            $event['allday'] = $this->_is_all_day( $event );
            $event           = $this->_registry->get( 'model.event', $event );
        }

        return $events;
    }

    /**
     * get_events_relative_to function
     *
     * Return all events starting after the given reference time, limiting the
     * result set to a maximum of $limit items, offset by $page_offset. A
     * negative $page_offset can be provided, which will return events *before*
     * the reference time, as expected.
     *
     * @param int $time           limit to events starting after this (local) UNIX time
     * @param int $limit          return a maximum of this number of items
     * @param int $page_offset    offset the result set by $limit times this number
     * @param array $filter       Array of filters for the events returned.
     *                            ['cat_ids']      => non-associatative array of category IDs
     *                            ['tag_ids']      => non-associatative array of tag IDs
     *                            ['post_ids']     => non-associatative array of post IDs
     *                            ['auth_ids']     => non-associatative array of author IDs
     *                            ['instance_ids'] => non-associatative array of author IDs
     * @param int $last_day       Last day (time), that was displayed.
     *                            NOTE FROM NICOLA: be careful, if you want a query with events
     *                            that have a start date which is greater than today, pass 0 as
     *                            this parameter. If you pass false ( or pass nothing ) you end up with a query
     *                            with events that finish before today. I don't know the rationale
     *                            behind this but that's how it works
     * @param bool $unique        Whether display only unique events and don't
     *                            duplicate results with other instances or not.
     *
     * @return array              five-element array:
     *                              ['events'] an array of matching event objects
     *                              ['prev'] true if more previous events
     *                              ['next'] true if more next events
     *                              ['date_first'] UNIX timestamp (date part) of first event
     *                              ['date_last'] UNIX timestamp (date part) of last event
     */
    public function get_events_relative_to(
        $time,
        $limit       = 0,
        $page_offset = 0,
        $filter      = array(),
        $last_day    = false,
        $unique      = false
    ) {
        $localization_helper = $this->_registry->get( 'p28n.wpml' );
        $settings = $this->_registry->get( 'model.settings' );


        // Even if there ARE more than 5 times the limit results - we shall not
        // try to fetch and display these, as it would crash system
        $limit = preg_replace('/\D/', '', $limit);
        $upper_boundary = $limit;
        if (
            $settings->get( 'agenda_include_entire_last_day' ) &&
        ( false !== $last_day )
        ) {
            $upper_boundary *= 5;
        }

        // Convert timestamp to GMT time
        $time = $this->_registry->get(
            'date.system'
        )->get_current_rounded_time();
        // Get post status Where snippet and associated SQL arguments
        $where_parameters  = $this->_get_post_status_sql();
        $post_status_where = $where_parameters['post_status_where'];

        // Get the Join (filter_join) and Where (filter_where) statements based
        // on $filter elements specified
        $filter = $this->_get_filter_sql( $filter );

        // Query arguments
        $args = array( $time );
        $args = array_merge( $args, $where_parameters['args'] );

        if( $page_offset >= 0 ) {
            $first_record = $page_offset * $limit;
        } else {
            $first_record = ( -$page_offset - 1 ) * $limit;
        }


        $wpml_join_particle  = $localization_helper
            ->get_wpml_table_join( 'p.ID' );

        $wpml_where_particle = $localization_helper
            ->get_wpml_table_where();

        $filter_date_clause = ( $page_offset >= 0 )
            ? 'i.end >= %d '
            : 'i.start < %d ';
        $order_direction    = ( $page_offset >= 0 ) ? 'ASC' : 'DESC';
        if ( false !== $last_day ) {
            if ( 0 == $last_day ) {
                $last_day = $time;
            }
            $filter_date_clause = ' i.end ';
            if ( $page_offset < 0 ) {
                $filter_date_clause .= '<';
                $order_direction     = 'DESC';
            } else {
                $filter_date_clause .= '>';
                $order_direction     = 'ASC';
            }
            $filter_date_clause .= ' %d ';
            $args[0]             = $last_day;
            $first_record        = 0;
        }
        $query = $this->_dbi->prepare(
            'SELECT DISTINCT p.*, e.post_id, i.id AS instance_id, ' .
            'i.start AS start, ' .
            'i.end AS end, ' .
            'e.allday AS event_allday, ' .
            'e.recurrence_rules, e.exception_rules, e.ticket_url, e.instant_event, e.recurrence_dates, e.exception_dates, ' .
            'e.venue, e.country, e.address, e.city, e.province, e.postal_code, ' .
            'e.show_map, e.contact_name, e.contact_phone, e.contact_email, e.cost, ' .
            'e.ical_feed_url, e.ical_source_url, e.ical_organizer, e.ical_contact, e.ical_uid, e.timezone_name, e.longitude, e.latitude ' .
            'FROM ' . $this->_dbi->get_table_name( 'ai1ec_events' ) . ' e ' .
            'INNER JOIN ' . $this->_dbi->get_table_name( 'posts' ) . ' p ON e.post_id = p.ID ' .
            $wpml_join_particle .
            ' INNER JOIN ' . $this->_dbi->get_table_name( 'ai1ec_event_instances' ) . ' i ON e.post_id = i.post_id ' .
            $filter['filter_join'] .
            " WHERE post_type = '" . AI1EC_POST_TYPE . "' " .
            ' AND ' . $filter_date_clause .
            $wpml_where_particle .
            $filter['filter_where'] .
            $post_status_where .
            ( $unique ? ' GROUP BY e.post_id' : '' ) .
            // Reverse order when viewing negative pages, to get correct set of
            // records. Then reverse results later to order them properly.
            ' ORDER BY i.start ' . $order_direction .
            ', post_title ' . $order_direction .
            ' LIMIT ' . $first_record . ', ' . $upper_boundary,
            $args
        );

        $events = $this->_dbi->get_results( $query, ARRAY_A );

        // Limit the number of records to convert to data-object
        $events = $this->_limit_result_set(
            $events,
            $limit,
            ( false !== $last_day )
        );

        // Reorder records if in negative page offset
        if( $page_offset < 0 ) {
            $events = array_reverse( $events );
        }

        $date_first = $date_last = NULL;

        foreach ( $events as &$event ) {
            $event['allday'] = $this->_is_all_day( $event );
            $event           = $this->_registry->get( 'model.event', $event );
            if ( null === $date_first ) {
                $date_first = $event->get( 'start' );
            }
            $date_last = $event->get( 'start' );
        }
        $date_first = $this->_registry->get( 'date.time', $date_first );
        $date_last  = $this->_registry->get( 'date.time', $date_last );
        // jus show next/prev links, in case no event found is shown.
        $next = true;
        $prev = true;

        return array(
            'events'     => $events,
            'prev'       => $prev,
            'next'       => $next,
            'date_first' => $date_first,
            'date_last'  => $date_last,
        );
    }

    /**
     * get_events_relative_to_reference function
     *
     * Return all events starting after the given date reference, limiting the
     * result set to a maximum of $limit items, offset by $page_offset. A
     * negative $page_offset can be provided, which will return events *before*
     * the reference time, as expected.
     *
     * @param int $date_reference if page_offset is greater than or equal to zero, events with start date greater than the date_reference will be returned
     *                               otherwise events with start date less than the date_reference will be returned.
     * @param int $limit          return a maximum of this number of items
     * @param int $page_offset    offset the result set by $limit times this number
     * @param array $filter       Array of filters for the events returned.
     *                            ['cat_ids']      => non-associatative array of category IDs
     *                            ['tag_ids']      => non-associatative array of tag IDs
     *                            ['post_ids']     => non-associatative array of post IDs
     *                            ['auth_ids']     => non-associatative array of author IDs
     *                            ['instance_ids'] => non-associatative array of author IDs
     * @param bool $unique        Whether display only unique events and don't
     *                            duplicate results with other instances or not.
     *
     * @return array              five-element array:
     *                              ['events'] an array of matching event objects
     *                              ['prev'] true if more previous events
     *                              ['next'] true if more next events
     *                              ['date_first'] UNIX timestamp (date part) of first event
     *                              ['date_last'] UNIX timestamp (date part) of last event
     */
    public function get_events_relative_to_reference( $date_reference, $limit = 0, $page_offset = 0, $filter = array(), $unique = false ) {
        $localization_helper = $this->_registry->get( 'p28n.wpml' );
        $settings = $this->_registry->get( 'model.settings' );

        // Even if there ARE more than 5 times the limit results - we shall not
        // try to fetch and display these, as it would crash system
        $limit = preg_replace( '/\D/', '', $limit );

        // Convert timestamp to GMT time
        if ( 0 == $date_reference ) {
            $timezone     = $this->_registry->get( 'date.timezone' )->get( $settings->get( 'timezone_string' ) );
            $current_time = new DateTime( 'now' );
            $current_time->setTimezone( $timezone );
            $time         = $current_time->format( 'U' );
        } else {
            $time = $date_reference;
        }

        // Get post status Where snippet and associated SQL arguments
        $where_parameters = $this->_get_post_status_sql();
        $post_status_where = $where_parameters['post_status_where'];

        // Get the Join (filter_join) and Where (filter_where) statements based
        // on $filter elements specified
        $filter = $this->_get_filter_sql( $filter );

        // Query arguments
        $args = array( $time );
        $args = array_merge( $args, $where_parameters['args'] );

        if ( 0 == $date_reference ) {
            if ( $page_offset >= 0 ) {
                $filter_date_clause = 'i.end >= %d ';
                $order_direction    = 'ASC';
            } else {
                $filter_date_clause = 'i.start < %d ';
                $order_direction    = 'DESC';
            }
        } else {
            if ( $page_offset < 0 ) {
                $filter_date_clause = 'i.end < %d ';
                $order_direction    = 'DESC';
            } else {
                $filter_date_clause = 'i.end >= %d ';
                $order_direction    = 'ASC';
            }
        }
        if ( $page_offset >= 0 ) {
            $first_record       = $page_offset * $limit;
        } else {
            $first_record       = ( - $page_offset - 1 ) * $limit;
        }
        $wpml_join_particle  = $localization_helper->get_wpml_table_join( 'p.ID' );
        $wpml_where_particle = $localization_helper->get_wpml_table_where();

        $query = $this->_dbi->prepare(
            'SELECT DISTINCT p.*, e.post_id, i.id AS instance_id, ' . 'i.start AS start, ' . 'i.end AS end, ' .
                 'e.allday AS event_allday, ' .
                 'e.recurrence_rules, e.exception_rules, e.ticket_url, e.instant_event, e.recurrence_dates, e.exception_dates, ' .
                 'e.venue, e.country, e.address, e.city, e.province, e.postal_code, ' .
                 'e.show_map, e.contact_name, e.contact_phone, e.contact_email, e.cost, ' .
                 'e.ical_feed_url, e.ical_source_url, e.ical_organizer, e.ical_contact, e.ical_uid, e.timezone_name, e.longitude, e.latitude ' .
                 'FROM ' . $this->_dbi->get_table_name( 'ai1ec_events' ) . ' e ' . 'INNER JOIN ' .
                 $this->_dbi->get_table_name( 'posts' ) . ' p ON e.post_id = p.ID ' . $wpml_join_particle .
                 ' INNER JOIN ' . $this->_dbi->get_table_name( 'ai1ec_event_instances' ) . ' i ON e.post_id = i.post_id ' .
                 $filter['filter_join'] . " WHERE post_type = '" . AI1EC_POST_TYPE . "' " . ' AND ' . $filter_date_clause .
                 $wpml_where_particle . $filter['filter_where'] . $post_status_where .
                 ( $unique ? ' GROUP BY e.post_id' : '' ) .
                // Reverse order when viewing negative pages, to get correct set of
                // records. Then reverse results later to order them properly.
                ' ORDER BY i.start ' . $order_direction . ', post_title ' . $order_direction . ' LIMIT ' . $first_record .
                 ', ' . ( $limit + 1 ),
                $args );

        $events = $this->_dbi->get_results( $query, ARRAY_A );

        if ( $page_offset >= 0 ) {
            $prev = true;
            $next = ( count( $events ) > $limit );
            if ( $next ) {
                 array_pop( $events );
            }
        } else {
            $prev = ( count( $events ) > $limit );
            if ( $prev ) {
                array_pop( $events );
            }
            $next = true;
        }

        // Reorder records if in negative page offset
        if ( $page_offset < 0 ) {
            $events = array_reverse( $events );
        }

        $date_first = $date_last = NULL;

        foreach ( $events as &$event ) {
            $event['allday'] = $this->_is_all_day( $event );
            $event = $this->_registry->get( 'model.event', $event );
            if ( null === $date_first ) {
                $date_first = $event->get( 'start' );
            }
            $date_last = $event->get( 'start' );
        }
        $date_first = $this->_registry->get( 'date.time', $date_first );
        $date_last = $this->_registry->get( 'date.time', $date_last );

        return array(
            'events' => $events,
            'prev' => $prev,
            'next' => $next,
            'date_first' => $date_first,
            'date_last' => $date_last );
    }

    /**
     * Returns events for given day. Event must start before end of day and must
     * ends after beginning of day.
     *
     * @param Ai1ec_Date_Time $day    Date object.
     * @param array           $filter Search filters;
     *
     * @return array List of events.
     */
    public function get_events_for_day(
        Ai1ec_Date_Time $day,
        array $filter = array()
    ) {
        $end_of_day   = $this->_registry->get( 'date.time', $day )
            ->set_time( 23, 59, 59 );
        $start_of_day = $this->_registry->get( 'date.time', $day )
            ->set_time( 0, 0, 0 );
        return $this->get_events_between(
            $start_of_day,
            $end_of_day,
            $filter,
            false,
            true
        );
    }

    /**
     * Get ID of event in database, matching imported one.
     *
     * Return event ID by iCalendar UID, feed url, start time and whether the
     * event has recurrence rules (to differentiate between an event with a UID
     * defining the recurrence pattern, and other events with with the same UID,
     * which are just RECURRENCE-IDs).
     *
     * @param int      $uid             iCalendar UID property
     * @param string   $feed            Feed URL
     * @param int      $start           Start timestamp (GMT)
     * @param bool     $has_recurrence  Whether the event has recurrence rules
     * @param int|null $exclude_post_id Do not match against this post ID
     *
     * @return object|null ID of matching event post, or NULL if no match
     */
    public function get_matching_event_id(
        $uid,
        $feed,
        $start,
        $has_recurrence  = false,
        $exclude_post_id = null
    ) {
        $dbi        = $this->_registry->get( 'dbi.dbi' );
        $table_name = $dbi->get_table_name( 'ai1ec_events' );
        $query      = 'SELECT `post_id` FROM ' . $table_name . '
            WHERE
                    ical_feed_url   = %s
                AND ical_uid        = %s
                AND start           = %d ' .
            ( $has_recurrence ? 'AND NOT ' : 'AND ' ) .
            ' ( recurrence_rules IS NULL OR recurrence_rules = \'\' )';
        $args = array( $feed, $uid );
        if ( $start instanceof Ai1ec_Date_Time ) {
            $args[] = $start->format();
        } else {
            $args[] = (int)$start;
        }
        if ( null !== $exclude_post_id ) {
            $query .= ' AND post_id <> %d';
            $args[] = $exclude_post_id;
        }

        return $dbi->get_var( $dbi->prepare( $query, $args ) );
    }

    /**
     * Get event by UID. UID must be unique.
     *
     * NOTICE: deletes events with that UID if they have different URLs.
     *
     * @param string $uid UID from feed.
     * @param string $uid Feed URL.
     *
     * @return int|null Matching Event ID or NULL if none found.
     */
    public function get_matching_event_by_uid_and_url( $uid, $url ) {
        if ( ! isset( $uid[1] ) ) {
            return null;
        }
        $dbi        = $this->_registry->get( 'dbi.dbi' );
        $table_name = $dbi->get_table_name( 'ai1ec_events' );
        $argv       = array( $url, $uid, $url );
        // fix issue where invalid feed URLs were assigned
        $update     = 'UPDATE ' . $table_name . ' SET `ical_feed_url` = %s' .
            ' WHERE `ical_uid` = %s AND `ical_feed_url` != %s';
        $query   = $dbi->prepare( $update, $argv);
        $success = $dbi->query( $query );

        // retrieve actual feed ID if any
        $select = 'SELECT `post_id` FROM `' . $table_name .
            '` WHERE `ical_uid` = %s';
        return $dbi->get_var( $dbi->prepare( $select, array( $uid ) ) );
    }

    /**
     * Get event ids for the passed feed url
     *
     * @param string $feed_url
     */
    public function get_event_ids_for_feed( $feed_url ) {
        $dbi        = $this->_registry->get( 'dbi.dbi' );
        $table_name = $dbi->get_table_name( 'ai1ec_events' );
        $query      = 'SELECT `post_id` FROM ' . $table_name .
                        ' WHERE ical_feed_url = %s';
        return $dbi->get_col( $dbi->prepare( $query, array( $feed_url ) ) );
    }

    /**
     * Returns events instances closest to today.
     *
     * @param array $events_ids Events ids filter.
     *
     * @return array Events collection.
     * @throws Ai1ec_Bootstrap_Exception
     */
    public function get_instances_closest_to_today( array $events_ids = array() ) {
        $where_events_ids = '';
        if ( ! empty( $events_ids ) ) {
            $where_events_ids = 'i.post_id IN ('
                . implode( ',', $events_ids ) . ') AND ';
        }
        $query = 'SELECT i.id, i.post_id FROM ' .
            $this->_dbi->get_table_name( 'ai1ec_event_instances' ) .
            ' i WHERE ' .
            $where_events_ids .
            ' i.start > %d ' .
            ' GROUP BY i.post_id';
        /** @var $today Ai1ec_Date_Time */
        $today   = $this->_registry->get( 'date.time', 'now', 'sys.default' );
        $today->set_time( 0, 0, 0 );
        $query   = $this->_dbi->prepare( $query, $today->format( 'U' ) );
        $results = $this->_dbi->get_results( $query );
        $events  = array();
        foreach ( $results as $result ) {
            $events[] = $this->get_event(
                $result->post_id,
                $result->id
            );
        }

        return $events;
    }

    /**
     * Check if given event must be treated as all-day event.
     *
     * Event instances that span 24 hours are treated as all-day.
     * NOTICE: event is passed in before being transformed into
     * Ai1ec_Event object, with Ai1ec_Date_Time fields.
     *
     * @param array $event Event data returned from database.
     *
     * @return bool True if event is all-day event.
     */
    protected function _is_all_day( array $event ) {
        if ( isset( $event['event_allday'] ) && $event['event_allday'] ) {
            return true;
        }

        if ( ! isset( $event['start'] ) || ! isset( $event['end'] ) ) {
            return false;
        }

        return ( 86400 === $event['end'] - $event['start'] );
    }

    /**
     * _limit_result_set function
     *
     * Slice given number of events from list, with exception when all
     * events from last day shall be included.
     *
     * @param array $events   List of events to slice
     * @param int   $limit    Number of events to slice-off
     * @param bool  $last_day Set to true to include all events from last day ignoring {$limit}
     *
     * @return array Sliced events list
     */
    protected function _limit_result_set(
        array $events,
        $limit,
        $last_day
    ) {
        $limited_events     = array();
        $start_day_previous = 0;
        foreach ( $events as $event ) {
            $start_day = date(
                'Y-m-d',
                $event['start']
            );
            --$limit; // $limit = $limit - 1;
            if ( $limit < 0 ) {
                if ( true === $last_day ) {
                    if ( $start_day != $start_day_previous ) {
                        break;
                    }
                } else {
                    break;
                }
            }
            $limited_events[]   = $event;
            $start_day_previous = $start_day;
        }
        return $limited_events;
    }

    /**
     * _get_post_status_sql function
     *
     * Returns SQL snippet for properly matching event posts, as well as array
     * of arguments to pass to $this_dbi->prepare, in function argument
     * references.
     * Nothing is returned by the function.
     *
     * @return array An array containing post_status_where: the sql string,
     * args: the arguments for prepare()
     */
    protected function _get_post_status_sql() {
        $args = array();

        // Query the correct post status
        if (
            current_user_can( 'administrator' ) ||
            current_user_can( 'editor' ) ||
            current_user_can( 'read_private_ai1ec_events' )
        ) {
            // User has privilege of seeing all published and private
            $post_status_where = 'AND post_status IN ( %s, %s ) ';
            $args[]            = 'publish';
            $args[]            = 'private';
        } elseif ( is_user_logged_in() ) {
            // User has privilege of seeing all published and only their own
            // private posts.

            // Get user ID
            $user_id           = 0;
            if ( is_callable( 'wp_get_current_user' ) ) {
                $user          = wp_get_current_user();
                $user_id       = (int)$user->ID;
                unset( $user );
            }

            // include post_status = published
            //   OR
            // post_status = private AND post_author = userID
            $post_status_where =
                'AND ( ' .
                'post_status = %s ' .
                'OR ( post_status = %s AND post_author = %d ) ' .
                ') ';

            $args[] = 'publish';
            $args[] = 'private';
            $args[] = $user_id;
        } else {
            // User can only see published posts.
            $post_status_where = 'AND post_status = %s ';
            $args[]            = 'publish';
        }

        return array(
            'post_status_where' => $post_status_where,
            'args'              => $args
        );
    }

    /**
     * Take filter and return SQL options.
     *
     * Takes an array of filtering options and turns it into JOIN and WHERE
     * statements for running an SQL query limited to the specified options.
     *
     * @param array $filter Array of filters for the events returned:
     *                          ['cat_ids']      => list of category IDs
     *                          ['tag_ids']      => list of tag IDs
     *                          ['post_ids']     => list of event post IDs
     *                          ['auth_ids']     => list of event author IDs
     *                          ['instance_ids'] => list of event instance IDs
     *
     * @return array The modified filter array to having:
     *                   ['filter_join']  the Join statements for the SQL
     *                   ['filter_where'] the Where statements for the SQL
     */
    protected function _get_filter_sql( $filter ) {
        $filter_join = $filter_where = array();
        foreach ( $filter as $filter_type => $filter_ids ) {
            $filter_object = null;
            try {
                if ( empty( $filter_ids ) ) {
                    $filter_ids = array();
                }
                $filter_object = $this->_registry->get(
                    'model.filter.' . $filter_type,
                    $filter_ids
                );
                if ( ! ( $filter_object instanceof Ai1ec_Filter_Interface ) ) {
                    throw new Ai1ec_Bootstrap_Exception(
                        'Filter \'' . get_class( $filter_object ) .
                        '\' is not instance of Ai1ec_Filter_Interface'
                    );
                }
            } catch ( Ai1ec_Bootstrap_Exception $exception ) {
                continue;
            }
            $filter_join[]  = $filter_object->get_join();
            $filter_where[] = $filter_object->get_where();
        }

        $filter_join  = array_filter( $filter_join );
        $filter_where = array_filter( $filter_where );
        $filter_join  = join( ' ', $filter_join );
        if ( count( $filter_where ) > 0 ) {
            $operator     = $this->get_distinct_types_operator();
            $filter_where = $operator . '( ' .
                implode( ' ) ' . $operator . ' ( ', $filter_where ) .
                ' ) ';
        } else {
            $filter_where = '';
        }

        return $filter + compact( 'filter_where', 'filter_join' );
    }

    /**
     * Get operator for joining distinct filters in WHERE.
     *
     * @return string SQL operator.
     */
    public function get_distinct_types_operator() {
        static $operators = array( 'AND' => 1, 'OR' => 2 );
        $default          = 'AND';
        $where_operator   = strtoupper( trim( (string)apply_filters(
            'ai1ec_filter_distinct_types_logic',
            $default
        ) ) );
        if ( ! isset( $operators[$where_operator] ) ) {
            $where_operator = $default;
        }
        return $where_operator;
    }

}


==================================================
FILE PATH: ./app/model/event/parent.php
==================================================
<?php
/**
 * Class which represnt event parent/child relationship.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */
class Ai1ec_Event_Parent extends Ai1ec_Base {

    /**
     * event_parent method
     *
     * Get/set event parent
     *
     * @param int $event_id    ID of checked event
     * @param int $parent_id   ID of new parent [optional=NULL, acts as getter]
     * @param int $instance_id ID of old instance id
     *
     * @return int|bool Value depends on mode:
     *     Getter: {@see self::get_parent_event()} for details
     *     Setter: true on success.
     */
    public function event_parent(
        $event_id,
        $parent_id   = null,
        $instance_id = null
    ) {
        $meta_key = '_ai1ec_event_parent';
        if ( null === $parent_id ) {
            return $this->get_parent_event( $event_id );
        }
        $meta_value = json_encode( array(
            'created'  => $this->_registry->get( 'date.system' )->current_time(),
            'instance' => $instance_id,
        ) );
        return add_post_meta( $event_id, $meta_key, $meta_value, true );
    }

    /**
     * Get parent ID for given event
     *
     * @param int $current_id Current event ID
     *
     * @return int|bool ID of parent event or bool(false)
     */
    public function get_parent_event( $current_id ) {
        static $parents = null;
        if ( null === $parents ) {
            $parents = $this->_registry->get( 'cache.memory' );
        }
        $current_id = (int)$current_id;
        if ( null === ( $parent_id = $parents->get( $current_id ) ) ) {
            $db = $this->_registry->get( 'dbi.dbi' );
            /* @var $db Ai1ec_Dbi */
            $query  = '
                SELECT parent.ID, parent.post_status
                FROM
                    ' . $db->get_table_name( 'posts' ) . ' AS child
                    INNER JOIN ' . $db->get_table_name( 'posts' ) . ' AS parent
                        ON ( parent.ID = child.post_parent )
                WHERE child.ID = ' . $current_id;
            $parent = $db->get_row( $query );
            if (
                empty( $parent ) ||
                'trash' === $parent->post_status
            ) {
                $parent_id = false;
            } else {
                $parent_id = $parent->ID;
            }
            $parents->set( $current_id, $parent_id );
            unset( $query );
        }
        return $parent_id;
    }

    /**
     * Returns a list of modified (children) event objects
     *
     * @param int  $parent_id     ID of parent event
     * @param bool $include_trash Includes trashed when `true` [optional=false]
     *
     * @return array List (might be empty) of Ai1ec_Event objects
     */
    public function get_child_event_objects(
        $parent_id,
        $include_trash = false
    ) {
        $db = $this->_registry->get( 'dbi.dbi' );
        /* @var $db Ai1ec_Dbi */
        $parent_id = (int)$parent_id;
        $sql_query = 'SELECT ID FROM ' . $db->get_table_name( 'posts' ) .
            ' WHERE post_parent = ' . $parent_id;
        $children  = (array)$db->get_col( $sql_query );
        $objects   = array();
        foreach ( $children as $child_id ) {
            try {
                $instance = $this->_registry->get( 'model.event', $child_id );
                if (
                    $include_trash ||
                    'trash' !== $instance->get( 'post' )->post_status
                ) {
                    $objects[$child_id] = $instance;
                }
            } catch ( Ai1ec_Event_Not_Found_Exception $exception ) {
                // ignore
            }
        }
        return $objects;
    }

    /**
     * admin_init_post method
     *
     * Bind to admin_action_editpost action to override default save
     * method when user is editing single instance.
     * New post is created with some fields unset.
     */
    public function admin_init_post( ) {
        if (
            isset( $_POST['ai1ec_instance_id'] ) &&
            isset( $_POST['action'] ) &&
            'editpost' === $_POST['action']
        ) {
            $old_post_id = $_POST['post_ID'];
            $instance_id = $_POST['ai1ec_instance_id'];
            $post_id     = $this->_registry->get( 'model.event.creating' )
                ->create_duplicate_post();
            if ( false !== $post_id ) {
                $this->_handle_instances(
                    $this->_registry->get( 'model.event', $post_id ),
                    $this->_registry->get( 'model.event', $old_post_id ),
                    $instance_id
                );
                $this->_registry->get( 'model.event.instance' )->clean(
                    $old_post_id,
                    $instance_id
                );
                $location = add_query_arg(
                    'message',
                    1,
                    get_edit_post_link( $post_id, 'url' )
                );
                wp_redirect(
                    apply_filters(
                        'redirect_post_location',
                        $location,
                        $post_id
                    )
                );
                exit();
            }
        }
    }

    /**
     * Inject base event edit link for modified instances
     *
     * Modified instances are events, belonging to some parent having recurrence
     * rule, and having some of it's properties altered.
     *
     * @param array    $actions List of defined actions
     * @param stdClass $post Instance being rendered (WP_Post class instance in WP 3.5+)
     *
     * @return array Optionally modified $actions list
     */
    public function post_row_actions( $actions, $post ) {
        if ( $this->_registry->get( 'acl.aco' )->is_our_post_type( $post ) ) {
            $parent_post_id = $this->event_parent( $post->ID );
            if (
                $parent_post_id &&
                NULL !== ( $parent_post = get_post( $parent_post_id ) ) &&
                isset( $parent_post->post_status ) &&
                'trash' !== $parent_post->post_status
            ) {
                $parent_link = get_edit_post_link(
                    $parent_post_id,
                    'display'
                );
                $actions['ai1ec_parent'] = sprintf(
                    '<a href="%s" title="%s">%s</a>',
                    wp_nonce_url( $parent_link ),
                    sprintf(
                        __( 'Edit &#8220;%s&#8221;', AI1EC_PLUGIN_NAME ),
                        apply_filters(
                            'the_title',
                            $parent_post->post_title,
                            $parent_post->ID
                        )
                    ),
                    __( 'Base Event', AI1EC_PLUGIN_NAME )
                );
            }
        }
        return $actions;
    }

    /**
     * add_exception_date method
     *
     * Add exception (date) to event.
     *
     * @param int   $post_id Event edited post ID
     * @param mixed $date    Parseable date representation to exclude
     *
     * @return bool Success
     */
    public function add_exception_date( $post_id, Ai1ec_Date_Time $date ) {
        $event      = $this->_registry->get( 'model.event', $post_id );
        $dates_list = explode( ',', $event->get( 'exception_dates' ) );
        if ( empty( $dates_list[0] ) ) {
            unset( $dates_list[0] );
        }
        $date->set_time( 0, 0, 0 );
        $dates_list[] = $date->format(
            'Ymd\THis\Z'
        );
        $event->set( 'exception_dates', implode( ',', $dates_list ) );
        return $event->save( true );
    }

    /**
     * Handles instances saving and switching if needed. If original event
     * and created event have different start dates proceed in old style
     * otherwise find next instance, switch original start date to next
     * instance start date. If there are no next instances mark event as
     * non recurring. Filter also exception dates if are past.
     *
     * @param Ai1ec_Event $created_event  Created event object.
     * @param Ai1ec_Event $original_event Original event object.
     *
     * @return void Method does not return.
     */
    protected function _handle_instances(
        Ai1ec_Event $created_event,
        Ai1ec_Event $original_event,
        $instance_id
    ) {
        $ce_start = $created_event->get( 'start' );
        $oe_start = $original_event->get( 'start' );
        if (
            $ce_start->format() !== $oe_start->format()
        ) {
            $this->add_exception_date(
                $original_event->get( 'post_id' ),
                $ce_start
            );
            return;
        }
        $next_instance = $this->_find_next_instance(
            $original_event->get( 'post_id' ),
            $instance_id
        );
        if ( ! $next_instance ) {
            $original_event->set( 'recurrence_rules', null );
            $original_event->save( true );
            return;
        }
        $original_event->set(
            'start',
            $this->_registry->get( 'date.time', $next_instance->get( 'start' ) )
        );
        $original_event->set(
            'end',
            $this->_registry->get( 'date.time', $next_instance->get( 'end' ) )
        );
        $edates = $this->_filter_exception_dates( $original_event );
        $original_event->set( 'exception_dates', implode( ',', $edates ) );
        $recurrence_rules = $original_event->get( 'recurrence_rules' );
        $rules_info       = $this->_registry->get( 'recurrence.rule' )
            ->build_recurrence_rules_array( $recurrence_rules );
        if ( isset( $rules_info['COUNT'] ) ) {
            $next_instances_count = $this->_count_next_instances(
                $original_event->get( 'post_id' ),
                $instance_id
            );
            $rules_info['COUNT']  = (int)$next_instances_count + count( $edates );
            $rules                = '';
            if ( $rules_info['COUNT'] <= 1 ) {
                $rules_info = array();
            }
            foreach ( $rules_info as $key => $value ) {
                $rules .= $key . '=' . $value . ';';
            }
            $original_event->set(
                'recurrence_rules',
                $rules
            );
        }
        $original_event->save( true );
    }

    /**
     * Returns next instance.
     *
     * @param int $post_id     Post ID.
     * @param int $instance_id Instance ID.
     *
     * @return null|Ai1ec_Event Result.
     */
    protected function _find_next_instance( $post_id, $instance_id ) {
        $dbi              = $this->_registry->get( 'dbi.dbi' );
        $table_instances  = $dbi->get_table_name( 'ai1ec_event_instances' );
        $table_posts      = $dbi->get_table_name( 'posts' );
        $query            = $dbi->prepare(
            'SELECT i.id FROM ' . $table_instances . ' i JOIN ' .
            $table_posts . ' p ON (p.ID = i.post_id) ' .
            'WHERE i.post_id = %d AND i.id > %d ' .
            'AND p.post_status = \'publish\' ' .
            'ORDER BY id ASC LIMIT 1',
            $post_id,
            $instance_id
        );
        $next_instance_id = $dbi->get_var( $query );
        if ( ! $next_instance_id ) {
            return null;
        }
        return $this->_registry->get( 'model.search' )
            ->get_event( $post_id, $next_instance_id );
    }

    /**
     * Counts future instances.
     *
     * @param int $post_id     Post ID.
     * @param int $instance_id Instance ID.
     *
     * @return int Result.
     */
    protected function _count_next_instances( $post_id, $instance_id ) {
        $dbi             = $this->_registry->get( 'dbi.dbi' );
        $table_instances = $dbi->get_table_name( 'ai1ec_event_instances' );
        $table_posts     = $dbi->get_table_name( 'posts' );
        $query = $dbi->prepare(
            'SELECT COUNT(i.id) FROM ' . $table_instances . ' i JOIN ' .
            $table_posts . ' p ON (p.ID = i.post_id) ' .
            'WHERE i.post_id = %d AND i.id > %d ' .
            'AND p.post_status = \'publish\'',
            $post_id,
            $instance_id
        );
        return (int)$dbi->get_var( $query );
    }

    /**
     * Filters past or out of range exception dates.
     *
     * @param Ai1ec_Event $event Event.
     *
     * @return array Filtered exception dates.
     */
    protected function _filter_exception_dates( Ai1ec_Event $event ) {
        $start           = (int)$event->get( 'start' )->format();
        $exception_dates = explode( ',', $event->get( 'exception_dates' ) );
        $dates           = array();
        foreach ( $exception_dates as $date ) {
            $ex_date = (int)$this->_registry->get( 'date.time', $date )->format();
            if ( $ex_date > $start ) {
                $dates[] = $date;
            }
        }
        return $dates;
    }
}


==================================================
FILE PATH: ./app/model/event/event-create-exception.php
==================================================
<?php

/**
 * Indicates a failure that happens during event save operation.
 *
 * @author     Time.ly Network Inc.
 * @since      2.1
 *
 * @package    AI1EC
 * @subpackage AI1EC.Model
 */
class Ai1ec_Event_Create_Exception extends Exception {

}


==================================================
FILE PATH: ./app/model/event/not-found-exception.php
==================================================
<?php

/**
 * Event not found.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Model
 */
class Ai1ec_Event_Not_Found_Exception extends Exception {

}

==================================================
FILE PATH: ./app/model/event/instance.php
==================================================
<?php

use Kigkonsult\Icalcreator\Util\UtilRecur;

/**
 * Event instance management model.
 *
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */
class Ai1ec_Event_Instance extends Ai1ec_Base {

    /**
     * @var Ai1ec_Dbi Instance of database abstraction.
     */
    protected $_dbi = null;

    /**
     * DBI utils.
     *
     * @var Ai1ec_Dbi_Utils
     */
    protected $_dbi_utils;

    /**
     * Store locally instance of Ai1ec_Dbi.
     *
     * @param Ai1ec_Registry_Object $registry Injected object registry.
     *
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $this->_dbi       = $this->_registry->get( 'dbi.dbi' );
        $this->_dbi_utils = $this->_registry->get( 'dbi.dbi-utils' );
    }

    /**
     * Remove entries for given post. Optionally delete particular instance.
     *
     * @param int      $post_id     Event ID to remove instances for.
     * @param int|null $instance_id Instance ID, or null for all.
     *
     * @return int|bool Number of entries removed, or false on failure.
     */
    public function clean( $post_id, $instance_id = null ) {
        $where  = array( 'post_id' => $post_id );
        $format = array( '%d' );
        if ( null !== $instance_id ) {
            $where['id'] = $instance_id;
            $format[]    = '%d';
        }
        return $this->_dbi->delete( 'ai1ec_event_instances', $where, $format );
    }

    /**
     * Remove and then create instance entries for given event.
     *
     * @param Ai1ec_Event $event Instance of event to recreate entries for.
     *
     * @return bool Success.
     */
    public function recreate( Ai1ec_Event $event ) {
        $old_instances = $this->_load_instances( $event->get( 'post_id' ) );
        $instances     = $this->_create_instances_collection( $event );
        $insert        = array();
        foreach ( $instances as $instance ) {
            if ( ! isset( $old_instances[$instance['start'] . ':' . $instance['end']] ) ) {
                $insert[] = $instance;
                continue;
            }
            unset( $old_instances[$instance['start'] . ':' . $instance['end']] );
        }
        $this->_remove_instances_by_ids( array_values( $old_instances ) );
        $this->_add_instances( $insert );
        return true;
    }

    /**
     * Create list of recurrent instances.
     *
     * @param Ai1ec_Event $event          Event to generate instances for.
     * @param array       $event_instance First instance contents.
     * @param int         $_start         Timestamp of first occurence.
     * @param int         $duration       Event duration in seconds.
     * @param string      $timezone       Target timezone.
     *
     * @return array List of event instances.
     */
    public function create_instances_by_recurrence(
        Ai1ec_Event $event,
        array $event_instance,
        $_start,
        $duration,
        $timezone
    ) {
        $restore_timezone  = date_default_timezone_get();
        $recurrence_parser = $this->_registry->get( 'recurrence.rule' );
        $events            = array();

        $start             = $event_instance['start'];
        $wdate             = $startdate = $enddate
            = $this->_parsed_date_array( $_start, $timezone );
        $enddate['year']   = $enddate['year'] + 10;
        $exclude_dates     = array();
        $exception_rules   = $event->get( 'exception_dates' );
        $recurrence_dates  = array();
        $recurrence_rules  = $event->get( 'recurrence_dates' );
        if ( $recurrence_rules ) {
            $recurrence_dates  = $this->_populate_recurring_dates(
                $recurrence_rules,
                $startdate,
                $timezone
            );
        }
        if ( $exception_rules ) {
            $exclude_dates = $this->_populate_recurring_dates(
                $exception_rules,
                $startdate,
                $timezone
            );
        }
        if ( $event->get( 'exception_rules' ) ) {
            // creat an array for the rules
            $exception_rules = $recurrence_parser
                ->build_recurrence_rules_array(
                    $event->get( 'exception_rules' )
                );
            unset($exception_rules['EXDATE']);
            if ( ! empty( $exception_rules ) ) {
                $exception_rules = UtilRecur::setRexrule(
                    $exception_rules
                );
                $result = array();
                date_default_timezone_set( $timezone );
                // The first array is the result and it is passed by reference
                UtilRecur::recur2date(
                    $exclude_dates,
                    $exception_rules,
                    $wdate,
                    $startdate,
                    $enddate
                );
                // Get start date time
                $startHour   = isset( $startdate['hour'] ) ? sprintf( "%02d", $startdate['hour'] ) : '00';
                $startMinute = isset( $startdate['min'] )  ? sprintf( "%02d", $startdate['min'] )  : '00';
                $startSecond = isset( $startdate['sec'] )  ? sprintf( "%02d", $startdate['sec'] )  : '00';
                $startTime   = $startHour . $startMinute . $startSecond;
                // Convert to timestamp
                if ( is_array( $exclude_dates ) ) {
                    $new_exclude_dates = array();
                    foreach ( $exclude_dates as $key => $value ) {
                        $timestamp = strtotime( $key . 'T' . $startTime );
                        $new_exclude_dates[$timestamp] = $value;
                    }
                    $exclude_dates = $new_exclude_dates;
                }
                date_default_timezone_set( $restore_timezone );
            }
        }
        $recurrence_rules = $recurrence_parser
            ->build_recurrence_rules_array(
                $event->get( 'recurrence_rules' )
            );

        $recurrence_rules = UtilRecur::setRexrule( $recurrence_rules );
        if ( $recurrence_rules ) {
            date_default_timezone_set( $timezone );
            UtilRecur::recur2date(
                $recurrence_dates,
                $recurrence_rules,
                $wdate,
                $startdate,
                $enddate
            );

            // Get start date time
            $startHour   = isset( $startdate['hour'] ) ? sprintf( "%02d", $startdate['hour'] ) : '00';
            $startMinute = isset( $startdate['min'] )  ? sprintf( "%02d", $startdate['min'] )  : '00';
            $startSecond = isset( $startdate['sec'] )  ? sprintf( "%02d", $startdate['sec'] )  : '00';
            $startTime   = $startHour . $startMinute . $startSecond;
            // Convert to timestamp
            if ( is_array( $recurrence_dates ) ) {
                $new_recurrence_dates = array();
                foreach ( $recurrence_dates as $key => $value ) {
                    $timestamp = strtotime( $key . 'T' . $startTime );
                    $new_recurrence_dates[$timestamp] = $value;
                }
                $recurrence_dates = $new_recurrence_dates;
            }
            date_default_timezone_set( $restore_timezone );
        }

        if ( ! is_array( $recurrence_dates ) ) {
            $recurrence_dates = array();
        }
        $recurrence_dates = array_keys( $recurrence_dates );
        // Add the instances
        foreach ( $recurrence_dates as $timestamp ) {
            // The arrays are in the form timestamp => true so an isset call is what we need
            if ( ! isset( $exclude_dates[$timestamp] ) ) {
                $event_instance['start'] = $timestamp;
                $event_instance['end']   = $timestamp + $duration;
                $events[$timestamp]      = $event_instance;
            }
        }

        return $events;
    }

    /**
     * Generate and store instance entries in database for given event.
     *
     * @param Ai1ec_Event $event Instance of event to create entries for.
     *
     * @return bool Success.
     */
    public function create( Ai1ec_Event $event ) {
        $instances = $this->_create_instances_collection( $event );
        $this->_add_instances( $instances );
        return true;
    }

    /**
     * Check if given date match dates in EXDATES rule.
     *
     * @param string $date     Date to check.
     * @param string $ics_rule ICS EXDATES rule.
     * @param string $timezone Timezone to evaluate value in.
     *
     * @return bool True if given date is in rule.
     */
    public function date_match_exdates( $date, $ics_rule, $timezone ) {
        $ranges = $this->_get_date_ranges( $ics_rule, $timezone );
        foreach ( $ranges as $interval ) {
            if ( $date >= $interval[0] && $date <= $interval[1] ) {
                return true;
            }
            if ( $date <= $interval[0] ) {
                break;
            }
        }
        return false;
    }

    /**
     * Prepare date range list for fast exdate search.
     *
     * NOTICE: timezone is relevant in only first run.
     *
     * @param string $date_list ICS list provided from data model.
     * @param string $timezone  Timezone in which to evaluate.
     *
     * @return array List of date ranges, sorted in increasing order.
     */
    protected function _get_date_ranges( $date_list, $timezone ) {
        static $ranges = array();
        if ( ! isset( $ranges[$date_list] ) ) {
            $ranges[$date_list] = array();
            $exploded = explode( ',', $date_list );
            sort( $exploded );
            foreach ( $exploded as $date ) {
                // COMMENT on `rtrim( $date, 'Z' )`:
                // user selects exclusion date in event timezone thus it
                // must be parsed as such as opposed to UTC which happen
                // when 'Z' is preserved.
                $date = $this->_registry
                    ->get( 'date.time', rtrim( $date, 'Z' ), $timezone )
                    ->format_to_gmt();
                $ranges[$date_list][] = array(
                    $date,
                    $date + (24 * 60 * 60) - 1
                );
            }
        }
        return $ranges[$date_list];
    }

    protected function _populate_recurring_dates( $rule, array $start_struct, $timezone ) {
        $start = clone $start_struct['_dt'];
        $dates = array();
        foreach ( explode( ',', $rule ) as $date ) {
            $i_date = clone $start;
            $spec   = sscanf( $date, '%04d%02d%02d' );
            $i_date->set_date(
                $spec[0],
                $spec[1],
                $spec[2]
            );
            $dates[$i_date->format_to_gmt()] = $i_date;
        }
        return $dates;
    }

    protected function _parsed_date_array( $startdate, $timezone ) {
        $datetime = $this->_registry->get( 'date.time', $startdate, $timezone );
        $parsed   = array(
            'year'  => intval( $datetime->format( 'Y' ) ),
            'month' => intval( $datetime->format( 'm' ) ),
            'day'   => intval( $datetime->format( 'd' ) ),
            'hour'  => intval( $datetime->format( 'H' ) ),
            'min'   => intval( $datetime->format( 'i' ) ),
            'sec'   => intval( $datetime->format( 's' ) ),
            'tz'    => $datetime->get_timezone(),
            '_dt'   => $datetime,
        );
        return $parsed;
    }

    /**
     * Returns current instances map.
     *
     * @param int post_id Post ID.
     *
     * @return array Array of data.
     */
    protected function _load_instances( $post_id ) {
        $query = $this->_dbi->prepare(
            'SELECT `id`, `start`, `end` FROM ' .
            $this->_dbi->get_table_name( 'ai1ec_event_instances' ) .
            ' WHERE post_id = %d',
            $post_id
        );
        $results   = $this->_dbi->get_results( $query );
        $instances = array();
        foreach ( $results as $result ) {
            $instances[(int)$result->start . ':' . (int)$result->end] = (int)$result->id;
        }
        return $instances;
    }

    /**
     * Generate and store instance entries in database for given event.
     *
     * @param Ai1ec_Event $event Instance of event to create entries for.
     *
     * @return bool Success.
     */
    protected function _create_instances_collection( Ai1ec_Event $event ) {
        $events     = array();
        $event_item = array(
            'post_id' => $event->get( 'post_id' ),
            'start'   => $event->get( 'start'   )->format_to_gmt(),
            'end'     => $event->get( 'end'     )->format_to_gmt(),
        );
        $duration = $event->get( 'end' )->diff_sec( $event->get( 'start' ) );

        $_start = $event->get( 'start' )->format_to_gmt();
        $_end   = $event->get( 'end'   )->format_to_gmt();

        // Always cache initial instance
        $events[$_start] = $event_item;

        if ( $event->get( 'recurrence_rules' ) || $event->get( 'recurrence_dates' ) ) {
            $start_timezone = $this->_registry->get( 'model.option' )
                                              ->get( 'timezone_string' );
            if ( empty( $start_timezone ) ) {
                $start_timezone = $this->_registry->get( 'date.timezone' )->get_default_timezone();
            }

            $events += $this->create_instances_by_recurrence(
                $event,
                $event_item,
                $_start,
                $duration,
                $start_timezone
            );
        }

        $search_helper = $this->_registry->get( 'model.search' );
        foreach ( $events as &$event_item ) {
            // Find out if this event instance is already accounted for by an
            // overriding 'RECURRENCE-ID' of the same iCalendar feed (by comparing the
            // UID, start date, recurrence). If so, then do not create duplicate
            // instance of event.
            $start             = $event_item['start'];
            $matching_event_id = null;
            if ( $event->get( 'ical_uid' ) ) {
                $matching_event_id = $search_helper->get_matching_event_id(
                    $event->get( 'ical_uid' ),
                    $event->get( 'ical_feed_url' ),
                    $event->get( 'start' ),
                    false,
                    $event->get( 'post_id' )
                );
            }

            // If no other instance was found
            if ( null !== $matching_event_id ) {
                $event_item = false;
            }
        }

        return array_filter( $events );
    }

    /**
     * Removes ai1ec_event_instances entries using their IDS.
     *
     * @param array $ids Collection of IDS.
     *
     * @return bool Result.
     */
    protected function _remove_instances_by_ids( array $ids ) {
        if ( empty( $ids ) ) {
            return false;
        }
        $query  = 'DELETE FROM ' . $this->_dbi->get_table_name(
                'ai1ec_event_instances'
            ) . ' WHERE id IN (';
        $ids    = array_filter( array_map( 'intval', $ids ) );
        $query .= implode( ',', $ids ) . ')';
        $this->_dbi->query( $query );
        return true;
    }

    /**
     * Adds new instances collection.
     *
     * @param array $instances Collection of instances.
     *
     * @return void
     */
    protected function _add_instances( array $instances ) {
        $chunks    = array_chunk( $instances, 50 );
        foreach ( $chunks as $chunk ) {
            $query = 'INSERT INTO ' . $this->_dbi->get_table_name(
                    'ai1ec_event_instances'
                ) . '(`post_id`, `start`, `end`) VALUES';
            $chunk  = array_map(
                array( $this->_dbi_utils, 'array_value_to_sql_value' ),
                $chunk
            );
            $query .= implode( ',', $chunk );
            $this->_dbi->query( $query );
        }
    }
}


==================================================
FILE PATH: ./app/model/event/legacy.php
==================================================
<?php

/**
 * Model representing a legacy event.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @instantiator new
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */
class Ai1ec_Event_Legacy extends Ai1ec_Event {

    /**
     * @var array map of method => class for legacy code.
     */
    protected static $_classes = array(
        'get_category_colors'              => 'taxonomy',
        'get_color_style'                  => 'taxonomy',
        'get_categories_html'              => 'taxonomy',
        'get_tags_html'                    => 'taxonomy',
        'get_category_text_color'          => 'taxonomy',
        'get_category_bg_color'            => 'taxonomy',
        'get_faded_color'                  => 'color',
        'get_rgba_color'                   => 'color',
        'get_event_avatar'                 => 'avatar',
        'get_event_avatar_url'             => 'avatar',
        'get_post_thumbnail_url'           => 'avatar',
        'get_content_img_url'              => 'avatar',
        'get_short_location'               => 'location',
        'get_location'                     => 'location',
        'get_map_view'                     => 'location',
        'get_latlng'                       => 'location',
        'get_gmap_url'                     => 'location',
        'get_tickets_url_label'            => 'ticket',
        'get_contact_html'                 => 'ticket',
        'get_timespan_html'                => 'time',
        'get_exclude_html'                 => 'time',
        'get_back_to_calendar_button_html' => 'content',
        'get_post_excerpt'                 => 'content',
    );

    public function get_long_end_date( $adjust = 0 ) {
        $time = $this->_registry->get( 'view.event.time' );
        $end  = $this->_registry->get( 'date.time', $this->get( 'end' ) );
        if ( ! empty( $adjust ) ) {
            $end->set_time(
                $end->format( 'H' ),
                $end->format( 'i' ),
                $adjust
            );
        }
        return $time->get_long_date( $end );
    }

    public function get_long_start_date() {
        $time = $this->_registry->get( 'view.event.time' );
        return $time->get_long_date( $this->get( 'start' ) );
    }

    public function get_multiday() {
        return $this->is_multiday();
    }

    public function get_recurrence_html() {
        $rrule = $this->_registry->get( 'recurrence.rule' );
        return $rrule->rrule_to_text( $this->get( 'recurrence_rules' ) );
    }

    public function get_short_end_date() {
        $time = $this->_registry->get( 'view.event.time' );
        $end  = $this->_registry->get( 'date.time', $this->get( 'end' ) );
        $end->set_time(
            $end->format( 'H' ),
            $end->format( 'i' ),
            -1
        );
        return $time->get_short_date( $end );
    }

    public function get_short_end_time() {
        $time = $this->_registry->get( 'view.event.time' );
        return $time->get_short_time( $this->get( 'end' ) );
    }

    public function get_short_start_date() {
        $time = $this->_registry->get( 'view.event.time' );
        return $time->get_short_date( $this->get( 'start' ) );
    }

    public function get_short_start_time() {
        $time = $this->_registry->get( 'view.event.time' );
        return $time->get_short_time( $this->get( 'start' ) );
    }

    /**
     * Handles legacy property setters.
     *
     * @param string $property Name of property being set.
     * @param mixed  $value    Value attempted to set.
     *
     * @return Ai1ec_Event Instance of self for chaining.
     */
    public function __set( $property, $value ) {
        return $this->set( $property, $value );
    }

    /**
     * Handle property accessors.
     *
     * @param string $name Property name
     *
     * @return mixed Property value
     */
    public function __get( $name ) {
        $method = 'get_' . $name;
        if ( method_exists( $this, $name ) ) {
            return $this->{$method}();
        }
        return $this->get( $name );
    }

    /**
     * Handle legacy methods calls.
     *
     * @param string $method    Legacy method name.
     * @param array  $arguments Arguments passed to method.
     *
     * @return mixed
     *
     * @throws Ai1ec_Invalid_Argument_Exception If there is no method handler.
     */
    public function __call( $method, $arguments ) {
        if ( ! isset( self::$_classes[$method] ) ) {
            throw new Ai1ec_Invalid_Argument_Exception(
                'Requested method \'' . $method . '\' is unknown'
            );
        }
        array_unshift( $arguments, $this );
        $class = 'view.event.' . self::$_classes[$method];
        return $this->_registry->dispatch(
            $class,
            $method,
            $arguments
        );
    }

}

==================================================
FILE PATH: ./app/model/event/taxonomy.php
==================================================
<?php

/**
 * Modal class representing an event or an event instance.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @instantiator new
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */

class Ai1ec_Event_Taxonomy extends Ai1ec_Base {

    /**
     * @var string Name of categories taxonomy.
     */
    const CATEGORIES    = 'events_categories';

    /**
     * @var string Name of tags taxonomy.
     */
    const TAGS          = 'events_tags';

    /**
     * @var string Name of feeds taxonomy.
     */
    const FEEDS         = 'events_feeds';

    /**
     * @var int ID of related post object
     */
    protected $_post_id = 0;

    /**
     * Store event ID in local variable.
     *
     * @param int $post_id ID of post being managed.
     *
     * @return void
     */
    public function __construct( Ai1ec_Registry_Object $registry, $post_id = 0 ) {
        parent::__construct( $registry );
        $this->_post_id = (int)$post_id;
    }

    /**
     * Get ID of term. Optionally create it if it doesn't exist.
     *
     * @param string $term     Name of term to create.
     * @param string $taxonomy Name of taxonomy to contain term within.
     * @param bool   $is_id    Set to true if $term is ID.
     * @param array  $attrs    Attributes to creatable entity.
     *
     * @return array|bool      Associative array with term_id
     *                         and taxonomy keys or false on error
     */
    public function initiate_term(
        $term,
        $taxonomy,
        $is_id       = false,
        array $attrs = array()
    ) {
        // cast to int to have it working with term_exists
        $term = ( $is_id ) ? (int) $term : $term;
        $term_to_check = term_exists( $term, $taxonomy );
        $to_return = array(
            'taxonomy' => $taxonomy
        );
        // if term doesn't exist, create it.
        if ( 0 === $term_to_check || null === $term_to_check ) {
            $alias_to_use = apply_filters( 'ai1ec_ics_import_alias', $term );
            // the filter will either return null, the term_id to use or the original $term
            // if the filter is not run. Thus in need to check that $term !== $alias_to_use
            if ( $alias_to_use && $alias_to_use !== $term ) {
                $to_return['term_id'] = (int) $alias_to_use;
                // check that the term matches the taxonomy
                $tax = $this->get_taxonomy_for_term_id( term_exists( (int) $alias_to_use ) );
                $to_return['taxonomy'] = $tax->taxonomy;
            } else {
                $term_to_check = wp_insert_term( $term, $taxonomy, $attrs );
                if ( is_wp_error( $term_to_check ) ) {
                    return false;
                }
                $term_to_check = (object)$term_to_check;
                $to_return['term_id'] = (int)$term_to_check->term_id;
            }
        } else {
            $term_id = is_array( $term_to_check )
                ? $term_to_check['term_id']
                : $term_to_check;
            $to_return['term_id'] = (int)$term_id;
            // when importing categories, use the mapping of the current site
            // so place the term in the current taxonomy
            if ( self::CATEGORIES === $taxonomy ) {
                // check that the term matches the taxonomy
                $tax = $this->get_taxonomy_for_term_id( $term_id );
                $to_return['taxonomy'] = $tax->taxonomy;
            }

        }
        return $to_return;
    }

    /**
     * Wrapper for terms setting to post.
     *
     * @param array  $terms    List of terms to set.
     * @param string $taxonomy Name of taxonomy to set terms to.
     * @param bool   $append   When true post may have multiple same instances.
     *
     * @return bool Success.
     */
    public function set_terms( array $terms, $taxonomy, $append = false ) {
        $result = wp_set_post_terms(
            $this->_post_id,
            $terms,
            $taxonomy,
            $append
        );
        if ( is_wp_error( $result ) ) {
            return false;
        }
        return $result;
    }

    /**
     * Update event categories.
     *
     * @param array $categories List of category IDs.
     *
     * @return bool Success.
     */
    public function set_categories( array $categories ) {
        return $this->set_terms( $categories, self::CATEGORIES );
    }

    /**
     * Update event tags.
     *
     * @param array $tags List of tag IDs.
     *
     * @return bool Success.
     */
    public function set_tags( array $tags ) {
        return $this->set_terms( $tags, self::TAGS );
    }

    /**
     * Update event feed description.
     *
     * @param object $feed Feed object.
     *
     * @return bool Success.
     */
    public function set_feed( $feed ) {
        $feed_name = $feed->feed_url;
        // If the feed is not from an imported file, parse the url.
        if ( ! isset( $feed->feed_imported_file ) ) {
            $url_components = parse_url( $feed->feed_url );
            $feed_name      = $url_components['host'];
        }
        $term = $this->initiate_term(
            $feed_name,
            self::FEEDS,
            false,
            array(
                'description' => $feed->feed_url,
            )
        );
        if ( false === $term ) {
            return false;
        }
        $term_id = $term['term_id'];
        return $this->set_terms( array( $term_id ), self::FEEDS );
    }

    /**
     * Get the taxonomy name from term id
     *
     * @param int $term
     *
     * @return stdClass The taxonomy nane
     */
    public function get_taxonomy_for_term_id( $term_id ) {
        $db = $this->_registry->get( 'dbi.dbi' );
        return $db->get_row(
            $db->prepare(
                'SELECT terms_taxonomy.taxonomy FROM ' .  $db->get_table_name( 'terms' ) .
                ' AS terms INNER JOIN ' .
                $db->get_table_name( 'term_taxonomy' ) .
                ' AS terms_taxonomy USING(term_id) '.
                'WHERE terms.term_id = %d LIMIT 1', $term_id )
        );
    }
}

==================================================
FILE PATH: ./app/model/event/entity.php
==================================================
<?php

/**
 * Event internal structure representation. Plain value object.
 *
 * @author       Time.ly Network, Inc.
 * @since        2.0
 * @instantiator new
 * @package      Ai1EC
 * @subpackage   Ai1EC.Model
 */
class Ai1ec_Event_Entity extends Ai1ec_Base {

    /**
     * Get list of object properties.
     *
     * Special value `registry` ({@see Ai1ec_Registry_Object}) is excluded.
     *
     * @return array List of accessible properties.
     *
     * @staticvar array $known List of properties.
     */
    public function list_properties() {
        static $known = null;
        if ( null === $known ) {
            $known = array();
            foreach ( $this as $name => $value ) {
                $name = substr( $name, 1 );
                if ( 'registry' === $name ) {
                    continue;
                }
                $known[] = $name;
            }
        }
        return $known;
    }

    /**
     * Handle cloning properly to resist property changes.
     *
     * @return void
     */
    public function __clone() {
        $this->_start = $this->_registry->get( 'date.time', $this->_start );
        $this->_end   = $this->_registry->get( 'date.time', $this->_end );
        $this->_post  = clone $this->_post;
    }

    /**
     * Change stored property.
     *
     * @param string $name  Name of property to change.
     * @param mixed  $value Arbitrary value to use.
     *
     * @return Ai1ec_Event_Entity Instance of self for chaining.
     *
     * @staticvar array $time_fields Map of fields holding a value of
     *                               {@see Ai1ec_Date_Time}, which
     *                               require modification instead of
     *                               replacement.
     */
    public function set( $name, $value ) {
        static $time_fields = array(
            'start' => true,
            'end'   => true,
        );
        if ( 'registry' === $name ) {
            return $this; // short-circuit: protection mean.
        }
        if ( 'timezone_name' === $name && empty( $value ) ) {
            return $this; // protection against invalid TZ values.
        }
        $field = '_' . $name;
        if ( isset( $time_fields[$name] ) ) {
            // object of Ai1ec_Date_Time type is now handled in it itself
            $this->{$field}->set_date_time(
                $value,
                ( null === $this->_timezone_name )
                    ? 'UTC'
                    : $this->_timezone_name
            );
            $this->adjust_preferred_timezone();
        } else {
            $this->{$field} = $value;
        }
        if ( 'timezone_name' === $name ) {
            $this->_start->set_timezone( $value );
            $this->_end  ->set_timezone( $value );
            $this->adjust_preferred_timezone();
        }
        return $this;
    }

    /**
     * Optionally adjust preferred (display) timezone.
     *
     * @return bool|DateTimeZone False or new timezone.
     *
     * @staticvar bool $do_adjust True when adjustment should be performed.
     */
    public function adjust_preferred_timezone() {
        static $do_adjust = null;
        if ( null === $do_adjust ) {
            $do_adjust = !$this->_registry
                ->get( 'model.settings' )
                ->get( 'always_use_calendar_timezone', false );
        }
        if ( ! $do_adjust ) {
            return false;
        }
        $timezone = $this->_registry->get( 'date.timezone' )->get(
            $this->_timezone_name
        );
        $this->set_preferred_timezone( $timezone );
        return $timezone;
    }

    /**
     * Set preferred timezone to datetime fields.
     *
     * @param DateTimeZone $timezone Preferred timezone instance.
     *
     * @return void
     */
    public function set_preferred_timezone( DateTimeZone $timezone ) {
        $this->_start->set_preferred_timezone( $timezone );
        $this->_end  ->set_preferred_timezone( $timezone );
    }

    /**
     * Get a value of some property.
     *
     * @param string $name    Name of property to get.
     * @param mixed  $default Value to return if property is not defined.
     *
     * @return mixed Found value or $default.
     */
    public function get( $name, $default = null ) {
        if ( ! isset( $this->{ '_' . $name } ) ) {
            return $default;
        }
        return $this->{ '_' . $name };
    }

    /**
     * Initialize values to some sane defaults.
     *
     * @param Ai1ec_Registry_Object $registry Injected registry.
     *
     * @return void
     */
    public function __construct( Ai1ec_Registry_Object $registry ) {
        parent::__construct( $registry );
        $this->_start = $this->_registry->get( 'date.time' );
        $this->_end   = $this->_registry->get( 'date.time', '+1 hour' );
    }

    /**
     * @var object Instance of WP_Post object.
     */
    private $_post;

    /**
     * @var int Post ID.
     */
    private $_post_id;

    /**
     * @var int|null Uniquely identifies the recurrence instance of this event
     *               object. Value may be null.
     */
    private $_instance_id;

    /**
     * @var string Name of timezone to use for event times.
     */
    private $_timezone_name;

    /**
     * @var Ai1ec_Date_Time Start date-time specifier
     */
    private $_start;

    /**
     * @var Ai1ec_Date_Time End date-time specifier
     */
    private $_end;

    /**
     * @var bool Whether this copy of the event was broken up for rendering and
     *           the start time is not its "real" start time.
     */
    private $_start_truncated;

    /**
     * @var bool Whether this copy of the event was broken up for rendering and
     *           the end time is not its "real" end time.
     */
    private $_end_truncated;

    /**
     * @var int If event is all-day long
     */
    private $_allday;

    /**
     * @var int If event has no duration
     */
    private $_instant_event;

    /**
     * ==========================
     * = Recurrence information =
     * ==========================
     */

    /**
     * @var string Recurrence rules
     */
    private $_recurrence_rules;

    /**
     * @var string Exception rules
     */
    private $_exception_rules;

    /**
     * @var string Recurrence dates
     */
    private $_recurrence_dates;

    /**
     * @var string Exception dates
     */
    private $_exception_dates;

    /**
     * @var string Venue name - free text
     */
    private $_venue;

    /**
     * @var string Country name - free text
     */
    private $_country;

    /**
     * @var string Address information - free text
     */
    private $_address;

    /**
     * @var string City name - free text
     */
    private $_city;

    /**
     * @var string Province free text definition
     */
    private $_province;

    /**
     * @var int Postal code
     */
    private $_postal_code;

    /**
     * @var int Set to true to display map
     */
    private $_show_map;

    /**
     * @var int Set to true to show coordinates in description
     */
    private $_show_coordinates;

    /**
     * @var float GEO information - longitude
     */
    private $_longitude;

    /**
     * @var float GEO information - latitude
     */
    private $_latitude;

    /**
     * @var string Event contact information - contact person
     */
    private $_contact_name;

    /**
     * @var string Event contact information - phone number
     */
    private $_contact_phone;

    /**
     * @var string Event contact information - email address
     */
    private $_contact_email;

    /**
     * @var string Event contact information - external URL.
     */
    private $_contact_url;

    /**
     * @var string Defines event cost.
     */
    private $_cost;

    /**
     * @var bool Indicates, whereas event is free.
     */
    private $_is_free;

    /**
     * @var string Link to buy tickets
     */
    private $_ticket_url;

    // ====================================
    // = iCalendar feed (.ics) properties =
    // ====================================

    /**
     * @var string URI of source ICAL feed.
     */
    private $_ical_feed_url;

    /**
     * @var string|null URI of source ICAL entity.
     */
    private $_ical_source_url;

    /**
     * @var string Organiser details
     */
    private $_ical_organizer;

    /**
     * @var string Contact details
     */
    private $_ical_contact;

    /**
     * @var string|int UID of ICAL feed
     */
    private $_ical_uid;

    // ===============================
    // = taxonomy-related properties =
    // ===============================

    /**
     * @var string Associated event tag names (*not* IDs), joined by commas.
     */
    private $_tags;

    /**
     * @var string Associated event category IDs, joined by commas.
     */
    private $_categories;

    /**
     * @var string Associated event feed object
     */
    private $_feed;


}


==================================================
FILE PATH: ./app/model/event/trashing.php
==================================================
<?php

/**
 * Handles trash/delete operations.
 *
 * NOTICE: only operations on events entries themselve is handled.
 * If plugins need some extra handling - they must bind to appropriate
 * actions on their will.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Model
 */
class Ai1ec_Event_Trashing extends Ai1ec_Base {

    /**
     * Trash/untrash/deletes child posts
     *
     * @param id $post_id
     * @param string $action
     */
    protected function _manage_children( $post_id, $action ) {
        try {
            $ai1ec_event = $this->_registry->get( 'model.event', $post_id );
            if (
                $ai1ec_event->get( 'post' ) &&
                    $ai1ec_event->get( 'recurrence_rules' )
            ) {
                // when untrashing also get trashed object
                $children = $this->_registry->get( 'model.event.parent' )
                    ->get_child_event_objects( $ai1ec_event->get( 'post_id' ), $action === 'untrash' );
                $function = 'wp_' . $action . '_post';
                foreach ( $children as $child ) {
                    $function( $child->get( 'post_id' ) );
                }
            }
        } catch ( Ai1ec_Event_Not_Found_Exception $exception ) {
            // ignore - not an event
        }
    }

    /**
     * Trashes child posts
     *
     * @param int $post_id
     */
    public function trash_children( $post_id ) {
        $this->_manage_children( $post_id, 'trash' );
    }

    /**
     * Delete child posts
     *
     * @param int $post_id
     */
    public function delete_children( $post_id ) {
        $this->_manage_children( $post_id, 'delete' );
    }

    /**
     * Untrashes child posts
     *
     * @param int $post_id
     */
    public function untrash_children( $post_id ) {
        $this->_manage_children( $post_id, 'untrash' );
    }

    /**
     * Handle PRE (event) trashing.
     *
     * @wp_hook trash_post
     *
     * @param int $post_id ID of post, which was trashed.
     *
     * @return bool Success.
     */
    public function trash_post( $post_id ) {
        $api             = $this->_registry->get( 'model.api.api-ticketing' );
        $post            = get_post( $post_id );
        $restored_status = get_post_meta( $post_id, '_wp_trash_meta_status', true );
        $fields          = array(
            'status' => 'trash'
        );
        $ajax    = defined( 'DOING_AJAX' ) && DOING_AJAX;
        $message = $api->update_api_event_fields( $post, $fields, 'trash', $ajax );
        if ( null !== $message )  {
            if ( $ajax ) {
                wp_die( $message );
            } else {
                wp_redirect( $this->get_sendback_page( $post_id ) );
                exit();
            }
        }
        return true;
    }

    /**
     * Handle POST (event) trashing.
     *
     * @wp_hook trashed_post
     *
     * @param int $post_id ID of post, which was trashed.
     *
     * @return bool Success.
     */
    public function trashed_post( $post_id ) {
        return $this->trash_children( $post_id );
    }

    private function get_sendback_page( $post_id ) {
        $sendback  = wp_get_referer();
        $page_base = Ai1ec_Wp_Uri_Helper::get_pagebase( $sendback ); //$_SERVER['REQUEST_URI'] );
        if ( 'post.php' === $page_base ) {
            return get_edit_post_link( $post_id, 'url' );
        } else {
            return admin_url( 'edit.php?post_type=ai1ec_event' );
        }
    }

    /**
     * Handle PRE (event) untrashing.
     *
     * @wp_hook untrash_post
     *
     * @param int $post_id ID of post, which was untrashed.
     *
     * @return bool Success. Interrupt the action with exit is
     * the integration with API fails
     */
    public function untrash_post ( $post_id ) {
        $api             = $this->_registry->get( 'model.api.api-ticketing' );
        $post            = get_post( $post_id );
        $restored_status = get_post_meta( $post_id, '_wp_trash_meta_status', true );
        $fields          = array(
            'status' => $restored_status
        );
        $ajax    = defined( 'DOING_AJAX' ) && DOING_AJAX;
        $message = $api->update_api_event_fields( $post, $fields, 'untrash', $ajax );
        if ( null !== $message )  {
            if ( $ajax ) {
                wp_die( $message );
            } else {
                wp_redirect( $this->get_sendback_page( $post_id ) );
                exit();
            }
        }
        return true;
    }

    /**
     * Handle POST (event) untrashing.
     *
     * @wp_hook untrashed_post
     *
     * @param int $post_id ID of post, which was untrashed.
     *
     * @return bool Success.
     */
    public function untrashed_post( $post_id ) {
        return $this->untrash_children( $post_id );
    }

    /**
     * Handle PRE (event) deletion.
     *
     * Executed before post is deleted, but after meta is removed.
     *
     * @wp_hook delete_post
     *
     * @param int $post_id ID of post, which was trashed.
     *
     * @return bool Success. Interrupt the action with exit is
     * the integration with API fails
     */
    public function before_delete_post( $post_id ) {
        $api     = $this->_registry->get( 'model.api.api-ticketing' );
        $ajax    = defined( 'DOING_AJAX' ) && DOING_AJAX;
        $message = $api->delete_api_event( $post_id, 'delete', $ajax );
        if ( null !==  $message )  {
            if ( $ajax ) {
                wp_die( $message );
            } else {
                wp_redirect( $this->get_sendback_page( $post_id ) );
                exit();
            }
        }
        return true;
    }

    /**
     * Handle POST (event) deletion.
     *
     * Executed before post is deleted, but after meta is removed.
     *
     * @wp_hook delete_post
     *
     * @param int $post_id ID of post, which was trashed.
     *
     * @return bool Success.
     */
    public function delete( $post_id ) {
        $post_id = (int)$post_id;
        $where   = array( 'post_id' => (int)$post_id );
        $format  = array( '%d' );
        $dbi     = $this->_registry->get( 'dbi.dbi' );
        $success = $this->delete_children( $post_id );
        $success = $dbi->delete( 'ai1ec_events', $where, $format );
        $success = $this->_registry->get( 'model.event.instance' )->clean( $post_id );
        unset( $where, $dbi );
        return $success;
    }

}

==================================================
FILE PATH: ./app/model/event/creating.php
==================================================
<?php

/**
 * Handles create/update operations.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Model
 */
class Ai1ec_Event_Creating extends Ai1ec_Base {

    protected function is_valid_event( $post ) {
            // verify this came from the our screen and with proper authorization,
        // because save_post can be triggered at other times
        if (
            ! isset( $_POST[AI1EC_POST_TYPE] ) ||
            ! wp_verify_nonce( $_POST[AI1EC_POST_TYPE], 'ai1ec' )
        ) {
            return false;
        }

        if (
            isset( $post->post_status ) &&
            'auto-draft' === $post->post_status
        ) {
            return false;
        }

        // verify if this is not inline-editing
        if (
            isset( $_REQUEST['action'] ) &&
            'inline-save' === $_REQUEST['action']
        ) {
            return false;
        }

        // verify that the post_type is that of an event
        if ( $post->post_type !==  AI1EC_POST_TYPE ) {
            return false;
        }

        return true;
    }

    private function _parse_post_to_event( $post_id ) {

        /**
         * =====================================================================
         *
         * CHANGE CODE BELOW TO HAVE FOLLOWING PROPERTIES:
         * - be initializiable from model;
         * - have sane defaults;
         * - avoid that cluster of isset and ternary operator.
         *
         * =====================================================================
         */

        $all_day          = isset( $_POST['ai1ec_all_day_event'] )    ? 1                                                                 : 0;
        $instant_event    = isset( $_POST['ai1ec_instant_event'] )    ? 1                                                                 : 0;
        $timezone_name    = isset( $_POST['ai1ec_timezone_name'] )    ? sanitize_text_field( $_POST['ai1ec_timezone_name'] )              : 'sys.default';
        $start_time       = isset( $_POST['ai1ec_start_time'] )       ? sanitize_text_field( $_POST['ai1ec_start_time'] )                 : '';
        $end_time         = isset( $_POST['ai1ec_end_time'] )         ? sanitize_text_field( $_POST['ai1ec_end_time'] )                   : '';
        $venue            = isset( $_POST['ai1ec_venue'] )            ? sanitize_text_field( $_POST['ai1ec_venue'] )                      : '';
        $address          = isset( $_POST['ai1ec_address'] )          ? sanitize_text_field( $_POST['ai1ec_address'] )                    : '';
        $city             = isset( $_POST['ai1ec_city'] )             ? sanitize_text_field( $_POST['ai1ec_city'] )                       : '';
        $province         = isset( $_POST['ai1ec_province'] )         ? sanitize_text_field( $_POST['ai1ec_province'] )                   : '';
        $postal_code      = isset( $_POST['ai1ec_postal_code'] )      ? sanitize_text_field( $_POST['ai1ec_postal_code'] )                : '';
        $country          = isset( $_POST['ai1ec_country'] )          ? sanitize_text_field( $_POST['ai1ec_country'] )                    : '';
        $google_map       = isset( $_POST['ai1ec_google_map'] )       ? 1                                                                 : 0;
        $cost             = isset( $_POST['ai1ec_cost'] )             ? sanitize_text_field( $_POST['ai1ec_cost'] )                       : '';
        $is_free          = isset( $_POST['ai1ec_is_free'] )          ? (bool)$_POST['ai1ec_is_free']                                     : false;
        $ticket_url       = isset( $_POST['ai1ec_ticket_url'] )       ? sanitize_text_field( $_POST['ai1ec_ticket_url'] )                 : '';
        $contact_name     = isset( $_POST['ai1ec_contact_name'] )     ? sanitize_text_field( $_POST['ai1ec_contact_name'] )               : '';
        $contact_phone    = isset( $_POST['ai1ec_contact_phone'] )    ? sanitize_text_field( $_POST['ai1ec_contact_phone'] )              : '';
        $contact_email    = isset( $_POST['ai1ec_contact_email'] )    ? sanitize_text_field( $_POST['ai1ec_contact_email'] )              : '';
        $contact_url      = isset( $_POST['ai1ec_contact_url'] )      ? sanitize_text_field( $_POST['ai1ec_contact_url'] )                : '';
        $show_coordinates = isset( $_POST['ai1ec_input_coordinates'] )? 1                                                                 : 0;
        $longitude        = isset( $_POST['ai1ec_longitude'] )        ? sanitize_text_field( $_POST['ai1ec_longitude'] )                  : '';
        $latitude         = isset( $_POST['ai1ec_latitude'] )         ? sanitize_text_field( $_POST['ai1ec_latitude'] )                   : '';
        $cost_type        = isset( $_POST['ai1ec_cost_type'] )        ? sanitize_text_field( $_POST['ai1ec_cost_type'] )                  : '';
        $rrule            = null;
        $exrule           = null;
        $exdate           = null;
        $rdate            = null;

        if ( 'external' !== $cost_type ) {
            $ticket_url = '';
        }

        $this->_remap_recurrence_dates();
        // if rrule is set, convert it from local to UTC time
        if (
            isset( $_POST['ai1ec_repeat'] ) &&
            ! empty( $_POST['ai1ec_repeat'] )
        ) {
            $rrule = $_POST['ai1ec_rrule'];
        }

        // add manual dates
        if (
            isset( $_POST['ai1ec_exdate'] ) &&
            ! empty( $_POST['ai1ec_exdate'] )
        ) {
            $exdate = $_POST['ai1ec_exdate'];
        }
        if (
            isset( $_POST['ai1ec_rdate'] ) &&
            ! empty( $_POST['ai1ec_rdate'] )
        ) {
            $rdate = $_POST['ai1ec_rdate'];
        }

        // if exrule is set, convert it from local to UTC time
        if (
            isset( $_POST['ai1ec_exclude'] ) &&
            ! empty( $_POST['ai1ec_exclude'] ) &&
            ( null !== $rrule || null !== $rdate ) // no point for exclusion, if repetition is not set
        ) {
            $exrule = $this->_registry->get( 'recurrence.rule' )->merge_exrule(
                $_POST['ai1ec_exrule'],
                $rrule
            );
        }

        $is_new = false;
        try {
            $event =  $this->_registry->get(
                'model.event',
                $post_id ? $post_id : null
            );
        } catch ( Ai1ec_Event_Not_Found_Exception $excpt ) {
            // Post exists, but event data hasn't been saved yet. Create new event
            // object.
            $is_new = true;
            $event  =  $this->_registry->get( 'model.event' );
        }
        $formatted_timezone = $this->_registry->get( 'date.timezone' )
                ->get_name( $timezone_name );
        if ( empty( $timezone_name ) || ! $formatted_timezone ) {
            $timezone_name = 'sys.default';
        }

        unset( $formatted_timezone );
        $start_time_entry = $this->_registry
            ->get( 'date.time', $start_time, $timezone_name );
        $end_time_entry   = $this->_registry
            ->get( 'date.time', $end_time,   $timezone_name );

        $timezone_name = $start_time_entry->get_timezone();
        if ( null === $timezone_name ) {
            $timezone_name = $start_time_entry->get_default_format_timezone();
        }

        $event->set( 'post_id',          $post_id );
        $event->set( 'start',            $start_time_entry );
        if ( $instant_event ) {
            $event->set_no_end_time();
        } else {
            $event->set( 'end',           $end_time_entry );
            $event->set( 'instant_event', false );
        }
        $event->set( 'timezone_name',    $timezone_name );
        $event->set( 'allday',           $all_day );
        $event->set( 'venue',            $venue );
        $event->set( 'address',          $address );
        $event->set( 'city',             $city );
        $event->set( 'province',         $province );
        $event->set( 'postal_code',      $postal_code );
        $event->set( 'country',          $country );
        $event->set( 'show_map',         $google_map );
        $event->set( 'cost',             $cost );
        $event->set( 'is_free',          $is_free );
        $event->set( 'ticket_url',       $ticket_url );
        $event->set( 'contact_name',     $contact_name );
        $event->set( 'contact_phone',    $contact_phone );
        $event->set( 'contact_email',    $contact_email );
        $event->set( 'contact_url',      $contact_url );
        $event->set( 'recurrence_rules', $rrule );
        $event->set( 'exception_rules',  $exrule );
        $event->set( 'exception_dates',  $exdate );
        $event->set( 'recurrence_dates', $rdate );
        $event->set( 'show_coordinates', $show_coordinates );
        $event->set( 'longitude',        trim( $longitude ) );
        $event->set( 'latitude',         trim( $latitude ) );
        $event->set( 'ical_uid',         $event->get_uid() );

        return array(
            'event'        => $event,
            'is_new'       => $is_new
        );
    }

    /**
     * Saves meta post data.
     *
     * @wp_hook save_post
     *
     * @param  int    $post_id Post ID.
     * @param  object $post    Post object.
     * @param  update
     *
     * @return object|null Saved Ai1ec_Event object if successful or null.
     */
    public function save_post( $post_id, $post, $update ) {

        if ( false === $this->is_valid_event( $post ) ) {
            return null;
        }

        // LABEL:magicquotes
        // remove WordPress `magical` slashes - we work around it ourselves
        $_POST = stripslashes_deep( $_POST );

        $data = $this->_parse_post_to_event( $post_id );
        if ( ! $data ) {
            return null;
        }
        $event        = $data['event'];
        $is_new       = $data['is_new'];

        $banner_image = isset( $_POST['ai1ec_banner_image'] )     ? sanitize_text_field( $_POST['ai1ec_banner_image'] ) : '';
        $cost_type    = isset( $_POST['ai1ec_cost_type'] )        ? sanitize_text_field( $_POST['ai1ec_cost_type'] )    : '';

        update_post_meta( $post_id, 'ai1ec_banner_image', $banner_image );
        if ( $cost_type ) {
            update_post_meta( $post_id, '_ai1ec_cost_type', $cost_type );
        }
        $api = $this->_registry->get( 'model.api.api-ticketing' );
        if ( $update === false ) {
            //this method just creates the API event, the update action
            //is treated by another hook (pre_update_event inside api )
            if ( 'tickets' === $cost_type ) {
                $result = $api->store_event( $event, $post, false );
                if ( true !== $result ) {
                    $_POST['_ticket_store_event_error'] = $result;
                } else {
                    update_post_meta(
                        $post_id,
                        '_ai1ec_timely_tickets_url',
                        $api->get_api_event_buy_ticket_url( $event->get( 'post_id' ) )
                    );
                }
            }
        }
        if ( 'tickets' === $cost_type ) {
            update_post_meta(
                $post_id,
                '_ai1ec_timely_tickets_url',
                $api->get_api_event_buy_ticket_url( $event->get( 'post_id' ) )
            );
        } else {
            delete_post_meta(
                $post_id,
                '_ai1ec_timely_tickets_url'
            );
        }
        if ( $is_new ) {
            $api->sendEvent( '000009220974' );
        }

        // let other extensions save their fields.
        do_action( 'ai1ec_save_post', $event );

        $event->save( ! $is_new );

        // LABEL:magicquotes
        // restore `magic` WordPress quotes to maintain compatibility
        $_POST = add_magic_quotes( $_POST );

        $api = $this->_registry->get( 'model.api.api-registration' );
        $api->check_settings();

        return $event;
    }

    private function get_sendback_page( $post_id ) {
        $sendback  = wp_get_referer();
        $page_base = Ai1ec_Wp_Uri_Helper::get_pagebase( $sendback ); //$_SERVER['REQUEST_URI'] );
        if ( 'post.php' === $page_base ) {
            return get_edit_post_link( $post_id, 'url' );
        } else {
            return admin_url( 'edit.php?post_type=ai1ec_event' );
        }
    }

    /**
     * Handle PRE (ticket event) update.
     * Just handle the Ticket Events, other kind of post are ignored
     * @wp_hook pre_post_update
     *
     */
    public function pre_post_update ( $post_id, $new_post_data ) {

        // LABEL:magicquotes
        // remove WordPress `magical` slashes - we work around it ourselves
        $_POST = stripslashes_deep( $_POST );

        $api    = $this->_registry->get( 'model.api.api-ticketing' );
        $action = $this->current_action();
        switch( $action ) {
        case 'inline-save': //quick edit from edit page
            $fields = array();
            if ( false === ai1ec_is_blank( $_REQUEST['post_title'] ) ) {
                $fields['title'] = sanitize_text_field( $_REQUEST['post_title'] );
            }
            if ( false === ai1ec_is_blank( $_REQUEST['_status'] ) ) {
                $fields['status'] = $_REQUEST['_status'];
            }
            if ( isset( $_REQUEST['keep_private'] ) && 'private' === $_REQUEST['keep_private'] ) {
                $fields['visibility'] = 'private';
            } else if ( isset( $_REQUEST['post_password'] ) && false === ai1ec_is_blank( $_REQUEST['post_password'] ) ) {
                $fields['visibility'] = 'password';
            }
            if ( 0 < count( $fields ) ) {
                $post    = get_post( $post_id );
                $ajax    = defined( 'DOING_AJAX' ) && DOING_AJAX;
                $message = $api->update_api_event_fields( $post, $fields, 'update', $ajax );
                if ( null !== $message )  {
                    if ( $ajax ) {
                        wp_die( $message );
                    } else {
                        wp_redirect( $this->get_sendback_page( $post_id ) );
                        exit();
                    }
                }
            }
            return;
        case 'edit': //bulk edition from edit page
            $fields          = array();
            if ( false === ai1ec_is_blank( $_REQUEST['_status'] ) ) {
                $fields['status'] = $_REQUEST['_status'];
            }
            if ( 0 < count( $fields ) ) {
                $post    = get_post( $post_id );
                $ajax    = defined( 'DOING_AJAX' ) && DOING_AJAX;
                $message = $api->update_api_event_fields( $post, $fields, 'update', $ajax );
                if ( null !== $message )  {
                    if ( $ajax ) {
                        wp_die( $message );
                    } else {
                        wp_redirect( $this->get_sendback_page( $post_id ) );
                        exit();
                    }
                }
            }
            return;
        case 'editpost': //edition from post page
            $new_post_data['ID'] = $post_id;
            $post = new WP_Post( (object) $new_post_data );
            if ( false === $this->is_valid_event( $post ) ) {
                break;
            }
            $data  = $this->_parse_post_to_event( $post_id );
            if ( ! $data ) {
                break;
            }
            $event     = $data['event'];
            $cost_type = isset( $_REQUEST['ai1ec_cost_type'] ) ? $_REQUEST['ai1ec_cost_type'] : '';
            if ( 'tickets' === $cost_type ) {
                $result = $api->store_event( $event, $post, true );
                if ( true !== $result ) {
                    wp_redirect( $this->get_sendback_page( $post_id ) );
                    exit();
                }
            } else {
                $message = $api->delete_api_event( $post_id, 'update', false );
                if ( null !== $message )  {
                    wp_redirect( $this->get_sendback_page( $post_id ) );
                    exit();
                }
            }
            break;
        default:
            break;
        }

        // LABEL:magicquotes
        // restore `magic` WordPress quotes to maintain compatibility
        $_POST = add_magic_quotes( $_POST );
    }

    protected function current_action() {
        $action = '';
        if ( isset( $_REQUEST['delete_all'] ) || isset( $_REQUEST['delete_all2'] ) ) {
            $action = 'delete';
        } else {
            if ( isset( $_REQUEST['action'] ) && -1 != $_REQUEST['action'] ) {
                $action = $_REQUEST['action'];
            }
            if ( isset( $_REQUEST['action2'] ) && -1 != $_REQUEST['action2'] ) {
                $action = $_REQUEST['action2'];
            }
        }
        return $action;
    }

    /**
     * _create_duplicate_post method
     *
     * Create copy of event by calling {@uses wp_insert_post} function.
     * Using 'post_parent' to add hierarchy.
     *
     * @param array $data Event instance data to copy
     *
     * @return int|bool New post ID or false on failure
     **/
    public function create_duplicate_post() {
        if ( ! isset( $_POST['post_ID'] ) ) {
            return false;
        }
        $clean_fields = array(
            'ai1ec_repeat'      => NULL,
            'ai1ec_rrule'       => '',
            'ai1ec_exrule'      => '',
            'ai1ec_exdate'      => '',
            'post_ID'           => NULL,
            'post_name'         => NULL,
            'ai1ec_instance_id' => NULL,
        );
        $old_post_id = $_POST['post_ID'];
        $instance_id = $_POST['ai1ec_instance_id'];
        foreach ( $clean_fields as $field => $to_value ) {
            if ( NULL === $to_value ) {
                unset( $_POST[$field] );
            } else {
                $_POST[$field] = $to_value;
            }
        }
        $_POST                   = _wp_translate_postdata( false, $_POST );
        $_POST['post_parent']    = $old_post_id;
        if ( isset( $_POST['post_title'] ) ) {
            $_POST['post_title'] = sanitize_text_field( $_POST['post_title'] );
        }
        $post_id = wp_insert_post( $_POST );
        $this->_registry->get( 'model.event.parent' )->event_parent(
            $post_id,
            $old_post_id,
            $instance_id
        );
        return $post_id;
    }

    /**
     * Cleans calendar shortcodes from event content.
     *
     * @param array $data    An array of slashed post data.
     * @param array $postarr An array of sanitized, but otherwise unmodified post data.
     *
     * @return array An array of slashed post data.
     */
    public function wp_insert_post_data( $data ) {
        global $shortcode_tags;
        if (
            ! isset( $data['post_type'] ) ||
            ! isset( $data['post_content'] ) ||
            AI1EC_POST_TYPE !== $data['post_type'] ||
            empty( $shortcode_tags ) ||
            ! is_array( $shortcode_tags ) ||
            false === strpos( $data['post_content'], '[' )
        ) {
            return $data;
        }
        $pattern              = get_shortcode_regex();
        $data['post_content'] = preg_replace_callback(
            "/$pattern/s",
            array( $this, 'strip_shortcode_tag' ),
            $data['post_content']
        );
        return $data;
    }

    /**
     * Reutrns shortcode or stripped content for given shortcode.
     * Currently regex callback function passes as $tag argument 7-element long
     * array.
     * First element ($tag[0]) is not modified full shortcode text.
     * Third element ($tag[2]) is pure shortcode identifier.
     * Sixth element ($tag[5]) contains shortcode content if any
     * [ai1ec_test]content[/ai1ec].
     *
     * @param array $tag Incoming data.
     *
     * @return string Shortcode replace tag.
     */
    public function strip_shortcode_tag( $tag ) {
        if (
            count( $tag ) < 7 ||
            'ai1ec' !== substr( $tag[2], 0, 5 ) ||
            ! apply_filters( 'ai1ec_content_remove_shortcode_' . $tag[2], false )
        ) {
            return $tag[0];
        }
        return $tag[5];
    }

    protected function _remap_recurrence_dates() {
        if (
            isset( $_POST['ai1ec_exclude'] ) &&
            'EXDATE' === substr( $_POST['ai1ec_exrule'], 0, 6 )
        ) {
            $_POST['ai1ec_exdate'] = substr( $_POST['ai1ec_exrule'], 7 );
            unset( $_POST['ai1ec_exclude'],  $_POST['ai1ec_exrule'] );
        }
        if (
            isset( $_POST['ai1ec_repeat'] ) &&
            'RDATE' === substr( $_POST['ai1ec_rrule'], 0, 5 )
        ) {
            $_POST['ai1ec_rdate'] = substr( $_POST['ai1ec_rrule'], 6 );
            unset( $_POST['ai1ec_repeat'],  $_POST['ai1ec_rrule'] );
        }
    }

}


==================================================
FILE PATH: ./app/model/event/invalid-argument-exception.php
==================================================
<?php

/**
 * Some argument was of invalid type.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Model
 */
class Ai1ec_Invalid_Argument_Exception extends Ai1ec_Exception {
}

==================================================
FILE PATH: ./app/model/filter/cat_ids.php
==================================================
<?php

/**
 * Categories filtering implementation.
 *
 * @instantiator new
 * @author       Time.ly Network Inc.
 * @since        2.0
 * @package      AI1EC
 * @subpackage   AI1EC.Filter
 */
class Ai1ec_Filter_Categories extends Ai1ec_Filter_Taxonomy {

    public function get_taxonomy() {
        return 'events_categories';
    }

}

==================================================
FILE PATH: ./app/model/filter/tag_ids.php
==================================================
<?php

/**
 * Tags filtering implementation.
 *
 * @instantiator new
 * @author       Time.ly Network Inc.
 * @since        2.0
 * @package      AI1EC
 * @subpackage   AI1EC.Filter
 */
class Ai1ec_Filter_Tags extends Ai1ec_Filter_Taxonomy {

    public function get_taxonomy() {
        return 'events_tags';
    }

}

==================================================
FILE PATH: ./app/model/filter/instance_ids.php
==================================================
<?php

/**
 * Posts (events) filtering implementation.
 *
 * @instantiator new
 * @author       Time.ly Network Inc.
 * @since        2.0
 * @package      AI1EC
 * @subpackage   AI1EC.Filter
 */
class Ai1ec_Filter_Posts_By_Instance extends Ai1ec_Filter_Int {

    public function get_field() {
        return 'i.id';
    }

}


==================================================
FILE PATH: ./app/model/filter/post_ids.php
==================================================
<?php

/**
 * Posts (events) filtering implementation.
 *
 * @instantiator new
 * @author       Time.ly Network Inc.
 * @since        2.0
 * @package      AI1EC
 * @subpackage   AI1EC.Filter
 */
class Ai1ec_Filter_Posts extends Ai1ec_Filter_Int {

    public function get_field() {
        return 'e.post_id';
    }

}

==================================================
FILE PATH: ./app/model/filter/interface.php
==================================================
<?php

/**
 * Filter provider interface.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Filter
 */
interface Ai1ec_Filter_Interface {

    /**
     * Store user-input locally.
     *
     * @param Ai1ec_Registry_Object $registry      Injected registry.
     * @param array                 $filter_values User provided input.
     *
     * @return void
     */
    public function __construct(
        Ai1ec_Registry_Object $registry,
        array $filter_values = array()
    );

    /**
     * Return SQL snippet for `FROM` part.
     *
     * @return string Valid SQL snippet for `FROM` part.
     */
    public function get_join();

    /**
     * Return SQL snippet for `WHERE` part.
     *
     * Snippet should not be put in brackets - this will be performed
     * in upper level.
     *
     * @return string Valid SQL snippet.
     */
    public function get_where();

}

==================================================
FILE PATH: ./app/model/filter/taxonomy.php
==================================================
<?php

/**
 * Base class for taxonomies filtering.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Filter
 */
abstract class Ai1ec_Filter_Taxonomy extends Ai1ec_Filter_Int {

    /**
     * @var Ai1ec_Dbi Instance of database interface.
     */
    protected $_dbi = null;

    /**
     * Sanitize input values upon construction.
     *
     * @param Ai1ec_Registry_Object $registry      Injected registry.
     * @param array                 $filter_values Values to sanitize.
     *
     * @return void
     */
    public function __construct(
        Ai1ec_Registry_Object $registry,
        array $filter_values = array()
    ) {
        parent::__construct( $registry, $filter_values );
        $this->_dbi = $this->_registry->get( 'dbi.dbi' );
    }

    /**
     * Build SQL snippet for `FROM` particle.
     *
     * @return string Valid SQL snippet.
     */
    public function get_join() {
        if ( empty( $this->_values ) ) {
            return '';
        }
        $sql_query =
            'LEFT JOIN `{{RELATIONSHIPS_TABLE}}` AS `{{RELATIONSHIP_ALIAS}}` ' .
                'ON ( `e` . `post_id` = `{{RELATIONSHIP_ALIAS}}` . `object_id` ) ' .
            'LEFT JOIN `{{TAXONOMY_TABLE}}` AS `{{TAXONOMY_ALIAS}}` ' .
                'ON (' .
                    '`{{RELATIONSHIP_ALIAS}}` . `term_taxonomy_id` = ' .
                        '`{{TAXONOMY_ALIAS}}` . `term_taxonomy_id` ' .
                    'AND `{{TAXONOMY_ALIAS}}` . taxonomy = {{TAXONOMY}} ' .
                ')';
        return str_replace(
            array(
                '{{RELATIONSHIPS_TABLE}}',
                '{{RELATIONSHIP_ALIAS}}',
                '{{TAXONOMY_TABLE}}',
                '{{TAXONOMY_ALIAS}}',
                '{{TAXONOMY}}',
            ),
            array(
                $this->_dbi->get_table_name( 'term_relationships' ),
                $this->_table_alias( 'term_relationships' ),
                $this->_dbi->get_table_name( 'term_taxonomy' ),
                $this->_table_alias( 'term_taxonomy' ),
                '\'' . addslashes( $this->get_taxonomy() ) . '\'',
            ),
            $sql_query
        );
    }

    /**
     * Required by parent class. Using internal abstractions.
     *
     * @return string Field name to use in `WHERE` particle.
     */
    public function get_field() {
        return $this->_table_alias( 'term_taxonomy' ) . '.term_id';
    }

    /**
     * Return the qualified name for the taxonomy.
     *
     * @return string Valid taxonomy name (see `term_taxonomy` table).
     */
    abstract public function get_taxonomy();

    /**
     * Generate table alias given taxonomy.
     *
     * @param string $table Table to generate alias for.
     *
     * @return string Table alias.
     */
    protected function _table_alias( $table ) {
        return $table . '_' . $this->get_taxonomy();
    }

}

==================================================
FILE PATH: ./app/model/filter/int.php
==================================================
<?php

/**
 * Base class for integers-based filters.
 *
 * @author     Time.ly Network Inc.
 * @since      2.0
 *
 * @package    AI1EC
 * @subpackage AI1EC.Filter
 */
abstract class Ai1ec_Filter_Int implements Ai1ec_Filter_Interface {

    /**
     * @var Ai1ec_Registry_Object Injected object registry.
     */
    protected $_registry = null;

    /**
     * @var array Sanitized input values with only positive integers kept.
     */
    protected $_values   = array();

    /**
     * Sanitize input values upon construction.
     *
     * @param Ai1ec_Registry_Object $registry      Injected registry.
     * @param array                 $filter_values Values to sanitize.
     *
     * @return void
     */
    public function __construct(
        Ai1ec_Registry_Object $registry,
        array $filter_values = array()
    ) {
        $this->_registry = $registry;
        $this->_values   = array_filter(
            array_map(
                array( $this->_registry->get( 'primitive.int' ), 'positive' ),
                $filter_values
            )
        );
    }

    /**
     * These simple filters does not require new joins.
     *
     * @return string Empty string is returned.
     */
    public function get_join() {
        return '';
    }

    /**
     * Get condition part of query for single field.
     *
     * @param string $inner_operator Inner logics to use. It is ignored.
     *
     * @return string Conditional snippet for query.
     */
    public function get_where( $inner_operator = null ) {
        if ( empty( $this->_values ) ) {
            return '';
        }
        return $this->get_field() . ' IN ( ' . join( ',', $this->_values ) . ' )';
    }

    /**
     * Require ancestors to override this to build correct conditional snippet.
     *
     * @return string Column alias to use in condition.
     */
    abstract public function get_field();

}

==================================================
FILE PATH: ./app/model/filter/auth_ids.php
==================================================
<?php

/**
 * Authors filtering implementation.
 *
 * @instantiator new
 * @author       Time.ly Network Inc.
 * @since        2.0
 * @package      AI1EC
 * @subpackage   AI1EC.Filter
 */
class Ai1ec_Filter_Authors extends Ai1ec_Filter_Int {

    public function get_field() {
        return 'p.post_author';
    }

}

==================================================
FILE PATH: ./all-in-one-event-calendar.php
==================================================
<?php
/**
 * Plugin Name: All-in-One Event Calendar by Time.ly
 * Plugin URI: https://wordpress.org/plugins/all-in-one-event-calendar/
 * Description: A calendar system with month, week, day, agenda views, upcoming events widget, color-coded categories, recurrence, and import/export of .ics feeds.
 * Author: Time.ly Network Inc.
 * Author URI: https://time.ly/
 * Version: 3.0.2
 * Text Domain: all-in-one-event-calendar
 * Domain Path: /language
 * Requires PHP: 7.2
 */

/* check database exists to identify old users*/
global $wpdb;
$ai1ec_base_dir = dirname( __FILE__ );

$ai1ec_base_url = plugins_url( '', __FILE__ );

$ai1ec_config_path = $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'app' .
	DIRECTORY_SEPARATOR . 'config' . DIRECTORY_SEPARATOR;

// Include configuration files and initiate global constants as they are used
// By the error/exception handler too.
foreach ( array( 'constants-local.php', 'constants.php' ) as $file ) {
	if ( is_file( $ai1ec_config_path . $file ) ) {
		require_once $ai1ec_config_path . $file;
	}
}

if ( ! function_exists( 'ai1ec_initiate_constants' ) ) {
	throw new Ai1ec_Exception(
		'No constant file was found.'
	);
}
ai1ec_initiate_constants( $ai1ec_base_dir, $ai1ec_base_url );

require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'exception' . DIRECTORY_SEPARATOR . 'ai1ec.php';
require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'exception' . DIRECTORY_SEPARATOR . 'error.php';
require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'exception' . DIRECTORY_SEPARATOR . 'handler.php';
require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'http' . DIRECTORY_SEPARATOR . 'response' .
	DIRECTORY_SEPARATOR . 'helper.php';
$ai1ec_exception_handler = new Ai1ec_Exception_Handler(
	'Ai1ec_Exception',
	'Ai1ec_Error_Exception'
);


// if the user clicked the link to reactivate the plugin
if ( isset( $_GET[Ai1ec_Exception_Handler::DB_REACTIVATE_PLUGIN] ) ) {
	$ai1ec_exception_handler->reactivate_plugin();
}
$soft_disable_message = $ai1ec_exception_handler->get_disabled_message();
if ( false !== $soft_disable_message ) {
	return $ai1ec_exception_handler->show_notices( $soft_disable_message );
}

$prev_er_handler = set_error_handler(
	array( $ai1ec_exception_handler, 'handle_error' )
);
$prev_ex_handler = set_exception_handler(
	array( $ai1ec_exception_handler, 'handle_exception' )
);
$ai1ec_exception_handler->set_prev_er_handler( $prev_er_handler );
$ai1ec_exception_handler->set_prev_ex_handler( $prev_ex_handler );

// Regular startup sequence starts here

require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'bootstrap' . DIRECTORY_SEPARATOR . 'loader.php';

require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'global-functions.php';

require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'lib' .
	DIRECTORY_SEPARATOR . 'iCal' . DIRECTORY_SEPARATOR . 'iCalcreator-2.26.9' . DIRECTORY_SEPARATOR . 'autoload.php';

require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'app' .
	DIRECTORY_SEPARATOR . 'controller' . DIRECTORY_SEPARATOR . 'extension.php';

require $ai1ec_base_dir . DIRECTORY_SEPARATOR . 'app' .
	DIRECTORY_SEPARATOR . 'controller' . DIRECTORY_SEPARATOR . 'extension-license.php';

$ai1ec_loader = new Ai1ec_Loader( $ai1ec_base_dir );
@ini_set( 'unserialize_callback_func', 'spl_autoload_call' );
spl_autoload_register( array( $ai1ec_loader, 'load' ) );

$ai1ec_front_controller = new Ai1ec_Front_Controller();
$ai1ec_front_controller->initialize( $ai1ec_loader );


==================================================
FILE PATH: ./uninstall.php
==================================================
<?php

// ====================================================================
// = Trigger Uninstall process only if WP_UNINSTALL_PLUGIN is defined =
// ====================================================================
if ( ! defined( 'WP_UNINSTALL_PLUGIN' ) ) {
    return;
}

global $wp_filesystem;

/**
 * remove_taxonomy function
 *
 * Remove a taxonomy
 *
 * @return void
 **/
function ai1ec_remove_taxonomy( $taxonomy ) {
    global $wp_taxonomies;
    // get all terms in $taxonomy
    $terms = get_terms( $taxonomy );

    // delete all terms in $taxonomy
    foreach ( $terms as $term ) {
        wp_delete_term( $term->term_id, $taxonomy );
    }

    // deregister $taxonomy
    unset( $wp_taxonomies[$taxonomy] );

    // do we need to flush the rewrite rules?
    $GLOBALS['wp_rewrite']->flush_rules();
}

/**
 * unregister our CRON
 */
function ai1ec_uninstall_crons() {
    foreach ( _get_cron_array() as $time => $cron ) {
        foreach ( $cron as $name => $args ) {
            if ( substr( $name, 0, 6 ) === 'ai1ec_' ) {
                wp_clear_scheduled_hook( $name );
            }
        }
    }
}

/**
 * Delete our options
 */
function ai1ec_uninstall_options() {
    global $wpdb;
    $options = $wpdb->get_col(
        'SELECT `option_name` FROM ' . $wpdb->options .
        ' WHERE `option_name` LIKE \'%ai1ec%\''
    );
    foreach ( $options as $option ) {
        delete_option( $option );
    }
}

/**
 * Delete restore tables created during upgrade
 *
 * @param string $table
 */
function ai1ec_delete_table_and_backup( $table ) {
    global $wpdb;
    $query = 'SHOW TABLES LIKE \'' . $table . '%\'';
    foreach ( $wpdb->get_col( $query ) as $table_name ) {
        // Delete table events
        $wpdb->query( 'DROP TABLE IF EXISTS ' . $table_name );
    }
}

/**
 * Deletes posts and drop tables
 */
function ai1ec_clean_up_tables() {
    global $wpdb;
    // Delete events
    $table_name = $wpdb->prefix . 'ai1ec_events';
    $query      = 'SELECT DISTINCT `ID` FROM `' . $wpdb->posts .
        '` WHERE `post_type` = \'ai1ec_event\'';
    foreach ( $wpdb->get_col( $query ) as $postid ) {
        wp_delete_post( (int) $postid, true );
    }

    // Delete table events
    ai1ec_delete_table_and_backup( $table_name );

    // Delete table event instances
    $table_name = $wpdb->prefix . 'ai1ec_event_instances';
    ai1ec_delete_table_and_backup( $table_name );

    // Delete table event feeds
    $table_name = $wpdb->prefix . 'ai1ec_event_feeds';
    ai1ec_delete_table_and_backup( $table_name );

    // Delete table category colors
    $table_name = $wpdb->prefix . 'ai1ec_event_category_meta';
    ai1ec_delete_table_and_backup( $table_name );

    // Delete legacy logging table
    $table_name = $wpdb->prefix . 'ai1ec_logging';
    ai1ec_delete_table_and_backup( $table_name );
}

/**
 * Deletes custom user roles and capabilities
 */
function ai1ec_remove_custom_user_roles_capabilities() {
    global $wp_roles; // global class wp-includes/capabilities.php

    // Remove AI1EC custom role
    remove_role( 'ai1ec_event_assistant' );

    // List of roles
    $roles = array(
        'administrator',
        'editor',
        'author',
        'subscriber'
    );

    // Complete list of AI1EC capabilities
    $caps = array(
        'delete_ai1ec_event',
        'delete_ai1ec_events',
        'delete_others_ai1ec_events',
        'delete_private_ai1ec_events',
        'delete_published_ai1ec_events',
        'edit_ai1ec_event',
        'edit_ai1ec_events',
        'edit_others_ai1ec_events',
        'edit_private_ai1ec_events',
        'edit_published_ai1ec_events',
        'manage_ai1ec_feeds',
        'manage_ai1ec_options',
        'publish_ai1ec_events',
        'read_ai1ec_event',
        'read_ai1ec_events',
        'read_private_ai1ec_events',
        'switch_ai1ec_themes'
    );

    foreach ( $roles as $role ) {
        foreach ( $caps as $cap ) {
            // Remove the capability.
            $wp_roles->remove_cap( $role, $cap );
        }
    }
}

/**
 * Deletes custom user meta
 */
function ai1ec_remove_custom_user_meta() {

    // List of custom user meta
    $metas = array(
            'closedpostboxes_ai1ec_event',
            'metaboxhidden_ai1ec_event'
    );

    $users = get_users('');

    foreach ($users as $user) {
        foreach ( $metas as $meta )
        delete_user_meta( $user->ID, $meta );
    }
}

function ai1ec_clean_up_site() {
    // Delete event categories taxonomy
    ai1ec_remove_taxonomy( 'events_categories' );
    // Delete event tags taxonomy
    ai1ec_remove_taxonomy( 'events_tags' );
    // Delete custom user roles and capabilities
    ai1ec_remove_custom_user_roles_capabilities();
    // Delete custom user meta
    ai1ec_remove_custom_user_meta();
    ai1ec_uninstall_crons();
    ai1ec_uninstall_options();
    ai1ec_clean_up_tables();
}

// Based on Codex article:
// http://codex.wordpress.org/Function_Reference/register_uninstall_hook
if ( is_multisite() ) { // For Multisite
    global $wpdb;
    $blog_ids         = $wpdb->get_col( 'SELECT blog_id FROM ' . $wpdb->blogs );
    $original_blog_id = get_current_blog_id();
    foreach ( $blog_ids as $blog_id ) {
        switch_to_blog( $blog_id );
        ai1ec_clean_up_site();
    }
    switch_to_blog( $original_blog_id );
}
ai1ec_clean_up_site();

// Delete themes folder
if ( is_object( $wp_filesystem ) && ! is_wp_error( $wp_filesystem->errors ) ) {
    // Get the base plugin folder
    $themes_dir = $wp_filesystem->wp_content_dir() . AI1EC_THEME_FOLDER;
    if ( ! empty( $themes_dir ) ) {
        $themes_dir = trailingslashit( $themes_dir );
        $wp_filesystem->delete( $themes_dir, true );
    }
}


==================================================
FILE PATH: ./public/js_cache/ai1ec_js_widget.js
==================================================


==================================================
FILE PATH: ./public/js_cache/calendar.js
==================================================


==================================================
FILE PATH: ./public/themes-ai1ec/vortex/index.php
==================================================
<?php ?>


==================================================
FILE PATH: ./public/themes-ai1ec/vortex/less/user_variables.php
==================================================
<?php
return array(
    "bodyBackground" => array(
        "value" => "#ffffff",
        "description" => __( "Body background", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "textColor" => array(
        "value"  => "#333333",
        "description" => __( "Text color", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "textEmboss" => array(
        "value"  => "#ffffff",
        "description" => __( "Text emboss", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "linkColor" => array(
        "value"  => "#3d6b99",
        "description" => __( "Link", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "linkColorHover" => array(
        "value"  => "#335980",
        "description" => __( "Link (hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "baseFontFamily" => array(
        "value"  => "\"Helvetica Neue\", Helvetica, Arial, sans-serif",
        "description" => __( "Base font", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "font",
    ),
    "baseFontSize" => array(
        "value"  => "13px",
        "description" => __( "Base font size", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "size",
    ),
    "tableBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Table background", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "tableLabelBackground" => array(
        "value"  => "#f5f5f5",
        "description" => __( "Table header background", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "tableLabelText" => array(
        "value"  => "#9e9e9e",
        "description" => __( "Table header text", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "btnPrimaryBackground" => array(
        "value"  => "#6dbb4f",
        "description" => __( "Primary brand color", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Button background", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnBorder" => array(
        "value"  => "#cccccc",
        "description" => __( "Button border", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnTextColor" => array(
        "value"  => "#333333",
        "description" => __( "Button text", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "inputText" => array(
        "value"  => "#555",
        "description" => __( "Input field text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Input field background", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBorder" => array(
        "value"  => "#cccccc",
        "description" => __( "Input field border", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBorderFocus" => array(
        "value"  => "rgba(82,168,236,0.8)",
        "description" => __( "Input field border (focus)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputDisabledBackground" => array(
        "value"  => "#eeeeee",
        "description" => __( "Input field background (disabled)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "labelColor" => array(
        "value"  => "#aaaaaa",
        "description" => __( "Field label", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Dropdown list background", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownBorder" => array(
        "value"  => "rgba(0,0,0,0.15)",
        "description" => __( "Dropdown list border", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkColor" => array(
        "value"  => "#333333",
        "description" => __( "List item text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkColorHover" => array(
        "value"  => "#262626",
        "description" => __( "List item text (active/hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkBackgroundHover" => array(
        "value"  => "#f5f5f5",
        "description" => __( "List item background (active/hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "placeholderText" => array(
        "value" => "#999999",
        "description" => __( "Input field placeholder text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "todayColor" => array(
        "value"  => "#ffffdd",
        "description" => __( "Today color", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "alldayBadgeGradientMiddle" => array(
        "value"  => "#3d6b99",
        "description" => __( "All-day badge color", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "eventImageShadow" => array(
        "value"  => "rgba(0,0,0,0.4)",
        "description" => __( "Event image shadow", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "eventDefaultColor" => array(
        "value"  => "#3d6b99",
        "description" => __( "Event default color", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventDefaultColorHover" => array(
        "value"  => "#335980",
        "description" => __( "Event default color (hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventStubAllDayText" => array(
        "value"  => "#ffffff",
        "description" => __( "All-day/multi-day event stub text", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventStubAllDayTextShadow" => array(
        "value"  => "rgba(0,0,0,0.4)",
        "description" => __( "All-day/multi-day event stub text shadow", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventBorder" => array(
        "value"  => "#cccccc",
        "description" => __( "Event border", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Event background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventTimeBackground" => array(
        "value"  => "#eeeeee",
        "description" => __( "Event time background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventText" => array(
        "value"  => "#333333",
        "description" => __( "Event text", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "monthViewDateBackground" => array(
        "value"  => "#eaf4ff",
        "description" => __( "Month view date background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "dayViewNowMarkerColor" => array(
        "value"  => "#f2c539",
        "description" => __( "Week/day view now marker", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "agendaDateTitleBorder" => array(
        "value"  => "#6689AC",
        "description" => __( "Date label accent color", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaDateTitleBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Date label background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaDateBackground" => array(
        "value"  => "#f2f2f2",
        "description" => __( "Date background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaTodayBackground" => array(
        "value"  => "#f4f4bf",
        "description" => __( "Today background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
);


==================================================
FILE PATH: ./public/themes-ai1ec/vortex/less.sha1.map.php
==================================================
<?php return array (
  'variables' => 
  array (
    'agendaDateBackground' => '#f2f2f2',
    'agendaDateTitleBackground' => '#ffffff',
    'agendaDateTitleBorder' => '#6689AC',
    'agendaTodayBackground' => '#f4f4bf',
    'alldayBadgeGradientMiddle' => '#3d6b99',
    'baseFontFamily' => '"Helvetica Neue", Helvetica, Arial, sans-serif',
    'baseFontSize' => '13px',
    'bodyBackground' => '#ffffff',
    'btnBackground' => '#ffffff',
    'btnBorder' => '#cccccc',
    'btnPrimaryBackground' => '#6dbb4f',
    'btnTextColor' => '#333333',
    'dayViewNowMarkerColor' => '#f2c539',
    'dropdownBackground' => '#ffffff',
    'dropdownBorder' => 'rgba(0,0,0,0.15)',
    'dropdownLinkBackgroundHover' => '#f5f5f5',
    'dropdownLinkColor' => '#333333',
    'dropdownLinkColorHover' => '#262626',
    'eventBackground' => '#ffffff',
    'eventBorder' => '#cccccc',
    'eventDefaultColor' => '#3d6b99',
    'eventDefaultColorHover' => '#335980',
    'eventImageShadow' => 'rgba(0,0,0,0.4)',
    'eventStubAllDayText' => '#ffffff',
    'eventStubAllDayTextShadow' => 'rgba(0,0,0,0.4)',
    'eventText' => '#333333',
    'eventTimeBackground' => '#eeeeee',
    'inputBackground' => '#ffffff',
    'inputBorder' => '#cccccc',
    'inputBorderFocus' => 'rgba(82,168,236,0.8)',
    'inputDisabledBackground' => '#eeeeee',
    'inputText' => '#555',
    'labelColor' => '#aaaaaa',
    'linkColor' => '#3d6b99',
    'linkColorHover' => '#335980',
    'monthViewDateBackground' => '#eaf4ff',
    'placeholderText' => '#999999',
    'tableBackground' => '#ffffff',
    'tableLabelBackground' => '#f5f5f5',
    'tableLabelText' => '#9e9e9e',
    'textColor' => '#333333',
    'textEmboss' => '#ffffff',
    'todayColor' => '#ffffdd',
  ),
  'files' => 
  array (
    'less\\ai1ec-icons.less' => 
    array (
      'size' => 3045,
      'sha1' => '576590aa4a54f3a8528825b50ab2b9c503edc0c8',
    ),
    'less\\bootstrap\\alerts.less' => 
    array (
      'size' => 1643,
      'sha1' => '3430045a53a78ef713234721153a866c04a321e3',
    ),
    'less\\bootstrap\\badges.less' => 
    array (
      'size' => 1071,
      'sha1' => '1144e3e8d85a9d1c84c09f321b3973705003d220',
    ),
    'less\\bootstrap\\bootstrap.less' => 
    array (
      'size' => 1071,
      'sha1' => '896fa407a97582682fd4b3c8eed9182d23dcb7f3',
    ),
    'less\\bootstrap\\breadcrumbs.less' => 
    array (
      'size' => 552,
      'sha1' => '13965487dedbbc5d70f9a2c8d67a53d63e5bb2ab',
    ),
    'less\\bootstrap\\button-groups.less' => 
    array (
      'size' => 5663,
      'sha1' => '5846fc9fbe5eee8c9c8bdf15c99829958fae83db',
    ),
    'less\\bootstrap\\buttons.less' => 
    array (
      'size' => 3859,
      'sha1' => 'da01aebf9d5a8cfb60834d267899a3b6e4e82cf4',
    ),
    'less\\bootstrap\\carousel.less' => 
    array (
      'size' => 4898,
      'sha1' => '5f32bf96382d44f19c7fcf29b073cd2b625b0651',
    ),
    'less\\bootstrap\\close.less' => 
    array (
      'size' => 701,
      'sha1' => '47bcc0eacd81ef6563f411d990649467ef925b86',
    ),
    'less\\bootstrap\\code.less' => 
    array (
      'size' => 1108,
      'sha1' => 'b7b3cd13cab40699be6c28dcd231d645d9a8ecf5',
    ),
    'less\\bootstrap\\component-animations.less' => 
    array (
      'size' => 563,
      'sha1' => 'dad3720bc6a37774f247c0b1c8799b907f9d6b0c',
    ),
    'less\\bootstrap\\dropdowns.less' => 
    array (
      'size' => 4019,
      'sha1' => '9cf16acd5acda0feb58cb9813ddaf9c2e00b8ec0',
    ),
    'less\\bootstrap\\forms.less' => 
    array (
      'size' => 9604,
      'sha1' => 'e360f70d737154d2676c61cc69e6d297675699f8',
    ),
    'less\\bootstrap\\glyphicons.less' => 
    array (
      'size' => 16124,
      'sha1' => '5841a73064ba73812d2eec2e5104ead29fde5d0a',
    ),
    'less\\bootstrap\\grid.less' => 
    array (
      'size' => 1943,
      'sha1' => '1a1b2fb5314e3e8cb9d6835c2ae12e872a443e19',
    ),
    'less\\bootstrap\\input-groups.less' => 
    array (
      'size' => 3617,
      'sha1' => 'b127b3fd5ef90327f6b5828e6210fe8cbf65e305',
    ),
    'less\\bootstrap\\jumbotron.less' => 
    array (
      'size' => 972,
      'sha1' => '32c4ddca4101db436c60a96491807fa9151dff1e',
    ),
    'less\\bootstrap\\labels.less' => 
    array (
      'size' => 1168,
      'sha1' => '1354ecf04cbb6914569da3e634ccc6fe16f631b6',
    ),
    'less\\bootstrap\\list-group.less' => 
    array (
      'size' => 2016,
      'sha1' => '2ac2500cb4a03f4497a9e8a3c5bf146452c2723a',
    ),
    'less\\bootstrap\\media.less' => 
    array (
      'size' => 932,
      'sha1' => 'f2785c4083cdf565be97b9f106c8bf2ca94a3a44',
    ),
    'less\\bootstrap\\mixins.less' => 
    array (
      'size' => 25423,
      'sha1' => 'cbf55fc13d833a63a7002488da11859703524dde',
    ),
    'less\\bootstrap\\modals.less' => 
    array (
      'size' => 3324,
      'sha1' => '447f634c5bc90a469b561958ff91b36633a25042',
    ),
    'less\\bootstrap\\navbar.less' => 
    array (
      'size' => 14492,
      'sha1' => '62a79adbefb2393f3b91d1efd88758deb97181e6',
    ),
    'less\\bootstrap\\navs.less' => 
    array (
      'size' => 5125,
      'sha1' => '495f825d566a3042c152e5effcabfd343f3bd39e',
    ),
    'less\\bootstrap\\normalize.less' => 
    array (
      'size' => 7287,
      'sha1' => '85488f7d622272f820b4a2a62560626e8eb86b1a',
    ),
    'less\\bootstrap\\pager.less' => 
    array (
      'size' => 895,
      'sha1' => '4fe06190b959ee0ae9395bdd35b4ba6895f32b89',
    ),
    'less\\bootstrap\\pagination.less' => 
    array (
      'size' => 1918,
      'sha1' => 'c9382f11ce75145763054cec2a48add2c0666837',
    ),
    'less\\bootstrap\\panels.less' => 
    array (
      'size' => 4364,
      'sha1' => 'e32797c3984024a948d3581b453e3d7eec3e178f',
    ),
    'less\\bootstrap\\popovers.less' => 
    array (
      'size' => 3432,
      'sha1' => 'a5b341bf1872e9cf58902d6463c686053c65d432',
    ),
    'less\\bootstrap\\print.less' => 
    array (
      'size' => 1734,
      'sha1' => '0dd3dfa0474ce05abde25b913f68f075308e6c30',
    ),
    'less\\bootstrap\\progress-bars.less' => 
    array (
      'size' => 1709,
      'sha1' => '79317167ca402b8c7e2f90ba98362bc810905ff5',
    ),
    'less\\bootstrap\\responsive-utilities.less' => 
    array (
      'size' => 5366,
      'sha1' => '1a8c194fa6fe703539edc98e66c7a3fbbfeb80d2',
    ),
    'less\\bootstrap\\scaffolding.less' => 
    array (
      'size' => 1939,
      'sha1' => 'd97f85740f83179d1b71614fcf1c7824871491d3',
    ),
    'less\\bootstrap\\tables.less' => 
    array (
      'size' => 4400,
      'sha1' => 'b7cf96d8a93381e1d582ecb2a8b80a3d2046ff9b',
    ),
    'less\\bootstrap\\theme.less' => 
    array (
      'size' => 7586,
      'sha1' => 'e80b731a27539d07c8aea78605def74d31d74370',
    ),
    'less\\bootstrap\\thumbnails.less' => 
    array (
      'size' => 772,
      'sha1' => 'a5d7e171ee920336308dfd4a393deab6c25726d0',
    ),
    'less\\bootstrap\\tooltip.less' => 
    array (
      'size' => 2738,
      'sha1' => 'f1f5a8e01f411779d77fd586aa07e8a0c70a916a',
    ),
    'less\\bootstrap\\type.less' => 
    array (
      'size' => 5413,
      'sha1' => 'ef4ae65f48fdd7015ca98eddf2690d32d26c28d5',
    ),
    'less\\bootstrap\\utilities.less' => 
    array (
      'size' => 876,
      'sha1' => '3e5001ccb88acf482db8f603f1c4de02dd03f281',
    ),
    'less\\bootstrap\\variables.less' => 
    array (
      'size' => 19762,
      'sha1' => 'af501270fb66d24d8ab98164c906a20fc4098426',
    ),
    'less\\bootstrap\\wells.less' => 
    array (
      'size' => 559,
      'sha1' => 'f3fa65f17459afda7141e7e79ed7faf5a0b09be4',
    ),
    'less\\calendar.less' => 
    array (
      'size' => 19251,
      'sha1' => '06e08ee4a9a70574f6f51bdbfeed2e53d2f779b0',
    ),
    'less\\common-widgets.less' => 
    array (
      'size' => 725,
      'sha1' => '0b39b1d4e35bffe2157468344e1b7f4d06533606',
    ),
    'less\\event.less' => 
    array (
      'size' => 3834,
      'sha1' => '4d8998b021b5480608424156cc554ff7393d60f0',
    ),
    'less\\font-awesome\\bordered-pulled.less' => 
    array (
      'size' => 330,
      'sha1' => '0469b430cd1567145ba800b22537588be2d1934d',
    ),
    'less\\font-awesome\\core.less' => 
    array (
      'size' => 270,
      'sha1' => '8286f2139fdd27c974385354c2ec24d4ec3b2537',
    ),
    'less\\font-awesome\\fixed-width.less' => 
    array (
      'size' => 119,
      'sha1' => 'ec0c24b97184dab86177660f486b8d08cd636c42',
    ),
    'less\\font-awesome\\font-awesome.less' => 
    array (
      'size' => 405,
      'sha1' => '7ffa0ce611a0c19dba8a981a4ce0bdbd945e3d7f',
    ),
    'less\\font-awesome\\icons.less' => 
    array (
      'size' => 26173,
      'sha1' => '085b25011d25f80636e84271fb0ae72376bc9ba2',
    ),
    'less\\font-awesome\\larger.less' => 
    array (
      'size' => 370,
      'sha1' => 'e7119e82dc50540dbc3472bba7d74282815a7ecc',
    ),
    'less\\font-awesome\\list.less' => 
    array (
      'size' => 375,
      'sha1' => 'b31f32ff393e3fa2f5c72d4a81c63871e61071ab',
    ),
    'less\\font-awesome\\mixins.less' => 
    array (
      'size' => 699,
      'sha1' => 'c46690a1efdea1d83c43063ec43d46f289d9b140',
    ),
    'less\\font-awesome\\path.less' => 
    array (
      'size' => 684,
      'sha1' => 'e152f9ef54b29bad851af8c6f8a77335a6e2c3f5',
    ),
    'less\\font-awesome\\rotated-flipped.less' => 
    array (
      'size' => 367,
      'sha1' => '6f63cbd44038b355cec327ce247008672f89cc3c',
    ),
    'less\\font-awesome\\spinning.less' => 
    array (
      'size' => 765,
      'sha1' => '57059d55b45c3ff7993acc57f3a579e056625fe0',
    ),
    'less\\font-awesome\\stacked.less' => 
    array (
      'size' => 476,
      'sha1' => 'f044077bc8be1a989c245254e81eb084d52d29a7',
    ),
    'less\\font-awesome\\variables.less' => 
    array (
      'size' => 10665,
      'sha1' => '8d7d0d81e445093ecc58577605c36320d2741ba7',
    ),
    'less\\plugins\\datepicker3.less' => 
    array (
      'size' => 5690,
      'sha1' => '8d6c3415942c6dcb4c27e955d512f7bb51c00bff',
    ),
    'less\\plugins\\fileupload.less' => 
    array (
      'size' => 2202,
      'sha1' => 'b1084d4dbddfb2de4883a3eb1b95b5cfc9fbbca0',
    ),
    'less\\plugins\\select2.less' => 
    array (
      'size' => 19259,
      'sha1' => '787c8ccb90526c4b7ebeaf189eb7d22d3e85b7a8',
    ),
    'less\\plugins\\timepicker.less' => 
    array (
      'size' => 3946,
      'sha1' => 'b20c2d939abce946e6456845df993a8043e9e1ae',
    ),
    'less\\style.less' => 
    array (
      'size' => 21007,
      'sha1' => 'a95f6f6d730ff3eed5013b6f0788835343a8a483',
    ),
    'less\\timely-font-awesome.less' => 
    array (
      'size' => 1395,
      'sha1' => 'dfbfe1d8ebb54b57bc6a60bbff55277d520fa2f3',
    ),
    'less\\timely-mixins.less' => 
    array (
      'size' => 8539,
      'sha1' => 'a1679e2bda8064f589a8228a0791ee1acff218c4',
    ),
    'less\\user-variable-map.less' => 
    array (
      'size' => 2341,
      'sha1' => 'f08577bc906d8cac06425035e1c0047d35f4563b',
    ),
    'less\\user_variables.php' => 
    array (
      'size' => 8612,
      'sha1' => 'eac102828cb0188f135039907e2b6ba503536baf',
    ),
    'less\\variables.less' => 
    array (
      'size' => 1248,
      'sha1' => '1d7fcb0178ffdf8a57e8e9c4f2fb2c0dc70e3c7f',
    ),
    'style.css' => 
    array (
      'size' => 241,
      'sha1' => '8abe0c48629ba19434e762b6e43efc382adb4eba',
    ),
  ),
);

==================================================
FILE PATH: ./public/themes-ai1ec/plana/index.php
==================================================
<?php ?>


==================================================
FILE PATH: ./public/themes-ai1ec/plana/less.sha1.map.php
==================================================
<?php return array (
  'variables' => 
  array (
    'agendaDateBackground' => '#f2f2f2',
    'agendaDateTitleBackground' => '#ffffff',
    'agendaDateTitleBorder' => '#6689AC',
    'agendaTodayBackground' => '#f4f4bf',
    'alldayBadgeGradientMiddle' => '#3d6b99',
    'baseFontFamily' => '"Helvetica Neue", Helvetica, Arial, sans-serif',
    'baseFontSize' => '13px',
    'bodyBackground' => '#ffffff',
    'btnBackground' => '#ffffff',
    'btnBorder' => '#cccccc',
    'btnPrimaryBackground' => '#6dbb4f',
    'btnTextColor' => '#333333',
    'dayViewNowMarkerColor' => '#f2c539',
    'dropdownBackground' => '#ffffff',
    'dropdownBorder' => 'rgba(0,0,0,0.15)',
    'dropdownLinkBackgroundHover' => '#f5f5f5',
    'dropdownLinkColor' => '#333333',
    'dropdownLinkColorHover' => '#262626',
    'eventBackground' => '#ffffff',
    'eventBorder' => '#cccccc',
    'eventDefaultColor' => '#3d6b99',
    'eventDefaultColorHover' => '#335980',
    'eventImageShadow' => 'rgba(0,0,0,0.4)',
    'eventStubAllDayText' => '#ffffff',
    'eventStubAllDayTextShadow' => 'rgba(0,0,0,0.4)',
    'eventText' => '#333333',
    'eventTimeBackground' => '#eeeeee',
    'inputBackground' => '#ffffff',
    'inputBorder' => '#cccccc',
    'inputBorderFocus' => 'rgba(82,168,236,0.8)',
    'inputDisabledBackground' => '#eeeeee',
    'inputText' => '#555',
    'labelColor' => '#aaaaaa',
    'linkColor' => '#3d6b99',
    'linkColorHover' => '#335980',
    'monthViewDateBackground' => '#eaf4ff',
    'placeholderText' => '#999999',
    'tableBackground' => '#ffffff',
    'tableLabelBackground' => '#f5f5f5',
    'tableLabelText' => '#9e9e9e',
    'textColor' => '#333333',
    'textEmboss' => '#ffffff',
    'todayColor' => '#ffffdd',
  ),
  'files' => 
  array (
    'less\\ai1ec-icons.less' => 
    array (
      'size' => 3045,
      'sha1' => '576590aa4a54f3a8528825b50ab2b9c503edc0c8',
    ),
    'less\\bootstrap\\alerts.less' => 
    array (
      'size' => 1643,
      'sha1' => '3430045a53a78ef713234721153a866c04a321e3',
    ),
    'less\\bootstrap\\badges.less' => 
    array (
      'size' => 1071,
      'sha1' => '1144e3e8d85a9d1c84c09f321b3973705003d220',
    ),
    'less\\bootstrap\\bootstrap.less' => 
    array (
      'size' => 1071,
      'sha1' => '896fa407a97582682fd4b3c8eed9182d23dcb7f3',
    ),
    'less\\bootstrap\\breadcrumbs.less' => 
    array (
      'size' => 552,
      'sha1' => '13965487dedbbc5d70f9a2c8d67a53d63e5bb2ab',
    ),
    'less\\bootstrap\\button-groups.less' => 
    array (
      'size' => 5663,
      'sha1' => '5846fc9fbe5eee8c9c8bdf15c99829958fae83db',
    ),
    'less\\bootstrap\\buttons.less' => 
    array (
      'size' => 3859,
      'sha1' => 'da01aebf9d5a8cfb60834d267899a3b6e4e82cf4',
    ),
    'less\\bootstrap\\carousel.less' => 
    array (
      'size' => 4898,
      'sha1' => '5f32bf96382d44f19c7fcf29b073cd2b625b0651',
    ),
    'less\\bootstrap\\close.less' => 
    array (
      'size' => 701,
      'sha1' => '47bcc0eacd81ef6563f411d990649467ef925b86',
    ),
    'less\\bootstrap\\code.less' => 
    array (
      'size' => 1108,
      'sha1' => 'b7b3cd13cab40699be6c28dcd231d645d9a8ecf5',
    ),
    'less\\bootstrap\\component-animations.less' => 
    array (
      'size' => 563,
      'sha1' => 'dad3720bc6a37774f247c0b1c8799b907f9d6b0c',
    ),
    'less\\bootstrap\\dropdowns.less' => 
    array (
      'size' => 4019,
      'sha1' => '9cf16acd5acda0feb58cb9813ddaf9c2e00b8ec0',
    ),
    'less\\bootstrap\\forms.less' => 
    array (
      'size' => 9604,
      'sha1' => 'e360f70d737154d2676c61cc69e6d297675699f8',
    ),
    'less\\bootstrap\\glyphicons.less' => 
    array (
      'size' => 16124,
      'sha1' => '5841a73064ba73812d2eec2e5104ead29fde5d0a',
    ),
    'less\\bootstrap\\grid.less' => 
    array (
      'size' => 1943,
      'sha1' => '1a1b2fb5314e3e8cb9d6835c2ae12e872a443e19',
    ),
    'less\\bootstrap\\input-groups.less' => 
    array (
      'size' => 3617,
      'sha1' => 'b127b3fd5ef90327f6b5828e6210fe8cbf65e305',
    ),
    'less\\bootstrap\\jumbotron.less' => 
    array (
      'size' => 972,
      'sha1' => '32c4ddca4101db436c60a96491807fa9151dff1e',
    ),
    'less\\bootstrap\\labels.less' => 
    array (
      'size' => 1168,
      'sha1' => '1354ecf04cbb6914569da3e634ccc6fe16f631b6',
    ),
    'less\\bootstrap\\list-group.less' => 
    array (
      'size' => 2016,
      'sha1' => '2ac2500cb4a03f4497a9e8a3c5bf146452c2723a',
    ),
    'less\\bootstrap\\media.less' => 
    array (
      'size' => 932,
      'sha1' => 'f2785c4083cdf565be97b9f106c8bf2ca94a3a44',
    ),
    'less\\bootstrap\\mixins.less' => 
    array (
      'size' => 25423,
      'sha1' => 'cbf55fc13d833a63a7002488da11859703524dde',
    ),
    'less\\bootstrap\\modals.less' => 
    array (
      'size' => 3324,
      'sha1' => '447f634c5bc90a469b561958ff91b36633a25042',
    ),
    'less\\bootstrap\\navbar.less' => 
    array (
      'size' => 14492,
      'sha1' => '62a79adbefb2393f3b91d1efd88758deb97181e6',
    ),
    'less\\bootstrap\\navs.less' => 
    array (
      'size' => 5125,
      'sha1' => '495f825d566a3042c152e5effcabfd343f3bd39e',
    ),
    'less\\bootstrap\\normalize.less' => 
    array (
      'size' => 7287,
      'sha1' => '85488f7d622272f820b4a2a62560626e8eb86b1a',
    ),
    'less\\bootstrap\\pager.less' => 
    array (
      'size' => 895,
      'sha1' => '4fe06190b959ee0ae9395bdd35b4ba6895f32b89',
    ),
    'less\\bootstrap\\pagination.less' => 
    array (
      'size' => 1918,
      'sha1' => 'c9382f11ce75145763054cec2a48add2c0666837',
    ),
    'less\\bootstrap\\panels.less' => 
    array (
      'size' => 4364,
      'sha1' => 'e32797c3984024a948d3581b453e3d7eec3e178f',
    ),
    'less\\bootstrap\\popovers.less' => 
    array (
      'size' => 3432,
      'sha1' => 'a5b341bf1872e9cf58902d6463c686053c65d432',
    ),
    'less\\bootstrap\\print.less' => 
    array (
      'size' => 1734,
      'sha1' => '0dd3dfa0474ce05abde25b913f68f075308e6c30',
    ),
    'less\\bootstrap\\progress-bars.less' => 
    array (
      'size' => 1709,
      'sha1' => '79317167ca402b8c7e2f90ba98362bc810905ff5',
    ),
    'less\\bootstrap\\responsive-utilities.less' => 
    array (
      'size' => 5366,
      'sha1' => '1a8c194fa6fe703539edc98e66c7a3fbbfeb80d2',
    ),
    'less\\bootstrap\\scaffolding.less' => 
    array (
      'size' => 1939,
      'sha1' => 'd97f85740f83179d1b71614fcf1c7824871491d3',
    ),
    'less\\bootstrap\\tables.less' => 
    array (
      'size' => 4400,
      'sha1' => 'b7cf96d8a93381e1d582ecb2a8b80a3d2046ff9b',
    ),
    'less\\bootstrap\\theme.less' => 
    array (
      'size' => 7586,
      'sha1' => 'e80b731a27539d07c8aea78605def74d31d74370',
    ),
    'less\\bootstrap\\thumbnails.less' => 
    array (
      'size' => 772,
      'sha1' => 'a5d7e171ee920336308dfd4a393deab6c25726d0',
    ),
    'less\\bootstrap\\tooltip.less' => 
    array (
      'size' => 2738,
      'sha1' => 'f1f5a8e01f411779d77fd586aa07e8a0c70a916a',
    ),
    'less\\bootstrap\\type.less' => 
    array (
      'size' => 5413,
      'sha1' => 'ef4ae65f48fdd7015ca98eddf2690d32d26c28d5',
    ),
    'less\\bootstrap\\utilities.less' => 
    array (
      'size' => 876,
      'sha1' => '3e5001ccb88acf482db8f603f1c4de02dd03f281',
    ),
    'less\\bootstrap\\variables.less' => 
    array (
      'size' => 19762,
      'sha1' => 'af501270fb66d24d8ab98164c906a20fc4098426',
    ),
    'less\\bootstrap\\wells.less' => 
    array (
      'size' => 559,
      'sha1' => 'f3fa65f17459afda7141e7e79ed7faf5a0b09be4',
    ),
    'less\\calendar.less' => 
    array (
      'size' => 19251,
      'sha1' => '06e08ee4a9a70574f6f51bdbfeed2e53d2f779b0',
    ),
    'less\\common-widgets.less' => 
    array (
      'size' => 725,
      'sha1' => '0b39b1d4e35bffe2157468344e1b7f4d06533606',
    ),
    'less\\event.less' => 
    array (
      'size' => 3834,
      'sha1' => '4d8998b021b5480608424156cc554ff7393d60f0',
    ),
    'less\\font-awesome\\bordered-pulled.less' => 
    array (
      'size' => 330,
      'sha1' => '0469b430cd1567145ba800b22537588be2d1934d',
    ),
    'less\\font-awesome\\core.less' => 
    array (
      'size' => 270,
      'sha1' => '8286f2139fdd27c974385354c2ec24d4ec3b2537',
    ),
    'less\\font-awesome\\fixed-width.less' => 
    array (
      'size' => 119,
      'sha1' => 'ec0c24b97184dab86177660f486b8d08cd636c42',
    ),
    'less\\font-awesome\\font-awesome.less' => 
    array (
      'size' => 405,
      'sha1' => '7ffa0ce611a0c19dba8a981a4ce0bdbd945e3d7f',
    ),
    'less\\font-awesome\\icons.less' => 
    array (
      'size' => 26173,
      'sha1' => '085b25011d25f80636e84271fb0ae72376bc9ba2',
    ),
    'less\\font-awesome\\larger.less' => 
    array (
      'size' => 370,
      'sha1' => 'e7119e82dc50540dbc3472bba7d74282815a7ecc',
    ),
    'less\\font-awesome\\list.less' => 
    array (
      'size' => 375,
      'sha1' => 'b31f32ff393e3fa2f5c72d4a81c63871e61071ab',
    ),
    'less\\font-awesome\\mixins.less' => 
    array (
      'size' => 699,
      'sha1' => 'c46690a1efdea1d83c43063ec43d46f289d9b140',
    ),
    'less\\font-awesome\\path.less' => 
    array (
      'size' => 684,
      'sha1' => 'e152f9ef54b29bad851af8c6f8a77335a6e2c3f5',
    ),
    'less\\font-awesome\\rotated-flipped.less' => 
    array (
      'size' => 367,
      'sha1' => '6f63cbd44038b355cec327ce247008672f89cc3c',
    ),
    'less\\font-awesome\\spinning.less' => 
    array (
      'size' => 765,
      'sha1' => '57059d55b45c3ff7993acc57f3a579e056625fe0',
    ),
    'less\\font-awesome\\stacked.less' => 
    array (
      'size' => 476,
      'sha1' => 'f044077bc8be1a989c245254e81eb084d52d29a7',
    ),
    'less\\font-awesome\\variables.less' => 
    array (
      'size' => 10665,
      'sha1' => '8d7d0d81e445093ecc58577605c36320d2741ba7',
    ),
    'less\\override.less' => 
    array (
      'size' => 2253,
      'sha1' => 'ddb7ed1009cc727e25ce76179f201f79eed3a205',
    ),
    'less\\plugins\\datepicker3.less' => 
    array (
      'size' => 5690,
      'sha1' => '8d6c3415942c6dcb4c27e955d512f7bb51c00bff',
    ),
    'less\\plugins\\fileupload.less' => 
    array (
      'size' => 2202,
      'sha1' => 'b1084d4dbddfb2de4883a3eb1b95b5cfc9fbbca0',
    ),
    'less\\plugins\\select2.less' => 
    array (
      'size' => 19259,
      'sha1' => '787c8ccb90526c4b7ebeaf189eb7d22d3e85b7a8',
    ),
    'less\\plugins\\timepicker.less' => 
    array (
      'size' => 3946,
      'sha1' => 'b20c2d939abce946e6456845df993a8043e9e1ae',
    ),
    'less\\style.less' => 
    array (
      'size' => 21007,
      'sha1' => 'a95f6f6d730ff3eed5013b6f0788835343a8a483',
    ),
    'less\\timely-font-awesome.less' => 
    array (
      'size' => 1395,
      'sha1' => 'dfbfe1d8ebb54b57bc6a60bbff55277d520fa2f3',
    ),
    'less\\timely-mixins.less' => 
    array (
      'size' => 8539,
      'sha1' => 'a1679e2bda8064f589a8228a0791ee1acff218c4',
    ),
    'less\\user-variable-map.less' => 
    array (
      'size' => 2341,
      'sha1' => 'f08577bc906d8cac06425035e1c0047d35f4563b',
    ),
    'less\\user_variables.php' => 
    array (
      'size' => 8612,
      'sha1' => 'eac102828cb0188f135039907e2b6ba503536baf',
    ),
    'less\\variables.less' => 
    array (
      'size' => 1248,
      'sha1' => '1d7fcb0178ffdf8a57e8e9c4f2fb2c0dc70e3c7f',
    ),
    'style.css' => 
    array (
      'size' => 241,
      'sha1' => '65ca338bf30e0bed1c6f7d13bb1111d5fd80a347',
    ),
  ),
);

==================================================
FILE PATH: ./public/themes-ai1ec/journey/index.php
==================================================
<?php ?>


==================================================
FILE PATH: ./public/themes-ai1ec/journey/less/user_variables.php
==================================================
<?php
return array(
    "bodyBackground" => array(
        "value" => "#ffffff",
        "description" => __( "Body background", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "textColor" => array(
        "value"  => "#333333",
        "description" => __( "Text color", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "textEmboss" => array(
        "value"  => "#ffffff",
        "description" => __( "Text emboss", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "linkColor" => array(
        "value"  => "#3d6b99",
        "description" => __( "Link", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "linkColorHover" => array(
        "value"  => "#335980",
        "description" => __( "Link (hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "baseFontFamily" => array(
        "value"  => "\"Helvetica Neue\", Helvetica, Arial, sans-serif",
        "description" => __( "Base font", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "font",
    ),
    "baseFontSize" => array(
        "value"  => "13px",
        "description" => __( "Base font size", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "size",
    ),
    "tableBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Table background", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "tableLabelBackground" => array(
        "value"  => "#f5f5f5",
        "description" => __( "Table header background", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "tableLabelText" => array(
        "value"  => "#9e9e9e",
        "description" => __( "Table header text", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "btnPrimaryBackground" => array(
        "value"  => "#6dbb4f",
        "description" => __( "Primary brand color", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Button background", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnBorder" => array(
        "value"  => "#cccccc",
        "description" => __( "Button border", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnTextColor" => array(
        "value"  => "#333333",
        "description" => __( "Button text", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "inputText" => array(
        "value"  => "#555",
        "description" => __( "Input field text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Input field background", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBorder" => array(
        "value"  => "#cccccc",
        "description" => __( "Input field border", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBorderFocus" => array(
        "value"  => "rgba(82,168,236,0.8)",
        "description" => __( "Input field border (focus)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputDisabledBackground" => array(
        "value"  => "#eeeeee",
        "description" => __( "Input field background (disabled)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "labelColor" => array(
        "value"  => "#aaaaaa",
        "description" => __( "Field label", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Dropdown list background", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownBorder" => array(
        "value"  => "rgba(0,0,0,0.15)",
        "description" => __( "Dropdown list border", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkColor" => array(
        "value"  => "#333333",
        "description" => __( "List item text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkColorHover" => array(
        "value"  => "#262626",
        "description" => __( "List item text (active/hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkBackgroundHover" => array(
        "value"  => "#f5f5f5",
        "description" => __( "List item background (active/hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "placeholderText" => array(
        "value" => "#999999",
        "description" => __( "Input field placeholder text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "todayColor" => array(
        "value"  => "#ffffdd",
        "description" => __( "Today color", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "alldayBadgeGradientMiddle" => array(
        "value"  => "#3d6b99",
        "description" => __( "All-day badge color", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "eventImageShadow" => array(
        "value"  => "rgba(0,0,0,0.4)",
        "description" => __( "Event image shadow", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "eventDefaultColor" => array(
        "value"  => "#3d6b99",
        "description" => __( "Event default color", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventDefaultColorHover" => array(
        "value"  => "#335980",
        "description" => __( "Event default color (hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventStubAllDayText" => array(
        "value"  => "#ffffff",
        "description" => __( "All-day/multi-day event stub text", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventStubAllDayTextShadow" => array(
        "value"  => "rgba(0,0,0,0.4)",
        "description" => __( "All-day/multi-day event stub text shadow", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventBorder" => array(
        "value"  => "#cccccc",
        "description" => __( "Event border", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Event background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventTimeBackground" => array(
        "value"  => "#eeeeee",
        "description" => __( "Event time background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventText" => array(
        "value"  => "#333333",
        "description" => __( "Event text", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "monthViewDateBackground" => array(
        "value"  => "#eaf4ff",
        "description" => __( "Month view date background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "dayViewNowMarkerColor" => array(
        "value"  => "#f2c539",
        "description" => __( "Week/day view now marker", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "agendaDateTitleBorder" => array(
        "value"  => "#6689AC",
        "description" => __( "Date label accent color", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaDateTitleBackground" => array(
        "value"  => "#ffffff",
        "description" => __( "Date label background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaDateBackground" => array(
        "value"  => "#f2f2f2",
        "description" => __( "Date background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaTodayBackground" => array(
        "value"  => "#f4f4bf",
        "description" => __( "Today background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
);


==================================================
FILE PATH: ./public/themes-ai1ec/journey/less.sha1.map.php
==================================================
<?php return array (
  'variables' => 
  array (
    'agendaDateBackground' => '#f2f2f2',
    'agendaDateTitleBackground' => '#ffffff',
    'agendaDateTitleBorder' => '#6689AC',
    'agendaTodayBackground' => '#f4f4bf',
    'alldayBadgeGradientMiddle' => '#3d6b99',
    'baseFontFamily' => '"Helvetica Neue", Helvetica, Arial, sans-serif',
    'baseFontSize' => '13px',
    'bodyBackground' => '#ffffff',
    'btnBackground' => '#ffffff',
    'btnBorder' => '#cccccc',
    'btnPrimaryBackground' => '#6dbb4f',
    'btnTextColor' => '#333333',
    'dayViewNowMarkerColor' => '#f2c539',
    'dropdownBackground' => '#ffffff',
    'dropdownBorder' => 'rgba(0,0,0,0.15)',
    'dropdownLinkBackgroundHover' => '#f5f5f5',
    'dropdownLinkColor' => '#333333',
    'dropdownLinkColorHover' => '#262626',
    'eventBackground' => '#ffffff',
    'eventBorder' => '#cccccc',
    'eventDefaultColor' => '#3d6b99',
    'eventDefaultColorHover' => '#335980',
    'eventImageShadow' => 'rgba(0,0,0,0.4)',
    'eventStubAllDayText' => '#ffffff',
    'eventStubAllDayTextShadow' => 'rgba(0,0,0,0.4)',
    'eventText' => '#333333',
    'eventTimeBackground' => '#eeeeee',
    'inputBackground' => '#ffffff',
    'inputBorder' => '#cccccc',
    'inputBorderFocus' => 'rgba(82,168,236,0.8)',
    'inputDisabledBackground' => '#eeeeee',
    'inputText' => '#555',
    'labelColor' => '#aaaaaa',
    'linkColor' => '#3d6b99',
    'linkColorHover' => '#335980',
    'monthViewDateBackground' => '#eaf4ff',
    'placeholderText' => '#999999',
    'tableBackground' => '#ffffff',
    'tableLabelBackground' => '#f5f5f5',
    'tableLabelText' => '#9e9e9e',
    'textColor' => '#333333',
    'textEmboss' => '#ffffff',
    'todayColor' => '#ffffdd',
  ),
  'files' => 
  array (
    'less\\ai1ec-icons.less' => 
    array (
      'size' => 3046,
      'sha1' => 'cd8cac785e5ad710be6c34d1de8a4a38e0569999',
    ),
    'less\\bootstrap\\alerts.less' => 
    array (
      'size' => 1643,
      'sha1' => '3430045a53a78ef713234721153a866c04a321e3',
    ),
    'less\\bootstrap\\badges.less' => 
    array (
      'size' => 1071,
      'sha1' => '1144e3e8d85a9d1c84c09f321b3973705003d220',
    ),
    'less\\bootstrap\\bootstrap.less' => 
    array (
      'size' => 1071,
      'sha1' => '896fa407a97582682fd4b3c8eed9182d23dcb7f3',
    ),
    'less\\bootstrap\\breadcrumbs.less' => 
    array (
      'size' => 552,
      'sha1' => '13965487dedbbc5d70f9a2c8d67a53d63e5bb2ab',
    ),
    'less\\bootstrap\\button-groups.less' => 
    array (
      'size' => 5663,
      'sha1' => '5846fc9fbe5eee8c9c8bdf15c99829958fae83db',
    ),
    'less\\bootstrap\\buttons.less' => 
    array (
      'size' => 3859,
      'sha1' => 'da01aebf9d5a8cfb60834d267899a3b6e4e82cf4',
    ),
    'less\\bootstrap\\carousel.less' => 
    array (
      'size' => 4898,
      'sha1' => '5f32bf96382d44f19c7fcf29b073cd2b625b0651',
    ),
    'less\\bootstrap\\close.less' => 
    array (
      'size' => 701,
      'sha1' => '47bcc0eacd81ef6563f411d990649467ef925b86',
    ),
    'less\\bootstrap\\code.less' => 
    array (
      'size' => 1108,
      'sha1' => 'b7b3cd13cab40699be6c28dcd231d645d9a8ecf5',
    ),
    'less\\bootstrap\\component-animations.less' => 
    array (
      'size' => 563,
      'sha1' => 'dad3720bc6a37774f247c0b1c8799b907f9d6b0c',
    ),
    'less\\bootstrap\\dropdowns.less' => 
    array (
      'size' => 4019,
      'sha1' => '9cf16acd5acda0feb58cb9813ddaf9c2e00b8ec0',
    ),
    'less\\bootstrap\\forms.less' => 
    array (
      'size' => 9604,
      'sha1' => 'e360f70d737154d2676c61cc69e6d297675699f8',
    ),
    'less\\bootstrap\\glyphicons.less' => 
    array (
      'size' => 16124,
      'sha1' => '5841a73064ba73812d2eec2e5104ead29fde5d0a',
    ),
    'less\\bootstrap\\grid.less' => 
    array (
      'size' => 1943,
      'sha1' => '1a1b2fb5314e3e8cb9d6835c2ae12e872a443e19',
    ),
    'less\\bootstrap\\input-groups.less' => 
    array (
      'size' => 3617,
      'sha1' => 'b127b3fd5ef90327f6b5828e6210fe8cbf65e305',
    ),
    'less\\bootstrap\\jumbotron.less' => 
    array (
      'size' => 972,
      'sha1' => '32c4ddca4101db436c60a96491807fa9151dff1e',
    ),
    'less\\bootstrap\\labels.less' => 
    array (
      'size' => 1168,
      'sha1' => '1354ecf04cbb6914569da3e634ccc6fe16f631b6',
    ),
    'less\\bootstrap\\list-group.less' => 
    array (
      'size' => 2016,
      'sha1' => '2ac2500cb4a03f4497a9e8a3c5bf146452c2723a',
    ),
    'less\\bootstrap\\media.less' => 
    array (
      'size' => 932,
      'sha1' => 'f2785c4083cdf565be97b9f106c8bf2ca94a3a44',
    ),
    'less\\bootstrap\\mixins.less' => 
    array (
      'size' => 25423,
      'sha1' => 'cbf55fc13d833a63a7002488da11859703524dde',
    ),
    'less\\bootstrap\\modals.less' => 
    array (
      'size' => 3324,
      'sha1' => '447f634c5bc90a469b561958ff91b36633a25042',
    ),
    'less\\bootstrap\\navbar.less' => 
    array (
      'size' => 14492,
      'sha1' => '62a79adbefb2393f3b91d1efd88758deb97181e6',
    ),
    'less\\bootstrap\\navs.less' => 
    array (
      'size' => 4936,
      'sha1' => 'cfe33635b12538d5d53de960b9e48c3883bd924a',
    ),
    'less\\bootstrap\\normalize.less' => 
    array (
      'size' => 7287,
      'sha1' => '85488f7d622272f820b4a2a62560626e8eb86b1a',
    ),
    'less\\bootstrap\\pager.less' => 
    array (
      'size' => 895,
      'sha1' => '4fe06190b959ee0ae9395bdd35b4ba6895f32b89',
    ),
    'less\\bootstrap\\pagination.less' => 
    array (
      'size' => 1918,
      'sha1' => 'c9382f11ce75145763054cec2a48add2c0666837',
    ),
    'less\\bootstrap\\panels.less' => 
    array (
      'size' => 4364,
      'sha1' => 'e32797c3984024a948d3581b453e3d7eec3e178f',
    ),
    'less\\bootstrap\\popovers.less' => 
    array (
      'size' => 3432,
      'sha1' => 'a5b341bf1872e9cf58902d6463c686053c65d432',
    ),
    'less\\bootstrap\\print.less' => 
    array (
      'size' => 1734,
      'sha1' => '0dd3dfa0474ce05abde25b913f68f075308e6c30',
    ),
    'less\\bootstrap\\progress-bars.less' => 
    array (
      'size' => 1709,
      'sha1' => '79317167ca402b8c7e2f90ba98362bc810905ff5',
    ),
    'less\\bootstrap\\responsive-utilities.less' => 
    array (
      'size' => 5366,
      'sha1' => '1a8c194fa6fe703539edc98e66c7a3fbbfeb80d2',
    ),
    'less\\bootstrap\\scaffolding.less' => 
    array (
      'size' => 1939,
      'sha1' => 'd97f85740f83179d1b71614fcf1c7824871491d3',
    ),
    'less\\bootstrap\\tables.less' => 
    array (
      'size' => 4400,
      'sha1' => 'b7cf96d8a93381e1d582ecb2a8b80a3d2046ff9b',
    ),
    'less\\bootstrap\\theme.less' => 
    array (
      'size' => 7586,
      'sha1' => 'e80b731a27539d07c8aea78605def74d31d74370',
    ),
    'less\\bootstrap\\thumbnails.less' => 
    array (
      'size' => 772,
      'sha1' => 'a5d7e171ee920336308dfd4a393deab6c25726d0',
    ),
    'less\\bootstrap\\tooltip.less' => 
    array (
      'size' => 2738,
      'sha1' => 'f1f5a8e01f411779d77fd586aa07e8a0c70a916a',
    ),
    'less\\bootstrap\\type.less' => 
    array (
      'size' => 5413,
      'sha1' => 'ef4ae65f48fdd7015ca98eddf2690d32d26c28d5',
    ),
    'less\\bootstrap\\utilities.less' => 
    array (
      'size' => 876,
      'sha1' => '3e5001ccb88acf482db8f603f1c4de02dd03f281',
    ),
    'less\\bootstrap\\variables.less' => 
    array (
      'size' => 19762,
      'sha1' => 'af501270fb66d24d8ab98164c906a20fc4098426',
    ),
    'less\\bootstrap\\wells.less' => 
    array (
      'size' => 559,
      'sha1' => 'f3fa65f17459afda7141e7e79ed7faf5a0b09be4',
    ),
    'less\\calendar.less' => 
    array (
      'size' => 20070,
      'sha1' => '7aca4618d6f66980c013e6d3a9e12781d3f2083b',
    ),
    'less\\common-widgets.less' => 
    array (
      'size' => 725,
      'sha1' => '0b39b1d4e35bffe2157468344e1b7f4d06533606',
    ),
    'less\\event.less' => 
    array (
      'size' => 2549,
      'sha1' => 'bc9ce3dbb8e03512c4746315a189d2842879e888',
    ),
    'less\\font-awesome\\bordered-pulled.less' => 
    array (
      'size' => 330,
      'sha1' => '0469b430cd1567145ba800b22537588be2d1934d',
    ),
    'less\\font-awesome\\core.less' => 
    array (
      'size' => 270,
      'sha1' => '8286f2139fdd27c974385354c2ec24d4ec3b2537',
    ),
    'less\\font-awesome\\fixed-width.less' => 
    array (
      'size' => 119,
      'sha1' => 'ec0c24b97184dab86177660f486b8d08cd636c42',
    ),
    'less\\font-awesome\\font-awesome.less' => 
    array (
      'size' => 405,
      'sha1' => '7ffa0ce611a0c19dba8a981a4ce0bdbd945e3d7f',
    ),
    'less\\font-awesome\\icons.less' => 
    array (
      'size' => 26173,
      'sha1' => '085b25011d25f80636e84271fb0ae72376bc9ba2',
    ),
    'less\\font-awesome\\larger.less' => 
    array (
      'size' => 370,
      'sha1' => 'e7119e82dc50540dbc3472bba7d74282815a7ecc',
    ),
    'less\\font-awesome\\list.less' => 
    array (
      'size' => 375,
      'sha1' => 'b31f32ff393e3fa2f5c72d4a81c63871e61071ab',
    ),
    'less\\font-awesome\\mixins.less' => 
    array (
      'size' => 699,
      'sha1' => 'c46690a1efdea1d83c43063ec43d46f289d9b140',
    ),
    'less\\font-awesome\\path.less' => 
    array (
      'size' => 684,
      'sha1' => 'e152f9ef54b29bad851af8c6f8a77335a6e2c3f5',
    ),
    'less\\font-awesome\\rotated-flipped.less' => 
    array (
      'size' => 367,
      'sha1' => '6f63cbd44038b355cec327ce247008672f89cc3c',
    ),
    'less\\font-awesome\\spinning.less' => 
    array (
      'size' => 765,
      'sha1' => '57059d55b45c3ff7993acc57f3a579e056625fe0',
    ),
    'less\\font-awesome\\stacked.less' => 
    array (
      'size' => 476,
      'sha1' => 'f044077bc8be1a989c245254e81eb084d52d29a7',
    ),
    'less\\font-awesome\\variables.less' => 
    array (
      'size' => 10665,
      'sha1' => '8d7d0d81e445093ecc58577605c36320d2741ba7',
    ),
    'less\\plugins\\datepicker3.less' => 
    array (
      'size' => 5690,
      'sha1' => '8d6c3415942c6dcb4c27e955d512f7bb51c00bff',
    ),
    'less\\plugins\\fileupload.less' => 
    array (
      'size' => 2202,
      'sha1' => 'b1084d4dbddfb2de4883a3eb1b95b5cfc9fbbca0',
    ),
    'less\\plugins\\select2.less' => 
    array (
      'size' => 19259,
      'sha1' => '787c8ccb90526c4b7ebeaf189eb7d22d3e85b7a8',
    ),
    'less\\plugins\\timepicker.less' => 
    array (
      'size' => 3946,
      'sha1' => 'b20c2d939abce946e6456845df993a8043e9e1ae',
    ),
    'less\\style.less' => 
    array (
      'size' => 21050,
      'sha1' => '548c3c3bd6ee3fcadd72d59b8f41cc8b7372ff5d',
    ),
    'less\\timely-font-awesome.less' => 
    array (
      'size' => 1395,
      'sha1' => 'dfbfe1d8ebb54b57bc6a60bbff55277d520fa2f3',
    ),
    'less\\timely-mixins.less' => 
    array (
      'size' => 8539,
      'sha1' => 'a1679e2bda8064f589a8228a0791ee1acff218c4',
    ),
    'less\\user-variable-map.less' => 
    array (
      'size' => 2341,
      'sha1' => 'f08577bc906d8cac06425035e1c0047d35f4563b',
    ),
    'less\\user_variables.php' => 
    array (
      'size' => 8612,
      'sha1' => 'eac102828cb0188f135039907e2b6ba503536baf',
    ),
    'less\\variables.less' => 
    array (
      'size' => 1248,
      'sha1' => '1d7fcb0178ffdf8a57e8e9c4f2fb2c0dc70e3c7f',
    ),
    'style.css' => 
    array (
      'size' => 230,
      'sha1' => 'ee68c1ec9d1b5050189259de431e6634e702bd1d',
    ),
  ),
);

==================================================
FILE PATH: ./public/themes-ai1ec/umbra/index.php
==================================================
<?php ?>


==================================================
FILE PATH: ./public/themes-ai1ec/umbra/less/user_variables.php
==================================================
<?php
return array(
    "bodyBackground" => array(
        "value" => "#000000",
        "description" => __( "Body background", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "textColor" => array(
        "value"  => "#b0b0b0",
        "description" => __( "Text color", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "textEmboss" => array(
        "value"  => "rgba(0,0,0,0)",
        "description" => __( "Text emboss", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "linkColor" => array(
        "value"  => "#5e8cba",
        "description" => __( "Link", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "linkColorHover" => array(
        "value"  => "#94b2d1",
        "description" => __( "Link (hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "color",
    ),
    "baseFontFamily" => array(
        "value"  => "\"Helvetica Neue\", Helvetica, Arial, sans-serif",
        "description" => __( "Base font", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "font",
    ),
    "baseFontSize" => array(
        "value"  => "13px",
        "description" => __( "Base font size", AI1EC_PLUGIN_NAME ),
        "tab" => "general",
        "type" => "size",
    ),
    "tableBackground" => array(
        "value"  => "#000000",
        "description" => __( "Table background", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "tableLabelBackground" => array(
        "value"  => "#303030",
        "description" => __( "Table header background", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "tableLabelText" => array(
        "value"  => "#6a6a6a",
        "description" => __( "Table header text", AI1EC_PLUGIN_NAME ),
        "tab" => "table",
        "type" => "color",
    ),
    "btnPrimaryBackground" => array(
        "value"  => "#5e8cba",
        "description" => __( "Primary brand color", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnBackground" => array(
        "value"  => "#2b2b2b",
        "description" => __( "Button background", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnBorder" => array(
        "value"  => "#000000",
        "description" => __( "Button border", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "btnTextColor" => array(
        "value"  => "#b0b0b0",
        "description" => __( "Button text", AI1EC_PLUGIN_NAME ),
        "tab" => "buttons",
        "type" => "color",
    ),
    "inputText" => array(
        "value"  => "#bbb",
        "description" => __( "Input field text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBackground" => array(
        "value"  => "#000000",
        "description" => __( "Input field background", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBorder" => array(
        "value"  => "#404040",
        "description" => __( "Input field border", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputBorderFocus" => array(
        "value"  => "rgba(82,168,236,0.8)",
        "description" => __( "Input field border (focus)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "inputDisabledBackground" => array(
        "value"  => "#303030",
        "description" => __( "Input field background (disabled)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "labelColor" => array(
        "value"  => "#999999",
        "description" => __( "Field label", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownBackground" => array(
        "value"  => "#000000",
        "description" => __( "Dropdown list background", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownBorder" => array(
        "value"  => "rgba(255,255,255,0.15)",
        "description" => __( "Dropdown list border", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkColor" => array(
        "value"  => "#999999",
        "description" => __( "List item text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkColorHover" => array(
        "value"  => "#dddddd",
        "description" => __( "List item text (active/hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "dropdownLinkBackgroundHover" => array(
        "value"  => "#003a66",
        "description" => __( "List item background (active/hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "placeholderText" => array(
        "value" => "#555",
        "description" => __( "Input field placeholder text", AI1EC_PLUGIN_NAME ),
        "tab" => "forms",
        "type" => "color",
    ),
    "todayColor" => array(
        "value"  => "#002743",
        "description" => __( "Today color", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "alldayBadgeGradientMiddle" => array(
        "value"  => "#5e8cba",
        "description" => __( "All-day badge color", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "eventImageShadow" => array(
        "value"  => "rgba(0,0,0,0.3)",
        "description" => __( "Event image shadow", AI1EC_PLUGIN_NAME ),
        "tab" => "calendar",
        "type" => "color",
    ),
    "eventDefaultColor" => array(
        "value"  => "#5e8cba",
        "description" => __( "Event default color", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventDefaultColorHover" => array(
        "value"  => "#94b2d1",
        "description" => __( "Event default color (hover)", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventStubAllDayText" => array(
        "value"  => "#000000",
        "description" => __( "All-day/multi-day event stub text", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventStubAllDayTextShadow" => array(
        "value"  => "rgba(255,255,255,0.4)",
        "description" => __( "All-day/multi-day event stub text shadow", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventBorder" => array(
        "value"  => "#404040",
        "description" => __( "Event border", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventBackground" => array(
        "value"  => "#222222",
        "description" => __( "Event background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventTimeBackground" => array(
        "value"  => "#000000",
        "description" => __( "Event time background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "eventText" => array(
        "value"  => "#b0b0b0",
        "description" => __( "Event text", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "monthViewDateBackground" => array(
        "value"  => "#001829",
        "description" => __( "Month view date background", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "dayViewNowMarkerColor" => array(
        "value"  => "#f2c539",
        "description" => __( "Week/day view now marker", AI1EC_PLUGIN_NAME ),
        "tab" => "month",
        "type" => "color",
    ),
    "agendaDateTitleBorder" => array(
        "value"  => "#35597d",
        "description" => __( "Date label accent color", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaDateTitleBackground" => array(
        "value"  => "#000000",
        "description" => __( "Date label background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaDateBackground" => array(
        "value"  => "#222222",
        "description" => __( "Date background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
    "agendaTodayBackground" => array(
        "value"  => "#040e16",
        "description" => __( "Today background", AI1EC_PLUGIN_NAME ),
        "tab" => "agenda",
        "type" => "color",
    ),
);


==================================================
FILE PATH: ./public/themes-ai1ec/umbra/less.sha1.map.php
==================================================
<?php return array (
  'variables' => 
  array (
    'agendaDateBackground' => '#222222',
    'agendaDateTitleBackground' => '#000000',
    'agendaDateTitleBorder' => '#35597d',
    'agendaTodayBackground' => '#040e16',
    'alldayBadgeGradientMiddle' => '#5e8cba',
    'baseFontFamily' => '"Helvetica Neue", Helvetica, Arial, sans-serif',
    'baseFontSize' => '13px',
    'bodyBackground' => '#000000',
    'btnBackground' => '#2b2b2b',
    'btnBorder' => '#000000',
    'btnPrimaryBackground' => '#5e8cba',
    'btnTextColor' => '#b0b0b0',
    'dayViewNowMarkerColor' => '#f2c539',
    'dropdownBackground' => '#000000',
    'dropdownBorder' => 'rgba(255,255,255,0.15)',
    'dropdownLinkBackgroundHover' => '#003a66',
    'dropdownLinkColor' => '#999999',
    'dropdownLinkColorHover' => '#dddddd',
    'eventBackground' => '#222222',
    'eventBorder' => '#404040',
    'eventDefaultColor' => '#5e8cba',
    'eventDefaultColorHover' => '#94b2d1',
    'eventImageShadow' => 'rgba(0,0,0,0.3)',
    'eventStubAllDayText' => '#000000',
    'eventStubAllDayTextShadow' => 'rgba(255,255,255,0.4)',
    'eventText' => '#b0b0b0',
    'eventTimeBackground' => '#000000',
    'inputBackground' => '#000000',
    'inputBorder' => '#404040',
    'inputBorderFocus' => 'rgba(82,168,236,0.8)',
    'inputDisabledBackground' => '#303030',
    'inputText' => '#bbb',
    'labelColor' => '#999999',
    'linkColor' => '#5e8cba',
    'linkColorHover' => '#94b2d1',
    'monthViewDateBackground' => '#001829',
    'placeholderText' => '#555',
    'tableBackground' => '#000000',
    'tableLabelBackground' => '#303030',
    'tableLabelText' => '#6a6a6a',
    'textColor' => '#b0b0b0',
    'textEmboss' => 'rgba(0,0,0,0)',
    'todayColor' => '#002743',
  ),
  'files' => 
  array (
    'less\\ai1ec-icons.less' => 
    array (
      'size' => 3045,
      'sha1' => '576590aa4a54f3a8528825b50ab2b9c503edc0c8',
    ),
    'less\\bootstrap\\alerts.less' => 
    array (
      'size' => 1643,
      'sha1' => '3430045a53a78ef713234721153a866c04a321e3',
    ),
    'less\\bootstrap\\badges.less' => 
    array (
      'size' => 1071,
      'sha1' => '1144e3e8d85a9d1c84c09f321b3973705003d220',
    ),
    'less\\bootstrap\\bootstrap.less' => 
    array (
      'size' => 1071,
      'sha1' => '896fa407a97582682fd4b3c8eed9182d23dcb7f3',
    ),
    'less\\bootstrap\\breadcrumbs.less' => 
    array (
      'size' => 552,
      'sha1' => '13965487dedbbc5d70f9a2c8d67a53d63e5bb2ab',
    ),
    'less\\bootstrap\\button-groups.less' => 
    array (
      'size' => 5663,
      'sha1' => '5846fc9fbe5eee8c9c8bdf15c99829958fae83db',
    ),
    'less\\bootstrap\\buttons.less' => 
    array (
      'size' => 3859,
      'sha1' => 'da01aebf9d5a8cfb60834d267899a3b6e4e82cf4',
    ),
    'less\\bootstrap\\carousel.less' => 
    array (
      'size' => 4898,
      'sha1' => '5f32bf96382d44f19c7fcf29b073cd2b625b0651',
    ),
    'less\\bootstrap\\close.less' => 
    array (
      'size' => 701,
      'sha1' => '47bcc0eacd81ef6563f411d990649467ef925b86',
    ),
    'less\\bootstrap\\code.less' => 
    array (
      'size' => 1108,
      'sha1' => 'b7b3cd13cab40699be6c28dcd231d645d9a8ecf5',
    ),
    'less\\bootstrap\\component-animations.less' => 
    array (
      'size' => 563,
      'sha1' => 'dad3720bc6a37774f247c0b1c8799b907f9d6b0c',
    ),
    'less\\bootstrap\\dropdowns.less' => 
    array (
      'size' => 4019,
      'sha1' => '9cf16acd5acda0feb58cb9813ddaf9c2e00b8ec0',
    ),
    'less\\bootstrap\\forms.less' => 
    array (
      'size' => 9604,
      'sha1' => 'e360f70d737154d2676c61cc69e6d297675699f8',
    ),
    'less\\bootstrap\\glyphicons.less' => 
    array (
      'size' => 16124,
      'sha1' => '5841a73064ba73812d2eec2e5104ead29fde5d0a',
    ),
    'less\\bootstrap\\grid.less' => 
    array (
      'size' => 1943,
      'sha1' => '1a1b2fb5314e3e8cb9d6835c2ae12e872a443e19',
    ),
    'less\\bootstrap\\input-groups.less' => 
    array (
      'size' => 3617,
      'sha1' => 'b127b3fd5ef90327f6b5828e6210fe8cbf65e305',
    ),
    'less\\bootstrap\\jumbotron.less' => 
    array (
      'size' => 972,
      'sha1' => '32c4ddca4101db436c60a96491807fa9151dff1e',
    ),
    'less\\bootstrap\\labels.less' => 
    array (
      'size' => 1168,
      'sha1' => '1354ecf04cbb6914569da3e634ccc6fe16f631b6',
    ),
    'less\\bootstrap\\list-group.less' => 
    array (
      'size' => 2016,
      'sha1' => '2ac2500cb4a03f4497a9e8a3c5bf146452c2723a',
    ),
    'less\\bootstrap\\media.less' => 
    array (
      'size' => 932,
      'sha1' => 'f2785c4083cdf565be97b9f106c8bf2ca94a3a44',
    ),
    'less\\bootstrap\\mixins.less' => 
    array (
      'size' => 25423,
      'sha1' => 'cbf55fc13d833a63a7002488da11859703524dde',
    ),
    'less\\bootstrap\\modals.less' => 
    array (
      'size' => 3324,
      'sha1' => '447f634c5bc90a469b561958ff91b36633a25042',
    ),
    'less\\bootstrap\\navbar.less' => 
    array (
      'size' => 14492,
      'sha1' => '62a79adbefb2393f3b91d1efd88758deb97181e6',
    ),
    'less\\bootstrap\\navs.less' => 
    array (
      'size' => 5125,
      'sha1' => '495f825d566a3042c152e5effcabfd343f3bd39e',
    ),
    'less\\bootstrap\\normalize.less' => 
    array (
      'size' => 7287,
      'sha1' => '85488f7d622272f820b4a2a62560626e8eb86b1a',
    ),
    'less\\bootstrap\\pager.less' => 
    array (
      'size' => 895,
      'sha1' => '4fe06190b959ee0ae9395bdd35b4ba6895f32b89',
    ),
    'less\\bootstrap\\pagination.less' => 
    array (
      'size' => 1918,
      'sha1' => 'c9382f11ce75145763054cec2a48add2c0666837',
    ),
    'less\\bootstrap\\panels.less' => 
    array (
      'size' => 4364,
      'sha1' => 'e32797c3984024a948d3581b453e3d7eec3e178f',
    ),
    'less\\bootstrap\\popovers.less' => 
    array (
      'size' => 3432,
      'sha1' => 'a5b341bf1872e9cf58902d6463c686053c65d432',
    ),
    'less\\bootstrap\\print.less' => 
    array (
      'size' => 1734,
      'sha1' => '0dd3dfa0474ce05abde25b913f68f075308e6c30',
    ),
    'less\\bootstrap\\progress-bars.less' => 
    array (
      'size' => 1709,
      'sha1' => '79317167ca402b8c7e2f90ba98362bc810905ff5',
    ),
    'less\\bootstrap\\responsive-utilities.less' => 
    array (
      'size' => 5366,
      'sha1' => '1a8c194fa6fe703539edc98e66c7a3fbbfeb80d2',
    ),
    'less\\bootstrap\\scaffolding.less' => 
    array (
      'size' => 1939,
      'sha1' => 'd97f85740f83179d1b71614fcf1c7824871491d3',
    ),
    'less\\bootstrap\\tables.less' => 
    array (
      'size' => 4400,
      'sha1' => 'b7cf96d8a93381e1d582ecb2a8b80a3d2046ff9b',
    ),
    'less\\bootstrap\\theme.less' => 
    array (
      'size' => 7586,
      'sha1' => 'e80b731a27539d07c8aea78605def74d31d74370',
    ),
    'less\\bootstrap\\thumbnails.less' => 
    array (
      'size' => 772,
      'sha1' => 'a5d7e171ee920336308dfd4a393deab6c25726d0',
    ),
    'less\\bootstrap\\tooltip.less' => 
    array (
      'size' => 2738,
      'sha1' => 'f1f5a8e01f411779d77fd586aa07e8a0c70a916a',
    ),
    'less\\bootstrap\\type.less' => 
    array (
      'size' => 5413,
      'sha1' => 'ef4ae65f48fdd7015ca98eddf2690d32d26c28d5',
    ),
    'less\\bootstrap\\utilities.less' => 
    array (
      'size' => 876,
      'sha1' => '3e5001ccb88acf482db8f603f1c4de02dd03f281',
    ),
    'less\\bootstrap\\variables.less' => 
    array (
      'size' => 19762,
      'sha1' => 'af501270fb66d24d8ab98164c906a20fc4098426',
    ),
    'less\\bootstrap\\wells.less' => 
    array (
      'size' => 559,
      'sha1' => 'f3fa65f17459afda7141e7e79ed7faf5a0b09be4',
    ),
    'less\\calendar.less' => 
    array (
      'size' => 19251,
      'sha1' => '06e08ee4a9a70574f6f51bdbfeed2e53d2f779b0',
    ),
    'less\\common-widgets.less' => 
    array (
      'size' => 725,
      'sha1' => '0b39b1d4e35bffe2157468344e1b7f4d06533606',
    ),
    'less\\event.less' => 
    array (
      'size' => 3834,
      'sha1' => '4d8998b021b5480608424156cc554ff7393d60f0',
    ),
    'less\\font-awesome\\bordered-pulled.less' => 
    array (
      'size' => 330,
      'sha1' => '0469b430cd1567145ba800b22537588be2d1934d',
    ),
    'less\\font-awesome\\core.less' => 
    array (
      'size' => 270,
      'sha1' => '8286f2139fdd27c974385354c2ec24d4ec3b2537',
    ),
    'less\\font-awesome\\fixed-width.less' => 
    array (
      'size' => 119,
      'sha1' => 'ec0c24b97184dab86177660f486b8d08cd636c42',
    ),
    'less\\font-awesome\\font-awesome.less' => 
    array (
      'size' => 405,
      'sha1' => '7ffa0ce611a0c19dba8a981a4ce0bdbd945e3d7f',
    ),
    'less\\font-awesome\\icons.less' => 
    array (
      'size' => 26173,
      'sha1' => '085b25011d25f80636e84271fb0ae72376bc9ba2',
    ),
    'less\\font-awesome\\larger.less' => 
    array (
      'size' => 370,
      'sha1' => 'e7119e82dc50540dbc3472bba7d74282815a7ecc',
    ),
    'less\\font-awesome\\list.less' => 
    array (
      'size' => 375,
      'sha1' => 'b31f32ff393e3fa2f5c72d4a81c63871e61071ab',
    ),
    'less\\font-awesome\\mixins.less' => 
    array (
      'size' => 699,
      'sha1' => 'c46690a1efdea1d83c43063ec43d46f289d9b140',
    ),
    'less\\font-awesome\\path.less' => 
    array (
      'size' => 684,
      'sha1' => 'e152f9ef54b29bad851af8c6f8a77335a6e2c3f5',
    ),
    'less\\font-awesome\\rotated-flipped.less' => 
    array (
      'size' => 367,
      'sha1' => '6f63cbd44038b355cec327ce247008672f89cc3c',
    ),
    'less\\font-awesome\\spinning.less' => 
    array (
      'size' => 765,
      'sha1' => '57059d55b45c3ff7993acc57f3a579e056625fe0',
    ),
    'less\\font-awesome\\stacked.less' => 
    array (
      'size' => 476,
      'sha1' => 'f044077bc8be1a989c245254e81eb084d52d29a7',
    ),
    'less\\font-awesome\\variables.less' => 
    array (
      'size' => 10665,
      'sha1' => '8d7d0d81e445093ecc58577605c36320d2741ba7',
    ),
    'less\\override.less' => 
    array (
      'size' => 252,
      'sha1' => '3a6f13f271b446835de767a40915ba0d3e682a8a',
    ),
    'less\\plugins\\datepicker3.less' => 
    array (
      'size' => 5690,
      'sha1' => '8d6c3415942c6dcb4c27e955d512f7bb51c00bff',
    ),
    'less\\plugins\\fileupload.less' => 
    array (
      'size' => 2202,
      'sha1' => 'b1084d4dbddfb2de4883a3eb1b95b5cfc9fbbca0',
    ),
    'less\\plugins\\select2.less' => 
    array (
      'size' => 19259,
      'sha1' => '787c8ccb90526c4b7ebeaf189eb7d22d3e85b7a8',
    ),
    'less\\plugins\\timepicker.less' => 
    array (
      'size' => 3946,
      'sha1' => 'b20c2d939abce946e6456845df993a8043e9e1ae',
    ),
    'less\\style.less' => 
    array (
      'size' => 21007,
      'sha1' => 'a95f6f6d730ff3eed5013b6f0788835343a8a483',
    ),
    'less\\timely-font-awesome.less' => 
    array (
      'size' => 1395,
      'sha1' => 'dfbfe1d8ebb54b57bc6a60bbff55277d520fa2f3',
    ),
    'less\\timely-mixins.less' => 
    array (
      'size' => 8539,
      'sha1' => 'a1679e2bda8064f589a8228a0791ee1acff218c4',
    ),
    'less\\user-variable-map.less' => 
    array (
      'size' => 2341,
      'sha1' => 'f08577bc906d8cac06425035e1c0047d35f4563b',
    ),
    'less\\user_variables.php' => 
    array (
      'size' => 8627,
      'sha1' => 'dd111c643a3fec2f551cf0b0827739e18682dbbe',
    ),
    'less\\variables.less' => 
    array (
      'size' => 1424,
      'sha1' => '1d1791f4334d063971673c2b55227d4655077d83',
    ),
    'style.css' => 
    array (
      'size' => 269,
      'sha1' => 'b4bedbc9a32c3276f410e346a865249f822f1f37',
    ),
  ),
);

==================================================
FILE PATH: ./public/themes-ai1ec/gamma/index.php
==================================================
<?php ?>


==================================================
FILE PATH: ./public/themes-ai1ec/gamma/functions.php
==================================================
<?php

/**
 * For advanced users:
 *
 * Place any custom WordPress hooks or theme functions into this file.
 *
 * This file is optional and can be omitted from your custom theme.
 */


==================================================
FILE PATH: ./public/themes-ai1ec/gamma/less.sha1.map.php
==================================================
<?php return array (
  'variables' => 
  array (
    'agendaDateBackground' => '#f2f2f2',
    'agendaDateTitleBackground' => '#ffffff',
    'agendaDateTitleBorder' => '#6689AC',
    'agendaTodayBackground' => '#f4f4bf',
    'alldayBadgeGradientMiddle' => '#3d6b99',
    'baseFontFamily' => '"Helvetica Neue", Helvetica, Arial, sans-serif',
    'baseFontSize' => '13px',
    'bodyBackground' => '#ffffff',
    'btnBackground' => '#ffffff',
    'btnBorder' => '#cccccc',
    'btnPrimaryBackground' => '#6dbb4f',
    'btnTextColor' => '#333333',
    'dayViewNowMarkerColor' => '#f2c539',
    'dropdownBackground' => '#ffffff',
    'dropdownBorder' => 'rgba(0,0,0,0.15)',
    'dropdownLinkBackgroundHover' => '#f5f5f5',
    'dropdownLinkColor' => '#333333',
    'dropdownLinkColorHover' => '#262626',
    'eventBackground' => '#ffffff',
    'eventBorder' => '#cccccc',
    'eventDefaultColor' => '#3d6b99',
    'eventDefaultColorHover' => '#335980',
    'eventImageShadow' => 'rgba(0,0,0,0.4)',
    'eventStubAllDayText' => '#ffffff',
    'eventStubAllDayTextShadow' => 'rgba(0,0,0,0.4)',
    'eventText' => '#333333',
    'eventTimeBackground' => '#eeeeee',
    'inputBackground' => '#ffffff',
    'inputBorder' => '#cccccc',
    'inputBorderFocus' => 'rgba(82,168,236,0.8)',
    'inputDisabledBackground' => '#eeeeee',
    'inputText' => '#555',
    'labelColor' => '#aaaaaa',
    'linkColor' => '#3d6b99',
    'linkColorHover' => '#335980',
    'monthViewDateBackground' => '#eaf4ff',
    'placeholderText' => '#999999',
    'tableBackground' => '#ffffff',
    'tableLabelBackground' => '#f5f5f5',
    'tableLabelText' => '#9e9e9e',
    'textColor' => '#333333',
    'textEmboss' => '#ffffff',
    'todayColor' => '#ffffdd',
  ),
  'files' => 
  array (
    'functions.php' => 
    array (
      'size' => 183,
      'sha1' => '64b6ef2e4b2912a2177d80d2d6ea3993e2096251',
    ),
    'less\\ai1ec-icons.less' => 
    array (
      'size' => 3045,
      'sha1' => '576590aa4a54f3a8528825b50ab2b9c503edc0c8',
    ),
    'less\\bootstrap\\alerts.less' => 
    array (
      'size' => 1643,
      'sha1' => '3430045a53a78ef713234721153a866c04a321e3',
    ),
    'less\\bootstrap\\badges.less' => 
    array (
      'size' => 1071,
      'sha1' => '1144e3e8d85a9d1c84c09f321b3973705003d220',
    ),
    'less\\bootstrap\\bootstrap.less' => 
    array (
      'size' => 1071,
      'sha1' => '896fa407a97582682fd4b3c8eed9182d23dcb7f3',
    ),
    'less\\bootstrap\\breadcrumbs.less' => 
    array (
      'size' => 552,
      'sha1' => '13965487dedbbc5d70f9a2c8d67a53d63e5bb2ab',
    ),
    'less\\bootstrap\\button-groups.less' => 
    array (
      'size' => 5663,
      'sha1' => '5846fc9fbe5eee8c9c8bdf15c99829958fae83db',
    ),
    'less\\bootstrap\\buttons.less' => 
    array (
      'size' => 3859,
      'sha1' => 'da01aebf9d5a8cfb60834d267899a3b6e4e82cf4',
    ),
    'less\\bootstrap\\carousel.less' => 
    array (
      'size' => 4898,
      'sha1' => '5f32bf96382d44f19c7fcf29b073cd2b625b0651',
    ),
    'less\\bootstrap\\close.less' => 
    array (
      'size' => 701,
      'sha1' => '47bcc0eacd81ef6563f411d990649467ef925b86',
    ),
    'less\\bootstrap\\code.less' => 
    array (
      'size' => 1108,
      'sha1' => 'b7b3cd13cab40699be6c28dcd231d645d9a8ecf5',
    ),
    'less\\bootstrap\\component-animations.less' => 
    array (
      'size' => 563,
      'sha1' => 'dad3720bc6a37774f247c0b1c8799b907f9d6b0c',
    ),
    'less\\bootstrap\\dropdowns.less' => 
    array (
      'size' => 4019,
      'sha1' => '9cf16acd5acda0feb58cb9813ddaf9c2e00b8ec0',
    ),
    'less\\bootstrap\\forms.less' => 
    array (
      'size' => 9604,
      'sha1' => 'e360f70d737154d2676c61cc69e6d297675699f8',
    ),
    'less\\bootstrap\\glyphicons.less' => 
    array (
      'size' => 16124,
      'sha1' => '5841a73064ba73812d2eec2e5104ead29fde5d0a',
    ),
    'less\\bootstrap\\grid.less' => 
    array (
      'size' => 1943,
      'sha1' => '1a1b2fb5314e3e8cb9d6835c2ae12e872a443e19',
    ),
    'less\\bootstrap\\input-groups.less' => 
    array (
      'size' => 3617,
      'sha1' => 'b127b3fd5ef90327f6b5828e6210fe8cbf65e305',
    ),
    'less\\bootstrap\\jumbotron.less' => 
    array (
      'size' => 972,
      'sha1' => '32c4ddca4101db436c60a96491807fa9151dff1e',
    ),
    'less\\bootstrap\\labels.less' => 
    array (
      'size' => 1168,
      'sha1' => '1354ecf04cbb6914569da3e634ccc6fe16f631b6',
    ),
    'less\\bootstrap\\list-group.less' => 
    array (
      'size' => 2016,
      'sha1' => '2ac2500cb4a03f4497a9e8a3c5bf146452c2723a',
    ),
    'less\\bootstrap\\media.less' => 
    array (
      'size' => 932,
      'sha1' => 'f2785c4083cdf565be97b9f106c8bf2ca94a3a44',
    ),
    'less\\bootstrap\\mixins.less' => 
    array (
      'size' => 25423,
      'sha1' => 'cbf55fc13d833a63a7002488da11859703524dde',
    ),
    'less\\bootstrap\\modals.less' => 
    array (
      'size' => 3324,
      'sha1' => '447f634c5bc90a469b561958ff91b36633a25042',
    ),
    'less\\bootstrap\\navbar.less' => 
    array (
      'size' => 14492,
      'sha1' => '62a79adbefb2393f3b91d1efd88758deb97181e6',
    ),
    'less\\bootstrap\\navs.less' => 
    array (
      'size' => 5125,
      'sha1' => '495f825d566a3042c152e5effcabfd343f3bd39e',
    ),
    'less\\bootstrap\\normalize.less' => 
    array (
      'size' => 7287,
      'sha1' => '85488f7d622272f820b4a2a62560626e8eb86b1a',
    ),
    'less\\bootstrap\\pager.less' => 
    array (
      'size' => 895,
      'sha1' => '4fe06190b959ee0ae9395bdd35b4ba6895f32b89',
    ),
    'less\\bootstrap\\pagination.less' => 
    array (
      'size' => 1918,
      'sha1' => 'c9382f11ce75145763054cec2a48add2c0666837',
    ),
    'less\\bootstrap\\panels.less' => 
    array (
      'size' => 4364,
      'sha1' => 'e32797c3984024a948d3581b453e3d7eec3e178f',
    ),
    'less\\bootstrap\\popovers.less' => 
    array (
      'size' => 3432,
      'sha1' => 'a5b341bf1872e9cf58902d6463c686053c65d432',
    ),
    'less\\bootstrap\\print.less' => 
    array (
      'size' => 1734,
      'sha1' => '0dd3dfa0474ce05abde25b913f68f075308e6c30',
    ),
    'less\\bootstrap\\progress-bars.less' => 
    array (
      'size' => 1709,
      'sha1' => '79317167ca402b8c7e2f90ba98362bc810905ff5',
    ),
    'less\\bootstrap\\responsive-utilities.less' => 
    array (
      'size' => 5366,
      'sha1' => '1a8c194fa6fe703539edc98e66c7a3fbbfeb80d2',
    ),
    'less\\bootstrap\\scaffolding.less' => 
    array (
      'size' => 1939,
      'sha1' => 'd97f85740f83179d1b71614fcf1c7824871491d3',
    ),
    'less\\bootstrap\\tables.less' => 
    array (
      'size' => 4400,
      'sha1' => 'b7cf96d8a93381e1d582ecb2a8b80a3d2046ff9b',
    ),
    'less\\bootstrap\\theme.less' => 
    array (
      'size' => 7586,
      'sha1' => 'e80b731a27539d07c8aea78605def74d31d74370',
    ),
    'less\\bootstrap\\thumbnails.less' => 
    array (
      'size' => 772,
      'sha1' => 'a5d7e171ee920336308dfd4a393deab6c25726d0',
    ),
    'less\\bootstrap\\tooltip.less' => 
    array (
      'size' => 2738,
      'sha1' => 'f1f5a8e01f411779d77fd586aa07e8a0c70a916a',
    ),
    'less\\bootstrap\\type.less' => 
    array (
      'size' => 5413,
      'sha1' => 'ef4ae65f48fdd7015ca98eddf2690d32d26c28d5',
    ),
    'less\\bootstrap\\utilities.less' => 
    array (
      'size' => 876,
      'sha1' => '3e5001ccb88acf482db8f603f1c4de02dd03f281',
    ),
    'less\\bootstrap\\variables.less' => 
    array (
      'size' => 19762,
      'sha1' => 'af501270fb66d24d8ab98164c906a20fc4098426',
    ),
    'less\\bootstrap\\wells.less' => 
    array (
      'size' => 559,
      'sha1' => 'f3fa65f17459afda7141e7e79ed7faf5a0b09be4',
    ),
    'less\\calendar.less' => 
    array (
      'size' => 19251,
      'sha1' => '06e08ee4a9a70574f6f51bdbfeed2e53d2f779b0',
    ),
    'less\\common-widgets.less' => 
    array (
      'size' => 725,
      'sha1' => '0b39b1d4e35bffe2157468344e1b7f4d06533606',
    ),
    'less\\event.less' => 
    array (
      'size' => 3834,
      'sha1' => '4d8998b021b5480608424156cc554ff7393d60f0',
    ),
    'less\\font-awesome\\bordered-pulled.less' => 
    array (
      'size' => 330,
      'sha1' => '0469b430cd1567145ba800b22537588be2d1934d',
    ),
    'less\\font-awesome\\core.less' => 
    array (
      'size' => 270,
      'sha1' => '8286f2139fdd27c974385354c2ec24d4ec3b2537',
    ),
    'less\\font-awesome\\fixed-width.less' => 
    array (
      'size' => 119,
      'sha1' => 'ec0c24b97184dab86177660f486b8d08cd636c42',
    ),
    'less\\font-awesome\\font-awesome.less' => 
    array (
      'size' => 405,
      'sha1' => '7ffa0ce611a0c19dba8a981a4ce0bdbd945e3d7f',
    ),
    'less\\font-awesome\\icons.less' => 
    array (
      'size' => 26173,
      'sha1' => '085b25011d25f80636e84271fb0ae72376bc9ba2',
    ),
    'less\\font-awesome\\larger.less' => 
    array (
      'size' => 370,
      'sha1' => 'e7119e82dc50540dbc3472bba7d74282815a7ecc',
    ),
    'less\\font-awesome\\list.less' => 
    array (
      'size' => 375,
      'sha1' => 'b31f32ff393e3fa2f5c72d4a81c63871e61071ab',
    ),
    'less\\font-awesome\\mixins.less' => 
    array (
      'size' => 699,
      'sha1' => 'c46690a1efdea1d83c43063ec43d46f289d9b140',
    ),
    'less\\font-awesome\\path.less' => 
    array (
      'size' => 684,
      'sha1' => 'e152f9ef54b29bad851af8c6f8a77335a6e2c3f5',
    ),
    'less\\font-awesome\\rotated-flipped.less' => 
    array (
      'size' => 367,
      'sha1' => '6f63cbd44038b355cec327ce247008672f89cc3c',
    ),
    'less\\font-awesome\\spinning.less' => 
    array (
      'size' => 765,
      'sha1' => '57059d55b45c3ff7993acc57f3a579e056625fe0',
    ),
    'less\\font-awesome\\stacked.less' => 
    array (
      'size' => 476,
      'sha1' => 'f044077bc8be1a989c245254e81eb084d52d29a7',
    ),
    'less\\font-awesome\\variables.less' => 
    array (
      'size' => 10665,
      'sha1' => '8d7d0d81e445093ecc58577605c36320d2741ba7',
    ),
    'less\\plugins\\datepicker3.less' => 
    array (
      'size' => 5690,
      'sha1' => '8d6c3415942c6dcb4c27e955d512f7bb51c00bff',
    ),
    'less\\plugins\\fileupload.less' => 
    array (
      'size' => 2202,
      'sha1' => 'b1084d4dbddfb2de4883a3eb1b95b5cfc9fbbca0',
    ),
    'less\\plugins\\select2.less' => 
    array (
      'size' => 19259,
      'sha1' => '787c8ccb90526c4b7ebeaf189eb7d22d3e85b7a8',
    ),
    'less\\plugins\\timepicker.less' => 
    array (
      'size' => 3946,
      'sha1' => 'b20c2d939abce946e6456845df993a8043e9e1ae',
    ),
    'less\\style.less' => 
    array (
      'size' => 21007,
      'sha1' => 'a95f6f6d730ff3eed5013b6f0788835343a8a483',
    ),
    'less\\timely-font-awesome.less' => 
    array (
      'size' => 1395,
      'sha1' => 'dfbfe1d8ebb54b57bc6a60bbff55277d520fa2f3',
    ),
    'less\\timely-mixins.less' => 
    array (
      'size' => 8539,
      'sha1' => 'a1679e2bda8064f589a8228a0791ee1acff218c4',
    ),
    'less\\user-variable-map.less' => 
    array (
      'size' => 2341,
      'sha1' => 'f08577bc906d8cac06425035e1c0047d35f4563b',
    ),
    'less\\user_variables.php' => 
    array (
      'size' => 8612,
      'sha1' => 'eac102828cb0188f135039907e2b6ba503536baf',
    ),
    'less\\variables.less' => 
    array (
      'size' => 1248,
      'sha1' => '1d7fcb0178ffdf8a57e8e9c4f2fb2c0dc70e3c7f',
    ),
    'style.css' => 
    array (
      'size' => 1729,
      'sha1' => '42c930a6523259355efb21950977d6bcb65cfc8f',
    ),
  ),
);

==================================================
FILE PATH: ./public/admin/row_yearly.php
==================================================
<div class="ai1ec-form-group">
  <label for="ai1ec_yearly_count" class="ai1ec-control-label ai1ec-col-sm-3">
      <?php _e( 'Every', AI1EC_PLUGIN_NAME ); ?>:
  </label>
  <div class="ai1ec-col-sm-9">
    <?php echo $count; ?>
  </div>
</div>

<div class="ai1ec-form-group">
  <label for="ai1ec_yearly_date_select" class="ai1ec-control-label ai1ec-col-sm-3">
      <?php _ex( 'In', 'Recurrence editor - yearly tab', AI1EC_PLUGIN_NAME ); ?>:
  </label>
  <div class="ai1ec-col-sm-9">
    <?php echo $year; ?>
  </div>
</div>


==================================================
FILE PATH: ./public/admin/save_error.php
==================================================
<div class="error">
    <?php foreach ( $msgs as $msg) : ?>
    <p>
        <strong>
            <?php echo $msg; ?>
        </strong>
    </p>
    <?php endforeach; ?>
</div>

==================================================
FILE PATH: ./public/admin/box_feeds.php
==================================================
<div class="timely">
    <ul class="ai1ec-nav ai1ec-nav-tabs">
        <?php $calendar_feeds->render_tab_headers() ?>
        <li class="timely-saas">
            <a href="#how_to" data-toggle="ai1ec-tab">How To</a>
        </li>
    </ul>
    <div class="ai1ec-tab-content">
        <?php $calendar_feeds->render_tab_contents() ?>
        <div class="ai1ec-feeds-howto ai1ec-tab-pane timely-saas" id="how_to">
            There are different ways to sync events depending on the source calendar provider. All of them require you to get their ICS (international calendar standard) feed. <br><br>

            <ul>
                <div>Look for a button on their calendar with any of the following buttons:</div>
                <li>ICS</li>
                <li>iCal</li>
                <li>Subscribe</li>
                <li>Feed</li>
                <li>Export</li>
            </ul>
            <br>
            Often you need to click to get the Copy Link Address. Once you have the ICS feed, you can paste it into your Timely calendar Import Feeds section.
            <br><br>
            Specific documentation & videos for each major source calendar provider are found <a href="https://time.ly/document/sourcing-pulling-in-local-feeds/">here</a>
            <br><br>
            Approximately 1 in 10 website calendars can export a feed. For those that dont, you can ask to get their own Timely calendar <a href="https://time.ly/website-calendar-pricing">https://time.ly/website-calendar-pricing</a> which you will be able to pull/sync events from.
            <br><br>
            You can also do a web search for calendars, ie:<br>
            Music & Toronto & Timely calendar
            <br><br>
            The <a href="https://time.ly/website-calendar-pricing">Timely Hub</a> calendar allows you to search for local Timely calendars and add their events directly via your own dashboard. We call this EventDiscovery.
            <div id="ai1ec-import-howto" class="calendar-samples"></div>
        </div>
    </div>
</div>



==================================================
FILE PATH: ./public/admin/row_monthly.php
==================================================
<div class="ai1ec-form-group">
    <label for="ai1ec_monthly_count" class="ai1ec-control-label ai1ec-col-sm-3">
        <?php _e( 'Every', AI1EC_PLUGIN_NAME ); ?>:
    </label>
    <div class="ai1ec-col-sm-9">
        <?php echo $count; ?>
    </div>
</div>

<div class="ai1ec-form-group">
    <div class="ai1ec-col-sm-offset-3 ai1ec-col-sm-9">
        <div class="radio">
            <label for="ai1ec_monthly_type_bymonthday">
                <input type="radio" name="ai1ec_monthly_type"
                    id="ai1ec_monthly_type_bymonthday" value="bymonthday" <?php echo $bymonthday_checked; ?>>
                <?php _e( 'On day of the month', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
        <div class="radio">
            <label for="ai1ec_monthly_type_byday">
                <input type="radio" name="ai1ec_monthly_type"
                    id="ai1ec_monthly_type_byday" value="byday" <?php echo $byday_checked; ?>>
                <?php _e( 'On day of the week', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
    </div>
</div>

<div class="ai1ec-form-group">
    <div id="ai1ec_repeat_monthly_bymonthday" class="ai1ec-collapse ai1ec-in">
        <div class="ai1ec-col-sm-offset-3 ai1ec-col-sm-9">
            <?php echo $month; ?>
        </div>
    </div>

    <div id="ai1ec_repeat_monthly_byday" class="ai1ec-collapse">
        <label for="ai1ec_monthly_type_byday"
            class="ai1ec-control-label ai1ec-col-sm-3">
            <?php _e( 'Every', AI1EC_PLUGIN_NAME ); ?>:
        </label>
        <div class="ai1ec-col-sm-9">
            <?php echo $day_nums; ?>
            <?php echo $week_days; ?>
        </div>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/add_new_event_meta_box.php
==================================================
<div class="timely ai1ec-panel-group ai1ec-form-inline"
    id="ai1ec-add-new-event-accordion">
    <?php foreach ( $boxes as $i => $box ) : ?>
        <div class="ai1ec-panel ai1ec-panel-default
        <?php echo 0 === $i ? 'ai1ec-overflow-visible' : '' ?>">
        <?php echo $box; ?>
        </div>
    <?php endforeach; ?>
</div>

==================================================
FILE PATH: ./public/admin/box_event_children.php
==================================================
<?php
if ( empty( $parent ) && empty( $children ) ) {
    return '';
}
?>
<div class="ai1ec-panel-heading">
    <a data-toggle="ai1ec-collapse"
        data-parent="#ai1ec-add-new-event-accordion"
        href="#ai1ec-event-children-box">
        <i class="ai1ec-fa ai1ec-fa-retweet"></i> <?php
        if ( $parent ) {
            _e( 'Base recurrence event', AI1EC_PLUGIN_NAME );
        } else {
            _e( 'Modified recurrence events', AI1EC_PLUGIN_NAME );
        }
    ?>
    </a>
</div>
<div id="ai1ec-event-children-box" class="ai1ec-panel-collapse ai1ec-collapse">
    <div class="ai1ec-panel-body">
    <?php if ( $parent ) : ?>
    <?php _e( 'Edit parent:', AI1EC_PLUGIN_NAME ); ?>
    <a href="<?php echo get_edit_post_link( $parent->get( 'post_id' ) ); ?>"><?php
    echo apply_filters( 'the_title', $parent->get( 'post' )->post_title, $parent->get( 'post_id' ) );
    ?></a>
    <?php else : /* children */ ?>
    <h4><?php _e( 'Modified Events', AI1EC_PLUGIN_NAME ); ?></h4>
    <ul>
        <?php foreach ( $children as $child ) : ?>
        <li>
            <?php _e( 'Edit:', AI1EC_PLUGIN_NAME ); ?>
            <a href="<?php echo get_edit_post_link( $child->get( 'post_id' ) ); ?>"><?php
            echo $child->get( 'post' )->post_title;
            ?></a>, <?php echo $registry->get( 'view.event.time' )->get_timespan_html( $child, 'long' ); ?>
        </li>
        <?php endforeach; ?>
    </ul>
    <?php endif; ?>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/calendar_tasks.php
==================================================
<div class="timely">
    <div class="ai1ec-hero-unit">
        <h1><?php _e( 'Welcome', AI1EC_PLUGIN_NAME ); ?></h1>
        <p><?php _e( 'to the All-in-One Event Calendar by <a href="https://time.ly/" target="_blank">Timely</a>', AI1EC_PLUGIN_NAME ); ?></p>
    </div>

    <div class="ai1ec-clearfix">
        <div class="ai1ec-row">
            <?php if ( $add_allowed ): ?>
                <div class="ai1ec-col-sm-6">
                    <p>
                        <a class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg" href="<?php echo esc_attr( $add_url ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-plus"></i>&nbsp;&nbsp;<?php _e( 'Post Your Event', AI1EC_PLUGIN_NAME ); ?>
                        </a>
                    </p>
                    <strong><?php _e( 'Add a new event to the calendar.', AI1EC_PLUGIN_NAME ); ?></strong>
                </div>
            <?php endif; ?>

            <?php if ( $edit_allowed ): ?>
                <div class="ai1ec-col-sm-6">
                    <p>
                        <a class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg" href="<?php echo esc_attr( $edit_url ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-pencil"></i>&nbsp;&nbsp;<?php _e( 'Manage Events', AI1EC_PLUGIN_NAME ); ?>
                        </a>
                    </p>
                    <strong><?php _e( 'View and edit all your events.', AI1EC_PLUGIN_NAME ); ?></strong>
                </div>
            <?php endif; ?>
        </div>

        <hr />

        <div class="ai1ec-row">
            <?php if ( $categories_allowed ): ?>
                <div class="ai1ec-col-sm-6">
                    <p>
                        <a class="ai1ec-btn ai1ec-btn-default" href="<?php echo esc_attr( $categories_url ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-tags ai1ec-fa-lg"></i> <?php _e( 'Manage Event Categories', AI1EC_PLUGIN_NAME ); ?>
                        </a>
                    </p>
                    <p><strong><?php _e( 'Organize and color-code your events.', AI1EC_PLUGIN_NAME ); ?></strong></p>
                </div>
            <?php endif; ?>

            <?php if ( $themes_allowed ): ?>
                <div class="ai1ec-col-sm-6">
                    <p>
                        <a class="ai1ec-btn ai1ec-btn-default" href="<?php echo esc_attr( $themes_url ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-leaf ai1ec-fa-lg"></i> <?php _e( 'Choose Your Theme', AI1EC_PLUGIN_NAME ); ?>
                        </a>
                    </p>
                    <p><strong><?php _e( 'Change the look and feel.', AI1EC_PLUGIN_NAME ); ?></strong></p>
                </div>
            <?php endif; ?>
        </div>

        <div class="ai1ec-row">
            <?php if ( $feeds_allowed ): ?>
                <div class="ai1ec-col-sm-6">
                    <p>
                        <a class="ai1ec-btn ai1ec-btn-default" href="<?php echo esc_attr( $feeds_url ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-refresh ai1ec-fa-lg"></i> <?php _e( 'Manage Calendar Feeds', AI1EC_PLUGIN_NAME ); ?>
                        </a>
                    </p>
                    <p><strong><?php _e( 'Subscribe to other calendars.', AI1EC_PLUGIN_NAME ); ?></strong></p>
                </div>
            <?php endif; ?>

            <?php if ( $settings_allowed ): ?>
                <div class="ai1ec-col-sm-6">
                    <p>
                        <a class="ai1ec-btn ai1ec-btn-default" href="<?php echo esc_attr( $settings_url ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-cog ai1ec-fa-lg"></i> <?php _e( 'Edit Calendar Settings', AI1EC_PLUGIN_NAME ); ?>
                        </a>
                    </p>
                    <p><strong><?php _e( 'Make this calendar your own.', AI1EC_PLUGIN_NAME ); ?></strong></p>
                </div>
            <?php endif; ?>
        </div>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/box_eventbrite.php
==================================================
<h4 class="box_h4"><?php _e( 'Eventbrite Ticketing', AI1EC_PLUGIN_NAME ); ?>:</h4>
<table>
    <tbody>
        <tr>
            <td>
                <label>
                    <?php _e( 'Register this event with Eventbrite.com?', AI1EC_PLUGIN_NAME ); ?>
                </label>
            </td>
            <td>
                <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_yes" id="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_yes" />
                <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_yes"><?php _e( 'Yes', AI1EC_PLUGIN_NAME ); ?></label>
                <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_no" id="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_no" />
                <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_no"><?php _e( 'No', AI1EC_PLUGIN_NAME ); ?></label>
            </td>
        </tr>
    </tbody>
</table>

<div id="<?php echo AI1EC_PLUGIN_NAME; ?>_eventbrite_body">
    <h4>
        <?php _e( 'Set up your first ticket', AI1EC_PLUGIN_NAME ); ?>
        <small>
            <?php _e( 'To create multiple tickets per event, submit this form, then follow the link to Eventbrite.', AI1EC_PLUGIN_NAME ); ?>
        </small>
    </h4>
    <table>
        <tbody>
            <tr>
                <td>
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_name">
                        <?php _e( 'Name', AI1EC_PLUGIN_NAME ); ?>:
                    </label>
                </td>
                <td>
                    <input type="text" name="<?php echo AI1EC_PLUGIN_NAME; ?>_name" id="<?php echo AI1EC_PLUGIN_NAME; ?>_name" />
                </td>
            </tr>
            <tr>
                <td>
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_description">
                        <?php _e( 'Description', AI1EC_PLUGIN_NAME ); ?>:
                    </label>
                </td>
                <td>
                    <textarea name="<?php echo AI1EC_PLUGIN_NAME; ?>_description" id="<?php echo AI1EC_PLUGIN_NAME; ?>_description">
                    </textarea>
                </td>
            </tr>
            <tr>
                <td>
                    <label>
                        <?php _e( 'Type', AI1EC_PLUGIN_NAME ); ?>:
                    </label>
                </td>
                <td>
                    <input type="radio" name="<?php echo AI1EC_PLUGIN_NAME; ?>_type" id="<?php echo AI1EC_PLUGIN_NAME; ?>_type_price" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_type_price"><?php _e( 'Set Price', AI1EC_PLUGIN_NAME ); ?></label>
                    <input type="radio" name="<?php echo AI1EC_PLUGIN_NAME; ?>_type" id="<?php echo AI1EC_PLUGIN_NAME; ?>_type_donation" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_type_donation"><?php _e( 'Donation Based', AI1EC_PLUGIN_NAME ); ?></label>
                </td>
            </tr>
            <tr>
                <td>
                </td>
                <td>
                    <small>
                        <?php _e( "The price for this event's first ticket will be taken from the Cost field above.", AI1EC_PLUGIN_NAME ); ?>
                    </small>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_quantity">
                        <?php _e( 'Quantity', AI1EC_PLUGIN_NAME ); ?>:
                    </label>
                </td>
                <td>
                    <input type="text" name="<?php echo AI1EC_PLUGIN_NAME; ?>_quantity" id="<?php echo AI1EC_PLUGIN_NAME; ?>_quantity" />
                </td>
            </tr>
            <tr>
                <td>
                    <label>
                        <?php _e( 'Include Fee in Price', AI1EC_PLUGIN_NAME ); ?>:
                    </label>
                </td>
                <td>
                    <input type="radio" name="<?php echo AI1EC_PLUGIN_NAME; ?>_fee_in_price" id="<?php echo AI1EC_PLUGIN_NAME; ?>_add_fee" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_add_fee"><?php _e( 'Add Service Fee on top of price', AI1EC_PLUGIN_NAME ); ?></label>
                    <input type="radio" name="<?php echo AI1EC_PLUGIN_NAME; ?>_fee_in_price" id="<?php echo AI1EC_PLUGIN_NAME; ?>_include_fee" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_include_fee"><?php _e( 'Include Service fee in price', AI1EC_PLUGIN_NAME ); ?></label>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>">
                        <?php _e( 'Payment Options', AI1EC_PLUGIN_NAME ); ?>:
                    </label>
                </td>
                <td>
                    <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_paypal" id="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_paypal" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_paypal"><?php _e( 'Paypal', AI1EC_PLUGIN_NAME ); ?></label>
                    <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_google" id="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_google" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_google"><?php _e( 'Google Checkout', AI1EC_PLUGIN_NAME ); ?></label>
                    <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_check" id="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_check" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_check"><?php _e( 'Check', AI1EC_PLUGIN_NAME ); ?></label>
                    <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_cash" id="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_cash" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_cash"><?php _e( 'Cash', AI1EC_PLUGIN_NAME ); ?></label>
                    <input type="checkbox" name="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_invoice" id="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_invoice" />
                    <label for="<?php echo AI1EC_PLUGIN_NAME; ?>_payment_invoice"><?php _e( 'Send an Invoice', AI1EC_PLUGIN_NAME ); ?></label>
                </td>
            </tr>
        </tbody>
    </table>
</div>

==================================================
FILE PATH: ./public/admin/on_the_select.php
==================================================
<?php ?>


==================================================
FILE PATH: ./public/admin/box_event_location.php
==================================================
<div class="ai1ec-panel-heading">
    <a data-toggle="ai1ec-collapse"
        data-parent="#ai1ec-add-new-event-accordion"
        href="#ai1ec-event-location-box">
        <i class="ai1ec-fa ai1ec-fa-map-marker ai1ec-fa-fw"></i>
        <?php _e( 'Event location details', AI1EC_PLUGIN_NAME ); ?>
    </a>
</div>
<div id="ai1ec-event-location-box" class="ai1ec-panel-collapse ai1ec-collapse">
    <div class="ai1ec-panel-body">
        <div class="ai1ec-row">
            <div class="ai1ec-col-md-8 ai1ec-col-lg-6">
                <table class="ai1ec-form ai1ec-location-form">
                    <tbody>
                        <?php echo $select_venue; ?>
                        <tr>
                            <td class="ai1ec-first">
                                <label for="ai1ec_venue">
                                    <?php _e( 'Venue name:', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                            </td>
                            <td>
                                <input type="text" name="ai1ec_venue" id="ai1ec_venue"
                                    class="ai1ec-form-control"
                                    value="<?php echo esc_attr( $venue ); ?>">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="ai1ec_address">
                                    <?php _e( 'Address:', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                            </td>
                            <td>
                                <input type="text" name="ai1ec_address" id="ai1ec_address"
                                    class="ai1ec-form-control"
                                    value="<?php echo esc_attr( $address ); ?>">
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <label for="ai1ec_input_coordinates">
                                    <input type="checkbox" value="1" name="ai1ec_input_coordinates"
                                        id="ai1ec_input_coordinates" <?php echo $coordinates; ?>>
                                    <?php _e( 'Input Coordinates', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                            </td>
                        </tr>
                        <?php echo $save_venue; ?>
                    </tbody>
                </table>
                <table id="ai1ec_table_coordinates" class="ai1ec-form ai1ec-location-form">
                    <tbody>
                        <tr>
                            <td class="ai1ec-first">
                                <label for="ai1ec_latitude">
                                    <?php _e( 'Latitude:', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                            </td>
                            <td>
                                <input type="text" name="ai1ec_latitude" id="ai1ec_latitude"
                                    class="ai1ec-coordinates ai1ec-form-control"
                                    value="<?php echo $latitude; ?>">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="ai1ec_longitude">
                                    <?php _e( 'Longitude:', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                            </td>
                            <td>
                                <input type="text" name="ai1ec_longitude" id="ai1ec_longitude"
                                    class="ai1ec-coordinates ai1ec-form-control"
                                    value="<?php echo $longitude; ?>">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="ai1ec-col-md-4 ai1ec-col-lg-6">
                <label for="ai1ec_google_map">
                    <input type="checkbox" value="1" name="ai1ec_google_map"
                        id="ai1ec_google_map" <?php echo $google_map; ?>>
                    <?php _e( 'Show Map', AI1EC_PLUGIN_NAME ); ?>
                </label>
                <div class="ai1ec-map-preview
                    <?php echo $show_map ? 'ai1ec-map-visible' : ''; ?>">
                    <div id="ai1ec_map_canvas"></div>
                </div>
            </div>
        </div>
        <input type="hidden" name="ai1ec_city" id="ai1ec_city" value="<?php echo esc_attr( $city ); ?>">
        <input type="hidden" name="ai1ec_province" id="ai1ec_province" value="<?php echo esc_attr( $province ); ?>">
        <input type="hidden" name="ai1ec_postal_code" id="ai1ec_postal_code" value="<?php echo esc_attr( $postal_code ); ?>">
        <input type="hidden" name="ai1ec_country" id="ai1ec_country" value="<?php echo esc_attr( $country ); ?>">
        <input type="hidden" name="ai1ec_country_short" id="ai1ec_country_short" value="">
    </div>
</div>


==================================================
FILE PATH: ./public/admin/box_inline_warning.php
==================================================
<?php ?>
<div id="ai1ec_event_inline_alert" class="timely ai1ec-alert ai1ec-alert-danger ai1ec-hidden"></div>

==================================================
FILE PATH: ./public/admin/feeds_settings.php
==================================================
<div class="wrap">

    <h2><?php echo $title; ?></h2>

    <div id="poststuff">

            <div class="metabox-holder">
                <div class="post-box-container ai1ec-feeds-page left-side timely">
                    <?php do_meta_boxes( $settings_page, 'left', null ); ?>
                </div>
            </div>

    </div><!-- #poststuff -->

</div><!-- .wrap -->


==================================================
FILE PATH: ./public/admin/agenda-widget-form.php
==================================================
<p>
    <label for="<?php echo $title['id'] ?>"><?php _e( 'Title:', AI1EC_PLUGIN_NAME ) ?></label>
    <input class="widefat" id="<?php echo $title['id'] ?>" name="<?php echo $title['name'] ?>" type="text" value="<?php echo $title['value'] ?>" />
</p>

<p>
    <input type="radio" id="<?php echo $events_seek_type['id']; ?>_events" name="<?php echo $events_seek_type['name']; ?>" value="events"<?php
    if ( 'events' === $events_seek_type['value'] ) {
        echo ' checked="checked"';
    }
    ?> />
    <label for="<?php echo $events_seek_type['id']; ?>_events"><?php _e( 'Number of events to show:', AI1EC_PLUGIN_NAME ) ?></label>
    <input id="<?php echo $events_per_page['id'] ?>" name="<?php echo $events_per_page['name'] ?>" type="text" size="3" value="<?php echo $events_per_page['value'] ?>" />
</p>
<p>
    <input type="radio" id="<?php echo $events_seek_type['id']; ?>_days" name="<?php echo $events_seek_type['name']; ?>" value="days"<?php
    if ( 'days' === $events_seek_type['value'] ) {
        echo ' checked="checked"';
    }
    ?> />
    <label for="<?php echo $events_seek_type['id']; ?>_days"><?php _e( 'Number of days to show:', AI1EC_PLUGIN_NAME ) ?></label>
    <input id="<?php echo $days_per_page['id'] ?>" name="<?php echo $days_per_page['name'] ?>" type="text" size="3" value="<?php echo $days_per_page['value'] ?>" />
</p>

<p class="ai1ec-limit-by-container">
    <?php _e( 'Limit to:', AI1EC_PLUGIN_NAME ); ?>
    <br />
    <!-- Limit by Category -->
    <input id="<?php echo $limit_by_cat['id'] ?>" class="ai1ec-limit-by-cat" name="<?php echo $limit_by_cat['name'] ?>" type="checkbox" value="1" <?php if( $limit_by_cat['value'] ) echo 'checked="checked"' ?> />
    <label for="<?php echo $limit_by_cat['id'] ?>"><?php _e( 'Events with these <strong>Categories</strong>', AI1EC_PLUGIN_NAME ) ?></label>
</p>
<div class="ai1ec-limit-by-options-container" <?php if( ! $limit_by_cat['value'] ) { ?> style="display: none;" <?php } ?>>
    <!-- Limit by Category Select box -->
    <select id="<?php echo $cat_ids['id'] ?>" class="ai1ec-widget-cat-ids" name="<?php echo $cat_ids['name'] ?>[]" size="5" multiple="multiple">
        <?php foreach( $cat_ids['options'] as $event_cat ): ?>
            <option value="<?php echo $event_cat->term_id; ?>"<?php if( in_array( $event_cat->term_id, $cat_ids['value'] ) ) { ?> selected="selected"<?php } ?>><?php echo $event_cat->name; ?></option>
        <?php endforeach ?>
        <?php if( count( $cat_ids['options'] ) == 0 ) : ?>
            <option disabled><?php _e( 'No categories found.', AI1EC_PLUGIN_NAME ) ?></option>
        <?php endif ?>
    </select>
</div>
<p class="ai1ec-limit-by-container">
    <!-- Limit by Tag -->
    <input id="<?php echo $limit_by_tag['id'] ?>" class="ai1ec-limit-by-tag" name="<?php echo $limit_by_tag['name'] ?>" type="checkbox" value="1" <?php if( $limit_by_tag['value'] ) echo 'checked="checked"' ?> />
    <label for="<?php echo $limit_by_tag['id'] ?>"><?php _e( '<strong>Or</strong> events with these <strong>Tags</strong>', AI1EC_PLUGIN_NAME ) ?></label>
</p>
<div class="ai1ec-limit-by-options-container" <?php if( ! $limit_by_tag['value'] ) { ?> style="display: none;" <?php } ?>>
    <!-- Limit by Tag Select box -->
    <select id="<?php echo $tag_ids['id'] ?>" class="ai1ec-widget-tag-ids" name="<?php echo $tag_ids['name'] ?>[]" size="5" multiple="multiple">
        <?php foreach( $tag_ids['options'] as $event_tag ): ?>
            <option value="<?php echo $event_tag->term_id; ?>"<?php if( in_array( $event_tag->term_id, $tag_ids['value'] ) ) { ?> selected="selected"<?php } ?>><?php echo $event_tag->name; ?></option>
        <?php endforeach ?>
        <?php if( count( $tag_ids['options'] ) == 0 ) : ?>
            <option disabled><?php _e( 'No tags found.', AI1EC_PLUGIN_NAME ) ?></option>
        <?php endif ?>
    </select>
</div>
<br />
<p>
    <input id="<?php echo $show_calendar_button['id'] ?>" name="<?php echo $show_calendar_button['name'] ?>" type="checkbox" value="1" <?php if( $show_calendar_button['value'] ) echo 'checked="checked"' ?> />
    <label for="<?php echo $show_calendar_button['id'] ?>"><?php _e( 'Show <strong>View Calendar</strong> button', AI1EC_PLUGIN_NAME ) ?></label>
    <br />
    <input id="<?php echo $show_subscribe_buttons['id'] ?>" name="<?php echo $show_subscribe_buttons['name'] ?>" type="checkbox" value="1" <?php if( $show_subscribe_buttons['value'] ) echo 'checked="checked"' ?> />
    <label for="<?php echo $show_subscribe_buttons['id'] ?>"><?php _e( 'Show <strong>Subscribe</strong> buttons', AI1EC_PLUGIN_NAME ) ?></label>
    <br />
    <input id="<?php echo $hide_on_calendar_page['id'] ?>" name="<?php echo $hide_on_calendar_page['name'] ?>" type="checkbox" value="1" <?php if( $hide_on_calendar_page['value'] ) echo 'checked="checked"' ?> />
    <label for="<?php echo $hide_on_calendar_page['id'] ?>"><?php _e( 'Hide this widget on calendar page', AI1EC_PLUGIN_NAME ) ?></label>
</p>


==================================================
FILE PATH: ./public/admin/row_custom.php
==================================================
<div class="ai1ec-form-group">
    <label class="ai1ec-control-label ai1ec-col-sm-3">
        <?php _e( 'Custom dates:', AI1EC_PLUGIN_NAME ) ;?>
    </label>
    <div class="ai1ec-col-sm-8">
        <div id="ai1ec_recurrence_calendar" data-date="<?php echo $selected_dates; ?>"></div>
    </div>
</div>
<div class="ai1ec-form-group">
    <div class="ai1ec-col-sm-9 ai1ec-col-sm-offset-3">
        <div id="ai1ec_rec_dates_list"></div>
        <input type="hidden" name="ai1ec_rec_custom_dates"
            id="ai1ec_rec_custom_dates" value="">
    </div>
</div>


==================================================
FILE PATH: ./public/admin/feed_row.php
==================================================
<div class="ai1ec-panel ai1ec-panel-default ai1ec-feed-container">
    <div class="ai1ec-panel-heading">
        <a data-toggle="ai1ec-collapse"
           data-parent="#ai1ec-feeds-accordion"
           href="#ai1ec-feed-<?php echo $feed_id; ?>">
            <?php echo parse_url( trim( $feed_url ), PHP_URL_HOST ); ?>
        </a>
    </div>
    <div class="ai1ec-panel-collapse ai1ec-collapse"
         id="ai1ec-feed-<?php echo $feed_id; ?>">
        <div class="ai1ec-panel-body">
            <div class="ai1ec-feed-content">
                <div class="ai1ec-form-group">
                    <div class="ai1ec-col-sm-1">
                        <label class="ai1ec-feed-url-label">
                            <?php _e( 'Feed URL:', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </div>
                    <div class="ai1ec-col-sm-11">
                        <input type="text" class="ai1ec-feed-url ai1ec-form-control"
                            readonly="readonly" value="<?php echo esc_attr( $feed_url ) ?>">
                    </div>
                </div>
                <input type="hidden" name="feed_id" class="ai1ec_feed_id"
                    value="<?php echo $feed_id; ?>">
                <div>
                    <div class="ai1ec-clearfix">
                        <?php if ( $event_category ) : ?>
                            <div class="ai1ec-feed-category"
                                 data-ids="<?php echo esc_attr( $categories_ids ); ?>">
                                <?php _e( 'Event categories:', AI1EC_PLUGIN_NAME ); ?>
                                <strong><?php echo $event_category; ?></strong>
                            </div>
                        <?php endif; ?>
                        <?php if ( $tags ) : ?>
                            <div class="ai1ec-feed-tags ai1ec-pull-left"
                                 data-ids="<?php echo esc_attr( $tags_ids ); ?>">
                                <?php _e( 'Tag with', AI1EC_PLUGIN_NAME ); ?>:
                                <strong><?php echo $tags; ?></strong>
                            </div>
                        <?php endif; ?>
                    </div>
                    <?php do_action( 'ai1ec_ics_row_after_categories_tags', $feed_id ); ?>
                    <div class="ai1ec-clearfix">
                        <div class="ai1ec-feed-comments-enabled"
                             data-state="<?php echo esc_attr( $comments_enabled ? 1 : 0 ); ?>">
                            <?php _e( 'Allow comments', AI1EC_PLUGIN_NAME ); ?>:
                            <strong><?php
                            if ( $comments_enabled ) {
                                _e( 'Yes', AI1EC_PLUGIN_NAME );
                            } else {
                                _e( 'No',  AI1EC_PLUGIN_NAME );
                            }
                            ?></strong>
                        </div>
                        <div class="ai1ec-feed-map-display-enabled"
                             data-state="<?php echo esc_attr( $map_display_enabled ? 1 : 0 ); ?>">
                            <?php _e( 'Show map', AI1EC_PLUGIN_NAME ); ?>:
                            <strong><?php
                            if ( $map_display_enabled ) {
                                _e( 'Yes', AI1EC_PLUGIN_NAME );
                            } else {
                                _e( 'No',  AI1EC_PLUGIN_NAME );
                            }
                            ?></strong>
                        </div>
                    </div>
                    <div class="ai1ec-feed-keep-tags-categories"
                         data-state="<?php echo esc_attr( $keep_tags_categories ? 1 : 0 ); ?>">
                        <?php _e( 'Keep original events categories and tags', AI1EC_PLUGIN_NAME ); ?>:
                        <strong><?php
                        if ( $keep_tags_categories ) {
                            _e( 'Yes', AI1EC_PLUGIN_NAME );
                        } else {
                            _e( 'No',  AI1EC_PLUGIN_NAME );
                        }
                        ?></strong>
                    </div>
                    <?php do_action( 'ai1ec_ics_row_after_keep_categories_tags', $feed_id ); ?>
                    <div class="ai1ec-feed-keep-old-events"
                         data-state="<?php echo esc_attr( $keep_old_events ? 1 : 0 ); ?>">
                        <?php _e( 'On refresh, preserve previously imported events that are missing from the feed', AI1EC_PLUGIN_NAME ); ?>:
                        <strong><?php
                        if ( $keep_old_events ) {
                            _e( 'Yes', AI1EC_PLUGIN_NAME );
                        } else {
                            _e( 'No',  AI1EC_PLUGIN_NAME );
                        }
                        ?></strong>
                    </div>
                    <div class="ai1ec-feed-import-timezone"
                         data-state="<?php echo esc_attr( $feed_import_timezone ? 1 : 0 ); ?>">
                            <?php _e( 'Convert event\'s date/time to calendar\'s timezone', AI1EC_PLUGIN_NAME ); ?>:
                        <strong><?php
                            if ( $feed_import_timezone ) {
                                _e( 'Yes', AI1EC_PLUGIN_NAME );
                            } else {
                                _e( 'No',  AI1EC_PLUGIN_NAME );
                            } ?>
                        </strong>
                    </div>

                    <?php if ( sizeof( $feed_events_uids ) > 0 ) : ?>
                    <div class="ai1ec-feed-category"
                         data-ids="<?php echo esc_attr( $categories_ids ); ?>"><br />
                        <label><?php _e( 'List of imported events:', AI1EC_PLUGIN_NAME ); ?></label>
                            <br />
                            <strong>
                            <?php
                                foreach ( $feed_events_uids as $feed_event_uid => $feed_event_title ):?>
                                    <div class="ai1ec-myfeeds-event"
                                         data-event-id="<?php echo esc_attr( $feed_event_uid ); ?>"
                                         data-feed-id="<?php echo esc_attr( $feed_name ); ?>">
                                        <?php echo $feed_event_title; ?>&nbsp;&nbsp;
                                        <a href="#" class="ai1ec-btn ai1ec-btn-secondary ai1ec-btn-xs ai1ec-text-warning
                                                           ai1ec-disabled ai1ec-hidden ai1ec-suggested-removing">
                                            <?php _e( 'Removing', AI1EC_PLUGIN_NAME ); ?>&hellip;
                                        </a>
                                        <a href="#" class="ai1ec-btn ai1ec-btn-secondary ai1ec-btn-xs ai1ec-text-danger
                                                           ai1ec-suggested-remove-event">
                                            <i class="ai1ec-fa ai1ec-fa-minus ai1ec-fa-xs ai1ec-fa-fw"></i>
                                            <?php _e( 'Remove', AI1EC_PLUGIN_NAME ); ?>
                                        </a>
                                    </div>
                                <?php endforeach; ?>
                            </strong>
                        </div>
                    <?php endif; ?>
                </div>
                <div>
                    <div class="ai1ec-btn-group ai1ec-pull-right ai1ec-feed-actions">
                        <?php
                            if ( $api_signed ):
                        ?>
                        <button type="button"
                            class="ai1ec-btn ai1ec-btn-sm ai1ec-btn-default ai1ec-text-primary
                                ai1ec_update_ics"
                            data-loading-text="<?php echo esc_attr(
                                '<i class="ai1ec-fa ai1ec-fa-refresh ai1ec-fa-spin ai1ec-fa-fw"></i> ' .
                                __( 'Refreshing&#8230;', AI1EC_PLUGIN_NAME ) ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-refresh ai1ec-fa-fw"></i>
                            <?php _e( 'Refresh', AI1EC_PLUGIN_NAME ); ?>
                        </button>
                        <button type="button"
                            class="ai1ec-btn ai1ec-btn-sm ai1ec-btn-default ai1ec-text-warning
                                ai1ec_edit_ics">
                            <i class="ai1ec-fa ai1ec-fa-edit ai1ec-fa-fw"></i>
                            <?php _e( 'Edit', AI1EC_PLUGIN_NAME ); ?>
                        </button>
                        <?php
                            endif;
                        ?>
                        <button type="button"
                            class="ai1ec-btn ai1ec-btn-sm ai1ec-btn-default ai1ec-text-danger
                                ai1ec_delete_ics"
                            data-loading-text="<?php echo esc_attr(
                                '<i class="ai1ec-fa ai1ec-fa-spinner ai1ec-fa-spin ai1ec-fa-fw"></i> ' .
                                __( 'Removing&#8230;', AI1EC_PLUGIN_NAME ) ); ?>">
                            <i class="ai1ec-fa ai1ec-fa-times ai1ec-fa-fw"></i>
                            <?php _e( 'Remove', AI1EC_PLUGIN_NAME ); ?>
                        </button>
                    </div>
                </div>
                <?php do_action( 'ai1ec_ics_row_after_settings', $feed_id ); ?>
            </div>
        </div>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/subscription_button.php
==================================================
<?php ?>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
    <input type="hidden" name="cmd" value="_s-xclick" />
    <input type="hidden" name="hosted_button_id" value="RGE42APRSL5UA" />
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_subscribeCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" />
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1" />
</form>

==================================================
FILE PATH: ./public/admin/box_event_contact.php
==================================================
<div class="ai1ec-panel-heading">
    <a data-toggle="ai1ec-collapse"
        data-parent="#ai1ec-add-new-event-accordion"
        href="#ai1ec-event-contact-box">
        <i class="ai1ec-fa ai1ec-fa-phone ai1ec-fa-fw"></i>
        <?php _e( 'Organizer contact info', AI1EC_PLUGIN_NAME ); ?>
        <i class="ai1ec-fa ai1ec-fa-warning ai1ec-fa-fw ai1ec-hidden"></i>
    </a>
</div>
<div id="ai1ec-event-contact-box" class="ai1ec-panel-collapse ai1ec-collapse">
    <div class="ai1ec-panel-body">
        <table class="ai1ec-form">
            <tbody>
                <tr>
                    <td class="ai1ec-first">
                        <label for="ai1ec_contact_name">
                            <?php _e( 'Contact name:', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </td>
                    <td>
                        <input type="text" name="ai1ec_contact_name"
                            id="ai1ec_contact_name"
                            class="ai1ec-form-control"
                            value="<?php echo esc_attr( $contact_name ); ?>">
                    </td>
                    <?php if ( null !== $submitter_html ): ?>
                    <td rowspan="4" style="vertical-align: top;">
                        <?php echo $submitter_html; ?>
                    </td>
                    <?php endif; ?>
                </tr>
                <tr>
                    <td>
                        <label for="ai1ec_contact_phone">
                            <?php _e( 'Phone:', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </td>
                    <td>
                        <input type="text" name="ai1ec_contact_phone"
                            id="ai1ec_contact_phone"
                            class="ai1ec-form-control"
                            value="<?php echo esc_attr( $contact_phone ); ?>">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="ai1ec_contact_email">
                            <?php _e( 'E-mail:', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </td>
                    <td>
                        <input type="text" name="ai1ec_contact_email"
                            id="ai1ec_contact_email"
                            class="ai1ec-form-control"
                            value="<?php echo esc_attr( $contact_email ); ?>">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="ai1ec_contact_url">
                            <?php _e( 'Website URL:', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </td>
                    <td>
                        <input type="text" name="ai1ec_contact_url"
                            id="ai1ec_contact_url"
                            class="ai1ec-form-control"
                            value="<?php echo esc_attr( $contact_url ); ?>">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/row_daily.php
==================================================
<div class="ai1ec-form-group">
  <label for="ai1ec_daily_count" class="ai1ec-control-label ai1ec-col-sm-3">
      <?php _e( 'Every', AI1EC_PLUGIN_NAME ); ?>:
  </label>
  <div class="ai1ec-col-sm-9">
    <?php echo $count; ?>
  </div>
</div>


==================================================
FILE PATH: ./public/admin/box_profile_timezone.php
==================================================
<h3><a name="ai1ec"><?php
_e( 'All-in-One Event Calendar', AI1EC_PLUGIN_NAME );
?></a></h3>
<table class="ai1ec-form">
    <tbody>
        <tr>
            <td class="ai1ec-first">
                <label for="ai1ec_user_timezone">
                    <?php _e( 'Your preferred timezone', AI1EC_PLUGIN_NAME ); ?>?
                </label>
            </td>
            <td>
                <select name="ai1ec_user_timezone" id="ai1ec_user_timezone">
                <?php echo $tz_selector; ?>
                </select>
            </td>
        </tr>
    </tbody>
</table>


==================================================
FILE PATH: ./public/admin/box_event_cost.php
==================================================
<div class="ai1ec-panel-heading">
    <a data-toggle="ai1ec-collapse"
        data-parent="#ai1ec-add-new-event-accordion"
        href="#ai1ec-event-cost-box">
        <i class="ai1ec-fa ai1ec-fa-shopping-cart ai1ec-fa-fw"></i>
        <?php _e( 'Event cost and Tickets', AI1EC_PLUGIN_NAME ); ?>
        <i class="ai1ec-fa ai1ec-fa-warning ai1ec-fa-fw ai1ec-hidden"></i>
    </a>
</div>
<div id="ai1ec-event-cost-box" class="ai1ec-panel-collapse ai1ec-collapse">
    <?php
        if ( ! is_null( $tax_options ) ) {
            foreach ( get_object_vars ( $tax_options ) as $key => $value ) {
                if ( ! is_null( $value ) ) {
                    echo '<input type="hidden" name="tax_options['. $key .']" value="'. $value . '">';
                }
            }
        }
    ?>
    <input type="hidden" name="ai1ec_uid" value="<?php echo $uid;?>">
    <input type="hidden" id="ai1ec_editing_ticket" value="<?php echo $is_ticket_event ? 1 : 0;?>">
    <?php if ( $tickets_loading_error ):?>
        <input type="hidden" name="ai1ec_tickets_loading_error" value="<?php echo htmlentities( $tickets_loading_error ); ?>">
    <?php endif; ?>
    <div class="ai1ec-panel-body">

    <?php
    if ( $ticket_event_imported ):?>
        <p><?php _e( 'Cost options not available, this event was imported from an external calendar.', AI1EC_PLUGIN_NAME ); ?></p>
    <?php
    elseif ( $tickets_loading_error ): ?>
        <p><?php echo $tickets_loading_error; ?></p>
    <?php elseif ( $is_ticket_event && ! $ticketing ): ?>
        <p><?php echo sprintf(
            __( 'This event was created using Timely Network. Sign in with the account %s to see the Ticket options.', AI1EC_PLUGIN_NAME ),
        $ticket_event_account ); ?></p>
        <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-tickets"
               class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg">
                <?php _e( 'Sign In for Timely Network', AI1EC_PLUGIN_NAME ); ?>
        </a>
    <?php else: ?>

        <div class="ai1ec-cost-types">
            <label for="ai1ec_no_tickets">
                <input type="radio" value="free" id="ai1ec_no_tickets"
                       name="ai1ec_cost_type" <?php if ( 'free' == $cost_type ) { echo 'checked'; } ?>>
                <?php _e( 'No Tickets', AI1EC_PLUGIN_NAME ); ?>
            </label>

            <label for="ai1ec_has_tickets">
                <input type="radio" value="tickets" id="ai1ec_has_tickets"
                       name="ai1ec_cost_type" <?php if ( 'tickets' == $cost_type ) { echo 'checked'; } ?>>
                <?php _e( 'Time.ly Tickets', AI1EC_PLUGIN_NAME ); ?>
            </label>

            <label for="ai1ec_external_tickets">
                <input type="radio" value="external" id="ai1ec_external_tickets"
                       name="ai1ec_cost_type" <?php if ( 'external' == $cost_type ) { echo 'checked'; } ?>>
                <?php _e( 'External Tickets', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>


        <?php
        if ( ! $ticketing ): ?>
            <div class="ai1ec-panel ai1ec-tickets-panel ai1ec-tickets-form">
                <?php
                if ( ! $tickets_message ): ?>
                    <p><?php _e( 'Ticketing allows you to sell tickets directly to the users.', AI1EC_PLUGIN_NAME ); ?></p>
                    <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-settings"
                       class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg">
                            <?php _e( 'Sign Up for Timely Network', AI1EC_PLUGIN_NAME ); ?>
                    </a>
                <?php
                else:
                    echo "<p>$tickets_message</p>";
                endif; ?>
            </div>
        <?php
        elseif ( ! $valid_payout_details ): ?>
            <div class="ai1ec-panel ai1ec-tickets-panel ai1ec-tickets-form">
                <p><?php _e( 'Please, provide valid payout details to use Ticketing.', AI1EC_PLUGIN_NAME ); ?></p>
                <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-tickets"
                   class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg">
                        <?php _e( 'Ticketing Settings', AI1EC_PLUGIN_NAME ); ?>
                </a>
            </div>
        <?php
        else:

            $i = 0;
            foreach ( $tickets as $ticket ):

        ?>

            <div class="ai1ec-panel ai1ec-tickets-panel ai1ec-tickets-form ai1ec-tickets-edit-form
                 <?php if ( 0 === $i ){ echo 'ai1ec-tickets-form-template';} ?>"
                 data-count="<?php echo $i;?>">
                <a href="#" class="ai1ec-btn ai1ec-btn-lg ai1ec-pull-right ai1ec-remove-ticket"
                   alt="" title="<?php _e( 'Remove Ticket Type', AI1EC_PLUGIN_NAME ); ?>">
                    <i class="ai1ec-fa ai1ec-fa-times"></i>
                </a>
                <?php if ( isset( $ticket->id ) ):?>
                    <input type="hidden" name="id" value="<?php echo esc_attr( $ticket->id );?>" />
                <?php endif; ?>
                <?php if ( isset( $ticket->taken ) ):?>
                    <input type="hidden" id="ai1ec-ticket-taken" name="taken" value="<?php echo esc_attr( $ticket->taken );?>" />
                <?php endif; ?>
                <?php if ( isset( $ticket->created_at ) ):?>
                    <input type="hidden" name="created_at" value="<?php echo esc_attr( $ticket->created_at );?>" />
                <?php endif; ?>
                <table class="ai1ec-form ai1ec-tickets-form">
                    <tbody>
                        <tr>
                            <td><?php _e( 'Title:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td>
                                <div class="ai1ec-ticket-field-error">
                                    <?php _e( 'This field is required.', AI1EC_PLUGIN_NAME ); ?>
                                </div>
                                <input class="ai1ec-form-control ai1ec-required"
                                       id="ai1ec_new_ticket_name"
                                       name="ticket_name"
                                       value="<?php if ( isset( $ticket->ticket_name ) ){echo esc_attr( $ticket->ticket_name );}?>"
                                       placeholder="<?php _e( 'Ex.: Regular Ticket', AI1EC_PLUGIN_NAME ); ?>">
                            </td>
                        </tr>
                        <tr>
                            <td><?php _e( 'Description:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td>
                                <input class="ai1ec-form-control"
                                       id="ai1ec_new_ticket_description"
                                       name="description"
                                       value="<?php if ( isset( $ticket->description ) ){echo esc_attr( $ticket->description );}?>"
                                       placeholder="<?php _e( '(Optional)', AI1EC_PLUGIN_NAME ); ?>">
                            </td>
                        </tr>
                        <tr>
                            <td class="ai1ec-first"><?php _e( 'Price:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td>
                                <div class="ai1ec-ticket-field-error">
                                    <?php _e( 'This field is required.', AI1EC_PLUGIN_NAME ); ?>
                                </div>
                                <input class="ai1ec-form-control ai1ec-required"
                                       name="ticket_price"
                                       value="<?php if ( isset( $ticket->ticket_price ) ){echo esc_attr( $ticket->ticket_price );}?>"
                                       id="ai1ec_ticket_price"
                                       >
                                <?php echo $ticket_currency; ?>
                            </td>
                        </tr>
                        <tr class="ai1ec-tickets-limits">
                            <td><?php _e( 'Limits:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td>
                                <div class="ai1ec-ticket-field-error">
                                    <?php _e( 'This fields are required.', AI1EC_PLUGIN_NAME ); ?>
                                </div>
                                <label for="ai1ec_buy_min_limit">
                                    <?php _e( 'Min:', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                                <input type="number"
                                       class="ai1ec-form-control ai1ec-required"
                                       id="ai1ec_buy_min_limit"
                                       name="buy_min_limit"
                                       min="0"
                                       data-default="0"
                                       value="<?php if ( isset( $ticket->buy_min_limit ) ){echo esc_attr( $ticket->buy_min_limit ); } else {echo 0;}?>">
                                <label for="ai1ec_buy_max_limit">
                                    <?php _e( 'Max:', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                                <input type="number"
                                       class="ai1ec-form-control ai1ec-required"
                                       id="ai1ec_buy_max_limit"
                                       name="buy_max_limit"
                                       min="0"
                                       data-default="25"
                                       value="<?php if ( isset( $ticket->buy_max_limit ) ){echo esc_attr( $ticket->buy_max_limit );} else {echo 25;}?>">
                            </td>
                        </tr>
                        <tr>
                            <td><?php _e( 'Quantity:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td>
                                <label>
                                    <input type="checkbox" id="ai1ec_ticket_unlimited"
                                           name="unlimited"
                                        <?php
                                            if ( isset( $ticket->unlimited ) && 'on' == $ticket->unlimited ) { echo 'checked="checked"';}
                                        ?>
                                    >
                                    <?php _e( 'Unlimited', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                                <input type="number" class="ai1ec-form-control" id="ai1ec_ticket_quantity"
                                       name="quantity" min="0" data-default="100"
                                    <?php
                                        if ( isset( $ticket->unlimited ) && 'on' == $ticket->unlimited ) {
                                            echo 'value="100"';
                                        } else {
                                            if ( isset ( $ticket->quantity ) ) {
                                                echo 'value="' . esc_attr( $ticket->quantity ) . '"; style="display:inline-block"';
                                            }
                                        }
                                    ?>
                                >
                            </td>
                        </tr>
                        <tr>
                            <td><?php _e( 'Available:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td class="ai1ec-avail-block">
                                <label>
                                    <input type="checkbox" id="ai1ec_ticket_avail"
                                           name="availibility"
                                           <?php
                                                if ( isset( $ticket->availibility ) &&
                                                    'on' == $ticket->availibility ) {
                                                    echo ' checked="checked" ';
                                                }
                                           ?>
                                           >
                                    <?php _e( 'Immediately', AI1EC_PLUGIN_NAME ); ?>
                                </label>
                                <div class="ai1ec-tickets-dates" style="display:
                                    <?php
                                        if ( isset( $ticket->availibility ) &&
                                                   'on' == $ticket->availibility ) {
                                            echo 'none';
                                        } else {
                                            echo 'block';
                                        }
                                    ?>;">
                                    <div>
                                        <div class="ai1ec-tickets-dates-block">
                                            <label><?php _e( 'From:', AI1EC_PLUGIN_NAME ); ?></label>
                                            <input type="text" class="ai1ec-form-control ai1ec-tickets-datepicker"
                                                   data-date-format="yyyy-mm-dd" size="12"
                                                   />
                                            <input type="text" class="ai1ec-form-control ai1ec-tickets-time"
                                                   value="00:00" size="5" maxlength="5"
                                                   /><br>
                                            <input type="hidden" id="ai1ec_ticket_sale_start_date"
                                                   name="ticket_sale_start_date"
                                                   class="ai1ec-tickets-full-date"
                                                <?php
                                                if ( isset( $ticket->ticket_sale_start_date ) ) {
                                                    echo 'value="' . esc_attr( $ticket->ticket_sale_start_date ) . '"';
                                                } else {
                                                    echo 'value="' . str_replace('T', ' ', $start->format_to_javascript( true ) ) . '"';
                                                } ?>
                                                >
                                        </div>
                                        <div class="ai1ec-tickets-dates-block">
                                            <label><?php _e( 'Till:', AI1EC_PLUGIN_NAME ); ?></label>
                                            <input type="text" class="ai1ec-form-control ai1ec-tickets-datepicker"
                                                   data-date-format="yyyy-mm-dd" size="12" />
                                            <input type="text" class="ai1ec-form-control ai1ec-tickets-time"
                                                   value="00:00" size="5" maxlength="5" /><br>
                                            <input type="hidden" id="ai1ec_ticket_sale_end_date"
                                                   name="ticket_sale_end_date"
                                                   class="ai1ec-tickets-full-date"
                                                <?php
                                                if ( isset( $ticket->ticket_sale_end_date ) ){
                                                    echo 'value="' . esc_attr( $ticket->ticket_sale_end_date ) . '"';
                                                } else {
                                                    echo 'value="' . str_replace('T', ' ', $end->format_to_javascript( true ) ) . '"';
                                                } ?>
                                                >
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td><?php _e( 'Status:', AI1EC_PLUGIN_NAME ); ?></td>
                            <td>
                                <table><tr>
                                    <td>
                                        <select class="ai1ec-form-control ai1ec-select2"
                                            id="ai1ec_new_ticket_status"
                                            name="ticket_status">
                                            <option value="open" <?php if ( isset( $ticket->ticket_status )
                                                    && 'open' === $ticket->ticket_status ){echo 'selected';}?>>
                                                <?php _e( 'Open for sale', AI1EC_PLUGIN_NAME ); ?>
                                            </option>
                                            <?php if ( isset( $ticket->id ) ):?>
                                                <option value="closed" <?php if ( isset( $ticket->ticket_status )
                                                        && 'closed' === $ticket->ticket_status ){echo 'selected';}?>>
                                                    <?php _e( 'Sale ended', AI1EC_PLUGIN_NAME ); ?>
                                                </option>
                                                <option value="canceled" <?php if ( isset( $ticket->ticket_status )
                                                        && 'canceled' === $ticket->ticket_status ){echo 'selected';}?>>
                                                    <?php _e( 'Canceled', AI1EC_PLUGIN_NAME ); ?>
                                                </option>
                                            <?php endif; ?>
                                        </select>
                                    </td>
                                    <td>&nbsp;&nbsp;</td>
                                    <td>
                                        <p id="ai1ec-ticket-status-message"></p>
                                    </td>
                                </tr></table>
                            </td>
                        </tr>
                        <?php if ( isset( $ticket->taken ) ) :?>
                            <tr>
                                <td><?php _e( 'Report:', AI1EC_PLUGIN_NAME ); ?></td>
                                <td>
                                    <?php echo sprintf(
                                        __( 'Sold: %d, Left: %s, Reserved: %d', AI1EC_PLUGIN_NAME ),
                                         $ticket->sold,
                                         ( is_null( $ticket->available ) ? __( 'Unlimited', AI1EC_PLUGIN_NAME ) :  $ticket->available ),
                                         ( $ticket->taken - $ticket->sold )
                                         );
                                    ?>
                                </td>
                            </tr>
                        <?php endif; ?>
                    </tbody>
                </table>
            </div>
            <?php $i++; endforeach; ?>

            <div id="ai1ec-ticket-forms"></div>
            <div class="ai1ec-tickets-form">
                <a href="#" class="ai1ec-btn ai1ec-btn-primary"
                   id="ai1ec_add_new_ticket">
                    <i class="ai1ec-fa ai1ec-fa-plus"></i>
                    <?php _e( 'Add New Ticket Type', AI1EC_PLUGIN_NAME ); ?>
                </a>&nbsp;

                <a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-warning
                    <?php echo 1 < count( $tickets ) ? 'ai1ec-hidden' : ''?>"
                   id="ai1ec_tax_options">
                    <i class="ai1ec-fa ai1ec-fa-gears"></i>
                    <div class="ai1ec-ticket-field-error ai1ec-tax-options-button">
                        <?php _e( 'This field is required.', AI1EC_PLUGIN_NAME ); ?>
                    </div>
                    <?php _e( 'Add Tax &amp; Invoice Options (required)', AI1EC_PLUGIN_NAME ); ?>
                </a>
                <a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-warning
                    <?php echo 1 < count( $tickets ) ? '' : 'ai1ec-hidden'?>"
                   id="ai1ec_update_tax_options">
                    <i class="ai1ec-fa ai1ec-fa-gears"></i>
                    <?php _e( 'Update Tax &amp; Invoice Options', AI1EC_PLUGIN_NAME ); ?>
                </a><br />

                <label>
                    <div class="ai1ec-ticket-field-error">
                        <?php _e( 'This field is required.', AI1EC_PLUGIN_NAME ); ?>
                    </div>
                     <input type="checkbox" name="ai1ec_accepted_terms" class="ai1ec-required" value="1" <?php echo 1 < count( $tickets ) ? 'checked' : ''?> />
                    <?php _e( 'I read and accept the <a href="https://time.ly/tos" target="_blank">terms of service</a>.', AI1EC_PLUGIN_NAME ); ?>
                </label>
                <div id="ai1ec_tax_box" class="ai1ec-modal ai1ec-fade">
                    <div class="ai1ec-modal-dialog">
                        <div class="ai1ec-modal-body ai1ec-text-center">
                            <div class="ai1ec-modal-content">
                                <div class="ai1ec-loading">
                                    <i class="ai1ec-fa ai1ec-fa-spinner ai1ec-fa-spin ai1ec-fa-3x"></i>
                                </div>
                                <iframe id="ai1ec_tax_frame" width="100%" height="600" class="ai1ec-hidden"></iframe>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="ai1ec_tax_inputs">
                </div>
            </div>
        <?php endif; ?>

        <div class="ai1ec-no-tickets">
            <table class="ai1ec-form">
                <tbody>
                    <tr>
                        <td class="ai1ec-first">
                            <label for="ai1ec_is_free">
                                <input type="checkbox"
                                       id="ai1ec_is_free"
                                       name="ai1ec_is_free"
                                       value="1"
                                       <?php echo $is_free; ?>>
                                <?php _e( 'Free Event', AI1EC_PLUGIN_NAME ); ?>
                            </label>
                        </td>
                        <td class="ai1ec-tickets-cost
                                   <?php if ( ! empty( $is_free ) ) { echo 'ai1ec-hidden'; }?>">
                            <label for="ai1ec_ticket_ext_cost">
                            <?php _e( 'Cost:', AI1EC_PLUGIN_NAME ); ?>
                                <input class="ai1ec-form-control"
                                       id="ai1ec_ticket_ext_cost"
                                       name="ai1ec_cost"
                                       value="<?php echo esc_attr( $cost ); ?>">
                            </label>
                        </td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="ai1ec-tickets-external">
            <table class="ai1ec-form">
                <tbody>
                    <tr>
                        <td class="ai1ec-first">
                            <span class="ai1ec-tickets-url-text
                                        <?php if ( ! empty( $is_free ) ) { echo 'ai1ec-hidden'; }?>">
                                <?php _e( 'Tickets URL:', AI1EC_PLUGIN_NAME ); ?>
                            </span>
                            <span class="ai1ec-register-url-text
                                        <?php if ( empty( $is_free ) ) { echo 'ai1ec-hidden'; }?>">
                                <?php _e( 'Registration URL:', AI1EC_PLUGIN_NAME ); ?>
                            </span>
                        </td>
                        <td>
                            <input class="ai1ec-form-control"
                                   id="ai1ec_ticket_ext_url"
                                   name="ai1ec_ticket_url"
                                   value="<?php echo esc_attr( $ticket_url ); ?>"
                                   placeholder="http://">
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    <?php endif; ?>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/settings.php
==================================================
<div class="wrap">

    <h2><?php echo $title; ?></h2>

    <div id="poststuff">

        <form method="post" action="" enctype="multipart/form-data">
            <?php wp_nonce_field( 'closedpostboxes', 'closedpostboxesnonce', false ); ?>
            <?php wp_nonce_field( 'meta-box-order', 'meta-box-order-nonce', false ); ?>

            <div class="metabox-holder">
                <div class="post-box-container column-1-ai1ec left-side timely">
                    <?php do_meta_boxes( $settings_page, 'left', null ); ?>
                    <?php
                        // Show the submit button only in the settings page and not in the Feeds page.
                        if ( $calendar_settings ) {
                            submit_button( esc_attr__( 'Update Settings', AI1EC_PLUGIN_NAME ), 'primary', 'ai1ec_save_settings' );
                        }
                    ?>
                </div>
                <div class="post-box-container column-2-ai1ec right-side timely"><?php do_meta_boxes( $settings_page, 'right', null ); ?></div>
            </div>
        </form>

    </div><!-- #poststuff -->

</div><!-- .wrap -->


==================================================
FILE PATH: ./public/admin/save_successful.php
==================================================
<div class="updated">
    <p>
        <strong>
            <?php echo $msg; ?>
        </strong>
    </p>
</div>

==================================================
FILE PATH: ./public/admin/box_time_and_date.php
==================================================
<div class="ai1ec-panel-heading">
    <a data-toggle="ai1ec-collapse"
        data-parent="#ai1ec-add-new-event-accordion"
        href="#ai1ec-time-and-date-box">
        <i class="ai1ec-fa ai1ec-fa-clock-o ai1ec-fa-fw"></i>
        <?php _e( 'Event date and time', AI1EC_PLUGIN_NAME ); ?>
    </a>
</div>
<div id="ai1ec-time-and-date-box"
    class="ai1ec-panel-collapse ai1ec-collapse ai1ec-in">
    <div class="ai1ec-panel-body">
        <?php wp_nonce_field( 'ai1ec', AI1EC_POST_TYPE ); ?>
        <?php if ( $instance_id ) : ?>
            <input type="hidden"
                name="ai1ec_instance_id"
                id="ai1ec_instance-id"
                value="<?php echo $instance_id; ?>">
        <?php endif; ?>
        <table class="ai1ec-form">
            <tbody>
                <tr>
                    <td colspan="2">
                        <label for="ai1ec_all_day_event">
                            <input type="checkbox" name="ai1ec_all_day_event"
                                id="ai1ec_all_day_event" value="1" <?php echo $all_day_event; ?>>
                            <?php _e( 'All-day event', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <label for="ai1ec_instant_event">
                            <input type="checkbox" name="ai1ec_instant_event"
                                id="ai1ec_instant_event" value="1" <?php echo $instant_event; ?>>
                            <?php _e( 'No end time', AI1EC_PLUGIN_NAME ); ?>
                        </label>
                    </td>
                </tr>
                <tr>
                    <td class="ai1ec-first">
                        <label for="ai1ec_start-date-input">
                            <?php _e( 'Start date / time', AI1EC_PLUGIN_NAME ); ?>:
                        </label>
                    </td>
                    <td>
                        <input type="text" class="ai1ec-date-input ai1ec-form-control"
                            id="ai1ec_start-date-input">
                        <input type="text" class="ai1ec-time-input ai1ec-form-control"
                            id="ai1ec_start-time-input">
                        <input type="hidden"
                            name="ai1ec_start_time"
                            id="ai1ec_start-time"
                            value="<?php echo $start->format_to_javascript( true ); ?>">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="ai1ec_end-date-input">
                            <?php _e( 'End date / time', AI1EC_PLUGIN_NAME ); ?>:
                        </label>
                    </td>
                    <td>
                        <input type="text" class="ai1ec-date-input ai1ec-form-control"
                            id="ai1ec_end-date-input">
                        <input type="text" class="ai1ec-time-input ai1ec-form-control"
                            id="ai1ec_end-time-input">
                        <input type="hidden"
                            name="ai1ec_end_time"
                            id="ai1ec_end-time"
                            value="<?php echo $end->format_to_javascript( true ); ?>">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="ai1ec_end-date-input">
                            <?php _e( 'Time zone', AI1EC_PLUGIN_NAME ); ?>:
                        </label>
                    </td>
                    <td>
                        <select name="ai1ec_timezone_name" id="timezone-select">
                            <option value=""><?php _e( 'Choose your time zone', AI1EC_PLUGIN_NAME ); ?></option>
                        <?php foreach ( $timezones_list as $group => $timezones ) : ?>
                            <optgroup label="<?php echo $group;?>">
                        <?php
                            foreach ( $timezones as $timezone ) : ?>
                                <option value="<?php echo $timezone['value'];?>"
                                    <?php echo $timezone['value'] == $timezone_string ? 'selected' : '';?>><?php echo $timezone['text'];?></option>
                            <?php endforeach; ?>
                            </optgroup>
                        <?php endforeach; ?>
                        </select>
                    </td>
                </tr>
                <?php
                $recurrence_attr = '';
                if ( $parent_event_id || $instance_id ) :
                    $recurrence_attr = ' class="ai1ec-hide"';
                endif;
                ?>
                <tr<?php echo $recurrence_attr; ?>>
                    <td>
                        <input type="checkbox" name="ai1ec_repeat" id="ai1ec_repeat"
                                value="1"
                                <?php echo $repeating_event ? 'checked' : ''; ?>>
                        <input type="hidden" name="ai1ec_rrule" id="ai1ec_rrule"
                                value="<?php echo $rrule; ?>">
                        <label for="ai1ec_repeat" id="ai1ec_repeat_label">
                            <?php _e( 'Repeat', AI1EC_PLUGIN_NAME );
                                echo $repeating_event ? ':' : '...'; ?>
                        </label>
                    </td>
                    <td>
                        <div id="ai1ec_repeat_text" class="ai1ec_rule_text">
                            <a href="#ai1ec_repeat_box"><?php echo $rrule_text; ?></a>
                        </div>
                    </td>
                </tr>
                <tr<?php echo $recurrence_attr; ?>>
                    <td>
                        <input type="checkbox" name="ai1ec_exclude" id="ai1ec_exclude"
                                value="1"
                                <?php echo $exclude_event ? 'checked' : ''; ?>
                                <?php echo $repeating_event ? '' : 'disabled'; ?>>
                        <input type="hidden" name="ai1ec_exrule" id="ai1ec_exrule"
                                value="<?php echo $exrule; ?>">
                        <label for="ai1ec_exclude" id="ai1ec_exclude_label">
                            <?php _e( 'Exclude', AI1EC_PLUGIN_NAME );
                                echo $exclude_event ? ':' : '...'; ?>
                        </label>
                    </td>
                    <td>
                        <div id="ai1ec_exclude_text" class="ai1ec_rule_text">
                            <a href="#ai1ec_exclude_box"><?php echo $exrule_text; ?></a>
                        </div>
                        <span class="ai1ec-info-text">
                            (<?php _e( 'Choose a rule for exclusion', AI1EC_PLUGIN_NAME ); ?>)
                        </span>
                    </td>
                </tr>
                <?php // Recurrence modal skeleton ?>
                <div id="ai1ec_repeat_box" class="ai1ec-modal ai1ec-fade">
                    <div class="ai1ec-modal-dialog">
                        <div class="ai1ec-loading ai1ec-modal-content">
                            <div class="ai1ec-modal-body ai1ec-text-center">
                                <i class="ai1ec-fa ai1ec-fa-spinner ai1ec-fa-spin ai1ec-fa-3x"></i>
                            </div>
                        </div>
                    </div>
                </div>

            </tbody>
        </table>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/base_page.php
==================================================
<div class="wrap">

    <h2><?php echo $page->title; ?></h2>

    <div id="poststuff">

        <form method="post" action="">
            <?php wp_nonce_field( 'update', 'simple_page_nonce' ); ?>

            <div class="metabox-holder">
                <div class="post-box-container left-side timely">
                    <?php $template_adapter->display_meta_box( $page->meta_box_id, 'left-side', null ); ?>
                </div>
            </div>
        </form>

    </div><!-- #poststuff -->

</div><!-- .wrap -->


==================================================
FILE PATH: ./public/admin/row_weekly.php
==================================================
<div class="ai1ec-form-group">
  <label for="ai1ec_weekly_count" class="ai1ec-control-label ai1ec-col-sm-3">
      <?php _e( 'Every', AI1EC_PLUGIN_NAME ); ?>:
  </label>
  <div class="ai1ec-col-sm-9">
    <?php echo $count; ?>
  </div>
</div>

<div class="ai1ec-form-group">
  <label class="ai1ec-control-label ai1ec-col-sm-3">
    <?php _ex( 'On', 'Recurrence editor - weekly tab', AI1EC_PLUGIN_NAME ); ?>:
  </label>
  <div class="ai1ec-col-sm-9">
    <?php echo $week_days; ?>
  </div>
</div>


==================================================
FILE PATH: ./public/admin/themes-install.php
==================================================
<?php if( ! validate_current_theme() ) : ?>
    <div id="message1" class="updated">
        <p>
            <?php _e( 'The active theme is broken.  Reverting to the default theme.', AI1EC_PLUGIN_NAME ); ?>
        </p>
    </div>
<?php elseif( isset( $_GET['activated'] ) ) :
        if( isset( $wp_registered_sidebars ) &&
         count( (array) $wp_registered_sidebars ) &&
         current_user_can('edit_theme_options') ) { ?>
            <div id="message2" class="updated">
                <p>
                    <?php printf( __( 'New theme activated. This theme supports widgets, please visit the <a href="%s">widgets settings</a> screen to configure them.', AI1EC_PLUGIN_NAME ),
                        ai1ec_admin_url( 'widgets.php' ) ); ?>
                </p>
            </div>
    <?php } else { ?>
            <div id="message2" class="updated">
                <p>
                    <?php printf( __( 'New theme activated. <a href="%s">Visit site</a>' ), home_url( '/' ) ); ?>
                </p>
            </div>
    <?php } elseif( isset( $_GET['deleted'] ) ) : ?>
            <div id="message3" class="updated">
                <p>
                    <?php _e( 'Theme deleted.', AI1EC_PLUGIN_NAME ) ?>
                </p>
            </div>
    <?php endif; ?>

    <div class="wrap">
        <?php
        if( ! is_multisite() && current_user_can( 'install_themes' ) ) : ?>
            <h2 class="nav-tab-wrapper">
                <a href="<?php echo ai1ec_admin_url( AI1EC_THEME_SELECTION_BASE_URL ) ?>" class="nav-tab nav-tab-active">
                    <?php echo esc_html( __( 'Manage Themes' ) ); ?>
                </a>
                <a href="<?php echo ai1ec_admin_url( AI1EC_THEME_SELECTION_BASE_URL . '-install' ) ?>" class="nav-tab">
                    <?php echo esc_html_x( 'Install Themes', 'theme' ); ?>
                </a>
            </h2>
        <?php else : ?>
            <h2><?php echo esc_html( __( 'Manage Themes' ) ); ?></h2>
        <?php endif; ?>

        <?php echo $html ?>


==================================================
FILE PATH: ./public/admin/themes-updated.php
==================================================
<div class="wrap">

    <h2><?php _e( 'Update Calendar Themes', AI1EC_PLUGIN_NAME ); ?></h2>

    <?php echo $msg; ?>

    <?php if ( $errors ): ?>
        <?php foreach ( $errors as $error ): ?>
            <?php echo $error; ?>
        <?php endforeach; ?>
    <?php endif; ?>

    <p><a class="button" href="<?php echo AI1EC_SETTINGS_BASE_URL; ?>"><?php _e( 'All-in-One Event Calendar Settings ', AI1EC_PLUGIN_NAME ); ?></a></p>
</div>


==================================================
FILE PATH: ./public/admin/import.php
==================================================
<div class="wrap">
    <table class="form-table">
        <tbody>
            <tr valign="top">
                <th scope="row">
                    <?php _e( 'Successfully imported events:', AI1EC_PLUGIN_NAME ) ?>
                </th>
                <td>
                    <?php echo $imported_events ?>
                </td>
            </tr>
        </tbody>
    </table>
</div>


==================================================
FILE PATH: ./public/admin/video_modal.php
==================================================
<div class="ai1ec-modal ai1ec-fade timely" id="ai1ec-video-modal"
    style="width: 600px; margin-left: -300px; margin-top: -200px;">
    <div class="ai1ec-modal-dialog">
        <div class="ai1ec-modal-content">
            <div class="ai1ec-modal-header">
                <button class="ai1ec-close" data-dismiss="ai1ec-modal"></button>
                <h1><small><?php echo esc_html( $title ); ?></small></h1>
            </div>
            <div id="ai1ec-video"></div>
            <?php if ( isset( $footer ) ): ?>
                <div class="ai1ec-modal-footer">
                    <?php echo $footer; ?>
                </div>
            <?php endif; ?>
        </div>
    </div>
</div>

<script type="text/javascript">
/* <![CDATA[ */
    // TODO: Localize this variable using requirejs-suitable technique rather than
    // this way.
    var ai1ecVideo = {
        youtubeId: '<?php echo $youtube_id; ?>'
    };
/* ]]> */
</script>


==================================================
FILE PATH: ./public/admin/plugins/suggested/feeds_list.php
==================================================
<?php
    if ( 0 === count( $suggested_feeds ) ):
?>
<p class="ai1ec-suggested-no-events"><?php _e( 'No events found.', AI1EC_PLUGIN_NAME ); ?></p>
<?php
    else:
?>
<table class="ai1ec-suggested-events" data-ai1ec-show="list both">
    <tbody>
        <?php foreach ( $suggested_feeds as $event ):?>
        <tr class="ai1ec-suggested-event"
            data-event="<?php echo esc_attr( json_encode( $event ) ); ?>"
            data-event-id="<?php echo $event->id;?>">
            <td class="ai1ec-suggested-image"
                style="background-image:url(<?php
                    if ( isset( $event->image_url ) ) {
                        echo esc_attr( $event->image_url );
                    } else {
                        echo esc_attr( $default_image );
                    }?>)">&nbsp;
            </td>
            <td class="ai1ec-suggested-content">
                <a href="#" class="ai1ec-suggested-title" data-url="<?php echo $event->url;?>">
                    <?php if ( isset( $event->longitude ) && isset( $event->latitude ) ):?>
                        <i class="ai1ec-fa ai1ec-fa-map-marker ai1ec-fa-xs ai1ec-fa-fw"></i>
                    <?php endif; ?>
                    <?php echo strip_tags( $event->title );?>
                </a>
                <div class="ai1ec-suggested-date">
                    <?php
                        $date = new DateTime( $event->dtstart );
                        echo $date->format( 'l jS M \'y' ) . ' @ ';
                        echo $event->venue_name;
                    ?>
                </div>
                <div class="ai1ec-suggested-description" data-ai1ec-show="list">
                    <?php echo strip_tags( $event->description ) ;?>
                </div>
            </td>
            <td class="ai1ec-suggested-event-actions">
                <?php echo $event_actions; ?>
            </td>
        </tr>
        <?php endforeach; ?>
    </tbody>
</table>
<?php
    endif;
?>
<div class="ai1ec-feeds-pagination">
<?php
if ( $page_links ) {
    echo '<div class="tablenav"><div class="tablenav-pages">'
        . $page_links
    . '</div></div>';
}
?>
</div>

==================================================
FILE PATH: ./public/admin/plugins/suggested/display_feeds.php
==================================================
<?php
    if ( ! $api_signed ):
?>
<div class="ai1ec-ics-signup-box">
    <p>
        <?php _e( 'Please, Sign In to <b>Timely Network</b> to manage your feeds.', AI1EC_PLUGIN_NAME ) ?>
    </p>
    <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-settings"
       class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-md">
        <?php _e( 'Sign In to Timely Network', AI1EC_PLUGIN_NAME ) ?>
    </a>
</div>
<?php
    else:
?>
<div class="ai1ec-form ai1ec-suggested-search-form">
    <label><?php _e( 'Find events matching:', AI1EC_PLUGIN_NAME ); ?>
        <input type="text" placeholder="Ex.: Concert"
               class="ai1ec-form-control" name="term" id="ai1ec_suggested_term" />
    </label>

    <label><?php _e( 'Located in:', AI1EC_PLUGIN_NAME ); ?>
        <input type="text" placeholder="Ex.: Vancouver"
               class="ai1ec-form-control" name="location" id="ai1ec_suggested_location" autocomplete="off"/>
    </label>

    <a href="#" class="ai1ec-btn ai1ec-btn-success" id="ai1ec_suggested_search">
        <i class="ai1ec-fa ai1ec-fa-search"></i>
        <?php _e( 'Search', AI1EC_PLUGIN_NAME ); ?>
    </a>
    <input type="hidden" id="ai1ec_suggested_radius" />
    <input type="hidden" id="ai1ec_suggested_lat" />
    <input type="hidden" id="ai1ec_suggested_lng" />
</div>

<div class="ai1ec-suggested-results">
    <div>
        <b>
            <span class="ai1ec-suggested-results-found">0</span>
            <?php _e( ' events found.', AI1EC_PLUGIN_NAME ); ?>
        </b>
        <?php _e( 'Update settings for the imported events in My feeds tab.', AI1EC_PLUGIN_NAME ); ?>
    </div>
    <div id="ai1ec-discovery-status">&nbsp;</div>
    <div class="ai1ec-suggested-view-selector">
        <a href="#" data-ai1ec-view="map">
            <?php _e( 'Map', AI1EC_PLUGIN_NAME ); ?>
        </a> |
        <a href="#" data-ai1ec-view="both" class="ai1ec-active">
            <?php _e( 'Both', AI1EC_PLUGIN_NAME ); ?>
        </a> |
            <a href="#" data-ai1ec-view="list">
            <?php _e( 'List', AI1EC_PLUGIN_NAME ); ?>
        </a>
    </div>
    <div class="ai1ec-suggested-map-container" data-ai1ec-show="both map">
        <div id="ai1ec_events_extra_details" data-ai1ec-show="both"></div>
        <div id="ai1ec_events_map_canvas"></div>
    </div>
    <div class="ai1ec-feeds-list-container">
    </div>
</div>

<?php
    endif;
?>

<div class="ai1ec-suggested-no-results">

    <h4>
        <i class="ai1ec-fa ai1ec-fa-times-circle"></i>
        <?php _e( 'No events found.', AI1EC_PLUGIN_NAME ); ?>
    </h4>
    <p class="ai1ec-suggested-results-hint">
        <?php _e( 'Please, modify your search criteria and try again.', AI1EC_PLUGIN_NAME ); ?>
    </p>
</div>

<div class="ai1ec-suggested-events-actions-template ai1ec-hidden">
    <?php echo $event_actions; ?>
</div>




==================================================
FILE PATH: ./public/admin/plugins/suggested/event_actions.php
==================================================
<div class="ai1ec-suggested-event-import">
    <a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs
                       ai1ec-suggested-import-event">
        <i class="ai1ec-fa ai1ec-fa-plus ai1ec-fa-xs ai1ec-fa-fw"></i>
        <?php _e( 'Import', AI1EC_PLUGIN_NAME ); ?>
    </a>
    <a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs ai1ec-btn-warning
                       ai1ec-disabled ai1ec-hidden ai1ec-suggested-processing">
        <?php _e( 'Importing', AI1EC_PLUGIN_NAME ); ?>&hellip;
    </a>
    <a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs ai1ec-btn-warning
                       ai1ec-disabled ai1ec-hidden ai1ec-suggested-removing">
        <?php _e( 'Removing', AI1EC_PLUGIN_NAME ); ?>&hellip;
    </a>
    <a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs ai1ec-btn-danger
                       ai1ec-hidden ai1ec-suggested-remove-event">
        <i class="ai1ec-fa ai1ec-fa-minus ai1ec-fa-xs ai1ec-fa-fw"></i>
        <?php _e( 'Remove', AI1EC_PLUGIN_NAME ); ?>
    </a>
</div>

==================================================
FILE PATH: ./public/admin/plugins/general_plugin_settings.php
==================================================
<h2><?php echo $plugin_name; ?></h2>
<?php if ( isset( $plugin_info ) ) : ?>
    <div class="ai1ec-clearfix"><?php echo $plugin_info; ?></div>
<?php endif; ?>
<?php foreach ( $plugin_settings as $setting) : ?>
    <?php
    $description = esc_html( $setting['setting-description'] );
    $value = esc_attr( $setting['setting-value'] );
    $id = esc_attr( $setting['setting-id'] );
    ?>
    <div class="ai1ec-form-group">
        <label class="ai1ec-control-label" for="<?php echo $id; ?>">
            <?php echo $description; ?>
        </label>
        <input name="<?php echo $id; ?>" id="<?php echo $id; ?>" type="text"
            class="ai1ec-form-control" value="<?php echo $value; ?>">
    </div>
<?php endforeach; ?>


==================================================
FILE PATH: ./public/admin/plugins/ics/display_feeds.php
==================================================
<?php
    if ( ! $api_signed ):
?>
<div class="ai1ec-ics-signup-box">
    <p>
        <?php _e( 'Please, Sign In to <b>Timely Network</b> to manage your feeds.', AI1EC_PLUGIN_NAME ) ?>
    </p>
    <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-settings"
       class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-md">
        <?php _e( 'Sign In to Timely Network', AI1EC_PLUGIN_NAME ) ?>
    </a>
</div>
<?php
    endif;
?>
<div id="ics-alerts"></div>
<p></p>
<?php
    if ( $migration ):
?>
<div class="ai1ec-feeds-migration">
    <?php _e(
        '<b>Your feeds will be migrated at the next scheduled refresh (it can take up to one hour).</b><br />
        You can\'t edit or remove them at the moment.
        Please, visit this page later to manage your feeds.',
        AI1EC_PLUGIN_NAME )
    ?>
    <br /><br />
</div>
<?php
    endif;
?>
<h5><?php _e( 'My imported Feeds:', AI1EC_PLUGIN_NAME ) ?></h5>
<div class="timely ai1ec-form-inline ai1ec-panel-group ai1ec-ics-feeds-list
            <?php if ( $migration ):?>ai1ec-feeds-migration<?php endif; ?>"
     id="ai1ec-feeds-accordion">
    <?php echo $feed_rows; ?>
</div>
<br />
<?php
    if ( $single_feed_rows ):
?>
<h5><?php _e( 'My imported Events (click on the feed to see the individually imported events):', AI1EC_PLUGIN_NAME ) ?></h5>
<div class="timely ai1ec-form-inline ai1ec-panel-group ai1ec-ics-single-events
            <?php if ( $migration ):?>ai1ec-feeds-migration<?php endif; ?>"
     id="ai1ec-feeds-accordion">
    <?php echo $single_feed_rows; ?>
</div>
<?php
    endif;
?>
<?php echo $modal->render(); ?>


==================================================
FILE PATH: ./public/admin/plugins/ics/import_feed.php
==================================================
<?php
    $feature      = Ai1ec_Api_Features::CODE_IMPORT_FEEDS;
    $api          = $this->_registry->get( 'model.api.api-feeds' );
    $provided     = $api->subscription_get_quantity_limit( $feature );
    $used         = $api->subscription_get_used_quantity( $feature );

    if ( $provided >= 1000000 ) {
        $provided = __( 'unlimited', AI1EC_PLUGIN_NAME );
    }

    if ( ! $api_signed ):
?>
<div class="ai1ec-ics-signup-box">
    <p>
        <?php _e( 'Please, Sign In to <b>Timely Network</b> to manage your feeds.', AI1EC_PLUGIN_NAME ) ?>
    </p>
    <a href="edit.php?post_type=ai1ec_event&page=all-in-one-event-calendar-settings"
       class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-md">
        <?php _e( 'Sign In to Timely Network', AI1EC_PLUGIN_NAME ) ?>
    </a>
</div>
<?php
    elseif ( ! $has_feature ):
?>
<div class="ai1ec-feed-container ai1ec-well ai1ec-well-sm ai1ec-clearfix">
    <?php _e(
        '<b>You don\'t have a subscription for this feature.</b><br>
        Please <a href="https://time.ly/hosted-calendar-addons/" target="_blank">upgrade here</a> to a plan that
        supports "Import Feeds".', AI1EC_PLUGIN_NAME )
    ?>
</div>
<?php
    elseif ( $reached_limit ):
?>
<div class="ai1ec-feed-container ai1ec-well ai1ec-well-sm ai1ec-clearfix">
    <?php _e(
            sprintf(
                    __( 'You are importing %s feed(s) out of %s.', AI1EC_PLUGIN_NAME ),
                    $used,
                    $provided
            ) )
    ?>
</div>
<div class="ai1ec-feed-container ai1ec-well ai1ec-well-sm ai1ec-clearfix">
    <?php _e(
        '<b>You have reached the limit of how many feeds you can import.</b><br>
        Please sign up for EventBoost plan <a href="https://time.ly/hosted-calendar-addons/" target="_blank">here</a>.', AI1EC_PLUGIN_NAME )
    ?>
</div>
<?php
    else:
?>
<div class="ai1ec-feed-container ai1ec-well ai1ec-well-sm ai1ec-clearfix">
    <?php _e(
            sprintf(
                    __( 'You are importing %s feed(s) out of %s.', AI1EC_PLUGIN_NAME ),
                    $used,
                    $provided
            ) )
    ?>
</div>
<div id="ai1ec-feeds-after"
    class="ai1ec-feed-container ai1ec-well ai1ec-well-sm ai1ec-clearfix">
    <div class="ai1ec-form-group ai1ec-row">
        <div class="ai1ec-col-sm-1">
            <label class="ai1ec-feed-url-label">
                <?php _e( 'Feed URL:', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
        <div class="ai1ec-col-sm-11">
            <input type="text" name="ai1ec_feed_url" id="ai1ec_feed_url"
                class="ai1ec-form-control" maxlength="255">
        </div>
    </div>
    <div class="ai1ec-feeds-edit-fields">
        <div class="ai1ec-row">
            <div class="ai1ec-col-sm-6">
                <?php $event_categories->render(); ?>
            </div>
            <div class="ai1ec-col-sm-6">
                <?php $event_tags->render(); ?>
            </div>
        </div>
        <?php do_action( 'ai1ec_ics_row_after_categories_tags', null ); ?>
        <div class="ai1ec-feed-comments-enabled">
            <label for="ai1ec_comments_enabled">
                <input type="checkbox" name="ai1ec_comments_enabled"
                    id="ai1ec_comments_enabled" value="1">
                <?php _e( 'Allow comments on imported events', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
        <div class="ai1ec-feed-map-display-enabled">
            <label for="ai1ec_map_display_enabled">
                <input type="checkbox" name="ai1ec_map_display_enabled"
                    id="ai1ec_map_display_enabled" value="1">
                <?php _e( 'Show map on imported events', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
        <div class="ai1ec-feed-add-tags-categories">
            <label for="ai1ec_add_tag_categories">
                <input type="checkbox" name="ai1ec_add_tag_categories"
                    id="ai1ec_add_tag_categories" value="1">
                <?php _e( 'Import any tags/categories provided by feed, in addition those selected above', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
        <?php do_action( 'ai1ec_ics_row_after_keep_categories_tags', null ); ?>
        <div class="ai1ec-feed-keep-old-events">
            <label for="ai1ec_keep_old_events">
                <input type="checkbox" name="ai1ec_keep_old_events"
                    id="ai1ec_keep_old_events" value="1">
                <?php _e( 'On refresh, preserve previously imported events that are missing from the feed', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
        <div class="ai1ec-feed-import-timezone">
            <label for="ai1ec_feed_import_timezone">
                <input type="checkbox" name="ai1ec_feed_import_timezones"
                    id="ai1ec_feed_import_timezone" value="1">
                <?php _e( 'Convert event\'s date/time to calendar\'s timezone', AI1EC_PLUGIN_NAME ); ?>
            </label>
        </div>
    </div>
    <div class="ai1ec-feeds-edit-fields">
        <div class="ai1ec-pull-right">
            <button type="button" id="ai1ec_cancel_ics"
                class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-sm ai1ec-hidden">
                <i class="ai1ec-fa ai1ec-fa-cancel"></i>
                <?php _e( 'Cancel', AI1EC_PLUGIN_NAME ); ?>
            </button>
            <button type="button" id="ai1ec_add_new_ics"
                class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-sm"
                data-loading-text="<?php echo esc_attr(
                    '<i class="ai1ec-fa ai1ec-fa-spinner ai1ec-fa-spin ai1ec-fa-fw"></i> ' .
                    __( 'Please wait&#8230;', AI1EC_PLUGIN_NAME ) ); ?>">
                <i class="ai1ec-fa ai1ec-fa-plus"></i>
                <span id="ai1ec_ics_add_new">
                    <?php _e( 'Import feed', AI1EC_PLUGIN_NAME ); ?>
                </span>
                <span id="ai1ec_ics_update" class="ai1ec-hidden">
                    <?php _e( 'Update feed', AI1EC_PLUGIN_NAME ); ?>
                </span>
            </button>
        </div>
    </div>
    <?php do_action( 'ai1ec_ics_row_after_settings', null ); ?>
</div>
<?php
    endif;
?>


==================================================
FILE PATH: ./public/admin/plugins/render_opening_div.php
==================================================
<div class="ai1ec-tab-pane ai1ec-feeds-both" id="<?php echo $id ?>">


==================================================
FILE PATH: ./public/admin/plugins/display_error_message.php
==================================================
<div id="message" class="ai1ec-alert ai1ec-alert-danger">
  <strong>
    <?php echo esc_html( _X( $message, 'calendar-feeds', AI1EC_PLUGIN_NAME ) )?>
  </strong>
</div>



==================================================
FILE PATH: ./public/admin/plugins/tab_header.php
==================================================
<li><a href="<?php echo esc_attr( "#$id" ); ?>" data-toggle="ai1ec-tab">
  <?php echo esc_html( $title ); ?></a>
</li>


==================================================
FILE PATH: ./public/admin/box_support.php
==================================================
<div class="ai1ec-clearfix">
    <div style="float:left; width: calc(100% - 100px);">
        <div class="ai1ec-brought-by">Your calendar is brought to you by:</div>
        <div class="ai1ec-slogan">
            <?php _e( 'Timelys All-in-One Event Calendar is a<br />revolutionary new way to find and share events.', AI1EC_PLUGIN_NAME ); ?>
        </div>
    </div>
    <h2 class="timely-logo" style="float:right">
        <a href="https://time.ly/?utm_source=dashboard&nbsp;utm_medium=button&nbsp;utm_term=ai1ec-pro&nbsp;utm_content=1.11.4&nbsp;utm_campaign=logo"
            title="<?php esc_attr_e( 'Timely', AI1EC_PLUGIN_NAME ); ?>"
            target="_blank">
        </a>
    </h2>

    <div>
        <div class="timely-icon">
            <a href="https://dashboard.time.ly/checkout/extended_views"></a>
        </div>
        <div class="timely-ev">
            <div class="timely-ev-title">
                <?php esc_attr_e( 'EXTENDED VIEWS', AI1EC_PLUGIN_NAME ); ?>
            </div>
            <div>
                <?php _e( 'Add beautiful and dynamic "Posterboard" and "Stream" layouts for your events.<br>Download the add-on, install and activate it, and you\'re set.', AI1EC_PLUGIN_NAME ); ?>
            </div>
            <a href="https://dashboard.time.ly/checkout/extended_views" class="ai1ec-btn ai1ec-btn-primary timely-get-ev">
                Get it now
            </a>
        </div>
    </div>

    <div class="timely-intro" style="clear:both;padding: 10px">
        <div class="ai1ec-support-buttons ai1ec-row">
            <div class="ai1ec-col-lg-4" id="ai1ec-addons-col">
                <a class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-block"
                    target="_blank"
                    href="https://time.ly/calendar-user-guide">
                    <i class="ai1ec-fa ai1ec-fa-book ai1ec-fa-fw"></i>
                    <?php _e( 'Guide', AI1EC_PLUGIN_NAME ); ?>
                </a>
            </div>
            <div class="ai1ec-col-lg-4" id="ai1ec-support-col">
                <a class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-block"
                    target="_blank"
                    href="#" onclick="jQuery('.ai1ec-support-tab').show(); jQuery('.ai1ec-news').hide(); return !1;">
                    <i class="ai1ec-fa ai1ec-fa-comments ai1ec-fa-fw"></i>
                    <?php _e( 'Support', AI1EC_PLUGIN_NAME ); ?>
                </a>
            </div>
            <div class="ai1ec-col-lg-4" id="ai1ec-videos-col">
                <a class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-block"
                    target="_blank"
                    href="https://www.youtube.com/playlist?list=PL0BLCDSrRmI5RJ1Pg4IPQScQQHShQzVn8">
                    <i class="ai1ec-fa ai1ec-fa-film ai1ec-fa-fw"></i>
                    <?php _e( 'Videos', AI1EC_PLUGIN_NAME ); ?>
                </a>
            </div>
        </div>
    </div>


    <div class="ai1ec-support-tab">
        Seems like youre having troubles, and we dont like that. Heres how we can work together to get your issues fixed.
        <br><br>
        <b>Do you have a theme or plugin conflict?</b>
        <br><br>
        First Troubleshooting step click <a target="_blank" href="https://time.ly/resources/troubleshooting/first-troubleshooting-step/">here</a>
        <br><br>
        Note: If the error is being caused by something in your environment (ie. hosting, theme or plugin conflict) - choosing any of our web-application calendars should solve it: <a target="_blank" href="https://time.ly/website-calendar-pricing">https://time.ly/website-calendar-pricing</a>
        <br><br>
        For more details on how we provide support please go to <a target="_blank" href="https://time.ly/wordpress-plugin-support">https://time.ly/wordpress-plugin-support</a>
        <br><br>
    </div>

    <div class="ai1ec-follow-fan">
        <div class="ai1ec-facebook-like-top">
            <script src="//connect.facebook.net/en_US/all.js#xfbml=1"></script>
            <fb:like href="https://www.facebook.com/timelycal" layout="button_count"
                show_faces="true" width="110" font="lucida grande"></fb:like>
        </div>
        <a href="https://twitter.com/_Timely" class="twitter-follow-button">
            <?php _e( 'Follow @_Timely', AI1EC_PLUGIN_NAME ) ?>
        </a>
        <script src="//platform.twitter.com/widgets.js" type="text/javascript">
        </script>
    </div>
</div>


==================================================
FILE PATH: ./public/admin/admin_notices.php
==================================================
<?php
$message_class = isset( $message_type ) ? $message_type : 'updated';
?>
<div class="message <?php echo $message_class ?>">
    <?php if( ! empty( $label ) ) : ?>
    <h3><?php echo $label ?></h3>
    <?php endif;  ?>
    <?php echo $msg ?>
    <?php if( isset( $button ) ) : ?>
        <div><input type="button" class="button <?php echo $button->class ?>" value="<?php echo $button->value ?>" /></div>
        <p></p>
    <?php endif ?>
</div>


==================================================
FILE PATH: ./public/admin/themes.php
==================================================
<?php if( $activated ) : ?>
    <div id="message2" class="updated">
        <p>
            <?php printf( __( 'New theme activated. <a href="%s">Visit site</a>' ), home_url( '/' ) ); ?>
        </p>
    </div>
<?php elseif( $deleted ) : ?>
    <div id="message3" class="updated">
        <p>
            <?php _e( 'Theme deleted.', AI1EC_PLUGIN_NAME ) ?>
        </p>
    </div>
<?php endif; ?>

<style>.timely-themes-wrap img { max-width: 550px; }</style>
<div class="wrap timely-themes-wrap">
    <h2><?php echo esc_html( $page_title ); ?></h2>
    <h3><?php _e( 'Current Calendar Theme', AI1EC_PLUGIN_NAME ); ?></h3>
    <div id="current-theme"<?php echo ( $ct->screenshot ) ? ' class="has-screenshot"' : '' ?>>
    <?php if ( $ct->screenshot ) : ?>
    <img src="<?php echo $ct->theme_root_uri . '/' . $ct->stylesheet . '/' . $ct->screenshot; ?>" alt="<?php esc_attr_e('Current theme preview', AI1EC_PLUGIN_NAME); ?>" />
    <?php endif; ?>
    <h4><?php
        /* translators: 1: theme title, 2: theme version, 3: theme author */
        printf(__('%1$s %2$s by %3$s', AI1EC_PLUGIN_NAME ), $ct->title, $ct->version, $ct->author) ; ?></h4>
    <p class="theme-description"><?php echo $ct->description; ?></p>
    <div class="theme-options">
        <?php if ( $ct->tags ) : ?>
        <p><?php _e( 'Tags:', AI1EC_PLUGIN_NAME ); ?> <?php echo join(', ', $ct->tags); ?></p>
        <?php endif; ?>
    </div>
    <?php theme_update_available($ct); ?>

    </div>

    <br class="clear" />
    <?php
    if (
        ! current_user_can( 'switch_themes' ) &&
        ! current_user_can( 'switch_ai1ec_themes' )
    ) {
        echo '</div>';
        return false;
    }
    ?>

    <h3><?php _e( 'Available Calendar Themes', AI1EC_PLUGIN_NAME ); ?></h3>

    <?php $wp_list_table->display(); ?>

    <br class="clear" />

    </div>


==================================================
FILE PATH: ./public/admin/box_repeat.php
==================================================
<div class="ai1ec-modal-content">

<div class="ai1ec-modal-header">
    <h4 class="ai1ec-modal-title">
        <?php _e( 'Select recurrence pattern:', AI1EC_PLUGIN_NAME ); ?>
    </h4>
</div>

<div class="ai1ec-modal-body ai1ec-form-horizontal">
    <div class="ai1ec-alert ai1ec-alert-danger ai1ec-hide"></div>

    <big>
        <ul class="ai1ec-nav ai1ec-nav-pills ai1ec-row">
            <li class="ai1ec-col-xs-4 ai1ec-col-sm-2 ai1ec-text-center ai1ec-freq-daily ai1ec-freq">
                <a href="#ai1ec_daily_content" data-toggle="ai1ec-tab">
                    <?php _e( 'Daily', AI1EC_PLUGIN_NAME ) ;?>
                </a>
            </li>
            <li class="ai1ec-col-xs-4 ai1ec-col-sm-2 ai1ec-text-center ai1ec-freq-weekly ai1ec-freq">
                <a href="#ai1ec_weekly_content" data-toggle="ai1ec-tab">
                    <?php _e( 'Weekly', AI1EC_PLUGIN_NAME ) ;?>
                </a>
            </li>
            <li class="ai1ec-col-xs-4 ai1ec-col-sm-2 ai1ec-text-center ai1ec-freq-monthly ai1ec-freq">
                <a href="#ai1ec_monthly_content" data-toggle="ai1ec-tab">
                    <?php _e( 'Monthly', AI1EC_PLUGIN_NAME ) ;?>
                </a>
            </li>
            <li class="ai1ec-col-xs-4 ai1ec-col-sm-2 ai1ec-text-center ai1ec-freq-yearly ai1ec-freq">
                <a href="#ai1ec_yearly_content" data-toggle="ai1ec-tab">
                    <?php _e( 'Yearly', AI1EC_PLUGIN_NAME ) ;?>
                </a>
            </li>
            <li class="ai1ec-col-xs-4 ai1ec-col-sm-2 ai1ec-text-center ai1ec-freq-custom ai1ec-freq">
                <a href="#ai1ec_custom_content" data-toggle="ai1ec-tab">
                    <?php _e( 'Custom', AI1EC_PLUGIN_NAME ) ;?>
                </a>
            </li>
        </ul>

        <p></p>
    </big>

    <div class="ai1ec-tab-content" id="ai1ec-tab-content" data-active-freq="<?php echo $selected_tab; ?>">
        <div id="ai1ec_daily_content" data-freq="daily"
            class="ai1ec-tab-pane ai1ec-freq ai1ec-freq-daily">
            <?php echo $row_daily; ?>
        </div>
        <div id="ai1ec_weekly_content" data-freq="weekly"
            class="ai1ec-tab-pane ai1ec-freq ai1ec-freq-weekly">
            <?php echo $row_weekly; ?>
        </div>
        <div id="ai1ec_monthly_content" data-freq="monthly"
            class="ai1ec-tab-pane ai1ec-freq ai1ec-freq-monthly">
            <?php echo $row_monthly; ?>
        </div>
        <div id="ai1ec_yearly_content" data-freq="yearly"
            class="ai1ec-tab-pane ai1ec-freq ai1ec-freq-yearly">
            <?php echo $row_yearly; ?>
        </div>
        <div id="ai1ec_custom_content" data-freq="custom"
            class="ai1ec-tab-pane ai1ec-freq ai1ec-freq-custom">
            <?php echo $row_custom; ?>
        </div>
    </div>
</div>

<div class="ai1ec-modal-footer">
    <div class="ai1ec-form-horizontal ai1ec-text-left ai1ec-end-field">
        <div class="ai1ec-form-group">
            <label for="ai1ec_end" class="ai1ec-control-label ai1ec-col-sm-3">
                <?php _e( 'End', AI1EC_PLUGIN_NAME ); ?>:
            </label>
            <div class="ai1ec-col-sm-9" id="end-input" data-ending-type="<?php echo $ending_type; ?>">
                <?php echo $end; ?>
            </div>
        </div>

        <div id="ai1ec_count_holder" class="ai1ec-form-group ai1ec-collapse"
            data-toggle="false">
            <label for="ai1ec_count" class="ai1ec-control-label ai1ec-col-sm-3">
                <?php _e( 'Ending after', AI1EC_PLUGIN_NAME ); ?>:
            </label>
            <div class="ai1ec-col-sm-9">
                <?php echo $count; ?>
            </div>
        </div>

        <div id="ai1ec_until_holder" class="ai1ec-form-group ai1ec-collapse"
            data-toggle="false">
            <label for="ai1ec_until-date-input"
                class="ai1ec-control-label ai1ec-col-sm-3">
                <?php _e( 'On date', AI1EC_PLUGIN_NAME ); ?>:
            </label>
            <div class="ai1ec-col-sm-9">
                <input type="text" class="ai1ec-date-input" id="ai1ec_until-date-input">
                <input type="hidden" name="ai1ec_until_time" id="ai1ec_until-time"
                    value="<?php echo ! is_null( $until ) && $until > 0 ? $until : ''; ?>">
            </div>
        </div>
    </div>

    <input type="hidden" id="ai1ec_is_box_repeat" value="<?php echo $repeat; ?>">

    <button type="button" id="ai1ec_repeat_apply"
        class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-lg"
        data-loading-text="<?php echo esc_attr(
            '<i class="ai1ec-fa ai1ec-fa-spinner ai1ec-fa-fw ai1ec-fa-spin"></i> ' .
            __( 'Please wait&#8230;', AI1EC_PLUGIN_NAME ) ); ?>">
        <i class="ai1ec-fa ai1ec-fa-check ai1ec-fa-fw"></i>
        <?php _e( 'Apply', AI1EC_PLUGIN_NAME ); ?>
    </button>
    <a id="ai1ec_repeat_cancel"
        class="ai1ec-btn ai1ec-btn-default ai1ec-text-danger ai1ec-btn-lg">
        <i class="ai1ec-fa ai1ec-fa-undo ai1ec-fa-fw"></i
        ><?php _e( 'Cancel', AI1EC_PLUGIN_NAME ); ?>
    </a>
</div>

</div>


==================================================
FILE PATH: ./public/admin/cron_freq.php
==================================================
<select name="cron_freq">
    <option value="hourly" <?php echo $cron_freq == 'hourly' ? 'selected' : ''; ?>>
        <?php _e( 'Hourly', AI1EC_PLUGIN_NAME ) ?>
    </option>
    <option value="twicedaily" <?php echo $cron_freq == 'twicedaily' ? 'selected' : '' ?>>
        <?php _e( 'Twice Daily', AI1EC_PLUGIN_NAME ) ?>
    </option>
    <option value="daily" <?php echo $cron_freq == 'daily' ? 'selected' : '' ?>>
        <?php _e( 'Daily', AI1EC_PLUGIN_NAME ) ?>
    </option>
</select>


==================================================
FILE PATH: ./public/js/require.js
==================================================
/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

var timely;(function(){if(!timely||!timely.requirejs){timely?require=timely:timely={};var requirejs,require,define;(function(global){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function each(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){if(n||!hasProp(e,i))r&&typeof t!="string"?(e[i]||(e[i]={}),mixin(e[i],t,n,r)):e[i]=t}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function v(e){var t,n;for(t=0;e[t];t+=1){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}}function m(e,t,n){var r,i,s,u,a,f,l,c,h,p,d,m=t&&t.split("/"),g=m,y=o.map,b=y&&y["*"];e&&e.charAt(0)==="."&&(t?(getOwn(o.pkgs,t)?g=m=[t]:g=m.slice(0,m.length-1),e=g.concat(e.split("/")),v(e),i=getOwn(o.pkgs,r=e[0]),e=e.join("/"),i&&e===r+"/"+i.main&&(e=r)):e.indexOf("./")===0&&(e=e.substring(2)));if(n&&y&&(m||b)){u=e.split("/");for(a=u.length;a>0;a-=1){l=u.slice(0,a).join("/");if(m)for(f=m.length;f>0;f-=1){s=getOwn(y,m.slice(0,f).join("/"));if(s){s=getOwn(s,l);if(s){c=s,h=a;break}}}if(c)break;!p&&b&&getOwn(b,l)&&(p=getOwn(b,l),d=a)}!c&&p&&(c=p,h=d),c&&(u.splice(0,h,c),e=u.join("/"))}return e}function g(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===r.contextName)return t.parentNode.removeChild(t),!0})}function y(e){var t=getOwn(o.paths,e);if(t&&isArray(t)&&t.length>1)return g(e),t.shift(),r.require.undef(e),r.require([e]),!0}function b(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function w(e,t,n,i){var s,o,u,a,f=null,l=t?t.name:null,h=e,v=!0,g="";return e||(v=!1,e="_@r"+(p+=1)),a=b(e),f=a[0],e=a[1],f&&(f=m(f,l,i),o=getOwn(c,f)),e&&(f?o&&o.normalize?g=o.normalize(e,function(e){return m(e,l,i)}):g=m(e,l,i):(g=m(e,l,i),a=b(g),f=a[0],g=a[1],n=!0,s=r.nameToUrl(g))),u=f&&!o&&!n?"_unnormalized"+(d+=1):"",{prefix:f,name:g,parentMap:t,unnormalized:!!u,url:s,originalName:h,isDefine:v,id:(f?f+"!"+g:g)+u}}function E(e){var t=e.id,n=getOwn(u,t);return n||(n=u[t]=new r.Module(e)),n}function S(e,t,n){var r=e.id,i=getOwn(u,r);hasProp(c,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(c[r]):E(e).on(t,n)}function x(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(u,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function T(){globalDefQueue.length&&(apsp.apply(l,[l.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function N(e){delete u[e],delete a[e]}function C(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,each(e.depMaps,function(r,i){var s=r.id,o=getOwn(u,s);o&&!e.depMatched[i]&&!n[s]&&(getOwn(t,s)?(e.defineDep(i,c[s]),e.check()):C(o,t,n))}),n[r]=!0)}function k(){var e,n,i,u,f=o.waitSeconds*1e3,l=f&&r.startTime+f<(new Date).getTime(),c=[],h=[],p=!1,d=!0;if(t)return;t=!0,eachProp(a,function(t){e=t.map,n=e.id;if(!t.enabled)return;e.isDefine||h.push(t);if(!t.error)if(!t.inited&&l)y(n)?(u=!0,p=!0):(c.push(n),g(n));else if(!t.inited&&t.fetched&&e.isDefine){p=!0;if(!e.prefix)return d=!1}});if(l&&c.length)return i=makeError("timeout","Load timeout for modules: "+c,null,c),i.contextName=r.contextName,x(i);d&&each(h,function(e){C(e,{},{})}),(!l||u)&&p&&(isBrowser||isWebWorker)&&!s&&(s=setTimeout(function(){s=0,k()},50)),t=!1}function L(e){hasProp(c,e[0])||E(w(e[0],null,!0)).init(e[1],e[2])}function A(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function O(e){var t=e.currentTarget||e.srcElement;return A(t,r.onScriptLoad,"load","onreadystatechange"),A(t,r.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function M(){var e;T();while(l.length){e=l.shift();if(e[0]===null)return x(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));L(e)}}var t,n,r,i,s,o={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},u={},a={},f={},l=[],c={},h={},p=1,d=1;return i={require:function(e){return e.require?e.require:e.require=r.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?e.exports:e.exports=c[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return o.config&&getOwn(o.config,e.map.id)||{}},exports:c[e.map.id]}}},n=function(e){this.events=getOwn(f,e.id)||{},this.map=e,this.shim=getOwn(o.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},n.prototype={init:function(e,t,n,r){r=r||{};if(this.inited)return;this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check()},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(this.fetched)return;this.fetched=!0,r.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();r.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))},load:function(){var e=this.map.url;h[e]||(h[e]=!0,r.load(this.map.id,e))},check:function(){if(!this.enabled||this.enabling)return;var e,t,n=this.map.id,i=this.depExports,s=this.exports,o=this.factory;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error)try{s=r.execCb(n,o,i,s)}catch(u){e=u}else s=r.execCb(n,o,i,s);this.map.isDefine&&(t=this.module,t&&t.exports!==undefined&&t.exports!==this.exports?s=t.exports:s===undefined&&this.usingExports&&(s=this.exports));if(e)return e.requireMap=this.map,e.requireModules=[this.map.id],e.requireType="define",x(this.error=e)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&(c[n]=s,req.onResourceLoad&&req.onResourceLoad(r,this.map,this.depMaps)),N(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var e=this.map,t=e.id,n=w(e.prefix);this.depMaps.push(n),S(n,"defined",bind(this,function(n){var i,s,a,f=this.map.name,l=this.map.parentMap?this.map.parentMap.name:null,c=r.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){n.normalize&&(f=n.normalize(f,function(e){return m(e,l,!0)})||""),s=w(e.prefix+"!"+f,this.map.parentMap),S(s,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),a=getOwn(u,s.id),a&&(this.depMaps.push(s),this.events.error&&a.on("error",bind(this,function(e){this.emit("error",e)})),a.enable());return}i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(u,function(e){e.map.id.indexOf(t+"_unnormalized")===0&&N(e.map.id)}),x(e)}),i.fromText=bind(this,function(n,s){var u=e.name,a=w(u),f=useInteractive;s&&(n=s),f&&(useInteractive=!1),E(a),hasProp(o.config,t)&&(o.config[u]=o.config[t]);try{req.exec(n)}catch(l){return x(makeError("fromtexteval","fromText eval for "+t+" failed: "+l,l,[t]))}f&&(useInteractive=!0),this.depMaps.push(a),r.completeLoad(u),c([u],i)}),n.load(e.name,c,i,o)})),r.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){a[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,s,o;if(typeof e=="string"){e=w(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(i,e.id);if(o){this.depExports[t]=o(this);return}this.depCount+=1,S(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&S(e,"error",this.errback)}n=e.id,s=u[n],!hasProp(i,n)&&s&&!s.enabled&&r.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(u,e.id);t&&!t.enabled&&r.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),e==="error"&&delete this.events[e]}},r={config:o,contextName:e,registry:u,defined:c,urlFetched:h,defQueue:l,Module:n,makeModuleMap:w,nextTick:req.nextTick,onError:x,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var t=o.pkgs,n=o.shim,i={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?t==="map"?(o.map||(o.map={}),mixin(o[t],e,!0,!0)):mixin(o[t],e,!0):o[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=r.makeShimExports(e)),n[t]=e}),o.shim=n),e.packages&&(each(e.packages,function(e){var n;e=typeof e=="string"?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),o.pkgs=t),eachProp(u,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=w(t))}),(e.deps||e.callback)&&r.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function s(o,a,f){var l,h,p;return n.enableBuildCallback&&a&&isFunction(a)&&(a.__requireJsBuild=!0),typeof o=="string"?isFunction(a)?x(makeError("requireargs","Invalid require call"),f):t&&hasProp(i,o)?i[o](u[t.id]):req.get?req.get(r,o,t,s):(h=w(o,t,!1,!0),l=h.id,hasProp(c,l)?c[l]:x(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(M(),r.nextTick(function(){M(),p=E(w(null,t)),p.skipMap=n.skipMap,p.init(o,a,f,{enabled:!0}),k()}),s)}return n=n||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var n,i=e.lastIndexOf("."),s=e.split("/")[0],o=s==="."||s==="..";return i!==-1&&(!o||i>1)&&(n=e.substring(i,e.length),e=e.substring(0,i)),r.nameToUrl(m(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(c,w(e,t,!1,!0).id)},specified:function(e){return e=w(e,t,!1,!0).id,hasProp(c,e)||hasProp(u,e)}}),t||(s.undef=function(e){T();var n=w(e,t,!0),r=getOwn(u,e);delete c[e],delete h[n.url],delete f[e],r&&(r.events.defined&&(f[e]=r.events),N(e))}),s},enable:function(e){var t=getOwn(u,e.id);t&&E(e).enable()},completeLoad:function(e){var t,n,r,i=getOwn(o.shim,e)||{},s=i.exports;T();while(l.length){n=l.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);L(n)}r=getOwn(u,e);if(!t&&!hasProp(c,e)&&r&&!r.inited){if(o.enforceDefine&&(!s||!getGlobal(s))){if(y(e))return;return x(makeError("nodefine","No define call for "+e,null,[e]))}L([e,i.deps||[],i.exportsFn])}k()},nameToUrl:function(e,t,n){var r,i,s,u,a,f,l,c,h;if(req.jsExtRegExp.test(e))c=e+(t||"");else{r=o.paths,i=o.pkgs,a=e.split("/");for(f=a.length;f>0;f-=1){l=a.slice(0,f).join("/"),s=getOwn(i,l),h=getOwn(r,l);if(h){isArray(h)&&(h=h[0]),a.splice(0,f,h);break}if(s){e===s.name?u=s.location+"/"+s.main:u=s.location,a.splice(0,f,u);break}}c=a.join("/"),c+=t||(/\?/.test(c)||n?"":".js"),c=(c.charAt(0)==="/"||c.match(/^[\w\+\.\-]+:/)?"":o.baseUrl)+c}return o.urlArgs?c+((c.indexOf("?")===-1?"?":"&")+o.urlArgs):c},load:function(e,t){req.load(r,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=O(e);r.completeLoad(t.id)}},onScriptError:function(e){var t=O(e);if(!y(t.id))return x(makeError("scripterror","Script error",e,[t.id]))}},r.require=r.makeRequire(),r}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(e){if(e.readyState==="interactive")return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.5",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=typeof window!="undefined"&&!!navigator&&!!document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t,n,r){var i,s,o=defContextName;return!isArray(e)&&typeof e!="string"&&(s=e,isArray(t)?(e=t,t=n,n=r):e=[]),s&&s.context&&(o=s.context),i=getOwn(contexts,o),i||(i=contexts[o]=req.s.newContext(o)),s&&i.configure(s),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=typeof setTimeout!="undefined"?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){var r=e&&e.config||{},i;if(isBrowser)return i=r.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=r.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,s,[t]))}},isBrowser&&eachReverse(scripts(),function(e){head||(head=e.parentNode),dataMain=e.getAttribute("data-main");if(dataMain)return cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this),timely.requirejs=requirejs,timely.require=require,timely.define=define}})();

==================================================
FILE PATH: ./public/js/main.js
==================================================
;

==================================================
FILE PATH: ./public/js/month.js
==================================================
timely.define(["libs/twig","month"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/month.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<table class="ai1ec-month-view ai1ec-popover-boundary\n	'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:"	"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"month_word_wrap",match:["month_word_wrap"]}],output:[{type:"raw",value:"ai1ec-word-wrap"}]}},{type:"raw",value:'">\n	<thead>\n		<tr>\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"weekday",expression:[{type:"Twig.expression.type.variable",value:"weekdays",match:["weekdays"]}],output:[{type:"raw",value:'				<th scope="col" class="ai1ec-weekday">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"weekday",match:["weekday"]}]},{type:"raw",value:"</th>\n			"}]}},{type:"raw",value:"		</tr>\n	</thead>\n	<tbody>\n		"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"week",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:"			"},{type:"logic",token:{type:"Twig.logic.type.set",key:"added_stretcher",expression:[{type:"Twig.expression.type.bool",value:!1}]}},{type:"raw",value:'			<tr class="ai1ec-week">\n				'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"week",match:["week"]}],output:[{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date"}],output:[{type:"raw",value:"						<td "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"}],output:[{type:"raw",value:'class="ai1ec-today"'}]}},{type:"raw",value:">\n							"},{type:"raw",value:"\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"added_stretcher",match:["added_stretcher"]},{type:"Twig.expression.type.operator.unary",value:"not",precidence:3,associativity:"rightToLeft",operator:"not"}],output:[{type:"raw",value:'								<div class="ai1ec-day-stretcher"></div>\n								'},{type:"logic",token:{type:"Twig.logic.type.set",key:"added_stretcher",expression:[{type:"Twig.expression.type.bool",value:!0}]}},{type:"raw",value:"							"}]}},{type:"raw",value:'\n							<div class="ai1ec-day">\n								<div class="ai1ec-date">\n									<a class="ai1ec-load-view"\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date_link"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date"}]},{type:"raw",value:"</a>\n								</div>\n\n								"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"events"}],output:[{type:"raw",value:'									<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:'											data-start-day="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_day"}]},{type:"raw",value:'"\n											data-end-day="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"multiday_end_day"}]},{type:"raw",value:'"\n											data-start-truncated="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"},{type:"Twig.expression.type.string",value:"true"},{type:"Twig.expression.type.string",value:"false"},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:'"\n											data-end-truncated="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"},{type:"Twig.expression.type.string",value:"true"},{type:"Twig.expression.type.string",value:"false"},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:'"\n										'}]}},{type:"raw",value:'										data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n										class="ai1ec-event-container ai1ec-load-event\n											ai1ec-popup-trigger\n											ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n											ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"}],output:[{type:"raw",value:"ai1ec-allday"}]}},{type:"raw",value:"											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n										>\n\n										<div class="ai1ec-event"\n											 style="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'												data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											'}]}},{type:"raw",value:'>\n											<span class="ai1ec-event-title">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"},{type:"Twig.expression.type.operator.unary",value:"not",precidence:3,associativity:"rightToLeft",operator:"not"}],output:[{type:"raw",value:'												<span class="ai1ec-event-time">\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"short_start_time"}]},{type:"raw",value:"\n												</span>\n											"}]}},{type:"raw",value:'										</div>\n									</a>\n\n									<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n									            ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									            ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									            "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"									                ai1ec-has-tickets-button\n									            "}]}},{type:"raw",value:'>\n									            ">\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'											<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n										"}]}},{type:"raw",value:'										<span class="ai1ec-popup-title">\n											<a class="ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'												<span class="ai1ec-event-location"\n													>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n											"}]}},{type:"raw",value:"										</span>\n\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'											<a class="post-edit-link"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n												<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n											</a>\n										"}]}},{type:"raw",value:'\n										<div class="ai1ec-event-time">\n											'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n										</div>\n\n										<a class="ai1ec-load-event"\n											href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n											'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										</a>\n										"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'											<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n										"}]}},{type:"raw",value:"									</div>\n								"}]}},{type:"raw",value:"							</div>\n						</td>\n					"}]}},{type:"logic",token:{type:"Twig.logic.type.else",match:["else"],output:[{type:"raw",value:" "},{type:"raw",value:'\n						<td class="ai1ec-empty"></td>\n					'}]}},{type:"raw",value:" "},{type:"raw",value:"\n\n				"}]}},{type:"raw",value:" "},{type:"raw",value:"\n			</tr>\n		"}]}},{type:"raw",value:" "},{type:"raw",value:'\n	</tbody>\n</table>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n});

==================================================
FILE PATH: ./public/js/scripts/setting/cache/cache_ajax_handlers.js
==================================================
timely.define(["jquery_timely","libs/utils"],function(e,t){var n=function(n){var r=e("#ai1ec-button-refresh"),i=e("#ai1ec-cache-scan-success"),s=e("#ai1ec-cache-scan-danger"),o;r.button("reset"),n.error?o=t.make_alert(n.message,"error"):"0"===n.state?(i.toggleClass("ai1ec-hide",!0),s.toggleClass("ai1ec-hide",!1)):(i.toggleClass("ai1ec-hide",!1),s.toggleClass("ai1ec-hide",!0))};return{handle_rescan_cache:n}});

==================================================
FILE PATH: ./public/js/scripts/setting/cache/cache_event_handlers.js
==================================================
timely.define(["jquery_timely","scripts/setting/cache/cache_ajax_handlers","libs/utils"],function(e,t,n){var r=n.get_ajax_url(),i=function(){var n=e(this);n.button("loading");var i={action:"ai1ec_rescan_cache"};return e.post(r,i,t.handle_rescan_cache,"json"),!1};return{perform_rescan:i}});

==================================================
FILE PATH: ./public/js/scripts/widget-creator.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("external_libs/jquery_cookie",["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),timely.define("scripts/widget-creator",["jquery_timely","domReady","ai1ec_config","libs/utils","external_libs/bootstrap/tab","external_libs/jquery_cookie"],function(e,t,n,r){var i=function(t){var n=e(this).attr("href");e.cookie("widget_creator_active_tab",n)},s=function(t){t===null?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},o=function(t){"ai1ec-widget-loaded"===t.data&&e("#widget-preview-title").html(n.widget_creator.preview)},u=function(){var t=e("#ai1ec-superwidget-code"),r=e("<iframe />").appendTo(e("#ai1ec-superwidget-preview").removeClass("ai1ec-hidden")),i=!1,s=function(){var r=n.set_calendar_page;if(n.calendar_page_id){var i=e(".ai1ec-tab-content .ai1ec-active"),s=i.attr("id"),o=t.data("widget-url"),u=n.javascript_widgets;r='&lt;script class="ai1ec-widget-placeholder" data-widget="'+s+'"',e("select",i).each(function(){var t=e(this),n=t.val();if(n){var i=t.attr("id");t.attr("multiple")&&(n=n.join(","),i=t.data("id")),r+=" data-"+i.replace(/\-/g,"_")+'="'+n+'"'}}),e("input",i).each(function(){var t=e(this),n=t.val();"checkbox"===t.attr("type")&&(n=this.checked);if(""!==n){var i=t.attr("id"),o=u[s];o[i]!=n&&(r+=" data-"+i+'="'+n+'"')}}),r+="&gt;<br>&nbsp;&nbsp;(function(){var d=document,s=d.createElement('script'),<br>&nbsp;&nbsp;i='ai1ec-script';if(d.getElementById(i))return;s.async=1;<br>&nbsp;&nbsp;s.id=i;s.src='"+o+"';<br>"+"&nbsp;&nbsp;d.getElementsByTagName('head')[0].appendChild(s);})();<br>"+"&lt;/script&gt;"}return t.html(r),r},o=function(){if(!i)return;e("#widget-preview-title").html(n.widget_creator.preview_loading);var o=r[0],u=s();if(!n.calendar_page_id)return;o=o.contentWindow?o.contentWindow:o.contentDocument.document?o.contentDocument.document:o.contentDocument,o.document.open(),o.document.write('<!DOCTYPE html><html><head><style type="text/css">body { padding: 20px 0; }</style></head><body>'+t.text()+"</body>"+"</html>"),o.document.close()};e(".timely").on("change",".ai1ec-form-group",o),e(".timely").on("shown.bs.tab",'a[data-toggle="ai1ec-tab"]',o),i=!0,o()};t(function(){r.activate_saved_tab_on_page_load(e.cookie("widget_creator_active_tab")),r.init_autoselect(),window.addEventListener("message",o,!1),u(),e(document).on("click","ul.ai1ec-nav a",i)})});

==================================================
FILE PATH: ./public/js/scripts/add_new_event.js
==================================================
timely.define(["jquery_timely","domReady","libs/utils","ai1ec_config","scripts/add_new_event/event_location/gmaps_helper","scripts/add_new_event/event_location/input_coordinates_event_handlers","scripts/add_new_event/event_location/input_coordinates_utility_functions","scripts/add_new_event/event_date_time/date_time_event_handlers","scripts/add_new_event/event_cost_helper","external_libs/jquery.calendrical_timespan","external_libs/jquery.inputdate","external_libs/jquery.tools","external_libs/bootstrap_datepicker","external_libs/bootstrap/transition","external_libs/bootstrap/collapse","external_libs/bootstrap/modal","external_libs/bootstrap/alert","external_libs/bootstrap/tab","external_libs/select2"],function(e,t,n,r,i,s,o,u,a,f){var l=function(){var t=new Date(r.now*1e3),n={allday:"#ai1ec_all_day_event",start_date_input:"#ai1ec_start-date-input",start_time_input:"#ai1ec_start-time-input",start_time:"#ai1ec_start-time",end_date_input:"#ai1ec_end-date-input",end_time_input:"#ai1ec_end-time-input",end_time:"#ai1ec_end-time",date_format:r.date_format,month_names:r.month_names,day_names:r.day_names,week_start_day:r.week_start_day,twentyfour_hour:r.twentyfour_hour,now:t};e.timespan(n)},c=function(){e(".ai1ec-panel-collapse").on("hide",function(){e(this).parent().removeClass("ai1ec-overflow-visible")}),e(".ai1ec-panel-collapse").on("shown",function(){var t=e(this);window.setTimeout(function(){t.parent().addClass("ai1ec-overflow-visible")},350)})},h=function(){l(),timely.require(["libs/gmaps"],function(e){e(i.init_gmaps)})},p=function(t,n){var r=null;"[object Array]"===Object.prototype.toString.call(n)?r=n.join("<br>"):r=n,e("#ai1ec_event_inline_alert").html(r),e("#ai1ec_event_inline_alert").removeClass("ai1ec-hidden"),t.preventDefault(),e("#publish, #ai1ec_bottom_publish").removeClass("button-primary-disabled"),e("#publish, #ai1ec_bottom_publish").removeClass("disabled"),e("#publish, #ai1ec_bottom_publish").siblings("#ajax-loading, .spinner").css("visibility","hidden")},d=function(t){o.ai1ec_check_lat_long_fields_filled_when_publishing_event(t)===!0&&(o.ai1ec_convert_commas_to_dots_for_coordinates(),o.ai1ec_check_lat_long_ok_for_search(t));var i=!1,s=[];e("#ai1ec_ticket_ext_url, #ai1ec_contact_url").each(function(){var t=this.value;e(this).removeClass("ai1ec-input-warn");var o=e(this).closest(".ai1ec-panel-collapse").parent().find(".ai1ec-panel-heading .ai1ec-fa-warning");i||o.addClass("ai1ec-hidden").parent().removeClass("ai1ec-tab-title-error");var u=e(this).attr("id"),a="ai1ec_ticket_ext_url"===u;if(""!==t&&!1===n.isValidUrl(t,a)){o.removeClass("ai1ec-hidden").parent().addClass("ai1ec-tab-title-error"),i||e(this).closest(".ai1ec-panel-collapse").collapse("show"),i=!0;var f=u+"_not_valid";s.push(r[f]),e(this).addClass("ai1ec-input-warn")}});var u=e("#ai1ec_contact_email"),a=u.closest(".ai1ec-panel-collapse").parent().find(".ai1ec-panel-heading .ai1ec-fa-warning");u.removeClass("ai1ec-input-warn"),i||a.addClass("ai1ec-hidden").parent().removeClass("ai1ec-tab-title-error");var f=e.trim(u.val());if(""!==f&&!1===n.isValidEmail(f)){a.removeClass("ai1ec-hidden").parent().addClass("ai1ec-tab-title-error"),i||u.closest(".ai1ec-panel-collapse").collapse("show"),i=!0;var l=u.attr("id")+"_not_valid";s.push(r[l]),u.addClass("ai1ec-input-warn")}var c=e("#title, #ai1ec_contact_name, #ai1ec_contact_email, #ai1ec_contact_phone, #content");if(e("#ai1ec_has_tickets").prop("checked")){c.addClass("ai1ec-required"),E(),e("#content").hasClass("ai1ec-error")?T(!0):T(!1);if(e(".ai1ec-error").not(".ai1ec-hidden .ai1ec-error").length||e(".ai1ec-tax-options-button").hasClass("ai1ec-required-error"))i=!0,e("#ai1ec-add-new-event-accordion > .ai1ec-panel-default > .ai1ec-panel-collapse").removeClass("ai1ec-collapse").css("height","auto"),s.push(r.ticketing_required_fields);e("#ai1ec_repeat").prop("checked")===!0&&(i=!0,s.push(r.ticketing_repeat_not_supported));if(!1===i){var h=0,d=0;e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").each(function(){var t=e(this),n=!1;t.find(".ai1ec-tickets-fields").remove(),t.find("select, input").each(function(){if(!this.name)return;"remove"===this.name&&(n=!0);var r=this.value;"checkbox"==this.type&&(1==this.checked?r="on":r="off"),e("<input />",{type:"hidden",name:"ai1ec_tickets["+h+"]["+this.name+"]","class":"ai1ec-tickets-fields",value:r}).appendTo(t)}),n||d++,h++}),0===d&&(i=!0,s.push(r.ticketing_no_tickets_included))}}else c.removeClass("ai1ec-required");i?p(t,s):(e(".ai1ec-tickets-form-template").remove(),e(".ai1ec-tickets-edit-form").find("input, select").not(".ai1ec-tickets-fields").prop("disabled",!0))},v=function(){e("#ai1ec_google_map").click(s.toggle_visibility_of_google_map_on_click),e("#ai1ec_input_coordinates").change(s.toggle_visibility_of_coordinate_fields_on_click),e("#post").submit(d),e("input.ai1ec-coordinates").blur(s.update_map_from_coordinates_on_blur),e("#ai1ec_bottom_publish").on("click",u.trigger_publish),e(document).on("change","#ai1ec_end",u.show_end_fields).on("click","#ai1ec_repeat_apply",u.handle_click_on_apply_button).on("click","#ai1ec_repeat_cancel",u.handle_click_on_cancel_modal).on("click","#ai1ec_monthly_type_bymonthday, #ai1ec_monthly_type_byday",u.handle_checkbox_monthly_tab_modal).on("click",".ai1ec-btn-group-grid a",u.handle_click_on_toggle_buttons),e("#ai1ec_repeat_box").on("hidden.bs.modal",u.handle_modal_hide),u.execute_pseudo_handlers(),e("#widgetField > a").on("click",u.handle_animation_of_calendar_widget),e(document).on("click",".ai1ec-set-banner-image",m),e(document).on("click",".ai1ec-remove-banner",g),e(document).on("click","#ai1ec_tax_options, #ai1ec_update_tax_options",k)},m=function(){var t={};return t._frame=wp.media({state:"featured-image",states:[new wp.media.controller.FeaturedImage,new wp.media.controller.EditImage]}),t._frame.open(),e(".media-frame:last ").addClass("ai1ec-banner-image-frame"),e(".media-frame-title:last h1").text(e(".ai1ec-set-banner-block .ai1ec-set-banner-image").text()),e(".media-frame-toolbar:last").append(e(".ai1ec-media-toolbar").clone().removeClass("ai1ec-media-toolbar ai1ec-hidden")),e(".ai1ec-save-banner-image").off().on("click",function(){var n=e(".attachments:visible li.selected img").attr("src"),r=e(".attachment-details:visible input[type=text]").val();return n&&r&&e("#ai1ec_event_banner .inside").find(".ai1ec-banner-image-block").removeClass("ai1ec-hidden").find("img").attr("src",n).end().find("input").val(r).end().end().find(".ai1ec-set-banner-block").addClass("ai1ec-hidden").end().find(".ai1ec-remove-banner-block").removeClass("ai1ec-hidden"),t._frame.close(),!1}),!1},g=function(){return e("#ai1ec_event_banner .inside").find(".ai1ec-remove-banner-block").addClass("ai1ec-hidden").end().find(".ai1ec-banner-image-block").addClass("ai1ec-hidden").find("input").val("").end().find("img").attr("src","").end().end().find(".ai1ec-set-banner-block").removeClass("ai1ec-hidden"),!1},y=function(){e("#ai1ec_event").insertAfter("#ai1ec_event_inline_alert"),e("#post").addClass("ai1ec-visible")},b=function(){e("#timezone-select").select2()},w=function(){e(".ai1ec-tickets-datepicker").not(".ai1ec-tickets-datepicker-inited").not(".ai1ec-tickets-form-template .ai1ec-tickets-datepicker").each(function(){var t=e(this),n=t.closest(".ai1ec-tickets-dates-block"),r=e(".ai1ec-tickets-time",n),i=e("input.ai1ec-tickets-full-date",n),s=i.val();t.val(s.substr(0,10)),r.val(s.substr(11,5)),r.on("change",function(){s=i.val(),i.val(s.substr(0,10)+" "+this.value+":00")}),t.addClass("ai1ec-tickets-datepicker-inited").datepicker({autoclose:!0}).on("changeDate",function(e){i.val(this.value+" "+r.val()+":00")})})},E=function(){e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").not(".ai1ec-hidden").find('input[id="ai1ec_ticket_unlimited"]').each(function(){var t=e(this),n=t.closest(".ai1ec-tickets-edit-form"),r=e('input[id="ai1ec_ticket_quantity"]',n);!1===t.prop("checked")?(r.val()==0&&r.val(""),r.addClass("ai1ec-required")):r.removeClass("ai1ec-required")}),e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").not(".ai1ec-hidden").find('input[id="ai1ec_ticket_avail"]').each(function(){var t=e(this);t.closest(".ai1ec-tickets-edit-form").find('input[id="ai1ec_ticket_sale_start_date"],input[id="ai1ec_ticket_sale_end_date"]').each(function(){!1===t.prop("checked")?e(this).addClass("ai1ec-required"):e(this).removeClass("ai1ec-required")})}),e(".ai1ec-ticket-field-error").hide(),e(".ai1ec-required").not(".ai1ec-tickets-form-template .ai1ec-required").each(function(){var t=e(this);t.removeClass("ai1ec-error");if(!e.trim(t.val())||"checkbox"===t.attr("type")&&!t.prop("checked"))t.addClass("ai1ec-error"),t.parent().find(".ai1ec-ticket-field-error").show()}),e('[name="ticket_sale_start_date"], [name="ticket_sale_end_date"]').not(".ai1ec-tickets-form-template input").each(function(){var t=e(this),n=t.closest(".ai1ec-tickets-dates-block").find('input[type="text"]');n.removeClass("ai1ec-error"),!t.closest(".ai1ec-avail-block").find('input[name="availibility"]:checked').length&&null===this.value.match(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})$/)&&n.addClass("ai1ec-error")});var t=e("#ai1ec_editing_ticket").val();return 0==t&&!e("#ai1ec_tax_inputs input").length?e(".ai1ec-tax-options-button").addClass("ai1ec-required-error").show():e(".ai1ec-tax-options-button").removeClass("ai1ec-required-error").hide(),e(".ai1ec-ticket-field-error:visible").length?!1:!0},S=function(t){var n=t.closest(".ai1ec-tickets-edit-form"),r=e("#ai1ec_ticket_quantity",n);1==t.prop("checked")?r.hide():r.show()},x=function(t){var n=t.closest(".ai1ec-tickets-edit-form"),r=e(".ai1ec-tickets-dates",n);1==t.prop("checked")?r.hide():r.show()},T=function(t){e("#ai1ec-event-description-field-error").remove(),t&&e("#postdivrich").before('<div id="ai1ec-event-description-field-error"><strong style="color: red;">* The Event description is required.</strong></div>')},N=function(){e(document).on("click change",'[id="ai1ec_ticket_unlimited"]',function(){S(e(this))}),e(document).on("click change",'[id="ai1ec_ticket_avail"]',function(){x(e(this))}),e(document).on("click change",'[id="ai1ec_new_ticket_status"]',function(){var t=e(this),n=t.closest(".ai1ec-tickets-panel"),i=t.find(":selected");if("canceled"===i.val()){var s=e("#ai1ec-ticket-taken",n);if(0<s.val()){e("#ai1ec-ticket-status-message",n).text(r.ticketing.cancel_message);return}}n.find("#ai1ec-ticket-status-message").text("")}),e(document).on("click",".ai1ec-remove-ticket",function(){var t=e(this).closest(".ai1ec-tickets-panel"),i=e("#ai1ec-ticket-taken",t);return 0<i.val()?n.alert(r.ticketing.information,r.ticketing.no_delete_text):t.addClass("ai1ec-hidden").append('<input type="hidden" name="remove" value="1">'),!1});var t=function(){var t=e(".ai1ec-tickets-form-template").clone();return t.removeClass("ai1ec-tickets-form-template").appendTo("#ai1ec-ticket-forms"),$checkbox=e("#ai1ec_ticket_unlimited",t),$checkbox.prop("checked",!0),S($checkbox),$checkbox=e("#ai1ec_ticket_avail",t),$checkbox.prop("checked",!0),x($checkbox),w(),!1};e("#ai1ec_add_new_ticket").on("click",t),e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").length||t()},C=function(){var t=function(){e(".ai1ec_review_modal").modal("hide"),e(".ai1ec_review_modal").hide()},n=function(){var n=e(".ai1ec_review_negative_feedback, .ai1ec_review_contact_name, .ai1ec_review_contact_email, .ai1ec_review_site_url");n.each(function(){var t=e(this);t.removeClass("ai1ec-error"),t.closest("td").find(".ai1ec-required-message").hide(),t.closest("td").find(".ai1ec-invalid-email-message").hide(),t.closest("td").find(".ai1ec-invalid-site-message").hide();if(!e.trim(t.val()))t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-required-message").show();else if(t.hasClass("ai1ec_review_contact_email")){var n=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;!1===n.test(t.val())&&(t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-invalid-email-message").show())}else if(t.hasClass("ai1ec_review_site_url")){var r=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi;!1===r.test(t.val())&&(t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-invalid-site-message").show())}}),!1===n.hasClass("ai1ec-error")&&(e(".ai1ec_review_send_feedback").button("loading"),n.prop("disabled",!0),e.ajax({url:r.ajax_url,type:"POST",data:{action:"ai1ec_send_feedback_message",message:e(".ai1ec_review_negative_feedback").val(),name:e(".ai1ec_review_contact_name").val(),email:e(".ai1ec_review_contact_email").val(),site:e(".ai1ec_review_site_url").val()},success:function(n){e(".ai1ec_review_messages").remove(),e(".ai1ec-review-form").prepend('<div class="timely ai1ec-alert ai1ec-alert-success ai1ec_review_messages"><strong>'+r.review.message_sent+"</strong></div>"),setTimeout(function(){e(".ai1ec_review_send_feedback").button("reset"),e(".ai1ec_not_enjoying_popup").prop("disabled",!0),t()},3e3)},error:function(t){n.prop("disabled",!1),e(".ai1ec_review_messages").remove(),e(".ai1ec-review-form").prepend('<div class="timely ai1ec-alert ai1ec-alert-danger ai1ec_review_messages"><strong>Error!</strong> '+r.review.message_error+"</div>")}}))},i=function(){o("y")},s=function(){o("n")},o=function(n){t(),e.ajax({url:r.ajax_url,type:"POST",data:{action:"ai1ec_save_feedback_review",feedback:n}})};e(".ai1ec_review_enjoying_no_rating, .ai1ec_review_enjoying_go_wordpress").on("click",i),e(".ai1ec_review_send_feedback").on("click",n),e(".ai1ec_review_not_enjoying_no_rating").on("click",s)},k=function(){var t=e("#ai1ec_tax_box"),n=e(".ai1ec-modal-content",t),r=e(".ai1ec-loading",t);if(t.hasClass("ai1ec-active")){t.modal("show");return}t.addClass("ai1ec-active").modal({backdrop:"static"}),e.post(ajaxurl,{action:"ai1ec_get_tax_box",ai1ec_event_id:e("#post_ID").val()},function(t){var n=e("#ai1ec_tax_frame").get(0).contentWindow.document;r.remove(),e("#ai1ec_tax_frame").removeClass("ai1ec-hidden"),n.open(),n.write(t.message.body),n.close();var i=0,s=0,o=e("#ai1ec_tax_frame");setInterval(function(){s=o.contents().find("body").height(),s!=i&&o.css("height",(i=s)+"px")},500)},"json")};window.addEventListener("message",function(t){var n=t.data.toString(),r="timely_tax_options_",i="timely_tax_cancel",s=e("#ai1ec_tax_inputs");if(n===i){e("#ai1ec_tax_box").modal("hide");return}if(0!==n.indexOf(r))return;n=JSON.parse(n.substr(r.length)),e("#ai1ec_tax_box").modal("hide"),e("#ai1ec_tax_options").addClass("ai1ec-hidden"),e("#ai1ec_update_tax_options").removeClass("ai1ec-hidden"),s.html("");for(var o in n)s.append(e("<input />",{type:"hidden",name:"tax_options["+o+"]",value:n[o]}))},!1);var L=function(){h(),t(function(){c(),y(),v(),b(),N(),w(),C()})};return{start:L}});

==================================================
FILE PATH: ./public/js/scripts/calendar_feeds.js
==================================================
timely.define(["jquery_timely","domReady","scripts/calendar_feeds/ics/ics_event_handlers","libs/select2_multiselect_helper","libs/tags_select","libs/utils","ai1ec_config","libs/gmaps","external_libs/jquery_cookie","external_libs/bootstrap/tab","external_libs/bootstrap/alert","external_libs/bootstrap/modal","external_libs/bootstrap/button","external_libs/bootstrap/collapse","scripts/add_new_event/event_location/input_coordinates_utility_functions","external_libs/jquery.autocomplete_geomod","external_libs/geo_autocomplete"],function(e,t,n,r,i,s,o,u){var a=function(){var t=e(this.hash);r.refresh(t),i.refresh(t)},f=function(t){var n=e(this).attr("href");e.cookie("feeds_active_tab",n),"#suggested"===n&&g()},l=function(){var t=e("#ai1ec-feeds-after"),s=e(".ai1ec_submit_wrapper"),l=e(".ai1ec_file_upload_tags_categories");r.init(t),i.init(t),r.init(s),i.init(s),r.init(l),i.init(l),e("ul.ai1ec-nav a").on("click",f),e("ul.ai1ec-nav a").on("shown",a),e('select[name="cron_freq"]').on("change",function(){e.ajax({url:ajaxurl,type:"POST",data:{action:"ai1ec_feeds_page_post",cron_freq:this.value}})}),e("#ai1ec-ics-modal").on("click",".remove, .keep",n.submit_delete_modal),e(document).on("click","#ai1ec_add_new_ics",n.add_new_feed).on("click",".ai1ec_delete_ics",n.open_delete_modal).on("click",".ai1ec_update_ics",n.update_feed).on("click",".ai1ec_edit_ics",n.edit_feed).on("click","#ai1ec_cancel_ics",n.edit_cancel).on("click",".ai1ec-panel-heading > a",n.edit_cancel).on("click",'.ai1ec-feed-container .ai1ec-panel-heading a, .ai1ec-nav-tabs a[href="#import"]',n.edit_cancel),e(document).on("click",".ai1ec-suggested-import-event",function(){var t=e(this),n=t.closest(".ai1ec-suggested-event-import"),r=e.parseJSON(t.closest(".ai1ec-infowindow, tr").attr("data-event"));return e("a.ai1ec-suggested-processing",n).removeClass("ai1ec-hidden"),t.addClass("ai1ec-hidden"),e.ajax({url:o.ajax_url,type:"POST",data:{action:"ai1ec_import_suggested_event",ai1ec_feed_url:r.url,ai1ec_feed_id:r.feed_id,ai1ec_event_id:r.id},success:function(t){e("a.ai1ec-suggested-processing",n).addClass("ai1ec-hidden"),t.error?(e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden"),e("#ai1ec-discovery-status").addClass("ai1ec-error").text(o.discovery_event_error).hide().fadeIn()):(e("a.ai1ec-suggested-remove-event",n).removeClass("ai1ec-hidden"),e("#ai1ec-discovery-status").removeClass("ai1ec-error").text(o.discovery_event_success).hide().fadeIn())},error:function(){e("a.ai1ec-suggested-processing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden"),e("#ai1ec-discovery-status").addClass("ai1ec-error").text(o.discovery_event_error).hide().fadeIn()}}),!1}),e(document).on("click",".ai1ec-suggested-remove-event",function(){var t=e(this),n=t.closest(".ai1ec-suggested-event-import, .ai1ec-myfeeds-event"),r=t.closest(".ai1ec-infowindow, tr"),i=t.closest(".ai1ec-myfeeds-event"),s=r.length?e.parseJSON(r.attr("data-event")):null,u=s?s.id:i.attr("data-event-id"),a=s?s.feed_id:i.attr("data-feed-id");return e("a.ai1ec-suggested-removing",n).removeClass("ai1ec-hidden"),t.addClass("ai1ec-hidden"),i.addClass("ai1ec-myfeeds-removing"),e.ajax({url:o.ajax_url,type:"POST",data:{action:"ai1ec_remove_suggested_event",ai1ec_event_id:u,ai1ec_feed_id:a,ai1ec_delete:!0},success:function(t){e("a.ai1ec-suggested-removing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden"),i.length&&!i.closest(".ai1ec-feed-category").find(".ai1ec-myfeeds-event").not(".ai1ec-myfeeds-removing").length&&i.closest(".ai1ec-feed-container").remove(),i.remove()},error:function(){e("a.ai1ec-suggested-removing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-remove-event",n).removeClass("ai1ec-hidden")}}),!1}),e(document).on("click",".ai1ec-suggested-view-selector > a",function(){var t=e(this),n=t.parent(),r=t.attr("data-ai1ec-view");return e("#suggested").removeClass(function(e,t){return(t.match(/(^|\s)ai1ec-feeds-\S+/g)||[]).join(" ")}).addClass("ai1ec-feeds-"+r),n.find("a.ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active").blur(),e("[data-ai1ec-show]").hide().filter('[data-ai1ec-show~="'+r+'"]').show(),"list"!==r&&u(function(){d(!0)}),!1}),e(document).on("click","a.ai1ec-suggested-title",function(){var t=e(this),n=t.closest("tr"),r=e.parseJSON(n.attr("data-event"));if(n.hasClass("ai1ec-suggested-hover"))e("#ai1ec_events_map_canvas").removeClass("goes-left"),n.removeClass("ai1ec-suggested-hover");else{e(".ai1ec-suggested-hover").removeClass("ai1ec-suggested-hover"),n.addClass("ai1ec-suggested-hover"),e("#ai1ec_events_map_canvas").addClass("goes-left");var i=e("#ai1ec_events_extra_details").html("");r.image_url&&i.append(e("<img />",{src:r.image_url,alt:""})),i.append(e('<a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-sm 						ai1ec-open-event" target="_blank">						<i class="ai1ec-fa ai1ec-fa-external-link ai1ec-fa-xs ai1ec-fa-fw"></i>						Open</a>')).append(e('<div class="ai1ec-extra-title"></div>').text(r.title)).append(e('<div class="ai1ec-extra-date"></div>').text(r.dtstart)).append(e('<div class="ai1ec-extra-venue"></div>').text(r.venue_name)).append(e('<div class="ai1ec-extra-location"></div>').text(r.location)).append(e('<div class="ai1ec-extra-description"></div>').text(e("<div />").html(r.description).text()))}return t.blur(),!1}),e(document).on("click",".ai1ec-feeds-list-container a.page-numbers",function(){var t=this.href.match(/pagenum=(\d+)/);return t&&1<t.length&&(t=t[1],e(".ai1ec-suggested-events").addClass("ai1ec-feeds-loading"),m({page:t})),!1}),e("#ai1ec_suggested_search").on("click",function(){return e("#ai1ec_events_map_canvas").removeClass("goes-left"),e("tr.ai1ec-suggested-hover a.ai1ec-suggested-title").click(),m(),!1}),e("#ai1ec_suggested_term").on("keydown change",function(){e(this).removeClass("ai1ec-error")})},c,h=[],p,d=function(t){var n={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,zoomControl:!0,scaleControl:!0},r=null,i=null,s=e(".ai1ec-suggested-events-actions-template").html(),o=new google.maps.InfoWindow({maxWidth:260}),u=function(e){var t='<div class="ai1ec-infowindow" data-event-id="'+e.id+'"><div class="ai1ec-infowindow-title"><b>'+e.title+"</b></div>"+e.dtstart.substr(0,10)+" @ "+e.venue_name+"<br>"+s+"</div>";o.setContent(t)},a=!t;p=function(){var t=[];for(var n=0;n<h.length;n++)e('tr[data-event-id="'+h[n].event_id+'"]').length?t.push(h[n].event_id):(h[n].setMap(null),h[n]=null);e("tr.ai1ec-suggested-event").each(function(){var n=e(this),r=e.parseJSON(n.attr("data-event"));if(!r||!r.latitude||!r.longitude)return;if(-1!=e.inArray(t,r.id))return;var i=new google.maps.Marker({map:c,title:r.title,position:new google.maps.LatLng(r.latitude,r.longitude)});i.event_id=r.id,i.addListener("click",function(){u(r),o.open(c,this)}),i.addListener("mouseover",function(){e('tr[data-event-id="'+this.event_id+'"]').addClass("ai1ec-suggested-hover")}),i.addListener("mouseout",function(){e('tr[data-event-id="'+this.event_id+'"]').removeClass("ai1ec-suggested-hover")}),h.push(i)}),h=h.filter(function(e){return e!==null})},t&&(c=new google.maps.Map(e("#ai1ec_events_map_canvas").get(0),n)),p(),v(t);var f=function(t,n){if("zoom_changed"===t&&!n)return a=!0,!1;clearTimeout(r),i&&4!=i.readystate&&(i.abort(),i=null,e(".ai1ec-suggested-events").removeClass("ai1ec-feeds-loading")),r=setTimeout(function(){var n=c.getCenter(),r=n.lat(),s=n.lng(),o=c.getBounds();e(".ai1ec-suggested-events").addClass("ai1ec-feeds-loading"),i=m({lat:r,lng:s,radius:b(r,s,o.getNorthEast().lat(),o.getNorthEast().lng(),o.getSouthWest().lat(),o.getSouthWest().lng())},p,t)},1e3)};t&&(c.addListener("dragend",function(){f("dragend",!0)},!1),c.addListener("zoom_changed",function(){f("zoom_changed",a)},!1))},v=function(t){if(!h.length||!t)return;var n=new google.maps.LatLngBounds,r=parseFloat(e("#ai1ec_suggested_lat").val()),i=parseFloat(e("#ai1ec_suggested_lng").val()),s=parseFloat(e("#ai1ec_suggested_radius").val());for(var o=0;o<h.length;o++)n.extend(h[o].getPosition());c.fitBounds(n),new google.maps.Circle({center:new google.maps.LatLng(r,i),fillOpacity:.05,strokeOpacity:.3,strokeWeight:1,map:c,radius:s*1e3})},m=function(t,n,r){return e("#ai1ec_suggested_term").removeClass("ai1ec-error"),t=e.extend({action:"ai1ec_search_events",term:e.trim(e("#ai1ec_suggested_term").val()),location:e.trim(e("#ai1ec_suggested_location").val()),lat:e("#ai1ec_suggested_lat").val(),lng:e("#ai1ec_suggested_lng").val(),radius:e("#ai1ec_suggested_radius").val()},t),e.ajax({url:o.ajax_url,type:"POST",data:t,success:function(i){i=e.parseJSON(i);if(!i)return;i.total?(e("#suggested").addClass("ai1ec-has-map"),e(".ai1ec-suggested-results").show(),e(".ai1ec-suggested-no-results").hide(),e(".ai1ec-feeds-list-container").html(i.list),e(".ai1ec-suggested-results-found").text(i.total),u(function(){d(!t||!n)}),e(".ai1ec-feeds-list-container tr.ai1ec-suggested-event").each(function(){var t=e(this),n=e.parseJSON(t.attr("data-event"));for(var r=0;r<i.imported.length;r++)if(i.imported[r].feed_id==n.feed_id&&i.imported[r].feed_events_uids[n.id]){e(".ai1ec-suggested-remove-event",t).removeClass("ai1ec-hidden"),e(".ai1ec-suggested-import-event",t).addClass("ai1ec-hidden");break}})):(e(".ai1ec-suggested-results-found").text("0"),r||(e("#suggested").removeClass("ai1ec-has-map"),e(".ai1ec-suggested-results").hide(),e(".ai1ec-suggested-no-results").show()),e(".ai1ec-feeds-list-container").html("")),n&&n.apply()}})},g=function(){setTimeout(function(){u(function(){d(!0)})},0)},y=function(){var t=e("#ai1ec_suggested_location"),n=e("#ai1ec_suggested_radius"),r=e("#ai1ec_suggested_lat"),i=e("#ai1ec_suggested_lng"),s=function(){n.val(""),r.val(""),i.val("")};e("#ai1ec_suggested_location").on("change",function(){s()}).geo_autocomplete(new google.maps.Geocoder,{selectFirst:!0,minChars:2,cacheLength:100,width:400,scroll:!0,scrollHeight:500,autoFill:!0}).result(function(e,o){if(o&&o.geometry&&o.formatted_address){var u=o.formatted_address,a=o.geometry.location.lat(),f=o.geometry.location.lng(),l=o.geometry.viewport;t.val(u),n.val(b(a,f,l.getNorthEast().lat(),l.getNorthEast().lng(),l.getSouthWest().lat(),l.getSouthWest().lng())),r.val(a),i.val(f)}else s()})},b=function(e,t,n,r,i,s){var o=n-i,u=r-s,a=o/.009,f=u/.009/Math.cos(e*Math.PI/180),l=Math.max(a,f),c=l/2;return c},w=function(){var n=E("suggestion");t(function(){n==undefined?s.activate_saved_tab_on_page_load(e.cookie("feeds_active_tab")):(s.activate_saved_tab_on_page_load("#import"),e("#ai1ec_feed_url").val(decodeURI(n))),l(),u(y)})},E=function(t){var n=decodeURIComponent(window.location.search.substring(1)),r=n.split("&"),i,s;for(s=0;s<r.length;s++){i=r[s].split("=");if(i[0]===t)return i[1]===undefined?!0:i[1]}};return{start:w}});

==================================================
FILE PATH: ./public/js/scripts/admin_settings.js
==================================================
timely.define(["jquery_timely","domReady","ai1ec_config","libs/utils","scripts/setting/cache/cache_event_handlers","external_libs/bootstrap/button","libs/collapse_helper","external_libs/bootstrap/tab","external_libs/bootstrap_datepicker","external_libs/bootstrap/tooltip","external_libs/jquery_cookie"],function(e,t,n,r,i){var s=function(){var t=!0;e("#ai1ec-plugins-settings input:text").each(function(){this.value!==""&&(t=!1)}),t===!0&&e("#ai1ec-plugins-settings").remove()},o=function(t){var n=e(this).attr("href");e.cookie("ai1ec_general_settings_active_tab",n)},u=function(){var t=e("#week_view_starts_at"),r=e("#week_view_ends_at"),i=parseInt(t.val(),10),s=parseInt(r.val(),10);if(s<i)return window.alert(n.end_must_be_after_start),r.focus(),!1;var o=s-i;if(o<6)return window.alert(n.show_at_least_six_hours),r.focus(),!1},a=function(){e(".ai1ec-gzip-causes-js-failure").remove()},f=function(){e("#ai1ec_save_settings").on("click",function(t){var r=e("#require_disclaimer").is(":checked"),i=e("#disclaimer").val();!0===r&&""===i&&(alert(n.require_desclaimer),e('#ai1ec-general-settings ul.ai1ec-nav a[href="#ai1ec-advanced"]').tab("show"),e("#disclaimer").focus(),t.preventDefault())})},l=function(){e("fieldset.ai1ec-captcha_provider").addClass("ai1ec-hidden"),e(".ai1ec-"+e(this).val()).removeClass("ai1ec-hidden")},c=function(){t(function(){f(),a(),r.activate_saved_tab_on_page_load(e.cookie("ai1ec_general_settings_active_tab")),e(document).on("click",'#ai1ec-general-settings .ai1ec-nav a[data-toggle="ai1ec-tab"]',o),e(document).on("click","#disable_standard_filter_menu_toggler",function(e){e.preventDefault()}),e(document).on("click","#ai1ec-button-refresh",i.perform_rescan);var t=e("#exact_date");t.datepicker({autoclose:!0}),s(),e(document).on("click",".ai1ec-admin-view-settings .ai1ec-toggle-view",function(){var t=e(this),n=t.parent().index()+1;if(0===t.closest("tr").siblings().find("td:nth-child("+n+") .ai1ec-toggle-view:checked").length)return!1;if(t.parent().next("td").find(".ai1ec-toggle-default-view").is(":checked"))return!1});var n=function(){var t=e(this).closest(".ai1ec-form-group").nextAll(".ai1ec-form-group").slice(0,4);e(this).prop("checked")?t.show():t.hide()};n.apply(e("#affix_filter_menu").on("click",n)[0]),e(document).on("click",".ai1ec-admin-view-settings .ai1ec-toggle-default-view",function(){e(this).parent().prev("td").children(".ai1ec-toggle-view").prop("checked",!0)}),e(document).on("change","#captcha_provider",l),r.init_autoselect();var c=e.cookie("ai1ec_api_signup_hidden");1!=c&&e(".ai1ec-signup-show").click(),e("#ai1ec_save_settings").on("click",u),e("#show_create_event_button").trigger("ready")})};return e('[name="ai1ec_tickets_signin"]').on("click",function(){e(".ai1ec-ticket-field-error").hide(),e(".ai1ec-required:visible").each(function(){var t=e(this);t.removeClass("ai1ec-error");if(!e.trim(t.val())||"checkbox"===t.attr("type")&&!this.checked)t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-ticket-field-error").show()});if(!e(".ai1ec-ticket-field-error:visible").length){e(".ai1ec-noauto").remove();var t=e("#ai1ec-api-signup-form"),n=t.attr("data-action"),r=e("<form></form",{method:"POST",action:n,"class":"ai1ec-hidden"});t.appendTo(r),r.appendTo("body").submit()}return!1}),e('[name="ai1ec_signing"]').on("click",function(){e(".ai1ec-error").removeClass("ai1ec-error"),"2"===this.value?(e(".ai1ec-ticketing-signup tr").not(":first").not(".signin").hide(),e(".signin").removeClass("ai1ec-hidden")):(e(".ai1ec-ticketing-signup tr").show(),e(".signin:last").addClass("ai1ec-hidden"))}),e("#ai1ec-api-signout").on("click",function(){return e("#ai1ec-api-signout-confirm").show(),e(this).hide(),!1}),e("#ai1ec-api-signout-cancel").on("click",function(){return e("#ai1ec-api-signout-confirm").hide(),e("#ai1ec-api-signout").show(),!1}),e("#ai1ec-api-signout-confirm").on("click",function(){if(!e("#ai1ec-api-signout-confirm:visible").length)return!1;var t=e("#ai1ec-api-signed-in"),n=e("#ai1ec-api-signout").attr("data-action"),r=e('<input type="hidden" name="ai1ec_signout" value="1" />'),i=e("<form></form",{method:"POST",action:n,"class":"ai1ec-hidden"});return i.append(r,t).appendTo("body").submit(),!1}),e(".ai1ec-api-signup-hide").on("click",function(){return e("#ai1ec-api-signup-form").addClass("ai1ec-hidden"),e(".ai1ec-signup-show").removeClass("ai1ec-hidden").show(),e(this).hide(),e.cookie("ai1ec_api_signup_hidden",1),!1}),e(".ai1ec-signup-show").on("click",function(){return e("#ai1ec-api-signup-form").removeClass("ai1ec-hidden"),e(".ai1ec-api-signup-hide").removeClass("ai1ec-hidden").show(),e(this).hide(),e.cookie("ai1ec_api_signup_hidden",0),!1}),{start:c}});

==================================================
FILE PATH: ./public/js/scripts/calendar_feeds/ics/ics_ajax_handlers.js
==================================================
timely.define(["jquery_timely","libs/utils"],function(e,t){var n=function(n){var r=e("#ai1ec_add_new_ics"),o=e("#ai1ec_feed_url");r.button("reset");if(n.error){var u=t.make_alert(n.message,"error");e("#ics-alerts").append(u).prependTo("#import")}else{s(),e("#ai1ec-feeds-after").addClass("ai1ec-well ai1ec-well-sm").insertAfter("#ics .ai1ec-form-horizontal");var a=n.update.data.ics_id,f=e(n.message),l=e('.ai1ec_feed_id[value="'+a+'"] ').closest(".ai1ec-feed-container");f.find(".ai1ec-collapse").removeClass("ai1ec-collapse");var l=e('.ai1ec_feed_id[value="'+a+'"] ').closest(".ai1ec-feed-container");l.length?l.replaceWith(f):e("#ics .ai1ec-ics-feeds-list").append(f),e('a[href="#ics"]').click(),n.update&&n.update.data&&!n.update.data.error&&i(n.update.data)}},r=function(n){var r=e("input[value="+n.ics_id+"]").closest(".ai1ec-feed-container"),i=n.error?"error":"success",s=t.make_alert(n.message,i);n.error?e(".ai1ec_update_ics",r).button("reset"):r.remove(),e("#ics-alerts").append(s)},i=function(n){var r=e("input[value="+n.ics_id+"]").closest(".ai1ec-feed-container"),i=n.error?"error":"success",s=t.make_alert(n.message,i);e(".ai1ec_update_ics",r).button("reset"),e("#ics-alerts").append(s).prependTo("#ics")},s=function(){e("#ai1ec_feed_url").val(" ").prop("readonly",!1),e('#ai1ec-feeds-after input[type="checkbox"]').prop("checked",!1),e("#ai1ec_feed_id").remove(),e("#ai1ec_feed_category").select2("val",""),e("#ai1ec_feed_tags").select2("val",""),e('[id^="ai1ec_feed_cfg_"]').select2("val",""),e("#ai1ec_ics_add_new, #ai1ec_add_new_ics > i").removeClass("ai1ec-hidden"),e("#ai1ec_ics_update").addClass("ai1ec-hidden"),e("#ics .ai1ec-alert").remove()};return{handle_add_new_ics:n,handle_delete_ics:r,handle_update_ics:i,reset_form:s}});

==================================================
FILE PATH: ./public/js/scripts/calendar_feeds/ics/ics_event_handlers.js
==================================================
timely.define(["jquery_timely","scripts/calendar_feeds/ics/ics_ajax_handlers","libs/utils","ai1ec_config","external_libs/select2"],function(e,t,n,r){var i=n.get_ajax_url(),s=function(){var s=e(this),o=e("#ai1ec_feed_url"),u=o.val().replace("webcal://","http://"),a=e("#ai1ec_feed_id").val(),f=!1,l;e(".ai1ec-feed-url, #ai1ec_feed_url").css("border-color","#DFDFDF"),e("#ai1ec-feed-error").remove(),a||e(".ai1ec-feed-url").each(function(){this.value===u&&(e(this).css("border-color","#FF0000"),f=!0,l=r.duplicate_feed_message)}),n.isUrl(u)||(f=!0,l=r.invalid_url_message);if(f)o.addClass("input-error").focus().before(n.make_alert(l,"error"));else{s.button("loading");var c=e("#ai1ec_comments_enabled").is(":checked")?1:0,h=e("#ai1ec_map_display_enabled").is(":checked")?1:0,p=e("#ai1ec_add_tag_categories").is(":checked")?1:0,d=e("#ai1ec_keep_old_events").is(":checked")?1:0,v=e("#ai1ec_feed_import_timezone").is(":checked")?1:0,m={action:"ai1ec_add_ics",nonce:r.calendar_feeds_nonce,feed_url:u,feed_category:e("#ai1ec_feed_category").val(),feed_tags:e("#ai1ec_feed_tags").val(),comments_enabled:c,map_display_enabled:h,keep_tags_categories:p,keep_old_events:d,feed_import_timezone:v};e(".ai1ec-feed-field").each(function(){var t=e(this).val();"checkbox"===e(this).attr("type")&&!e(this).prop("checked")&&(t=0),m[e(this).attr("name")]=t}),a&&(m.feed_id=a),e.post(i,m,t.handle_add_new_ics,"json")}},o=function(){var t=e(this),n=t.closest(".ai1ec-feed-container"),r=e("#ai1ec-feeds-after"),i=e("#ai1ec_ics_add_new, #ai1ec_add_new_ics > i"),s=e("#ai1ec_ics_update"),o=(e(".ai1ec-feed-category",n).data("ids")||"").toString(),u=(e(".ai1ec-feed-tags",n).data("ids")||"").toString(),a=e(".ai1ec-cfg-feed",n),f=[];a.each(function(){var t=e(this);f[t.attr("data-group_name")]=t.attr("data-terms")}),e("#ai1ec_feed_url").val(e(".ai1ec-feed-url",n).val()).prop("readonly",!0),e("#ai1ec_comments_enabled").prop("checked",e(".ai1ec-feed-comments-enabled",n).data("state")),e("#ai1ec_map_display_enabled").prop("checked",e(".ai1ec-feed-map-display-enabled",n).data("state")),e("#ai1ec_add_tag_categories").prop("checked",e(".ai1ec-feed-keep-tags-categories",n).data("state")),e("#ai1ec_keep_old_events").prop("checked",e(".ai1ec-feed-keep-old-events",n).data("state")),e("#ai1ec_feed_import_timezone").prop("checked",e(".ai1ec-feed-import-timezone",n).data("state")),i.addClass("ai1ec-hidden"),s.removeClass("ai1ec-hidden"),e('<input type="hidden" id="ai1ec_feed_id" name="ai1ec_feed_id">').val(e(".ai1ec_feed_id",n).val()).appendTo(r),e("#ai1ec_feed_category").select2("val",o.split(",")),e("#ai1ec_feed_tags").select2("val",u.split(","));for(var l in f)e('[id="ai1ec_feed_cfg_'+l.toLowerCase()+'"]').select2("val",f[l].split(",")||f[l]);var c=e(".ai1ec-feed-content",n);c.hide(),e("#ai1ec_cancel_ics").show(),e("#ai1ec-feeds-after").removeClass("ai1ec-well ai1ec-well-sm").insertAfter(c),e("#ics .ai1ec-alert").remove()},u=function(n){return e("#ai1ec-feeds-after").addClass("ai1ec-well ai1ec-well-sm").appendTo("#import"),e(".ai1ec-feed-content").show(),t.reset_form(),e("#ai1ec_cancel_ics").hide(),!1},a=function(n){n.preventDefault();var r=e(this).hasClass("remove")?!0:!1,s=e(e(this).data("el")),o=s.closest(".ai1ec-feed-container"),u=e(".ai1ec_feed_id",o).val(),a={action:"ai1ec_delete_ics",ics_id:u,remove_events:r};s.button("loading"),e("#ai1ec-ics-modal").modal("hide"),e.post(i,a,t.handle_delete_ics,"json")},f=function(){e("#ai1ec-ics-modal .ai1ec-btn").data("el",this),e("#ai1ec-ics-modal").modal({backdrop:"static"})},l=function(){var n=e(this),r=n.closest(".ai1ec-feed-container"),s=e(".ai1ec_feed_id",r).val(),o={action:"ai1ec_update_ics",ics_id:s};n.button("loading"),e.post(i,o,t.handle_update_ics,"json")};return{add_new_feed:s,submit_delete_modal:a,open_delete_modal:f,update_feed:l,edit_feed:o,edit_cancel:u}});

==================================================
FILE PATH: ./public/js/scripts/calendar/load_views.js
==================================================
timely.define(["jquery_timely","scripts/calendar/print","scripts/calendar/agenda_view","scripts/calendar/month_view","libs/frontend_utils","libs/utils","ai1ec_calendar","ai1ec_config","scripts/common_scripts/frontend/common_frontend","libs/select2_multiselect_helper","external_libs/twig","agenda","oneday","month","external_libs/jquery_history","external_libs/jquery.tablescroller","external_libs/jquery.scrollTo","external_libs/bootstrap_datepicker","external_libs/bootstrap/alert","external_libs/jquery_cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){e.cookie.json=!0;var d="ai1ec_saved_filter",v=!e("#save_filtered_views").hasClass("ai1ec-hide");timely.renderer_map||(timely.renderer_map={}),e.extend(timely.renderer_map,{agenda:c,oneday:h,week:h,month:p});var m=function(t){var n=t.find("#ai1ec-view-dropdown .ai1ec-dropdown-menu .ai1ec-active a"),i=u.week_view_ends_at-u.week_view_starts_at,s=i*60;t.find("table.ai1ec-week-view-original").tableScroll({height:s,containerClass:"ai1ec-week-view ai1ec-popover-boundary",scroll:!1}),t.find("table.ai1ec-oneday-view-original").tableScroll({height:s,containerClass:"ai1ec-oneday-view ai1ec-popover-boundary",scroll:!1});if(t.find(".ai1ec-week-view").length||t.find(".ai1ec-oneday-view").length)t.find(".ai1ec-oneday-view .tablescroll_wrapper, .ai1ec-week-view .tablescroll_wrapper").scrollTo(t.find(".ai1ec-hour-marker:eq("+u.week_view_starts_at+")")),t.find(".ai1ec-hour-marker:eq("+u.week_view_starts_at+")").addClass("ai1ec-first-visible");t.find(".ai1ec-month-view .ai1ec-multiday").length&&r.extend_multiday_events(t),t.find(".ai1ec-calendar-view-container").data("ai1ec-inited",!0).trigger("initialize_view.ai1ec"),t.find(".ai1ec-calendar-toolbar").trigger("ai1ec-affix.reinit"),e(".ai1ec-event[data-ticket-url], .ai1ec-has-tickets-button").each(function(){var t=e(this),n=t.data("ticket-url"),r=e.merge(e(".ai1ec-sas-action-tickets",t),e(".ai1ec-sas-action-tickets",t.parent("a").next(".ai1ec-popover"))).attr("href",n)})},g=function(t){t.find(".ai1ec-calendar-view-container").trigger("destroy_view.ai1ec");var n=t.find(".ai1ec-minical-trigger").data("datepicker");typeof n!="undefined"&&(n.picker.remove(),e(document).off("changeDate",".ai1ec-minical-trigger")),t.find(".ai1ec-tooltip.ai1ec-in, .ai1ec-popup").remove(),t.find(".ai1ec-calendar-toolbar .ai1ec-btn-toolbar").remove()},y=function(){var t=[],n=[],r=[],i;e(".ai1ec-category-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){t.push(e(this).data("term"))}),e(".ai1ec-tag-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){n.push(e(this).data("term"))}),e(".ai1ec-author-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){r.push(e(this).data("term"))});var s={};return s.cat_ids=t,s.tag_ids=n,s.auth_ids=r,i=e(".ai1ec-views-dropdown .ai1ec-dropdown-menu .ai1ec-active").data("action"),s.action=i,s},b=function(){var t=History.getState(),n=e.cookie(d);if(null===n||undefined===n)n={};var r=y();u.is_calendar_page?n.calendar_page=r:n[t.url]=r,e.cookie(d,n,{path:"/",expires:365}),e("#save_filtered_views").addClass("ai1ec-active").attr("data-original-title",u.clear_saved_filter_text);var i=s.make_alert(u.save_filter_text_ok,"success");e("#ai1ec-calendar").prepend(i)},w=function(t){t.stopImmediatePropagation();var n=e.cookie(d);if(u.is_calendar_page)delete n.calendar_page;else{var r=History.getState();delete n[r.url]}e.cookie(d,n,{path:"/",expires:365}),e("#save_filtered_views").removeClass("ai1ec-active").attr("data-original-title",u.reset_saved_filter_text),v||e("#save_filtered_views").addClass("ai1ec-hide");var i=s.make_alert(u.remove_filter_text_ok,"success");e("#ai1ec-calendar").prepend(i)},E=!1,S={},x=function(t,n,r){D(t,n),t.find(".ai1ec-calendar-view-loading").fadeIn("fast").end().find(".ai1ec-calendar-view").fadeTo("fast",.3,function(){var i={request_type:r,ai1ec_doing_ajax:!0};e("#ai1ec-container > .ai1ec-alert").remove(),E&&1===E.readyState&&E.abort("ai1ec_abort");var o="-"+i.request_type;S[n+o]?E=S[n+o]:(E=e.ajax({url:n,dataType:r,data:i,method:"GET"}),S[n+o]=E.promise()),E.done(function(i){e(document).trigger("calendar_view_loaded.ai1ec",t),g(t),typeof i.views_dropdown=="string"&&t.find(".ai1ec-views-dropdown").replaceWith(i.views_dropdown),typeof i.categories=="string"&&t.find(".ai1ec-category-filter").replaceWith(i.categories),typeof i.authors=="string"&&t.find(".ai1ec-author-filter").replaceWith(i.authors),typeof i.tags=="string"&&t.find(".ai1ec-tag-filter").replaceWith(i.tags);if(typeof i.custom_filters=="string"){var s=t.find("li.ai1ec-custom-filter").parent();t.find("li.ai1ec-custom-filter").remove(),s.append(i.custom_filters)}typeof i.subscribe_buttons=="string"&&t.find(".ai1ec-subscribe-container").empty().append(i.subscribe_buttons),typeof i.save_view_btngroup=="string"&&t.find("#save_filtered_views").closest(".ai1ec-btn-group").replaceWith(i.save_view_btngroup),v=i.are_filters_set;var o;if(i.is_json){var u=i.html.type;if(!timely.renderer_map[u]){x(t,n.replace(/\~json/,"~html"),r);return}o=timely.renderer_map[u]}t.find(".ai1ec-calendar-view").html(o?o.render(i.html):e(i.html).find(".ai1ec-calendar-view").length?e(i.html).find(".ai1ec-calendar-view").html():i.html),m(t);var a=t.offset().top-21;e(window).scrollTop()>a&&window.scrollTo(0,a)}),E.fail(function(n,r,i){if("ai1ec_abort"===r)return;var o=u.load_views_error;o=o.replace("%STATUS%",n.status),o=o.replace("%ERROR%",i),o=o+"<br/>"+s.make_popup_content_link(u.load_views_error_link_popup,u.load_views_error_popup_title,n.responseText);var a=s.make_alert(o,"error",!0);e("#ai1ec-container").prepend(a),g(t),m(t)}),E.always(function(){t.find(".ai1ec-calendar-view-loading").fadeOut("fast"),t.find(".ai1ec-calendar-view").fadeTo("fast",1)})})},T=!1,N=function(t){var n=History.getState(),r=e(".ai1ec-calendar:first");if(n.data.ai1ec!==undefined&&!0===n.data.ai1ec||!0===T)T=!0,x(r,n.url,"json")},C=function(e,t,n){if(t==="json"){var r={ai1ec:!0};null===n.match(/^http/)&&(n=location.protocol+n),History.pushState(r,document.title,decodeURI(n))}else x(e,n,"jsonp")},k=function(t){var n=e(this),r=n.closest(".ai1ec-calendar");t.preventDefault(),C(r,n.data("type"),n.attr("href"))},L=function(t){var n=e(this);t.preventDefault();if(typeof n.data("datepicker")=="undefined"){n.datepicker({todayBtn:"linked",todayHighlight:!0,language:n.data("lang")});var r=n.data("datepicker");if(n.closest(".ai1ec-pull-right").length>0){r.picker.addClass("ai1ec-right-aligned");var i=r.place;r.place=function(){i.call(this);var t=this.component?this.component:this.element,n=t.offset();this.picker.css({left:"auto",right:e(document).width()-n.left-t.outerWidth()})}}e(document).one("changeDate",".ai1ec-minical-trigger",A)}n.datepicker("show")},A=function(t){var n,r=e(this),i=r.closest(".ai1ec-calendar"),s;r.datepicker("hide"),n=r.data("href"),s=t.format(),s=s.replace(/\//g,"-"),n=n.replace("__DATE__",s),C(i,r.data("type"),n)},O=function(t){var n;typeof t.added!="undefined"?n=e(t.added.element).data("href"):n=e("option[value="+t.removed.id+"]",t.target).data("href");var r={ai1ec:!0};History.pushState(r,null,n)},M=function(){var t=e(this).closest(".ai1ec-calendar");return C(t,e(this).attr("data-type"),e(this).attr("data-href")),!1},_=u.ai1ec_permalinks_enabled?"/":"|",D=function(t,n){var r={},i=function(i,s){var o=e(".ai1ec-filters .ai1ec-load-view."+s.filter_class,t),u=e(s.filter_button,t),a=new RegExp(i+"~((,?[0-9]+)+)"),f=n.match(a),l=n.match(/action~(\w+)/),l=l&&l[1]?l[1]:null,f=f&&f[1]?e.map(f[1].split(","),function(e){return parseInt(e,10)}):[];r[i]=f.join(","),o.each(function(){var t=this.href,n=e(this).closest("[data-term]"),r=n.data("term"),s=e.extend(!0,[],f);-1<e.inArray(r,f)?(s=e.grep(s,function(e){return r!=e}),n.addClass("ai1ec-active")):(s.push(r),n.removeClass("ai1ec-active"));var o=s.length?i+"~"+s.join(","):"";t.match(a)?this.href=t.replace(a,o):s.length&&(this.href+=_+o),l&&(this.href=this.href.replace(/action~(\w+)/,"action~"+l)),this.href=P(this.href)}),e(s.filter_items,t).length?u.addClass("ai1ec-active"):u.removeClass("ai1ec-active"),e(".ai1ec-clear-filter",u).each(function(){e(this).attr("data-href",P(e(this).attr("data-href").replace(a,"").replace(/action~(\w+)/,"action~"+l)))})},s={};e("ul.ai1ec-filters > li",t).each(function(){var t=e(this),n=t.data("slug");s[n+"_ids"]={filter_class:"ai1ec-"+n,filter_button:"li.ai1ec-"+n+"-filter",filter_items:".ai1ec-"+n+"-filter .ai1ec-active"}});for(var o in s)i(o,s[o]);for(var o in r){var u=r[o],a=new RegExp(o+"~((,?[0-9]+)+)");e(".ai1ec-filters .ai1ec-load-view").each(function(){if(e(this).hasClass(s[o].filter_class))return;u?this.href.match(a)?this.href=this.href.replace(a,o+"~"+u):this.href=this.href+_+o+"~"+u:this.href=P(this.href.replace(a,""))}),e(".ai1ec-clear-filter",t).each(function(){var t=e(this),n=t.closest("[data-slug]").data("slug");n===o.substr(0,o.length-4)||!u?t.attr("data-href",P(t.attr("data-href").replace(a,""))):t.attr("data-href").match(a)?t.attr("data-href",P(t.attr("data-href").replace(a,o+"~"+u))):t.attr("data-href",P(t.attr("data-href")+_+o+"~"+u))})}},P=function(e){return"/"===_?e.replace(/\/\//g,"/").replace(/\/\//g,"/").replace(/:\//g,"://"):e.replace(/\|\|/g,"|").replace(/\|\|/g,"|")};return{initialize_view:m,handle_click_on_link_to_load_view:k,handle_minical_trigger:L,handle_minical_change_date:A,clear_filters:M,handle_state_change:N,load_view:x,save_current_filter:b,remove_current_filter:w,load_view_from_select2_filter:O,load_view_according_to_datatype:C}});

==================================================
FILE PATH: ./public/js/scripts/calendar/calendar-affix.js
==================================================
timely.define(["jquery_timely","ai1ec_config"],function(e,t){var n=function(n){var r=n.find(".ai1ec-calendar-toolbar");r.length||(r=e("<div />",{"class":"timely ai1ec-calendar-toolbar ai1ec-empty-toolbar ai1ec-clearfix"}),n.prepend(r));var i=n.find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").css("clear","both"),s=r.find(".ai1ec-dropdown-toggle"),o=n.find("#ai1ec-calendar-view"),u=e("#wpadminbar"),a=r.offset().top,f=0,l=null,c=function(){return e("#ai1ec-bs-modes div:visible:first").text()},h=function(){var t=["xs","sm","md","lg"],n=e('<div id="ai1ec-bs-modes"></div>');for(var r in t)e('<div class="ai1ec-device-'+t[r]+" ai1ec-visible-"+t[r]+'">'+t[r]+"</div>").appendTo(n);n.appendTo("body")},p=function(){return parseInt(t["affix_vertical_offset_"+c()]||0)},d=function(){s.each(function(){e(this).contents().eq(-3).wrap('<div class="ai1ec-hidden" />')})},v=function(){s.find(".ai1ec-hidden").contents().unwrap()},m=function(){var e=0;"fixed"===u.css("position")&&(e=u.height()),r.css("top",e+p()+"px")},g=function(){return f},y=function(){f=a-("fixed"===u.css("position")?u.height():0)-p()},b=function(){r.height()>r.data("original_height")?(d(),r.height()>r.data("original_height")&&v()):v()},w=function(){n.find(".ai1ec-affix .ai1ec-views-dropdown").closest("div.ai1ec-clearfix").remove(),i=n.find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix"),s=r.find(".ai1ec-dropdown-toggle"),r.trigger("ai1ec-affix-top.bs.affix").find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").hide().end().end().data({original_height:r.height()}).find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").show().end().end().filter(".ai1ec-affix").trigger("ai1ec-affix.bs.affix")},E=function(){r.hasClass("ai1ec-affix")&&r.addClass("ai1ec-was-affixed"),y(),r.removeClass("ai1ec-affix").css("width",n.width()).find(".ai1ec-btn-toolbar").hide().end().data({original_height:r.height()}),m(),a=r.offset().top,r.filter(".ai1ec-was-affixed").addClass("ai1ec-affix").removeClass("ai1ec-was-affixed").find(".ai1ec-btn-toolbar").show(),l=null};return h(),y(),r.data({original_height:r.height()}).css("width",n.width()).affix({offset:{top:g,bottom:0}}).on("ai1ec-affix.bs.affix",function(){var t=o.offset().top;i.hide().appendTo(r).show().css("opacity",0).animate({opacity:1},400),b(),m(),o.css("margin-top",r.outerHeight(!0)+parseInt(r.css("margin-bottom"))+"px"),e("body").addClass("ai1ec-has-affixed-toolbar")}).on("ai1ec-affix-top.bs.affix",function(){i.hide(),o.prepend(i),i.show().css("opacity",0).animate({opacity:1},400),v(),m(),o.css("margin-top",0),r.data("original_height",r.height()),e("body").removeClass("ai1ec-has-affixed-toolbar")}).on("ai1ec-affix.reinit",w).filter(".ai1ec-affix").trigger("ai1ec-affix.bs.affix"),e(window).on("resize.affix",function(){clearTimeout(l),l=setTimeout(E,100)}),n};return{initialize_affixed_toolbar:n}});

==================================================
FILE PATH: ./public/js/scripts/calendar/event.js
==================================================
/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/*!
 * jQuery.ScrollTo
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 12/14/2012
 *
 * @projectDescription Easy element scrolling using jQuery.
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @author Ariel Flesler
 * @version 1.4.5 BETA
 *
 * @id jQuery.scrollTo
 * @id jQuery.fn.scrollTo
 * @param {String, Number, DOMElement, jQuery, Object} target Where to scroll the matched elements.
 *	  The different options for target are:
 *		- A number position (will be applied to all axes).
 *		- A string position ('44', '100px', '+=90', etc ) will be applied to all axes
 *		- A jQuery/DOM element ( logically, child of the element to scroll )
 *		- A string selector, that will be relative to the element to scroll ( 'li:eq(2)', etc )
 *		- A hash { top:x, left:y }, x and y can be any kind of number/string like above.
 *		- A percentage of the container's dimension/s, for example: 50% to go to the middle.
 *		- The string 'max' for go-to-end.
 * @param {Number, Function} duration The OVERALL length of the animation, this argument can be the settings object instead.
 * @param {Object,Function} settings Optional set of settings or the onAfter callback.
 *	 @option {String} axis Which axis must be scrolled, use 'x', 'y', 'xy' or 'yx'.
 *	 @option {Number, Function} duration The OVERALL length of the animation.
 *	 @option {String} easing The easing method for the animation.
 *	 @option {Boolean} margin If true, the margin of the target element will be deducted from the final position.
 *	 @option {Object, Number} offset Add/deduct from the end position. One number for both axes or { top:x, left:y }.
 *	 @option {Object, Number} over Add/deduct the height/width multiplied by 'over', can be { top:x, left:y } when using both axes.
 *	 @option {Boolean} queue If true, and both axis are given, the 2nd axis will only be animated after the first one ends.
 *	 @option {Function} onAfter Function to be called after the scrolling ends.
 *	 @option {Function} onAfterFirst If queuing is activated, this function will be called after the first scrolling ends.
 * @return {jQuery} Returns the same jQuery object, for chaining.
 *
 * @desc Scroll to a fixed position
 * @example $('div').scrollTo( 340 );
 *
 * @desc Scroll relatively to the actual position
 * @example $('div').scrollTo( '+=340px', { axis:'y' } );
 *
 * @desc Scroll using a selector (relative to the scrolled element)
 * @example $('div').scrollTo( 'p.paragraph:eq(2)', 500, { easing:'swing', queue:true, axis:'xy' } );
 *
 * @desc Scroll to a DOM element (same for jQuery object)
 * @example var second_child = document.getElementById('container').firstChild.nextSibling;
 *			$('#container').scrollTo( second_child, { duration:500, axis:'x', onAfter:function(){
 *				alert('scrolled!!');
 *			}});
 *
 * @desc Scroll on both axes, to different values
 * @example $('div').scrollTo( { top: 300, left:'+=200' }, { axis:'xy', offset:-20 } );
 */

timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("external_libs/jquery.scrollTo",["jquery_timely"],function(e){function n(e){return typeof e=="object"?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,r){e(window).scrollTo(t,n,r)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})},e.fn.scrollTo=function(r,i,s){return typeof i=="object"&&(s=i,i=0),typeof s=="function"&&(s={onAfter:s}),r=="max"&&(r=9e9),s=e.extend({},t.defaults,s),i=i||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(i/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function h(e){u.animate(l,i,s.easing,e&&function(){e.call(this,r,s)})}if(r==null)return;var o=this,u=e(o),a=r,f,l={},c=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)f=(a=e(a)).offset()}e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),p="scroll"+r,d=o[p],v=t.max(o,n);if(f)l[p]=f[i]+(c?0:d-u.offset()[i]),s.margin&&(l[p]-=parseInt(a.css("margin"+r))||0,l[p]-=parseInt(a.css("border"+r+"Width"))||0),l[p]+=s.offset[i]||0,s.over[i]&&(l[p]+=a[n=="x"?"width":"height"]()*s.over[i]);else{var m=a[i];l[p]=m.slice&&m.slice(-1)=="%"?parseFloat(m)/100*v:m}s.limit&&/^\d+$/.test(l[p])&&(l[p]=l[p]<=0?0:Math.min(l[p],v)),!e&&s.queue&&(d!=l[p]&&h(s.onAfterFirst),delete l[p])}),h(s.onAfter)}).end()},t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])}}),timely.define("scripts/calendar/event",["jquery_timely","libs/utils","external_libs/jquery.scrollTo"],function(e,t){var n=function(n){n.preventDefault(),e("div.ai1ec-popover").remove();var r="jsonp",i=e(this).closest(".timely-calendar"),s={request_type:r,ai1ec_doing_ajax:!0,ai1ec:t.create_ai1ec_to_send(i)};e.ajax({url:e(this).attr("href"),dataType:r,data:s,method:"get",success:function(t){e(n.target).closest("#ai1ec-calendar-view").html(t.html);var r=e(".ai1ec-calendar-link").attr("href"),s=e(n.target).closest(".timely-calendar").data("action");s&&(r=r+"action~"+s+"/"),e.scrollTo(i,1e3,{offset:{left:0,top:-100}}),timely.require(["pages/event"])}})};return{load_event_through_jsonp:n}});

==================================================
FILE PATH: ./public/js/scripts/calendar/print.js
==================================================
timely.define(["jquery_timely"],function(e){var t=function(t){t.preventDefault();var n=e("body"),r=e("html"),i=e(this).closest(".ai1ec-calendar").html(),s=n.html();s=s.replace(/<script.*?>([\s\S]*?)<\/script>/gmi,""),n.empty(),n.addClass("timely"),r.addClass("ai1ec-print"),n.html(i),e("span").click(function(){return!1}),e(".ai1ec-agenda-view a").each(function(){e(this).data("href",e(this).attr("href")),e(this).attr("href","#")}),window.print(),e(".ai1ec-agenda-view a").each(function(){e(this).attr("href",e(this).data("href")),e(this).data("href","")}),n.removeClass("timely"),r.removeClass("ai1ec-print"),n.html(s)};return{handle_click_on_print_button:t}});

==================================================
FILE PATH: ./public/js/scripts/calendar/month_view.js
==================================================
timely.define(["jquery_timely","external_libs/modernizr"],function(e,t){var n=navigator.userAgent.match(/opera/i),r=navigator.userAgent.match(/webkit/i),i=function(t){var n=t.find(".ai1ec-day"),r=t.find(".ai1ec-week:first .ai1ec-day").length;t.find(".ai1ec-month-view .ai1ec-multiday").each(function(){var t=this.parentNode,r=e(this).outerHeight(!0),i=e(".ai1ec-date",t),u=parseInt(i.text(),10),a=e(this).data("endTruncated"),f=parseInt(a?e(n[n.length-1]).text():e(this).data("endDay"),10),l=e(this),c=e(".ai1ec-event",l)[0].style.backgroundColor,h=0,p=f-u+1,d=p,v,m=0;n.each(function(t){var n=e(".ai1ec-date",this),r=e(this.parentNode),i=r.index(),a=parseInt(n.text(),10);if(a>=u&&a<=f){a===u&&(v=parseInt(n.css("marginBottom"),10)+16,newMargin=v,$week=n.closest(".ai1ec-week"),$multidayEvents=$week.find("a.ai1ec-multiday[data-end-day]").filter(function(){return e(this).offset().left<n.offset().left&&e(this).offset().left+e(this).width()>n.offset().left}),$multidayEvents.each(function(){var t=e(this).prop("offsetTop");if(null===newMargin||t>newMargin)newMargin=t}),null!==newMargin&&$multidayEvents.length&&newMargin>v&&(newMargin+=19,v=newMargin,n.css("marginBottom",newMargin+"px"))),h===0&&m++;if(i===0&&a>u&&d!==0){var p=l.next(".ai1ec-popup").andSelf().clone(!1);n.parent().append(p);var g=p.first();g.addClass("ai1ec-multiday-bar ai1ec-multiday-clone"),g.css({position:"absolute",left:"1px",top:parseInt(n.css("marginBottom"),10)+13,backgroundColor:c});var y=d>7?7:d;g.css("width",s(y)),d>7&&g.append(o(1,c)),g.append(o(2,c))}h===0?n.css({marginBottom:v+"px"}):n.css({marginBottom:"+=16px"}),d--,d>0&&i===6&&h++}});if(a){var g=l.find("."+l[0].className.replace(/\s+/igm,".")).last();g.append(o(1,c))}e(this).css({position:"absolute",top:i.outerHeight(!0)-r-1+"px",left:"1px",width:s(m)}),h>0&&e(this).append(o(1,c)),e(this).data("startTruncated")&&e(this).append(o(2,c)).addClass("ai1ec-multiday-bar")}),n.each(function(){var t=e(".ai1ec-date",this),n=parseInt(t.text(),10),r=t.closest(".ai1ec-week"),i=e(this).find("a.ai1ec-event-container:not(.ai1ec-multiday)").length,s=null,o;if(0===i)return;o=r.find("a.ai1ec-multiday[data-end-day]").filter(function(){return e(this).offsetLeft<=t.offset().left&&e(this).offsetLeft+e(this).width()>=t.offset().left}),o.each(function(){var t=e(this).prop("offsetTop");if(null===s||t>s)s=t}),null!==s&&(s+=3,t.css("marginBottom",s))})},s=function(e){var t;switch(e){case 1:t=97.5;break;case 2:t=198.7;break;case 3:t=300;break;case 4:t=401;break;case 5:r||n?t=507:t=503.4;break;case 6:r||n?t=608:t=603.5;break;case 7:r||n?t=709:t=705}return t+"%"},o=function(t,n){var r=e('<div class="ai1ec-multiday-arrow'+t+'"></div>');return t===1?r.css({borderLeftColor:n}):r.css({borderTopColor:n,borderRightColor:n,borderBottomColor:n}),r};return{extend_multiday_events:i}});

==================================================
FILE PATH: ./public/js/scripts/calendar/agenda_view.js
==================================================
timely.define(["jquery_timely"],function(e){var t=function(){e(this).closest(".ai1ec-event").toggleClass("ai1ec-expanded").find(".ai1ec-event-summary").slideToggle(300)},n=function(){var t=e(this).closest(".ai1ec-calendar");t.find(".ai1ec-expanded .ai1ec-event-toggle").click()},r=function(){var t=e(this).closest(".ai1ec-calendar");t.find(".ai1ec-event:not(.ai1ec-expanded) .ai1ec-event-toggle").click()};return{toggle_event:t,collapse_all:n,expand_all:r}});

==================================================
FILE PATH: ./public/js/scripts/common_scripts/backend/common_event_handlers.js
==================================================
/**
	 * Dismiss button clicked in invalid license warning.
	 *
	 * @param  {Event} e jQuery event object
	 */

timely.define(["jquery_timely","scripts/common_scripts/backend/common_ajax_handlers"],function(e,t){var n=function(n){var r={action:"ai1ec_facebook_cron_dismiss"};e.post(ajaxurl,r,t.handle_dismiss_plugins,"json")},r=function(n){var r=e(this);r.attr("disabled",!0);var i={action:"ai1ec_disable_notification",note:!1};e.post(ajaxurl,i,t.handle_dismiss_notification)},i=function(n){var r=e(this);r.attr("disabled",!0);var i={action:"ai1ec_disable_intro_video",note:!1};e.post(ajaxurl,i,t.handle_dismiss_intro_video)},s=function(n){var r=e(this);r.attr("disabled",!0);var i={action:"ai1ec_set_license_warning",value:"dismissed"};e.post(ajaxurl,i,t.handle_dismiss_license_warning)},o=function(t){e(this).parent().next(".ai1ec-limit-by-options-container").toggle().find("option").removeAttr("selected")},u=function(t){$document=e(document.body),$one_shot_popup=e("#ai1ec-one-shot-popup",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-one-shot-popup" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><strong><div id="ai1ec-one-shot-popup-title"/></strong></div><div class="ai1ec-modal-body ai1ec-clearfix"><textarea class="ai1ec-form-control code" rows="8" cols="40" id="ai1ec-one-shot-popup-text"></textarea></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-one-shot-popup",$document));var n=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(n.data("alert-title")),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n.data("alert-text")),$one_shot_popup.modal("show")};return{dismiss_plugins_messages_handler:n,dismiss_notification_handler:r,dismiss_intro_video_handler:i,dismiss_license_warning_handler:s,handle_multiselect_containers_widget_page:o,handle_alert_click:u}});

==================================================
FILE PATH: ./public/js/scripts/common_scripts/backend/common_backend.js
==================================================
timely.define(["jquery_timely","domReady","ai1ec_config","scripts/common_scripts/backend/common_event_handlers","external_libs/Placeholders","external_libs/bootstrap/tooltip","external_libs/bootstrap/popover","external_libs/bootstrap/modal","external_libs/bootstrap/dropdown"],function(e,t,n,r){var i=function(){e("#ai1ec-facebook-filter option[value=exportable]:selected").length>0&&e("table.wp-list-table tr.no-items").length===0&&n.facebook_logged_in==="1"&&(e("<option>").val("export-facebook").text("Export to facebook").appendTo("select[name='action']"),e("<option>").val("export-facebook").text("Export to facebook").appendTo("select[name='action2']"))},s=function(){if(n.platform_active==="1"){e("#menu-posts-ai1ec_event li").each(function(){var t=e(this);if(t.has('a[href$="all-in-one-event-calendar-themes"], a[href$="all-in-one-event-calendar-edit-css"], a[href$="all-in-one-event-calendar-settings"]').length){if(t.is(".current")){var n=e("a",t).attr("href");e('#adminmenu a:not(.current)[href="'+n+'"]').parent().andSelf().addClass("current").end().closest("li.menu-top").find("> a.menu-top").andSelf().addClass("wp-has-current-submenu wp-menu-open").removeClass("wp-not-current-submenu"),t.closest("li.menu-top").find("> a.menu-top").andSelf().removeClass("wp-has-current-submenu wp-menu-open").addClass("wp-not-current-submenu")}t.hide()}});if(e("body.options-reading-php").length){var t=function(){e("#page_on_front").attr("disabled","disabled")};t(),e("#front-static-pages input:radio").change(t),e("#page_on_front").after('<span class="description">'+n.page_on_front_description+"</span>")}n.strict_mode==="1"&&(e("#dashboard-widgets .postbox").not("#ai1ec-calendar-tasks, #dashboard_right_now").remove(),e("#adminmenu > li").not(".wp-menu-separator, #menu-dashboard, #menu-posts-ai1ec_event, #menu-media, #menu-appearance, #menu-users, #menu-settings").remove(),e("#menu-appearance > .wp-submenu li, #menu-settings > .wp-submenu li").not(':has(a[href*="all-in-one-event-calendar"])').remove())}},o=function(){e("#ai1ec-video").length&&(e.ajax({cache:!0,async:!0,dataType:"script",url:"//www.youtube.com/iframe_api"}),window.onYouTubeIframeAPIReady=function(){var t=new YT.Player("ai1ec-video",{height:"368",width:"600",videoId:window.ai1ecVideo.youtubeId});e("#ai1ec-video").css("display","block"),e("#ai1ec-video-modal").on("hide",function(){t.stopVideo()})})},u=function(){e(document).on("click",".ai1ec-facebook-cron-dismiss-notification",r.dismiss_plugins_messages_handler).on("click",".ai1ec-dismiss-notification",r.dismiss_notification_handler).on("click",".ai1ec-dismiss-intro-video",r.dismiss_intro_video_handler).on("click",".ai1ec-dismiss-license-warning",r.dismiss_license_warning_handler).on("click",".ai1ec-limit-by-cat, .ai1ec-limit-by-tag, .ai1ec-limit-by-event",r.handle_multiselect_containers_widget_page).on("click",".ai1ec-dismissable",function(){var t={action:"ai1ec_dismiss_notice",key:e(this).data("key")},n=this;e.post(ajaxurl,t,function(t){e(n).closest(".ai1ec-message").remove()})}),e(document).on("click",".ai1ec-alert-trigger",r.handle_alert_click)},a=function(){e("#ai1ec-support .ai1ec-download a[title]").popover({placement:"left"}),e(".ai1ec-tooltip-toggle").tooltip({container:"body"})},f=function(){var t=e(".ai1ec-taxonomy-header"),n=e(".ai1ec-taxonomy-edit-link"),r;t.length&&(e("form#edittag").length||n.removeClass("ai1ec-hide").appendTo(".wrap > h2:first"),e(".wrap").prepend(t.removeClass("ai1ec-hide")),t.find("li.ai1ec-active").length||(r=e("[data-ai1ec_active_tab]").data("ai1ec_active_tab"),r&&e(r).addClass("ai1ec-active")),e('#menu-posts-ai1ec_event a[href="edit-tags.php?taxonomy=events_categories&post_type=ai1ec_event"]').closest("li").addClass("current"))},l=function(){t(function(){i(),f(),o(),u(),s(),a()})};return{start:l}});

==================================================
FILE PATH: ./public/js/scripts/common_scripts/backend/common_ajax_handlers.js
==================================================
/**
	 * AJAX result after clicking Dismiss in license warning.
	 * @param  {object} response Data returned by HTTP response
	 */

timely.define(["jquery_timely"],function(e){var t=function(t){t&&(typeof t.message!="undefined"?window.alert(t.message):e(".ai1ec-facebook-cron-dismiss-notification").closest(".message").fadeOut())},n=function(t){t.error?window.alert(t.message):e(".ai1ec-dismiss-notification").closest(".message").fadeOut()},r=function(t){t.error?window.alert(t.message):e(".ai1ec-dismiss-intro-video").closest(".message").fadeOut()},i=function(t){t.error?window.alert(t.message):e(".ai1ec-dismiss-license-warning").closest(".message").fadeOut()};return{handle_dismiss_plugins:t,handle_dismiss_notification:n,handle_dismiss_intro_video:r,handle_dismiss_license_warning:i}});

==================================================
FILE PATH: ./public/js/scripts/common_scripts/page_ready.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.require(["jquery_timely","domReady"],function(e,t){t(function(){e(document).trigger("page_ready.ai1ec")})}),timely.define("scripts/common_scripts/page_ready",function(){});

==================================================
FILE PATH: ./public/js/scripts/common_scripts/frontend/common_event_handlers.js
==================================================
timely.define(["jquery_timely","external_libs/bootstrap/affix"],function(e){var t=function(t){var n=e(this),r=n.next(".ai1ec-popup"),i,s,o;if(r.length===0)return;i=r.html(),s=r.attr("class");var u=n.closest("#ai1ec-calendar-view");u.length===0&&(u=e("body")),n.offset().left-u.offset().left>182?o="left":o="right",n.constrained_popover({content:i,title:"",placement:o,trigger:"manual",html:!0,template:'<div class="timely ai1ec-popover '+s+'">'+'<div class="ai1ec-arrow"></div>'+'<div class="ai1ec-popover-inner">'+'<div class="ai1ec-popover-content"><div></div></div>'+"</div>"+"</div>",container:"body"}).constrained_popover("show")},n=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-popup").length===0&&e(this).constrained_popover("hide")},r=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip").length===0&&(e(this).remove(),e("body > .ai1ec-tooltip").remove())},i=function(t){if("ontouchstart"in document.documentElement){t.preventDefault();return}var n=e(this),r={template:'<div class="timely ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"manual",container:"body"};if(n.is(".ai1ec-category .ai1ec-color-swatch")||n.is(".ai1ec-custom-filter .ai1ec-color-swatch"))return;n.is(".ai1ec-tooltip-auto")&&(r.placement=u(250)),n.tooltip(r),n.tooltip("show")},s=function(t){e(this).tooltip("hide")},o=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip-trigger").length===0&&e(this).remove(),n.closest(".ai1ec-popup").length===0&&e("body > .ai1ec-popup").remove()},u=function(t){return function(n,r){var i,s,o=e(r),u=o.attr("data-placement"),a=e.extend({},o.offset(),{width:r.offsetWidth,height:r.offsetHeight}),f=function(){return!1===i?!1:(i=a.left-t>=0,i?"left":!1)},l=function(){return!1===s?!1:(s=a.left+t<=e(window).width(),s?"right":!1)};switch(u){case"top":return"top";case"bottom":return"bottom";case"left":if(f())return"left";case"right":if(l())return"right";default:if(f())return"left";if(l())return"right";return u}}};return{handle_popover_over:t,handle_popover_out:n,handle_popover_self_out:r,handle_tooltip_over:i,handle_tooltip_out:s,handle_tooltip_self_out:o}});

==================================================
FILE PATH: ./public/js/scripts/common_scripts/frontend/common_frontend.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: affix.js v3.1.1
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.0.3
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/affix",["jquery_timely"],function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="ai1ec-affix ai1ec-affix-top ai1ec-affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("ai1ec-affix");var e=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;this.affixed=="top"&&(i.top+=r),typeof s!="object"&&(u=o=s),typeof o=="function"&&(o=s.top(this.$element)),typeof u=="function"&&(u=s.bottom(this.$element));var a=this.unpin!=null&&r+this.unpin<=i.top?!1:u!=null&&i.top+this.$element.height()>=n-u?"bottom":o!=null&&r<=o?"top":!1;if(this.affixed===a)return;this.unpin&&this.$element.css("top","");var f="ai1ec-affix"+(a?"-"+a:""),l=e.Event(f+".bs.affix");this.$element.trigger(l);if(l.isDefaultPrevented())return;this.affixed=a,this.unpin=a=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(f).trigger(e.Event(f.replace("affix","affixed"))),a=="bottom"&&this.$element.offset({top:n-u-this.$element.height()})};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="ai1ec-affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}),timely.define("scripts/common_scripts/frontend/common_event_handlers",["jquery_timely","external_libs/bootstrap/affix"],function(e){var t=function(t){var n=e(this),r=n.next(".ai1ec-popup"),i,s,o;if(r.length===0)return;i=r.html(),s=r.attr("class");var u=n.closest("#ai1ec-calendar-view");u.length===0&&(u=e("body")),n.offset().left-u.offset().left>182?o="left":o="right",n.constrained_popover({content:i,title:"",placement:o,trigger:"manual",html:!0,template:'<div class="timely ai1ec-popover '+s+'">'+'<div class="ai1ec-arrow"></div>'+'<div class="ai1ec-popover-inner">'+'<div class="ai1ec-popover-content"><div></div></div>'+"</div>"+"</div>",container:"body"}).constrained_popover("show")},n=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-popup").length===0&&e(this).constrained_popover("hide")},r=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip").length===0&&(e(this).remove(),e("body > .ai1ec-tooltip").remove())},i=function(t){if("ontouchstart"in document.documentElement){t.preventDefault();return}var n=e(this),r={template:'<div class="timely ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"manual",container:"body"};if(n.is(".ai1ec-category .ai1ec-color-swatch")||n.is(".ai1ec-custom-filter .ai1ec-color-swatch"))return;n.is(".ai1ec-tooltip-auto")&&(r.placement=u(250)),n.tooltip(r),n.tooltip("show")},s=function(t){e(this).tooltip("hide")},o=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip-trigger").length===0&&e(this).remove(),n.closest(".ai1ec-popup").length===0&&e("body > .ai1ec-popup").remove()},u=function(t){return function(n,r){var i,s,o=e(r),u=o.attr("data-placement"),a=e.extend({},o.offset(),{width:r.offsetWidth,height:r.offsetHeight}),f=function(){return!1===i?!1:(i=a.left-t>=0,i?"left":!1)},l=function(){return!1===s?!1:(s=a.left+t<=e(window).width(),s?"right":!1)};switch(u){case"top":return"top";case"bottom":return"bottom";case"left":if(f())return"left";case"right":if(l())return"right";default:if(f())return"left";if(l())return"right";return u}}};return{handle_popover_over:t,handle_popover_out:n,handle_popover_self_out:r,handle_tooltip_over:i,handle_tooltip_out:s,handle_tooltip_self_out:o}}),timely.define("external_libs/modernizr",[],function(){var e=function(e,t,n){function S(e){f.cssText=e}function x(e,t){return S(h.join(e+";")+(t||""))}function T(e,t){return typeof e===t}function N(e,t){return!!~(""+e).indexOf(t)}function C(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:T(s,"function")?s.bind(r||t):s}return!1}var r="2.5.3",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p={},d={},v={},m=[],g=m.slice,y,b=function(e,n,r,i){var s,a,f,l=t.createElement("div"),c=t.body,h=c?c:t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),l.appendChild(f);return s=["&#173;","<style>",e,"</style>"].join(""),l.id=u,(c?l:h).innerHTML+=s,h.appendChild(l),c||(h.style.background="",o.appendChild(h)),a=n(l,e),c?l.parentNode.removeChild(l):h.parentNode.removeChild(h),!!a},w={}.hasOwnProperty,E;!T(w,"undefined")&&!T(w.call,"undefined")?E=function(e,t){return w.call(e,t)}:E=function(e,t){return t in e&&T(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=g.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(g.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(g.call(arguments)))};return i});var k=function(n,r){var s=n.join(""),o=r.length;b(s,function(n,r){var s=t.styleSheets[t.styleSheets.length-1],u=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"",a=n.childNodes,f={};while(o--)f[a[o].id]=a[o];i.touch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||(f.touch&&f.touch.offsetTop)===9},o,r)}([,["@media (",h.join("touch-enabled),("),u,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);p.touch=function(){return i.touch};for(var L in p)E(p,L)&&(y=L.toLowerCase(),i[y]=p[L](),m.push((i[y]?"":"no-")+y));return S(""),a=l=null,i._version=r,i._prefixes=h,i.testStyles=b,o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+m.join(" "):""),i}(window,window.document);return e}),timely.define("external_libs/bootstrap/tooltip",["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}),timely.define("external_libs/bootstrap/popover",["jquery_timely","external_libs/bootstrap/tooltip"],function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="ai1ec-popover"><div class="ai1ec-arrow"></div><h3 class="ai1ec-popover-title"></h3><div class="ai1ec-popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".ai1ec-popover-title")[this.options.html?"html":"text"](t),e.find(".ai1ec-popover-content")[this.options.html?"html":"text"](n),e.removeClass("ai1ec-fade ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right ai1ec-in"),e.find(".ai1ec-popover-title").html()||e.find(".ai1ec-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}),timely.define("external_libs/constrained_popover",["jquery_timely","external_libs/bootstrap/popover"],function(e){var t=function(e,t){this.init("constrained_popover",e,t)};t.DEFAULTS=e.extend({},e.fn.popover.Constructor.DEFAULTS,{container:"",content:this.options}),t.prototype=e.extend({},e.fn.popover.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.applyPlacement=function(t,n){e.fn.popover.Constructor.prototype.applyPlacement.call(this,t,n);var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=this.getPosition(),u={};switch(n){case"left":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left-i:u.left=newPos.left-i,r.offset(u);break;case"right":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left+o.width:u.left=newPos.left+o.width,r.offset(u)}},t.prototype.defineBounds=function(t){var n,r,i,s,o,u={},a=e("body"===this.options.container?document:this.options.container);return a.length?(n=a.offset()||{top:0,left:0},r=n.top,i=n.left,s=r+a.height(),o=i+a.width(),t.top+t.height/2<r&&(u.top=r),t.top+t.height/2>s&&(u.top=s),t.left-t.width/2<i&&(u.left=i),t.left-t.width/2>o&&(u.left=o),u):!1};var n=e.fn.popover;e.fn.constrained_popover=function(n){return this.each(function(){var r=e(this),i=r.data("ai1ec.constrained_popover"),s=typeof n=="object"&&n;i||r.data("ai1ec.constrained_popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.constrained_popover.Constructor=t,e.fn.constrained_popover.noConflict=function(){return e.fn.constrained_popover=n,this}}),timely.define("external_libs/bootstrap/dropdown",["jquery_timely"],function(e){function i(){e(t).remove(),e(n).each(function(t){var n=s(e(this));if(!n.hasClass("ai1ec-open"))return;n.trigger(t=e.Event("hide.bs.dropdown"));if(t.isDefaultPrevented())return;n.removeClass("ai1ec-open").trigger("hidden.bs.dropdown")})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".ai1ec-dropdown-backdrop",n="[data-toggle=ai1ec-dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".ai1ec-disabled, :disabled"))return;var r=s(n),o=r.hasClass("ai1ec-open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".ai1ec-navbar-nav").length&&e('<div class="ai1ec-dropdown-backdrop"/>').insertAfter(e(this)).on("click",i),r.trigger(t=e.Event("show.bs.dropdown"));if(t.isDefaultPrevented())return;r.toggleClass("ai1ec-open").trigger("shown.bs.dropdown"),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".ai1ec-disabled, :disabled"))return;var i=s(r),o=i.hasClass("ai1ec-open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=e("[role=menu] li:not(.ai1ec-divider):visible a",i);if(!u.length)return;var a=u.index(u.filter(":focus"));t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<u.length-1&&a++,~a||(a=0),u.eq(a).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".ai1ec-dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)}),timely.define("scripts/common_scripts/frontend/common_frontend",["jquery_timely","domReady","scripts/common_scripts/frontend/common_event_handlers","ai1ec_calendar","external_libs/modernizr","external_libs/bootstrap/tooltip","external_libs/constrained_popover","external_libs/bootstrap/dropdown"],function(e,t,n,r,i){var s=!1,o=function(){s=!0,e(document).on("mouseenter",".ai1ec-popup-trigger",n.handle_popover_over),e(document).on("mouseleave",".ai1ec-popup-trigger",n.handle_popover_out),e(document).on("mouseleave",".ai1ec-popup",n.handle_popover_self_out),e(document).on("mouseenter",".ai1ec-tooltip-trigger",n.handle_tooltip_over),e(document).on("mouseleave",".ai1ec-tooltip-trigger",n.handle_tooltip_out),e(document).on("mouseleave",".ai1ec-tooltip",n.handle_tooltip_self_out)},u=function(){t(function(){o()})},a=function(){return s};return{start:u,are_event_listeners_attached:a}});

==================================================
FILE PATH: ./public/js/scripts/event.js
==================================================
timely.define(["jquery_timely","domReady","ai1ec_config","scripts/event/gmaps_helper"],function(e,t,n,r){var i=function(){e("#ai1ec-gmap-canvas").length>0&&timely.require(["libs/gmaps"],function(e){e(r.init_gmaps)})},s=function(){e(".ai1ec-gmap-placeholder:first").click(r.handle_show_map_when_clicking_on_placeholder),e(document).on("click","#ai1ec_tickets_submit",function(){return e(this).closest("form").submit(),!1})},o=function(){e("img[data-ai1ec-hidden]","#timely-description, #ai1ec-event-modal").each(function(){var t=e(this),n=e("#timely-event-poster img").attr("src");t.attr("src")!=n&&t.removeAttr("data-ai1ec-hidden")})},u=function(){t(function(){i(),s(),o(),e(document).trigger("event_page_ready.ai1ec"),e("body").addClass("ai1ec-event-details-ready")})};return{start:u}});

==================================================
FILE PATH: ./public/js/scripts/less_variables_editing.js
==================================================
timely.define(["jquery_timely","domReady","ai1ec_config","libs/utils","external_libs/bootstrap_colorpicker","external_libs/bootstrap/tab","external_libs/jquery_cookie"],function(e,t,n,r){var i=function(t){var n=e(this).attr("href");e.cookie("less_variables_active_tab",n)},s=function(t){t===null?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},o=function(){e(this).val()==="custom"?e(this).closest(".ai1ec-form-group").find(".ai1ec-custom-font").removeClass("ai1ec-hide"):e(this).closest(".ai1ec-form-group").find(".ai1ec-custom-font").addClass("ai1ec-hide")},u=function(){return window.confirm(n.confirm_reset_theme)},a=function(){var t=!0;return e(".ai1ec-less-variable-size").each(function(){var r=e(this),i=r.closest(".ai1ec-form-group"),s=e.trim(r.val());i.removeClass("ai1ec-has-warning");if(""===s)return;var o=/^auto$|^[+-]?[0-9]+\.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)?$/ig;if(!o.test(s)){t=!1;var u=i.closest(".ai1ec-tab-pane").attr("id");return i.closest(".ai1ec-tabbable").find('a[data-toggle="ai1ec-tab"][href="#'+u+'"]').trigger("click"),i.addClass("ai1ec-has-warning"),window.alert(n.size_less_variable_not_ok),r.trigger("focus"),!1}}),t};t(function(){e(".colorpickers").colorpicker(),r.activate_saved_tab_on_page_load(e.cookie("less_variables_active_tab")),e(document).on("click","ul.ai1ec-nav a",i).on("click","#ai1ec_reset_themes_options",u).on("change",".ai1ec_font",o),e("#ai1ec_save_themes_options").closest("form").on("submit",a)})});

==================================================
FILE PATH: ./public/js/scripts/event_category.js
==================================================
timely.define(["jquery_timely","ai1ec_config","domReady","external_libs/colorpicker"],function(e,t,n){var r,i=function(n){n.preventDefault(),typeof r=="undefined"&&(r=wp.media.frames.file_frame=wp.media({title:t.choose_image_message,button:{text:t.choose_image_message},multiple:!1}),r.on("select",function(){var t=r.state().get("selection").first().toJSON();e("#ai1ec_category_imag_preview").attr("src",t.url),e("#ai1ec_category_image_url").val(t.url)})),r.open()};e("#tag-color").click(function(){var t=e("#tag-color").offset(),n=t.top+e("#tag-color").height(),r=t.left+1,i=e('<ul class="timely colorpicker-list"></ul>'),o=e('<li class="ai1ec-btn ai1ec-btn-xs ai1ec-btn-default ai1ec-btn-block"><i class="ai1ec-fa ai1ec-fa-ellipsis-h ai1ec-fa-lg"></i></li>'),a="",f;for(f=1;f<=32;f++)a+='<li class="color-'+f+'"></li>';a=e(a),o.ColorPicker({onSubmit:function(t,n,r,s){e("#tag-color-background").css("background-color","#"+n),e("#tag-color-value").val("#"+n),e(s).ColorPickerHide(),i.remove()},onBeforeShow:function(){i.hide(),e(document).unbind("mousedown",u);var t=e("#tag-color-value").val();t=t.length>0?t:"#ffffff",e(this).ColorPickerSetColor(t)}}),a.click(function(){var t=e(this).css("background-color");t="rgba(0, 0, 0, 0)"===t?"":s(t),e("#tag-color-background").css("background-color",t),e("#tag-color-value").val(t),i.remove()}),i.append(a).append(o),i.appendTo("body").css({top:n+"px",left:r+"px"}),e(document).bind("mousedown",{ls:i},u)}),e("#tag-color-value-remove").click(function(){e("#tag-color-background").css("background-color",""),e("#tag-color-value").val("")});var s=function(e){return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+o(e[1])+o(e[2])+o(e[3])},o=function(e){return("0"+parseInt(e,10).toString(16)).slice(-2)},u=function(t){a(t.data.ls.get(0),t.target,t.data.ls.get(0))||(e(t.data.ls.get(0)).remove(),e(document).unbind("mousedown",u))},a=function(e,t,n){if(e===t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(e.compareDocumentPosition(t)&16);var r=t.parentNode;while(r&&r!==n){if(r===e)return!0;r=r.parentNode}return!1},f=function(){n(function(){e("#ai1ec_category_image_uploader").click(i);var t=e("#ai1ec_category_imag_preview").attr("src");t&&t.length>0&&e("#ai1ec_category_image_url").val(t)})};return{start:f}});

==================================================
FILE PATH: ./public/js/scripts/event/gmaps_helper.js
==================================================
timely.define(["jquery_timely"],function(e){var t=function(){var t=e("#ai1ec-gmap-address")[0].value.split(","),n=parseFloat(t[0]),r=parseFloat(t[1]),i=new google.maps.LatLng(n,r),s={zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1},o=new google.maps.Map(e("#ai1ec-gmap-canvas")[0],s),u=new google.maps.Marker({map:o}),a=new google.maps.Geocoder;n&&r&&i?(o.setCenter(i),u.setPosition(i)):a.geocode({address:e("#ai1ec-gmap-address")[0].value},function(e,t){t===google.maps.GeocoderStatus.OK&&(o.setCenter(e[0].geometry.location),u.setPosition(e[0].geometry.location))})},n=function(){var t=e(".ai1ec-gmap-container-hidden:first");e(this).remove(),t.hide(),t.removeClass("ai1ec-gmap-container-hidden"),t.fadeIn()};return{handle_show_map_when_clicking_on_placeholder:n,init_gmaps:t}});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/event_location/input_coordinates_utility_functions.js
==================================================
timely.define(["jquery_timely","ai1ec_config","libs/utils"],function(e,t,n){var r=function(){e("#ai1ec_input_coordinates:checked").length>0&&e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){this.value=n.convert_comma_to_dot(this.value)})},i=function(t,n){var r=e("<div />",{text:n,"class":"ai1ec-error"});e(t).after(r)},s=function(t,n){t.target.id==="post"&&(t.stopImmediatePropagation(),t.preventDefault(),e("#publish").removeClass("button-primary-disabled"),e("#publish").siblings(".spinner").css("visibility","hidden")),e(n).focus()},o=function(){var t=n.field_has_value("ai1ec_address"),r=!0;return e("input.ai1ec-coordinates").each(function(){var e=n.field_has_value(this.id);e||(r=!1)}),t||r},u=function(n){var r=!0,o=!1;return e("#ai1ec_input_coordinates:checked").length>0&&(e("div.ai1ec-error").remove(),e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){var n=e(this).hasClass("latitude"),s=n?t.error_message_not_entered_lat:t.error_message_not_entered_long;this.value===""&&(r=!1,o===!1&&(o=this),i(this,s))})),r===!1&&s(n,o),r},a=function(r){if(e("#ai1ec_input_coordinates:checked").length===1){e("div.ai1ec-error").remove();var o=!0,u=!1,a=!1;return e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){if(this.value===""){a=!0;return}var r=e(this).hasClass("latitude"),s=r?t.error_message_not_valid_lat:t.error_message_not_valid_long;n.is_valid_coordinate(this.value,r)||(o=!1,u===!1&&(u=this),i(this,s))}),o===!1&&s(r,u),a===!0&&(o=!1),o}};return{ai1ec_convert_commas_to_dots_for_coordinates:r,ai1ec_show_error_message_after_element:i,check_if_address_or_coordinates_are_set:o,ai1ec_check_lat_long_fields_filled_when_publishing_event:u,ai1ec_check_lat_long_ok_for_search:a}});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/event_location/gmaps_helper.js
==================================================
timely.define(["jquery_timely","domReady","ai1ec_config","scripts/add_new_event/event_location/input_coordinates_utility_functions","external_libs/jquery.autocomplete_geomod","external_libs/geo_autocomplete"],function(e,t,n,r){var i,s,o,u,a,f,l=function(t){e("#ai1ec_latitude").val(t.latLng.lat()),e("#ai1ec_longitude").val(t.latLng.lng()),e("#ai1ec_input_coordinates:checked").length===0&&e("#ai1ec_input_coordinates").trigger("click")},c=function(){n.disable_autocompletion||e("#ai1ec_address").geo_autocomplete(new google.maps.Geocoder,{selectFirst:!1,minChars:3,cacheLength:50,width:300,scroll:!0,scrollHeight:330,region:n.region}).result(function(e,t){t&&p(t)}).change(function(){if(e(this).val().length>0){var t=e(this).val();i.geocode({address:t,region:n.region},function(e,t){t===google.maps.GeocoderStatus.OK&&p(e[0])})}})},h=function(){i=new google.maps.Geocoder,s=new google.maps.LatLng(9.965,-83.327),o={zoom:0,mapTypeId:google.maps.MapTypeId.ROADMAP,center:s},t(function(){e("#ai1ec_map_canvas").length>0&&(u=new google.maps.Map(e("#ai1ec_map_canvas").get(0),o),a=new google.maps.Marker({map:u,draggable:!0}),google.maps.event.addListener(a,"dragend",l),a.setPosition(s),c(),v(),e('a[href="#ai1ec-event-location-box"]').on("click",function(){window.setTimeout(function(){google.maps.event.trigger(u,"resize"),u.setCenter(a.getPosition())},150)}))})},p=function(t){u.setCenter(t.geometry.location),u.setZoom(15),a.setPosition(t.geometry.location),e("#ai1ec_address").val(t.formatted_address),e("#ai1ec_latitude").val(t.geometry.location.lat()),e("#ai1ec_longitude").val(t.geometry.location.lng()),e("#ai1ec_input_coordinates").is(":checked")||e("#ai1ec_input_coordinates").click();var n="",r="",i="",s=0,o=0,f="",l;for(var c=0;c<t.address_components.length;c++)switch(t.address_components[c].types[0]){case"street_number":n=t.address_components[c].long_name;break;case"route":r=t.address_components[c].long_name;break;case"locality":i=t.address_components[c].long_name;break;case"administrative_area_level_1":f=t.address_components[c].long_name;break;case"postal_code":s=t.address_components[c].long_name;break;case"country":l=t.address_components[c].short_name,o=t.address_components[c].long_name}var h=n.length>0?n+" ":"";h+=r.length>0?r:"",s=s!==0?s:"",e("#ai1ec_city").val(i),e("#ai1ec_province").val(f),e("#ai1ec_postal_code").val(s),e("#ai1ec_country").val(o),e("#ai1ec_country_short").val(l)},d=function(){var t=parseFloat(e("#ai1ec_latitude").val()),n=parseFloat(e("#ai1ec_longitude").val()),r=new google.maps.LatLng(t,n);u.setCenter(r),u.setZoom(15),a.setPosition(r)},v=function(){e("#ai1ec_input_coordinates:checked").length===0?(e("#ai1ec_table_coordinates").hide(),e("#ai1ec_address").change()):d()},m=function(){return a},g=function(){return f};return{init_gmaps:h,ai1ec_update_map_from_coordinates:d,get_marker:m,get_position:g}});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/event_location/input_coordinates_event_handlers.js
==================================================
timely.define(["jquery_timely","scripts/add_new_event/event_location/input_coordinates_utility_functions","scripts/add_new_event/event_location/gmaps_helper","ai1ec_config"],function(e,t,n,r){var i=function(t){this.checked?e(".ai1ec-map-preview").addClass("ai1ec-map-visible"):e(".ai1ec-map-preview").removeClass("ai1ec-map-visible")},s=function(t){this.checked?e("#ai1ec_table_coordinates").fadeIn("fast"):e("#ai1ec_table_coordinates").fadeOut("fast")},o=function(e){t.ai1ec_convert_commas_to_dots_for_coordinates();var r=t.ai1ec_check_lat_long_ok_for_search(e);r===!0&&n.ai1ec_update_map_from_coordinates()};return{toggle_visibility_of_google_map_on_click:i,toggle_visibility_of_coordinate_fields_on_click:s,update_map_from_coordinates_on_blur:o}});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/event_cost_helper.js
==================================================
timely.define(["jquery_timely","ai1ec_config"],function(e,t){var n=e(".ai1ec-tickets-cost"),r=e(".ai1ec-tickets-url-text"),i=e(".ai1ec-register-url-text");e('input[name="ai1ec_cost_type"]').on("click change",function(){var t=e(".ai1ec-no-tickets"),n=e(".ai1ec-tickets-form, .ai1ec-tickets-list-container"),r=e(".ai1ec-tickets-external");"free"===this.value?(n.hide(),r.hide(),t.show()):"tickets"===this.value?(n.show(),r.hide(),t.hide()):(n.hide(),r.show(),t.show())}),e('input[name="ai1ec_cost_type"]:checked').click(),e("#ai1ec_is_free").on("click",function(){this.checked?(n.addClass("ai1ec-hidden"),r.addClass("ai1ec-hidden"),i.removeClass("ai1ec-hidden")):(n.removeClass("ai1ec-hidden"),r.removeClass("ai1ec-hidden"),i.addClass("ai1ec-hidden"))})});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/facebook_export.js
==================================================
timely.define(["jquery_timely","external_libs/bootstrap/collapse","external_libs/bootstrap/modal"],function(e){var t=function(t){!e(this).is(":checked")&&e("#ai1ec-facebook-export-modal").length?e("#ai1ec-facebook-export-modal").modal({show:!0,backdrop:"static"}):e("#ai1ec-remove-fb-event-hidden").remove()},n=function(){e("#ai1ec-facebook-export-modal").modal("hide");if(e(this).hasClass("remove")){var t=e("<input />",{type:"hidden",name:"ai1ec-remove-event",value:1,id:"ai1ec-remove-fb-event-hidden"});e("#ai1ec-facebook-publish").append(t)}else e("#ai1ec-remove-fb-event-hidden").remove()},r=function(t){t.preventDefault();var n=e(t.target).closest("#ai1ec-facebook-publish"),r=n.find(".ai1ec-fa-refresh"),i={action:"ai1ec_refresh_tokens"};r.addClass("ai1ec-fa-spin"),e.post(ajaxurl,i,function(e){var t=n.find(".ai1ec-page-choices");r.removeClass("ai1ec-fa-spin"),t.length?t.replaceWith(e):n.find(".ai1ec-refresh-fb-pages").before(e)},"json")},i=function(t){var n=e("#ai1ec-fb-collapse");n.length&&n.collapse(this.checked?"show":"hide")};return{open_modal_on_unpublish:t,add_hidden_field_when_user_click_remove_in_modal:n,show_page_choices_when_present:i,refresh_list_of_pages:r}});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/event_date_time/date_time_utility_functions.js
==================================================
timely.define(["jquery_timely","ai1ec_config","libs/utils","external_libs/jquery.calendrical_timespan"],function(e,t,n,r){var i=n.get_ajax_url(),s=function(t,n,r,i,s,o){e(t).val(i),e("#ai1ec_repeat_box").modal("hide");var u=e.trim(e(n).text());u.lastIndexOf(":")===-1&&(u=u.substring(0,u.length-3),e(n).html(u+":")),e(s).attr("disabled",!1),e(r).fadeOut("fast",function(){e(this).html(o.message),e(this).fadeIn("fast")})},o=function(t,n,r,i){e("#ai1ec_repeat_box .ai1ec-alert-danger").text(r.message).removeClass("ai1ec-hide"),e(i).attr("disabled",!1),e(t).val("");var s=e.trim(e(n).text());s.lastIndexOf("...")===-1&&(s=s.substring(0,s.length-1),e(n).text(s+"...")),e(this).closest("tr").find(".ai1ec_rule_text").text()===""&&e(t).siblings("input:checkbox").removeAttr("checked")},u=function(t,n,r,i,s){e(document).on("click",t,function(){if(!e(n).is(":checked")){e(n).attr("checked",!0);var t=e.trim(e(r).text());t=t.substring(0,t.length-3),e(r).text(t+":")}return c(i,s),!1})},a=function(t,n,r,i,s){e(t).click(function(){if(e(this).is(":checked"))this.id==="ai1ec_repeat"&&e("#ai1ec_exclude").removeAttr("disabled"),c(i,s);else{this.id==="ai1ec_repeat"&&(e("#ai1ec_exclude").removeAttr("checked").attr("disabled",!0),e("#ai1ec_exclude_text > a").text("")),e(n).text("");var t=e.trim(e(r).text());t=t.substring(0,t.length-1),e(r).text(t+"...")}})},f=function(t,n,r){if(e.trim(e(t).text())===""){e(n).removeAttr("checked"),e("#ai1ec_repeat").is(":checked")||e("#ai1ec_exclude").attr("disabled",!0);var i=e.trim(e(r).text());i.lastIndexOf("...")===-1&&(i=i.substring(0,i.length-1),e(r).text(i+"..."))}},l=function(){e("#ai1ec_count, #ai1ec_daily_count, #ai1ec_weekly_count,			#ai1ec_monthly_count, #ai1ec_yearly_count").rangeinput({css:{input:"ai1ec-range",slider:"ai1ec-slider",progress:"ai1ec-progress",handle:"ai1ec-handle"}});var n=e("#ai1ec_recurrence_calendar");n.datepicker({multidate:!0,weekStart:t.week_start_day}),n.on("changeDate",function(n){var i=[],s=[];for(var o=0;o<n.dates.length;o++){var u=new Date(n.dates[o]),a=""+u.getFullYear()+("0"+(u.getMonth()+1)).slice(-2)+("0"+u.getDate()).slice(-2)+"T000000Z",f='<span class="ai1ec-label ai1ec-label-default">'+r.formatDate(u,t.date_format,!0)+"</span>";i.push(a),s.push(f)}e("#ai1ec_rec_dates_list").html(s.join(" ")),e("#ai1ec_rec_custom_dates").val(i.join(","))});var i={start_date_input:"#ai1ec_until-date-input",start_time:"#ai1ec_until-time",date_format:t.date_format,month_names:t.month_names,day_names:t.day_names,week_start_day:t.week_start_day,twentyfour_hour:t.twentyfour_hour,now:new Date(t.now*1e3)};e.inputdate(i),e(document).trigger("ai1ec.recurrence-modal.inited")},c=function(t,n){var r=e("#ai1ec_repeat_box"),s=e(".ai1ec-loading",r);r.modal({backdrop:"static"}),e.post(i,t,function(e){e.error?(window.alert(e.message),r.modal("hide")):(s.addClass("ai1ec-hide").after(e.message),typeof n=="function"&&n())},"json")};return{show_repeat_tabs:c,init_modal_widgets:l,click_on_modal_cancel:f,click_on_checkbox:a,click_on_ics_rule_text:u,repeat_form_error:o,repeat_form_success:s}});

==================================================
FILE PATH: ./public/js/scripts/add_new_event/event_date_time/date_time_event_handlers.js
==================================================
timely.define(["jquery_timely","ai1ec_config","scripts/add_new_event/event_date_time/date_time_utility_functions","external_libs/jquery.calendrical_timespan","libs/utils","external_libs/bootstrap/button"],function(e,t,n,r,i){var s=i.get_ajax_url(),o=function(){var t=e("#ai1ec_end option:selected").val();switch(t){case"0":e("#ai1ec_until_holder, #ai1ec_count_holder").collapse("hide");break;case"1":e("#ai1ec_until_holder").collapse("hide"),e("#ai1ec_count_holder").collapse("show");break;case"2":e("#ai1ec_count_holder").collapse("hide"),e("#ai1ec_until_holder").collapse("show")}},u=function(){e("#publish").trigger("click")},a=function(){var i=e(this),o="",u=e("#ai1ec_repeat_box .ai1ec-tab-pane.ai1ec-active"),a=u.data("freq"),f=!0;switch(a){case"daily":o+="FREQ=DAILY;";var l=e("#ai1ec_daily_count").val();l>1&&(o+="INTERVAL="+l+";");break;case"weekly":o+="FREQ=WEEKLY;";var c=e("#ai1ec_weekly_count").val();c>1&&(o+="INTERVAL="+c+";");var h=e('input[name="ai1ec_weekly_date_select"]:first').val(),p=e('#ai1ec_weekly_date_select > div:first > input[type="hidden"]:first').val();h.length>0&&(o+="WKST="+p+";BYday="+h+";");break;case"monthly":o+="FREQ=MONTHLY;";var d=e("#ai1ec_monthly_count").val(),v=e('input[name="ai1ec_monthly_type"]:checked').val();d>1&&(o+="INTERVAL="+d+";");var m=e('input[name="ai1ec_montly_date_select"]:first').val();if(m.length>0&&v==="bymonthday")o+="BYMONTHDAY="+m+";";else if(v==="byday"){var g=e("#ai1ec_monthly_byday_num").val(),y=e("#ai1ec_monthly_byday_weekday").val();o+="BYday="+g+y+";"}break;case"yearly":o+="FREQ=YEARLY;";var b=e("#ai1ec_yearly_count").val();b>1&&(o+="INTERVAL="+b+";");var w=e('input[name="ai1ec_yearly_date_select"]:first').val();w.length>0&&(o+="BYMONTH="+w+";");break;case"custom":"1"===e("#ai1ec_is_box_repeat").val()?o+="RDATE=":o+="EXDATE=",o+=e("#ai1ec_rec_custom_dates").val(),f=!1}var E=e("#ai1ec_end").val();if("1"===E&&f)o+="COUNT="+e("#ai1ec_count").val()+";";else if("2"===E&&f){var S=e("#ai1ec_until-date-input").val();S=r.parseDate(S,t.date_format);var x=e("#ai1ec_start-time").val();x=r.parseDate(x,t.date_format),x=new Date(x);var T=S.getUTCDate(),N=S.getUTCMonth()+1,C=x.getUTCHours(),k=x.getUTCMinutes();N=N<10?"0"+N:N,T=T<10?"0"+T:T,C=C<10?"0"+C:C,k=k<10?"0"+k:k,S=S.getUTCFullYear()+""+N+T+"T235959Z",o+="UNTIL="+S+";"}var L={action:"ai1ec_rrule_to_text",rrule:o};i.button("loading").next().addClass("ai1ec-disabled"),e.post(s,L,function(t){t.error?(i.button("reset").next().removeClass("ai1ec-disabled"),"1"===e("#ai1ec_is_box_repeat").val()?n.repeat_form_error("#ai1ec_rrule","#ai1ec_repeat_label",t,i):n.repeat_form_error("#ai1ec_exrule","#ai1ec_exclude_label",t,i)):"1"===e("#ai1ec_is_box_repeat").val()?n.repeat_form_success("#ai1ec_rrule","#ai1ec_repeat_label","#ai1ec_repeat_text > a",o,i,t):n.repeat_form_success("#ai1ec_exrule","#ai1ec_exclude_label","#ai1ec_exclude_text > a",o,i,t)},"json")},f=function(){return e("#ai1ec_is_box_repeat").val()==="1"?n.click_on_modal_cancel("#ai1ec_repeat_text > a","#ai1ec_repeat","#ai1ec_repeat_label"):n.click_on_modal_cancel("#ai1ec_exclude_text > a","#ai1ec_exclude","#ai1ec_exclude_label"),e("#ai1ec_repeat_box").modal("hide"),!1},l=function(){e(this).is("#ai1ec_monthly_type_bymonthday")?(e("#ai1ec_repeat_monthly_byday").collapse("hide"),e("#ai1ec_repeat_monthly_bymonthday").collapse("show")):(e("#ai1ec_repeat_monthly_bymonthday").collapse("hide"),e("#ai1ec_repeat_monthly_byday").collapse("show"))},c=function(){var t=e(this),n=[],r=t.closest(".ai1ec-btn-group-grid"),i;t.toggleClass("ai1ec-active"),e("a",r).each(function(){var t=e(this);t.is(".ai1ec-active")&&(i=t.next().val(),n.push(i))}),r.next().val(n.join())},h=function(){n.click_on_ics_rule_text("#ai1ec_repeat_text > a","#ai1ec_repeat","#ai1ec_repeat_label",{action:"ai1ec_get_repeat_box",repeat:1,post_id:e("#post_ID").val()},n.init_modal_widgets),n.click_on_ics_rule_text("#ai1ec_exclude_text > a","#ai1ec_exclude","#ai1ec_exclude_label",{action:"ai1ec_get_repeat_box",repeat:0,post_id:e("#post_ID").val()},n.init_modal_widgets),n.click_on_checkbox("#ai1ec_repeat","#ai1ec_repeat_text > a","#ai1ec_repeat_label",{action:"ai1ec_get_repeat_box",repeat:1,post_id:e("#post_ID").val()},n.init_modal_widgets),n.click_on_checkbox("#ai1ec_exclude","#ai1ec_exclude_text > a","#ai1ec_exclude_label",{action:"ai1ec_get_repeat_box",repeat:0,post_id:e("#post_ID").val()},n.init_modal_widgets)},p=function(t){return e("#ai1ec_widget_calendar").toggle(),!1},d=function(){e(".ai1ec-modal-content",this).not(".ai1ec-loading ").remove().end().removeClass("ai1ec-hide")},v=function(){var t=e("#ai1ec_repeat_box").find("ul.ai1ec-nav").find("li.ai1ec-active"),n=e("#ai1ec_repeat_box").find(".ai1ec-end-field");t.hasClass("ai1ec-freq-custom")?n.addClass("ai1ec-hidden"):n.removeClass("ai1ec-hidden"),t.hasClass("ai1ec-freq-monthly")&&l()},m=function(){var t=e("#ai1ec-tab-content").data("activeFreq"),n=e("#ai1ec_recurrence_calendar");e(".ai1ec-freq").removeClass("ai1ec-active"),e(".ai1ec-freq-"+t).addClass("ai1ec-active"),e(document).on("shown.bs.tab",v),o(),v()};return e(document).on("ai1ec.recurrence-modal.inited",m),{show_end_fields:o,trigger_publish:u,handle_click_on_apply_button:a,handle_click_on_cancel_modal:f,handle_checkbox_monthly_tab_modal:l,execute_pseudo_handlers:h,handle_animation_of_calendar_widget:p,handle_click_on_toggle_buttons:c,handle_modal_hide:d}});

==================================================
FILE PATH: ./public/js/scripts/ticketing.js
==================================================
timely.define(["jquery_timely","ai1ec_config"],function(e,t){e('input[name="ai1ec_payment_method"]').on("click change",function(){e(".ai1ec-payment-details").removeClass("ai1ec-active"),e(this).closest("li").find(".ai1ec-payment-details").addClass("ai1ec-active")}),e(".ai1ec-tickets-manage ul.ai1ec-nav-tabs li").on("click",function(){return e(".ai1ec-tickets-manage ul.ai1ec-nav-tabs li.ai1ec-active").removeClass("ai1ec-active"),e(".ai1ec-tickets-manage .ai1ec-tab-pane").removeClass("ai1ec-active"),e(this).addClass("ai1ec-active"),$tab=e(e(this).find("a").attr("href")),$tab.addClass("ai1ec-active"),!1}),e(document).on("click","a.ai1ec-has-tickets",function(){var r=e(this),i=r.closest("tr"),s=r.attr("data-post-id"),o=i.find("td, th").not(".hidden").length,u=e('<tr class="ai1ec-tickets-details ai1ec-tickets-details-'+s+'"><td colspan="'+o+'" class="ai1ec-ticket-details-row-empty"></td></tr>'),a=e('<tr class="ai1ec-tickets-details ai1ec-tickets-details-'+s+'""><td colspan="'+o+'" class="ai1ec-ticket-details-row"><div></div></td></tr>');return r.hasClass("ai1ec-tickets-shown")?(e(".ai1ec-tickets-details-"+s).remove(),r.text(t.ticketing.details).removeClass("ai1ec-tickets-shown"),!1):(r.text(t.ticketing.hide_details).addClass("ai1ec-tickets-shown"),i.after(a).after(u),a.find(".ai1ec-ticket-details-row > div").append(t.ticketing.loading_details),e.ajax({url:t.ajax_url,type:"POST",data:{action:"ai1ec_show_ticket_details",ai1ec_event_id:s},success:function(r){r=e.parseJSON(r);if(r&&r.data&&r.data.length){a.find(".ai1ec-ticket-details-row > div").html("");var i=e("<table></table>"),o=e("<thead></thead>"),u=e("<tbody></tbody>");o=e("<th>"+t.ticketing.type_and_price+"</th>"+'<th class="ai1ec-hidden-sm">'+t.ticketing.info+"</th>"+"<th>"+t.ticketing.report+"</th>"+'<th class="ai1ec-hidden-sm">'+t.ticketing.sale_dates+"</th>"+'<th class="ai1ec-hidden-sm">'+t.ticketing.limits+"</th>"+'<th class="ai1ec-ticket-details-actions">'+t.ticketing.actions+"</th>"),o.appendTo(i);for(var f=0;f<r.data.length;f++){var l=e("<tr></tr>"),c='<span class="ai1ec-tickets-status ai1ec-tickets-status-'+n(r.data[f].ticket_status)+'">'+n(r.data[f].ticket_status_label)+"</span>",h="";typeof r.data[f]["symbol"]!="undefined"?h=n(r.data[f].symbol):h="$",l.append(e("<td></td>").html('"'+n(r.data[f].name)+'"'+"<br /><b>"+h+n(r.data[f].price)+" "+n(r.data[f].currency)+"</b>"+'<div class="ai1ec-visible-sm">'+c+"</div>"),e('<td class="ai1ec-hidden-sm"></td>').html(c),e("<td></td>").html(t.ticketing.sold+" "+n(r.data[f].sold)+"<br>"+t.ticketing.left+" "+(null==r.data[f]["available"]?t.ticketing.unlimited:n(r.data[f].available))),e('<td class="ai1ec-hidden-sm"></td>').html(t.ticketing.start+" "+n(r.data[f].sale_start_date)+"<br />"+t.ticketing.end+" "+n(r.data[f].sale_end_date)),e('<td class="ai1ec-hidden-sm"></td>').html(t.ticketing.min+" "+n(r.data[f].buy_min_qty)+"<br />"+t.ticketing.max+""+n(r.data[f].buy_max_qty)),e("<td></td>").html('<a href="#" class="ai1ec-show-attendees" data-ticket-type="'+n(r.data[f].id)+'" data-post-id="'+s+'">'+t.ticketing.attendees+"</a>")),i.append(l)}a.find(".ai1ec-ticket-details-row > div").append(i)}else r&&r.error&&(a.find(".ai1ec-ticket-details-row > div").html(""),a.find(".ai1ec-ticket-details-row > div").append(r.error))}}),!1)}),e(document).on("click",".ai1ec-show-attendees",function(){var r=e(this),i=r.closest("tr"),s=e(this).attr("data-ticket-type"),o=r.attr("data-post-id");return attendees=0,r.hasClass("ai1ec-attendees-shown")?(r.removeClass("ai1ec-attendees-shown").text(t.ticketing.attendees),i.next(".ai1ec-ticket-attendees-row").remove(),!1):(r.text(t.ticketing.hide_attendees).addClass("ai1ec-attendees-shown"),e.ajax({url:t.ajax_url,type:"POST",data:{action:"ai1ec_show_attendees",ai1ec_event_id:o},success:function(r){r=e.parseJSON(r);var o=e('<tr class="ai1ec-ticket-attendees-row"><td colspan="6" class="ai1ec-ticket-attendees"><h3>'+t.ticketing.attendees_list+"</h3>"+'<table class="ai1ec-attendees-list"><thead>'+'<th class="ai1ec-hidden-sm">#</th>'+"<th>"+t.ticketing.guest_name+"</th>"+'<th class="ai1ec-hidden-sm">'+t.ticketing.status+"</th>"+"<th>"+t.ticketing.code+"</th>"+'<th class="ai1ec-hidden-sm">'+t.ticketing.email+"</th>"+"</thead><tbody></tbody></table></td></tr>");if(r&&r.data&&r.data.length){for(var u=0;u<r.data.length;u++)s==r.data[u]["ticket_type_id"]&&($att_row=e("<tr></tr>"),$att_row.append(e('<td class="ai1ec-hidden-sm"></td>').text(u+1),e("<td></td>").text(r.data[u].holder_first_name+" "+r.data[u].holder_last_name),e('<td class="ai1ec-hidden-sm"></td>').text(r.data[u].status),e("<td></td>").text(r.data[u].ticket_code),e('<td class="ai1ec-hidden-sm"></td>').html('<a href="'+n(r.data[u].holder_email)+'">'+n(r.data[u].holder_email)+"</a>")),o.find("tbody").append($att_row),attendees++);attendees||o.find("table").replaceWith("<h4>"+t.ticketing.no_attendees+"</h4>"),i.after(o)}else r&&r.error&&(o.find("table").replaceWith("<h4>"+r.error+"</h4>"),i.after(o))}}),!1)}),e('[name="ai1ec_tickets_submit"]').on("click",function(){return e(".ai1ec-ticket-field-error").hide(),e(".ai1ec-required:visible").each(function(){var t=e(this);t.removeClass("ai1ec-error");if(!e.trim(t.val())||"checkbox"===t.attr("type")&&!this.checked)t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-ticket-field-error").show(),t.prev(".ai1ec-ticket-field-error").show()}),e(".ai1ec-ticket-field-error:visible").length||(e(".ai1ec-noauto").remove(),e(this).closest("form").submit()),!1});var n=function(e){return"string"==typeof e&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),e}});

==================================================
FILE PATH: ./public/js/scripts/calendar.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: affix.js v3.1.1
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.0.3
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/*
Copyright 2012 Igor Vaynberg

Version: 3.3.1 Timestamp: Wed Feb 20 09:57:22 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

/**
 * Twig.js 0.7.2
 *
 * @copyright 2011-2013 John Roepke
 * @license   Available under the BSD 2-Clause License
 * @link      https://github.com/justjohn/twig.js
 */

//     Twig.js
//     Copyright (c) 2011-2013 John Roepke
//     Available under the BSD 2-Clause License
//     https://github.com/justjohn/twig.js

// The following methods are from MDN and are available under a
// [MIT License](http://www.opensource.org/licenses/mit-license.php) or are
// [Public Domain](https://developer.mozilla.org/Project:Copyrights).
//
// See:
// * [Object.keys - MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)

// ## twig.lib.js
//
// This file contains 3rd party libraries used within twig.
//
// Copies of the licenses for the code included here can be found in the
// LICENSES.md file.
//

/**
     * jPaq - A fully customizable JavaScript/JScript library
     * http://jpaq.org/
     *
     * Copyright (c) 2011 Christopher West
     * Licensed under the MIT license.
     * http://jpaq.org/license/
     *
     * Version: 1.0.6.0000W
     * Revised: April 6, 2011
     */

//     Twig.js
//     Copyright (c) 2011-2013 John Roepke
//                   2012 Hadrien Lanneau
//     Available under the BSD 2-Clause License
//     https://github.com/justjohn/twig.js

/**
				 * History.js jQuery Adapter
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
				 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
				 */

/**
				 * History.js HTML4 Support
				 * Depends on the HTML5 Support
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
				 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
				 */

/**
		 * History.js Core
		 * @author Benjamin Arthur Lupton <contact@balupton.com>
		 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
		 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
		 */

/**
				 * History.getInternetExplorerMajorVersion()
				 * Get's the major version of Internet Explorer
				 * @return {integer}
				 * @license Public Domain
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @author James Padolsey <https://gist.github.com/527683>
				 */

/**
				 * History.isInternetExplorer()
				 * Are we using Internet Explorer?
				 * @return {boolean}
				 * @license Public Domain
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 */

/*

Copyright (c) 2009 Dimas Begunoff, http://www.farinspace.com

Licensed under the MIT license
http://en.wikipedia.org/wiki/MIT_License

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

*/

/*!
 * jQuery.ScrollTo
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 12/14/2012
 *
 * @projectDescription Easy element scrolling using jQuery.
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @author Ariel Flesler
 * @version 1.4.5 BETA
 *
 * @id jQuery.scrollTo
 * @id jQuery.fn.scrollTo
 * @param {String, Number, DOMElement, jQuery, Object} target Where to scroll the matched elements.
 *	  The different options for target are:
 *		- A number position (will be applied to all axes).
 *		- A string position ('44', '100px', '+=90', etc ) will be applied to all axes
 *		- A jQuery/DOM element ( logically, child of the element to scroll )
 *		- A string selector, that will be relative to the element to scroll ( 'li:eq(2)', etc )
 *		- A hash { top:x, left:y }, x and y can be any kind of number/string like above.
 *		- A percentage of the container's dimension/s, for example: 50% to go to the middle.
 *		- The string 'max' for go-to-end.
 * @param {Number, Function} duration The OVERALL length of the animation, this argument can be the settings object instead.
 * @param {Object,Function} settings Optional set of settings or the onAfter callback.
 *	 @option {String} axis Which axis must be scrolled, use 'x', 'y', 'xy' or 'yx'.
 *	 @option {Number, Function} duration The OVERALL length of the animation.
 *	 @option {String} easing The easing method for the animation.
 *	 @option {Boolean} margin If true, the margin of the target element will be deducted from the final position.
 *	 @option {Object, Number} offset Add/deduct from the end position. One number for both axes or { top:x, left:y }.
 *	 @option {Object, Number} over Add/deduct the height/width multiplied by 'over', can be { top:x, left:y } when using both axes.
 *	 @option {Boolean} queue If true, and both axis are given, the 2nd axis will only be animated after the first one ends.
 *	 @option {Function} onAfter Function to be called after the scrolling ends.
 *	 @option {Function} onAfterFirst If queuing is activated, this function will be called after the first scrolling ends.
 * @return {jQuery} Returns the same jQuery object, for chaining.
 *
 * @desc Scroll to a fixed position
 * @example $('div').scrollTo( 340 );
 *
 * @desc Scroll relatively to the actual position
 * @example $('div').scrollTo( '+=340px', { axis:'y' } );
 *
 * @desc Scroll using a selector (relative to the scrolled element)
 * @example $('div').scrollTo( 'p.paragraph:eq(2)', 500, { easing:'swing', queue:true, axis:'xy' } );
 *
 * @desc Scroll to a DOM element (same for jQuery object)
 * @example var second_child = document.getElementById('container').firstChild.nextSibling;
 *			$('#container').scrollTo( second_child, { duration:500, axis:'x', onAfter:function(){
 *				alert('scrolled!!');
 *			}});
 *
 * @desc Scroll on both axes, to different values
 * @example $('div').scrollTo( { top: 300, left:'+=200' }, { axis:'xy', offset:-20 } );
 */

/* =========================================================
 * bootstrap-datepicker.js
 * Repo: https://github.com/eternicode/bootstrap-datepicker/
 * Demo: http://eternicode.github.io/bootstrap-datepicker/
 * Docs: http://bootstrap-datepicker.readthedocs.org/
 * Forked from http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Started by Stefan Petre; improvements by Andrew Rowls + contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ========================================================================
 * Bootstrap: alert.js v3.0.3
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: transition.js v3.0.3
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.0.3
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("scripts/calendar/print",["jquery_timely"],function(e){var t=function(t){t.preventDefault();var n=e("body"),r=e("html"),i=e(this).closest(".ai1ec-calendar").html(),s=n.html();s=s.replace(/<script.*?>([\s\S]*?)<\/script>/gmi,""),n.empty(),n.addClass("timely"),r.addClass("ai1ec-print"),n.html(i),e("span").click(function(){return!1}),e(".ai1ec-agenda-view a").each(function(){e(this).data("href",e(this).attr("href")),e(this).attr("href","#")}),window.print(),e(".ai1ec-agenda-view a").each(function(){e(this).attr("href",e(this).data("href")),e(this).data("href","")}),n.removeClass("timely"),r.removeClass("ai1ec-print"),n.html(s)};return{handle_click_on_print_button:t}}),timely.define("scripts/calendar/agenda_view",["jquery_timely"],function(e){var t=function(){e(this).closest(".ai1ec-event").toggleClass("ai1ec-expanded").find(".ai1ec-event-summary").slideToggle(300)},n=function(){var t=e(this).closest(".ai1ec-calendar");t.find(".ai1ec-expanded .ai1ec-event-toggle").click()},r=function(){var t=e(this).closest(".ai1ec-calendar");t.find(".ai1ec-event:not(.ai1ec-expanded) .ai1ec-event-toggle").click()};return{toggle_event:t,collapse_all:n,expand_all:r}}),timely.define("external_libs/modernizr",[],function(){var e=function(e,t,n){function S(e){f.cssText=e}function x(e,t){return S(h.join(e+";")+(t||""))}function T(e,t){return typeof e===t}function N(e,t){return!!~(""+e).indexOf(t)}function C(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:T(s,"function")?s.bind(r||t):s}return!1}var r="2.5.3",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p={},d={},v={},m=[],g=m.slice,y,b=function(e,n,r,i){var s,a,f,l=t.createElement("div"),c=t.body,h=c?c:t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),l.appendChild(f);return s=["&#173;","<style>",e,"</style>"].join(""),l.id=u,(c?l:h).innerHTML+=s,h.appendChild(l),c||(h.style.background="",o.appendChild(h)),a=n(l,e),c?l.parentNode.removeChild(l):h.parentNode.removeChild(h),!!a},w={}.hasOwnProperty,E;!T(w,"undefined")&&!T(w.call,"undefined")?E=function(e,t){return w.call(e,t)}:E=function(e,t){return t in e&&T(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=g.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(g.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(g.call(arguments)))};return i});var k=function(n,r){var s=n.join(""),o=r.length;b(s,function(n,r){var s=t.styleSheets[t.styleSheets.length-1],u=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"",a=n.childNodes,f={};while(o--)f[a[o].id]=a[o];i.touch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||(f.touch&&f.touch.offsetTop)===9},o,r)}([,["@media (",h.join("touch-enabled),("),u,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);p.touch=function(){return i.touch};for(var L in p)E(p,L)&&(y=L.toLowerCase(),i[y]=p[L](),m.push((i[y]?"":"no-")+y));return S(""),a=l=null,i._version=r,i._prefixes=h,i.testStyles=b,o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+m.join(" "):""),i}(window,window.document);return e}),timely.define("scripts/calendar/month_view",["jquery_timely","external_libs/modernizr"],function(e,t){var n=navigator.userAgent.match(/opera/i),r=navigator.userAgent.match(/webkit/i),i=function(t){var n=t.find(".ai1ec-day"),r=t.find(".ai1ec-week:first .ai1ec-day").length;t.find(".ai1ec-month-view .ai1ec-multiday").each(function(){var t=this.parentNode,r=e(this).outerHeight(!0),i=e(".ai1ec-date",t),u=parseInt(i.text(),10),a=e(this).data("endTruncated"),f=parseInt(a?e(n[n.length-1]).text():e(this).data("endDay"),10),l=e(this),c=e(".ai1ec-event",l)[0].style.backgroundColor,h=0,p=f-u+1,d=p,v,m=0;n.each(function(t){var n=e(".ai1ec-date",this),r=e(this.parentNode),i=r.index(),a=parseInt(n.text(),10);if(a>=u&&a<=f){a===u&&(v=parseInt(n.css("marginBottom"),10)+16,newMargin=v,$week=n.closest(".ai1ec-week"),$multidayEvents=$week.find("a.ai1ec-multiday[data-end-day]").filter(function(){return e(this).offset().left<n.offset().left&&e(this).offset().left+e(this).width()>n.offset().left}),$multidayEvents.each(function(){var t=e(this).prop("offsetTop");if(null===newMargin||t>newMargin)newMargin=t}),null!==newMargin&&$multidayEvents.length&&newMargin>v&&(newMargin+=19,v=newMargin,n.css("marginBottom",newMargin+"px"))),h===0&&m++;if(i===0&&a>u&&d!==0){var p=l.next(".ai1ec-popup").andSelf().clone(!1);n.parent().append(p);var g=p.first();g.addClass("ai1ec-multiday-bar ai1ec-multiday-clone"),g.css({position:"absolute",left:"1px",top:parseInt(n.css("marginBottom"),10)+13,backgroundColor:c});var y=d>7?7:d;g.css("width",s(y)),d>7&&g.append(o(1,c)),g.append(o(2,c))}h===0?n.css({marginBottom:v+"px"}):n.css({marginBottom:"+=16px"}),d--,d>0&&i===6&&h++}});if(a){var g=l.find("."+l[0].className.replace(/\s+/igm,".")).last();g.append(o(1,c))}e(this).css({position:"absolute",top:i.outerHeight(!0)-r-1+"px",left:"1px",width:s(m)}),h>0&&e(this).append(o(1,c)),e(this).data("startTruncated")&&e(this).append(o(2,c)).addClass("ai1ec-multiday-bar")}),n.each(function(){var t=e(".ai1ec-date",this),n=parseInt(t.text(),10),r=t.closest(".ai1ec-week"),i=e(this).find("a.ai1ec-event-container:not(.ai1ec-multiday)").length,s=null,o;if(0===i)return;o=r.find("a.ai1ec-multiday[data-end-day]").filter(function(){return e(this).offsetLeft<=t.offset().left&&e(this).offsetLeft+e(this).width()>=t.offset().left}),o.each(function(){var t=e(this).prop("offsetTop");if(null===s||t>s)s=t}),null!==s&&(s+=3,t.css("marginBottom",s))})},s=function(e){var t;switch(e){case 1:t=97.5;break;case 2:t=198.7;break;case 3:t=300;break;case 4:t=401;break;case 5:r||n?t=507:t=503.4;break;case 6:r||n?t=608:t=603.5;break;case 7:r||n?t=709:t=705}return t+"%"},o=function(t,n){var r=e('<div class="ai1ec-multiday-arrow'+t+'"></div>');return t===1?r.css({borderLeftColor:n}):r.css({borderTopColor:n,borderRightColor:n,borderBottomColor:n}),r};return{extend_multiday_events:i}}),timely.define("libs/frontend_utils",[],function(){var e=function(e){var t,n;t=function(e){if(/&[^;]+;/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.firstChild?t.firstChild.nodeValue:e}return e};if(typeof e=="string")return t(e);if(typeof e=="object")for(n in e)typeof e[n]=="string"&&(e[n]=t(e[n]));return e},t=function(e,t,n){var r,i,s,o,u;if("#"===e.charAt(0)||"?"===e.charAt(0))e=e.substring(1);r={},e=e.split(t);for(i=0;i<e.length;i++)o=e[i].trim(),-1!==(u=o.indexOf(n))?(s=o.substring(0,u).trim(),o=o.substring(u+1).trim()):(s=o,o=!0),r[s]=o;return r},n=function(e){var n,r,i,s,o;e=t(e,"&","="),i=Object.keys(e),n={ai1ec:{},action:"month"};for(r=0;r<i.length;r++)if("ai1ec"===i[r]){var u=t(e[i[r]],"|",":");for(s in u)if(""!==u[s]){if("action"===s||"view"===s)n.action=u[s];n.ai1ec[s]=u[s]}}else"ai1ec_"===i[r].substring(0,6)?n.ai1ec[i[r].substring(6)]=e[i[r]]:n[i[r]]=e[i[r]];"ai1ec_"!==n.action.substring(0,6)&&(n.action="ai1ec_"+n.action),o="action="+n.action+"&ai1ec=";for(s in n.ai1ec)n.ai1ec.hasOwnProperty(s)&&(o+=escape(s)+":"+escape(n.ai1ec[s])+"|");o=o.substring(0,o.length-1);for(s in n)"ai1ec"!==s&&"action"!==s&&(o+="&"+s+"="+escape(n[s]));return o};return{ai1ec_convert_entities:e,ai1ec_map_internal_query:n,ai1ec_tokenize_uri:t}}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("external_libs/bootstrap/affix",["jquery_timely"],function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="ai1ec-affix ai1ec-affix-top ai1ec-affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("ai1ec-affix");var e=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;this.affixed=="top"&&(i.top+=r),typeof s!="object"&&(u=o=s),typeof o=="function"&&(o=s.top(this.$element)),typeof u=="function"&&(u=s.bottom(this.$element));var a=this.unpin!=null&&r+this.unpin<=i.top?!1:u!=null&&i.top+this.$element.height()>=n-u?"bottom":o!=null&&r<=o?"top":!1;if(this.affixed===a)return;this.unpin&&this.$element.css("top","");var f="ai1ec-affix"+(a?"-"+a:""),l=e.Event(f+".bs.affix");this.$element.trigger(l);if(l.isDefaultPrevented())return;this.affixed=a,this.unpin=a=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(f).trigger(e.Event(f.replace("affix","affixed"))),a=="bottom"&&this.$element.offset({top:n-u-this.$element.height()})};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="ai1ec-affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}),timely.define("scripts/common_scripts/frontend/common_event_handlers",["jquery_timely","external_libs/bootstrap/affix"],function(e){var t=function(t){var n=e(this),r=n.next(".ai1ec-popup"),i,s,o;if(r.length===0)return;i=r.html(),s=r.attr("class");var u=n.closest("#ai1ec-calendar-view");u.length===0&&(u=e("body")),n.offset().left-u.offset().left>182?o="left":o="right",n.constrained_popover({content:i,title:"",placement:o,trigger:"manual",html:!0,template:'<div class="timely ai1ec-popover '+s+'">'+'<div class="ai1ec-arrow"></div>'+'<div class="ai1ec-popover-inner">'+'<div class="ai1ec-popover-content"><div></div></div>'+"</div>"+"</div>",container:"body"}).constrained_popover("show")},n=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-popup").length===0&&e(this).constrained_popover("hide")},r=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip").length===0&&(e(this).remove(),e("body > .ai1ec-tooltip").remove())},i=function(t){if("ontouchstart"in document.documentElement){t.preventDefault();return}var n=e(this),r={template:'<div class="timely ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"manual",container:"body"};if(n.is(".ai1ec-category .ai1ec-color-swatch")||n.is(".ai1ec-custom-filter .ai1ec-color-swatch"))return;n.is(".ai1ec-tooltip-auto")&&(r.placement=u(250)),n.tooltip(r),n.tooltip("show")},s=function(t){e(this).tooltip("hide")},o=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip-trigger").length===0&&e(this).remove(),n.closest(".ai1ec-popup").length===0&&e("body > .ai1ec-popup").remove()},u=function(t){return function(n,r){var i,s,o=e(r),u=o.attr("data-placement"),a=e.extend({},o.offset(),{width:r.offsetWidth,height:r.offsetHeight}),f=function(){return!1===i?!1:(i=a.left-t>=0,i?"left":!1)},l=function(){return!1===s?!1:(s=a.left+t<=e(window).width(),s?"right":!1)};switch(u){case"top":return"top";case"bottom":return"bottom";case"left":if(f())return"left";case"right":if(l())return"right";default:if(f())return"left";if(l())return"right";return u}}};return{handle_popover_over:t,handle_popover_out:n,handle_popover_self_out:r,handle_tooltip_over:i,handle_tooltip_out:s,handle_tooltip_self_out:o}}),timely.define("external_libs/bootstrap/tooltip",["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}),timely.define("external_libs/bootstrap/popover",["jquery_timely","external_libs/bootstrap/tooltip"],function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="ai1ec-popover"><div class="ai1ec-arrow"></div><h3 class="ai1ec-popover-title"></h3><div class="ai1ec-popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".ai1ec-popover-title")[this.options.html?"html":"text"](t),e.find(".ai1ec-popover-content")[this.options.html?"html":"text"](n),e.removeClass("ai1ec-fade ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right ai1ec-in"),e.find(".ai1ec-popover-title").html()||e.find(".ai1ec-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}),timely.define("external_libs/constrained_popover",["jquery_timely","external_libs/bootstrap/popover"],function(e){var t=function(e,t){this.init("constrained_popover",e,t)};t.DEFAULTS=e.extend({},e.fn.popover.Constructor.DEFAULTS,{container:"",content:this.options}),t.prototype=e.extend({},e.fn.popover.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.applyPlacement=function(t,n){e.fn.popover.Constructor.prototype.applyPlacement.call(this,t,n);var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=this.getPosition(),u={};switch(n){case"left":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left-i:u.left=newPos.left-i,r.offset(u);break;case"right":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left+o.width:u.left=newPos.left+o.width,r.offset(u)}},t.prototype.defineBounds=function(t){var n,r,i,s,o,u={},a=e("body"===this.options.container?document:this.options.container);return a.length?(n=a.offset()||{top:0,left:0},r=n.top,i=n.left,s=r+a.height(),o=i+a.width(),t.top+t.height/2<r&&(u.top=r),t.top+t.height/2>s&&(u.top=s),t.left-t.width/2<i&&(u.left=i),t.left-t.width/2>o&&(u.left=o),u):!1};var n=e.fn.popover;e.fn.constrained_popover=function(n){return this.each(function(){var r=e(this),i=r.data("ai1ec.constrained_popover"),s=typeof n=="object"&&n;i||r.data("ai1ec.constrained_popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.constrained_popover.Constructor=t,e.fn.constrained_popover.noConflict=function(){return e.fn.constrained_popover=n,this}}),timely.define("external_libs/bootstrap/dropdown",["jquery_timely"],function(e){function i(){e(t).remove(),e(n).each(function(t){var n=s(e(this));if(!n.hasClass("ai1ec-open"))return;n.trigger(t=e.Event("hide.bs.dropdown"));if(t.isDefaultPrevented())return;n.removeClass("ai1ec-open").trigger("hidden.bs.dropdown")})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".ai1ec-dropdown-backdrop",n="[data-toggle=ai1ec-dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".ai1ec-disabled, :disabled"))return;var r=s(n),o=r.hasClass("ai1ec-open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".ai1ec-navbar-nav").length&&e('<div class="ai1ec-dropdown-backdrop"/>').insertAfter(e(this)).on("click",i),r.trigger(t=e.Event("show.bs.dropdown"));if(t.isDefaultPrevented())return;r.toggleClass("ai1ec-open").trigger("shown.bs.dropdown"),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".ai1ec-disabled, :disabled"))return;var i=s(r),o=i.hasClass("ai1ec-open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=e("[role=menu] li:not(.ai1ec-divider):visible a",i);if(!u.length)return;var a=u.index(u.filter(":focus"));t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<u.length-1&&a++,~a||(a=0),u.eq(a).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".ai1ec-dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)}),timely.define("scripts/common_scripts/frontend/common_frontend",["jquery_timely","domReady","scripts/common_scripts/frontend/common_event_handlers","ai1ec_calendar","external_libs/modernizr","external_libs/bootstrap/tooltip","external_libs/constrained_popover","external_libs/bootstrap/dropdown"],function(e,t,n,r,i){var s=!1,o=function(){s=!0,e(document).on("mouseenter",".ai1ec-popup-trigger",n.handle_popover_over),e(document).on("mouseleave",".ai1ec-popup-trigger",n.handle_popover_out),e(document).on("mouseleave",".ai1ec-popup",n.handle_popover_self_out),e(document).on("mouseenter",".ai1ec-tooltip-trigger",n.handle_tooltip_over),e(document).on("mouseleave",".ai1ec-tooltip-trigger",n.handle_tooltip_out),e(document).on("mouseleave",".ai1ec-tooltip",n.handle_tooltip_self_out)},u=function(){t(function(){o()})},a=function(){return s};return{start:u,are_event_listeners_attached:a}}),timely.define("external_libs/select2",["jquery_timely"],function(e){(function(e){typeof e.fn.each2=="undefined"&&e.fn.extend({each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})})(e),function(e,t){function l(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(c(e,t[n]))return n;return-1}function c(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e===n+"":n.constructor===String?n===e+"":!1}function h(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r}function p(e){return e.outerWidth(!1)-e.width()}function d(n){var r="keyup-change-value";n.bind("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.bind("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function v(n){n.bind("mousemove",function(n){var r=a;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function m(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function g(e){var t=!1,n;return function(){return t===!1&&(n=e(),t=!0),n}}function y(e,t){var n=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){l(e.target,t.get())>=0&&n(e)})}function b(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus(),t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",n),r.select())},0)}function w(e){e.preventDefault(),e.stopPropagation()}function E(e){e.preventDefault(),e.stopImmediatePropagation()}function S(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),u.attr("class","select2-sizer"),e("body").append(u)}return u.text(t.val()),u.width()}function x(t,n,r){var i,s=[],o;i=t.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")===0&&s.push(this)}),i=n.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),typeof o=="string"&&o.length>0&&s.push(this))}),t.attr("class",s.join(" "))}function T(e,t,n,r){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function N(t){var n,r=0,i=null,s=t.quietMillis||100,o=t.url,u=this;return function(a){window.clearTimeout(n),n=window.setTimeout(function(){r+=1;var n=r,s=t.data,f=o,l=t.transport||e.ajax,c=t.type||"GET",h={};s=s?s.call(u,a.term,a.page,a.context):null,f=typeof f=="function"?f.call(u,a.term,a.page,a.context):f,null!==i&&i.abort(),t.params&&(e.isFunction(t.params)?e.extend(h,t.params.call(u)):e.extend(h,t.params)),e.extend(h,{url:f,dataType:t.dataType,data:s,type:c,cache:!1,success:function(e){if(n<r)return;var i=t.results(e,a.page);a.callback(i)}}),i=l.call(u,h)},s)}}function C(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=n.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function k(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o)}}function L(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function A(t){return e.isFunction(t)?t():t}function O(t){var n=0;return e.each(t,function(e,t){t.children?n+=O(t.children):n++}),n}function M(e,n,r,i){var s=e,o=!1,u,a,f,l,h;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){h=i.tokenSeparators[f],a=e.indexOf(h);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+h.length);if(u.length>0){u=i.createSearchChoice(u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(c(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function _(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}var n,r,i,s,o,u,a,f;n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},f=e(document),o=function(){var e=1;return function(){return e++}}(),f.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}}),r=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results",u;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=g(function(){return n.element.closest("body")}),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(A(n.containerCss)),this.container.addClass(A(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabIndex"),this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(A(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=r=this.container.find(s),this.search=i=this.container.find("input.select2-input"),i.attr("tabIndex",this.elementTabIndex),this.resultsPage=0,this.context=null,this.initContainer(),v(this.results),this.dropdown.delegate(s,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent)),y(80,this.results),this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop(),o;i>0&&s-i<=0?(r.scrollTop(0),w(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),w(e))}),d(i),i.bind("keyup-change input paste",this.bind(this.updateResults)),i.bind("focus",function(){i.addClass("select2-focused")}),i.bind("blur",function(){i.removeClass("select2-focused")}),this.dropdown.delegate(s,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show())},prepareOpts:function(n){var r,i,s,o;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,s){var o,u,a,f,l=this.opts.id,c=this;o=function(r,i,u){var a,f,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(a=0,f=r.length;a<f;a+=1)h=r[a],d=h.disabled===!0,p=!d&&l(h)!==t,v=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+u),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(c.opts.formatResultCssClass(h)),g=e(document.createElement("div")),g.addClass("select2-result-label"),b=n.formatResult(h,g,s,c.opts.escapeMarkup),b!==t&&g.html(b),m.append(g),v&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),o(h.children,y,u+1),m.append(y)),m.data("select2-data",h),i.append(m)},o(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(s=n.id,n.id=function(e){return e[s]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.attr("data-select2-tags")}i?(n.query=this.bind(function(n){var i={results:[],more:!1},s=n.term,o,u,a;a=function(e,t){var r;e.is("option")?n.matcher(s,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:c(e.attr("disabled"),"disabled")}):e.is("optgroup")&&(r={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){a(t,r.children)}),r.children.length>0&&t.push(r))},o=r.children(),this.getPlaceholder()!==t&&o.length>0&&(u=o[0],e(u).text()===""&&(o=o.not(u))),o.each2(function(e,t){a(t,i.results)}),n.callback(i)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(o=n.element.data("ajax-url"),o&&o.length>0&&(n.ajax.url=o),n.query=N.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=k(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(h(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){if(c(this.id,t))return r=this.text,!1}),i.push({id:t,text:r})}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var e,t,n=this;e=this.opts.element.attr("disabled")!=="disabled",t=this.opts.element.attr("readonly")==="readonly",e=e&&!t,this.enabled!==e&&(e?this.enable():this.disable()),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),e.bind("propertychange.select2 DOMAttrModified.select2",t),typeof WebKitMutationObserver!="undefined"&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)}),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=this.dropdown.outerHeight(!1),s=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),u=t.top+n,a=t.left,f=u+i<=o,l=t.top-i>=this.body().scrollTop(),c=this.dropdown.outerWidth(!1),h=a+c<=s,p=this.dropdown.hasClass("select2-drop-above"),d,v,m;this.body().css("position")!=="static"&&(d=this.body().offset(),u-=d.top,a-=d.left),p?(v=!0,!l&&f&&(v=!1)):(v=!1,!f&&l&&(v=!0)),h||(a=t.left+r-c),v?(u=t.top-i,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),m=e.extend({top:u,left:a,width:r},A(this.opts.dropdownCss)),this.dropdown.css(m)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.clearDropdownAlignmentPreference(),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.updateResults(!0),s=e("#select2-drop-mask"),s.length==0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body()),s.bind("mousedown touchstart",function(t){var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),s.show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible();var o=this;this.container.parents().add(window).each(function(){e(this).bind(r+" "+n+" "+i,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),o.positionDropdown()})}),this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(n).unbind(r).unbind(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices(),i=e(n[r]),s=i.offset().top+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!0),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=i.offset().top-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return l(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),r=e(n[t]),r.addClass("select2-highlighted"),this.ensureHighlightVisible(),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"highlight",val:this.id(i),choice:i})},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=-1,i=this.resultsPage+1,s=this,o=this.search.val(),u=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:u,matcher:this.opts.matcher,callback:this.bind(function(n){if(!s.opened())return;s.opts.populateResults.call(this,e,n.results,{term:o,page:i,context:u}),n.more===!0?(t.detach().appendTo(e).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):t.remove(),s.positionDropdown(),s.resultsPage=i,s.context=n.context})}))},tokenize:function(){},updateResults:function(n){function f(){i.scrollTop(0),r.removeClass("select2-active"),u.positionDropdown()}function l(e){i.html(e),f()}var r=this.search,i=this.results,s=this.opts,o,u=this,a;if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;r.addClass("select2-active");var h=this.getMaximumSelectionSize();if(h>=1){o=this.data();if(e.isArray(o)&&o.length>=h&&L(s.formatSelectionTooBig,"formatSelectionTooBig")){l("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(h)+"</li>");return}}if(r.val().length<s.minimumInputLength){L(s.formatInputTooShort,"formatInputTooShort")?l("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>"):l("");return}s.formatSearching()&&n===!0&&l("<li class='select2-searching'>"+s.formatSearching()+"</li>");if(s.maximumInputLength&&r.val().length>s.maximumInputLength){L(s.formatInputTooLong,"formatInputTooLong")?l("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>"):l("");return}a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(null,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return c(u.id(this),u.id(a))}).length===0&&o.results.unshift(a));if(o.results.length===0&&L(s.formatNoMatches,"formatNoMatches")){l("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&L(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),f()})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){b(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r&&(this.highlight(t),this.onSelect(r,e))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,r,i,s,o;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s+=1){i=r[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(i!==null&&i.length>=1)return i[1]}}return this.opts.width==="resolve"?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);r!==null&&this.container.css("width",r)}}),i=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments),this.focusser.attr("disabled","disabled"),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),b(this.focusser)},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var e,t=this.container,r=this.dropdown,i=!1;this.showSearch(this.opts.minimumResultsForSearch>=0),this.selection=e=t.find(".select2-choice"),this.focusser=t.find(".select2-focusser"),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.TAB:case n.ENTER:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}})),this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC)return;if(this.opts.openOnEnter===!1&&e.which===n.ENTER){w(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){this.open(),w(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){this.opts.allowClear&&this.clear(),w(e);return}})),d(this.focusser),this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open(),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.focusser.val(""),w(e)})),e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear(),E(e),this.close(),this.selection.focus()})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?this.close():this.enabled&&this.open(),w(e),i=!1})),r.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(e){w(e)})),this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active")})),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),this.opts.element.trigger({type:"removed",val:this.id(e),choice:e}),this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()==="")this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(t,n){var r=t.find(":selected");e.isFunction(n)&&n({id:r.attr("value"),text:r.text(),element:r})}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val();t.query({matcher:function(e,n,r){return c(i,t.id(r))},callback:e.isFunction(r)?function(e){r(e.results.length?e.results[0]:null)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.select.find("option").first().text()!==""?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,t){var n=0,r=this,i=!0;this.findHighlightableChoices().each2(function(e,t){if(c(r.id(t.data("select2-data")),r.opts.element.val()))return n=e,!1}),this.highlight(n);if(t===!0){var s=this.opts.minimumResultsForSearch;i=s<0?!1:O(e.results)>=s,this.showSearch(i)}},showSearch:function(t){this.showSearchInput=t,this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var n=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.close(),(!t||!t.noFocus)&&this.selection.focus(),c(n,this.id(e))||this.triggerChange()},updateSelection:function(e){var n=this.selection.find("span"),r;this.selection.data("select2-data",e),n.empty(),r=this.opts.formatSelection(e,n),r!==t&&n.append(this.opts.escapeMarkup(r)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=!1,r=null,i=this;if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1]);if(this.select)this.select.val(e).find(":selected").each2(function(e,t){return r={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e&&e!==0){this.clear(),n&&this.triggerChange();return}this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange()})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;!e||e===""?this.clear():(this.opts.element.val(e?this.id(e):""),this.updateSelection(e))}}),s=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var n=[];e.find(":selected").each2(function(e,t){n.push({id:t.attr("value"),text:t.text(),element:t[0]})}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=h(n.val(),t.separator);t.query({matcher:function(n,r,s){return e.grep(i,function(e){return c(e,t.id(s))}).length},callback:e.isFunction(r)?function(e){r(e.results)}:e.noop})}),t},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(t),this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;this.opened()||this.open()})),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.BACKSPACE&&this.search.val()===""){this.close();var t,i=r.find(".select2-search-choice-focus");if(i.length>0){this.unselect(i.first()),this.search.width(10),w(e);return}t=r.find(".select2-search-choice:not(.select2-locked)"),t.length>0&&t.last().addClass("select2-search-choice-focus")}else r.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.ENTER:case n.TAB:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC)return;if(e.which===n.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN)&&w(e)})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.opened()||this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()})),this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0)},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus(),this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){l(i.id(this),n)<0&&(n.push(i.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){i.addSelectedChoice(this)}),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a=this.getVal(),f;f=this.opts.formatSelection(n,o.find("div")),f!=t&&o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(f)+"</div>"),r&&o.find(".select2-search-choice-close").bind("mousedown",w).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),w(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),a.push(u),this.setVal(a)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";n=e.data("select2-data");if(!n)return;r=l(this.id(n).toString(),t),r>=0&&(t.splice(r,1),this.setVal(t),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(n),choice:n}),this.triggerChange({removed:n})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),n=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,n){var i=r.id(n.data("select2-data"));l(i,e)>=0&&(n.addClass("select2-selected"),n.find(".select2-result-selectable").addClass("select2-selected"))}),n.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&r.highlight(0)},resizeSearch:function(){var e,t,n,r,i,s=p(this.search);e=S(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(i)},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),h(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){l(this,n)<0&&n.push(this)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator)))},val:function(){var n,r=!1,i=[],s=this;if(arguments.length===0)return this.getVal();n=arguments[0],arguments.length>1&&(r=arguments[1]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange();return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n=this,r;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();t||(t=[]),r=e.map(t,function(e){return n.opts.id(e)}),this.setVal(r),this.updateSelection(t),this.clearSearch()}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?a=r.element.attr("multiple"):(a=r.multiple||!1,"tags"in r&&(r.multiple=a=!0)),o=a?new s:new i,o.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(l(n[0],f)<0)throw"Unknown method: "+n[0];u=t,o=e(this).data("select2");if(o===t)return;n[0]==="container"?u=o.container:u=o[n[0]].apply(o,n.slice(1));if(u!==t)return!1}}),u===t?this:u},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return T(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n){return e?e.text:t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please enter "+n+" less character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}}}(e)}),timely.define("libs/select2_multiselect_helper",["jquery_timely","external_libs/select2"],function(e){var t=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""&&(s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> '),s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},n=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""?s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> ':s+='<span class="ai1ec-color-swatch-empty"></span> ',s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},r=function(r){typeof r=="undefined"&&(r=e(document)),e(".ai1ec-select2-multiselect-selector",r).select2({allowClear:!0,formatResult:n,formatSelection:t,escapeMarkup:function(e){return e}})},i=function(t){e(".ai1ec-select2-multiselect-selector.select2-container",t).each(function(){e(this).data("select2").resizeSearch()})};return{init:r,refresh:i}});var Twig=function(e){return e.VERSION="0.7.2",e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}function n(t,n){var r,i,s="/",o=[],u;if(t.url)typeof t.base!="undefined"?r=t.base+(t.base.charAt(t.base.length-1)==="/"?"":"/"):r=t.url;else{if(!t.path)throw new e.Error("Cannot extend an inline template.");var a=require("path"),f=a.sep||s,l=new RegExp("^\\.{1,2}"+f.replace("\\","\\\\"));n=n.replace(/\//g,f),t.base!==undefined&&n.match(l)==null?(n=n.replace(t.base,""),r=t.base+f):r=t.path,r=r.replace(f+f,f),s=f}i=r.split(s),i.pop(),i=i.concat(n.split(s));while(i.length>0)u=i.shift(),u!="."&&(u==".."&&o.length>0&&o[o.length-1]!=".."?o.pop():o.push(u));return o.join(s)}return e.trace=!1,e.debug=!1,e.cache=!0,e.placeholders={parent:"{{|PARENT|}}"},e.indexOf=function(e,t){if(Array.prototype.hasOwnProperty("indexOf"))return e.indexOf(t);if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(r===0)return-1;var i=0;arguments.length>0&&(i=Number(arguments[1]),i!==i?i=0:i!==0&&i!==Infinity&&i!==-Infinity&&(i=(i>0||-1)*Math.floor(Math.abs(i))));if(i>=r)return-1;var s=i>=0?i:Math.max(r-Math.abs(i),0);for(;s<r;s++)if(s in n&&n[s]===t)return s;return e==t?0:-1},e.forEach=function(e,t,n){if(Array.prototype.forEach)return e.forEach(t,n);var r,i;if(e==null)throw new TypeError(" this is null or not defined");var s=Object(e),o=s.length>>>0;if({}.toString.call(t)!="[object Function]")throw new TypeError(t+" is not a function");n&&(r=n),i=0;while(i<o){var u;i in s&&(u=s[i],t.call(r,u,i,s)),i++}},e.Error=function(e){this.message=e,this.name="TwigException",this.type="TwigException"},e.Error.prototype.toString=function(){var e=this.name+": "+this.message;return e},e.log={trace:function(){e.trace&&console&&console.log(Array.prototype.slice.call(arguments))},debug:function(){e.debug&&console&&console.log(Array.prototype.slice.call(arguments))}},typeof console!="undefined"&&typeof console.log!="undefined"?e.log.error=function(){console.log.apply(console,arguments)}:e.log.error=function(){},e.token={},e.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw"},e.token.definitions=[{type:e.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:e.token.type.output,open:"{{",close:"}}"},{type:e.token.type.logic,open:"{%",close:"%}"},{type:e.token.type.comment,open:"{#",close:"#}"}],e.token.strings=['"',"'"],e.token.findStart=function(t){var n={position:null,def:null},r,i,s;for(r=0;r<e.token.definitions.length;r++)i=e.token.definitions[r],s=t.indexOf(i.open),e.log.trace("Twig.token.findStart: ","Searching for ",i.open," found at ",s),s>=0&&(n.position===null||s<n.position)&&(n.position=s,n.def=i);return n},e.token.findEnd=function(t,n,r){var i=null,s=!1,o=0,u=null,a=null,f=null,l=null,c=null,h=null,p,d;while(!s){u=null,a=null,f=t.indexOf(n.close,o);if(!(f>=0))throw new e.Error("Unable to find closing bracket '"+n.close+"'"+" opened near template position "+r);i=f,s=!0;if(n.type===e.token.type.comment)break;d=e.token.strings.length;for(p=0;p<d;p+=1)c=t.indexOf(e.token.strings[p],o),c>0&&c<f&&(u===null||c<u)&&(u=c,a=e.token.strings[p]);if(u!==null){l=u+1,i=null,s=!1;for(;;){h=t.indexOf(a,l);if(h<0)throw"Unclosed string in template";if(t.substr(h-1,1)!=="\\"){o=h+1;break}l=h+1}}}return i},e.tokenize=function(t){var n=[],r=0,i=null,s=null;while(t.length>0)i=e.token.findStart(t),e.log.trace("Twig.tokenize: ","Found token: ",i),i.position!==null?(i.position>0&&n.push({type:e.token.type.raw,value:t.substring(0,i.position)}),t=t.substr(i.position+i.def.open.length),r+=i.position+i.def.open.length,s=e.token.findEnd(t,i.def,r),e.log.trace("Twig.tokenize: ","Token ends at ",s),n.push({type:i.def.type,value:t.substring(0,s).trim()}),i.def.type==="logic"&&t.substr(s+i.def.close.length,1)==="\n"&&(s+=1),t=t.substr(s+i.def.close.length),r+=s+i.def.close.length):(n.push({type:e.token.type.raw,value:t}),t="");return n},e.compile=function(t){try{var n=[],r=[],i=[],s=null,o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null;while(t.length>0){s=t.shift(),e.log.trace("Compiling token ",s);switch(s.type){case e.token.type.raw:r.length>0?i.push(s):n.push(s);break;case e.token.type.logic:o=e.logic.compile.apply(this,[s]),c=o.type,h=e.logic.handler[c].open,p=e.logic.handler[c].next,e.log.trace("Twig.compile: ","Compiled logic token to ",o," next is: ",p," open is : ",h);if(h!==undefined&&!h){a=r.pop(),f=e.logic.handler[a.type];if(e.indexOf(f.next,c)<0)throw new Error(c+" not expected after a "+a.type);a.output=a.output||[],a.output=a.output.concat(i),i=[],l={type:e.token.type.logic,token:a},r.length>0?i.push(l):n.push(l)}p!==undefined&&p.length>0?(e.log.trace("Twig.compile: ","Pushing ",o," to logic stack."),r.length>0&&(a=r.pop(),a.output=a.output||[],a.output=a.output.concat(i),r.push(a),i=[]),r.push(o)):h!==undefined&&h&&(l={type:e.token.type.logic,token:o},r.length>0?i.push(l):n.push(l));break;case e.token.type.comment:break;case e.token.type.output:e.expression.compile.apply(this,[s]),r.length>0?i.push(s):n.push(s)}e.log.trace("Twig.compile: "," Output: ",n," Logic Stack: ",r," Pending Output: ",i)}if(r.length>0)throw u=r.pop(),new Error("Unable to find an end tag for "+u.type+", expecting one of "+u.next);return n}catch(d){e.log.error("Error compiling twig template "+this.id+": "),d.stack?e.log.error(d.stack):e.log.error(d.toString());if(this.options.rethrow)throw d}},e.parse=function(t,n){try{var r=[],i=!0,s=this;return n=n||{},e.forEach(t,function(o){e.log.debug("Twig.parse: ","Parsing token: ",o);switch(o.type){case e.token.type.raw:r.push(o.value);break;case e.token.type.logic:var u=o.token,a=e.logic.parse.apply(s,[u,n,i]);a.chain!==undefined&&(i=a.chain),a.context!==undefined&&(n=a.context),a.output!==undefined&&r.push(a.output);break;case e.token.type.comment:break;case e.token.type.output:e.log.debug("Twig.parse: ","Output token: ",o.stack),r.push(e.expression.parse.apply(s,[o.stack,n]))}}),r.join("")}catch(o){e.log.error("Error parsing twig template "+this.id+": "),o.stack?e.log.error(o.stack):e.log.error(o.toString());if(this.options.rethrow)throw o;if(e.debug)return o.toString()}},e.prepare=function(t){var n,r;return e.log.debug("Twig.prepare: ","Tokenizing ",t),r=e.tokenize.apply(this,[t]),e.log.debug("Twig.prepare: ","Compiling ",r),n=e.compile.apply(this,[r]),e.log.debug("Twig.prepare: ","Compiled ",n),n},e.Templates={registry:{}},e.validateId=function(t){if(t==="prototype")throw new e.Error(t+" is not a valid twig identifier");if(e.Templates.registry.hasOwnProperty(t))throw new e.Error("There is already a template with the ID "+t);return!0},e.Templates.save=function(t){if(t.id===undefined)throw new e.Error("Unable to save template with no id");e.Templates.registry[t.id]=t},e.Templates.load=function(t){return e.Templates.registry.hasOwnProperty(t)?e.Templates.registry[t]:null},e.Templates.loadRemote=function(t,n,r,i){var s=n.id,o=n.method,u=n.async,a=n.precompiled,f=null;u===undefined&&(u=!0),s===undefined&&(s=t),n.id=s;if(e.cache&&e.Templates.registry.hasOwnProperty(s))return r&&r(e.Templates.registry[s]),e.Templates.registry[s];if(o=="ajax"){if(typeof XMLHttpRequest=="undefined")throw new e.Error("Unsupported platform: Unable to do remote requests because there is no XMLHTTPRequest implementation");var l=new XMLHttpRequest;l.onreadystatechange=function(){var s=null;l.readyState==4&&(l.status==200?(e.log.debug("Got template ",l.responseText),a===!0?s=JSON.parse(l.responseText):s=l.responseText,n.url=t,n.data=s,f=new e.Template(n),r&&r(f)):i&&i(l))},l.open("GET",t,u),l.send()}else(function(){var s=require("fs"),o=require("path"),l=null,c=function(s,o){if(s){i&&i(s);return}a===!0&&(o=JSON.parse(o)),n.data=o,n.path=t,f=new e.Template(n),r&&r(f)};if(u===!0)s.stat(t,function(n,r){if(n||!r.isFile())throw new e.Error("Unable to find template file "+t);s.readFile(t,"utf8",c)});else{if(!s.statSync(t).isFile())throw new e.Error("Unable to find template file "+t);l=s.readFileSync(t,"utf8"),c(undefined,l)}})();return u===!1?f:!0},e.Template=function(n){var r=n.data,i=n.id,s=n.blocks,o=n.macros||{},u=n.base,a=n.path,f=n.url,l=n.options;this.id=i,this.base=u,this.path=a,this.url=f,this.macros=o,this.options=l,this.reset(s),t("String",r)?this.tokens=e.prepare.apply(this,[r]):this.tokens=r,i!==undefined&&e.Templates.save(this)},e.Template.prototype.reset=function(t){e.log.debug("Twig.Template.reset","Reseting template "+this.id),this.blocks={},this.child={blocks:t||{}},this.extend=null},e.Template.prototype.render=function(t,r){r=r||{};var i,s;this.context=t||{},this.reset(),r.blocks&&(this.blocks=r.blocks),r.macros&&(this.macros=r.macros),i=e.parse.apply(this,[this.tokens,this.context]);if(this.extend){var o;return this.options.allowInlineIncludes&&(o=e.Templates.load(this.extend),o&&(o.options=this.options)),o||(s=n(this,this.extend),o=e.Templates.loadRemote(s,{method:this.url?"ajax":"fs",base:this.base,async:!1,id:s,options:this.options})),this.parent=o,this.parent.render(this.context,{blocks:this.blocks})}return r.output=="blocks"?this.blocks:r.output=="macros"?this.macros:i},e.Template.prototype.importFile=function(t){var r,i;if(!this.url&&!this.path&&this.options.allowInlineIncludes){i=e.Templates.load(t),i.options=this.options;if(i)return i;throw new e.Error("Didn't find the inline template by id")}return r=n(this,t),i=e.Templates.loadRemote(r,{method:this.url?"ajax":"fs",base:this.base,async:!1,options:this.options,id:r}),i},e.Template.prototype.importBlocks=function(t,n){var r=this.importFile(t),i=this.context,s=this,o;n=n||!1,r.render(i),e.forEach(Object.keys(r.blocks),function(e){if(n||s.blocks[e]===undefined)s.blocks[e]=r.blocks[e]})},e.Template.prototype.importMacros=function(t){var r=n(this,t),i=e.Templates.loadRemote(r,{method:this.url?"ajax":"fs",async:!1,id:r});return i},e.Template.prototype.compile=function(t){return e.compiler.compile(this,t)},e}(Twig||{});(function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t})})();var Twig=function(e){e.lib={};var t=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function n(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};return r.format=function(r,i){var s=1,o=r.length,u="",a,f=[],l,c,h,p,d,v;for(l=0;l<o;l++){u=e(r[l]);if(u==="string")f.push(r[l]);else if(u==="array"){h=r[l];if(h[2]){a=i[s];for(c=0;c<h[2].length;c++){if(!a.hasOwnProperty(h[2][c]))throw t('[sprintf] property "%s" does not exist',h[2][c]);a=a[h[2][c]]}}else h[1]?a=i[h[1]]:a=i[s++];if(/[^s]/.test(h[8])&&e(a)!="number")throw t("[sprintf] expecting number but found %s",e(a));switch(h[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=h[7]?a.toExponential(h[7]):a.toExponential();break;case"f":a=h[7]?parseFloat(a).toFixed(h[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&h[7]?a.substring(0,h[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(h[8])&&h[3]&&a>=0?"+"+a:a,d=h[4]?h[4]=="0"?"0":h[4].charAt(1):" ",v=h[6]-String(a).length,p=h[6]?n(d,v):"",f.push(h[5]?a+p:p+a)}}return f.join("")},r.cache={},r.parse=function(e){var t=e,n=[],r=[],i=0;while(t){if((n=/^[^\x25]+/.exec(t))!==null)r.push(n[0]);else if((n=/^\x25{2}/.exec(t))!==null)r.push("%");else{if((n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))===null)throw"[sprintf] huh?";if(n[2]){i|=1;var s=[],o=n[2],u=[];if((u=/^([a-z_][a-z_\d]*)/i.exec(o))===null)throw"[sprintf] huh?";s.push(u[1]);while((o=o.substring(u[0].length))!=="")if((u=/^\.([a-z_][a-z_\d]*)/i.exec(o))!==null)s.push(u[1]);else{if((u=/^\[(\d+)\]/.exec(o))===null)throw"[sprintf] huh?";s.push(u[1])}n[2]=s}else i|=2;if(i===3)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},r}(),n=function(e,n){return n.unshift(e),t.apply(null,n)};return e.lib.sprintf=t,e.lib.vsprintf=n,function(){function s(e){return(e=Math.abs(e)%100)%10==1&&e!=11?"st":e%10==2&&e!=12?"nd":e%10==3&&e!=13?"rd":"th"}function o(e){var t=new Date(e.getFullYear()+1,0,4);return(t-e)/864e5<7&&(e.getDay()+6)%7<(t.getDay()+6)%7?t.getFullYear():e.getMonth()>0||e.getDate()>=4?e.getFullYear():e.getFullYear()-((e.getDay()+6)%7-e.getDate()>2?1:0)}function u(e){var t=new Date(o(e),0,4);return t.setDate(t.getDate()-(t.getDay()+6)%7),parseInt((e-t)/6048e5)+1}var t="Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),n="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),r="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),i="January,February,March,April,May,June,July,August,September,October,November,December".split(",");e.lib.formatDate=function(e,a){if(typeof a!="string"||/^\s*$/.test(a))return e+"";var f=new Date(e.getFullYear(),0,1),l=e;return a.replace(/[dDjlNSwzWFmMntLoYyaABgGhHisuU]/g,function(e){switch(e){case"d":return("0"+l.getDate()).replace(/^.+(..)$/,"$1");case"D":return t[l.getDay()];case"j":return l.getDate();case"l":return n[l.getDay()];case"N":return(l.getDay()+6)%7+1;case"S":return s(l.getDate());case"w":return l.getDay();case"z":return Math.ceil((f-l)/864e5);case"W":return("0"+u(l)).replace(/^.(..)$/,"$1");case"F":return i[l.getMonth()];case"m":return("0"+(l.getMonth()+1)).replace(/^.+(..)$/,"$1");case"M":return r[l.getMonth()];case"n":return l.getMonth()+1;case"t":return(new Date(l.getFullYear(),l.getMonth()+1,-1)).getDate();case"L":return(new Date(l.getFullYear(),1,29)).getDate()==29?1:0;case"o":return o(l);case"Y":return l.getFullYear();case"y":return(l.getFullYear()+"").replace(/^.+(..)$/,"$1");case"a":return l.getHours()<12?"am":"pm";case"A":return l.getHours()<12?"AM":"PM";case"B":return Math.floor(((l.getUTCHours()+1)%24+l.getUTCMinutes()/60+l.getUTCSeconds()/3600)*1e3/24);case"g":return l.getHours()%12!=0?l.getHours()%12:12;case"G":return l.getHours();case"h":return("0"+(l.getHours()%12!=0?l.getHours()%12:12)).replace(/^.+(..)$/,"$1");case"H":return("0"+l.getHours()).replace(/^.+(..)$/,"$1");case"i":return("0"+l.getMinutes()).replace(/^.+(..)$/,"$1");case"s":return("0"+l.getSeconds()).replace(/^.+(..)$/,"$1");case"u":return l.getMilliseconds();case"U":return l.getTime()/1e3}})}}(),e.lib.strip_tags=function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})},e.lib.parseISO8601Date=function(e){var t=/(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d+)?(Z|([+-])(\d\d):(\d\d))/,n=[];n=e.match(t);if(!n)throw"Couldn't parse ISO 8601 date string '"+e+"'";var r=[1,2,3,4,5,6,10,11];for(var i in r)n[r[i]]=parseInt(n[r[i]],10);n[7]=parseFloat(n[7]);var s=Date.UTC(n[1],n[2]-1,n[3],n[4],n[5],n[6]);n[7]>0&&(s+=Math.round(n[7]*1e3));if(n[8]!="Z"&&n[10]){var o=n[10]*60*60*1e3;n[11]&&(o+=n[11]*60*1e3),n[9]=="-"?s-=o:s+=o}return new Date(s)},e.lib.strtotime=function(t,n){var r,i,s,o,u="";t=t.replace(/\s{2,}|^\s|\s$/g," "),t=t.replace(/[\t\r\n]/g,"");if(t==="now")return n===null||isNaN(n)?(new Date).getTime()/1e3|0:n|0;if(!isNaN(u=Date.parse(t)))return u/1e3|0;n?n=new Date(n*1e3):n=new Date;var a=t;t=t.toLowerCase();var f={day:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},mon:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]},l=function(e){var t=e[2]&&e[2]==="ago",r=(r=e[0]==="last"?-1:1)*(t?-1:1);switch(e[0]){case"last":case"next":switch(e[1].substring(0,3)){case"yea":n.setFullYear(n.getFullYear()+r);break;case"wee":n.setDate(n.getDate()+r*7);break;case"day":n.setDate(n.getDate()+r);break;case"hou":n.setHours(n.getHours()+r);break;case"min":n.setMinutes(n.getMinutes()+r);break;case"sec":n.setSeconds(n.getSeconds()+r);break;case"mon":if(e[1]==="month"){n.setMonth(n.getMonth()+r);break};default:var i=f.day[e[1].substring(0,3)];if(typeof i!="undefined"){var s=i-n.getDay();s===0?s=7*r:s>0?e[0]==="last"&&(s-=7):e[0]==="next"&&(s+=7),n.setDate(n.getDate()+s),n.setHours(0,0,0,0)}}break;default:if(!/\d+/.test(e[0]))return!1;r*=parseInt(e[0],10);switch(e[1].substring(0,3)){case"yea":n.setFullYear(n.getFullYear()+r);break;case"mon":n.setMonth(n.getMonth()+r);break;case"wee":n.setDate(n.getDate()+r*7);break;case"day":n.setDate(n.getDate()+r);break;case"hou":n.setHours(n.getHours()+r);break;case"min":n.setMinutes(n.getMinutes()+r);break;case"sec":n.setSeconds(n.getSeconds()+r)}}return!0};s=t.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/);if(s!==null)return s[2]?s[3]||(s[2]+=":00"):s[2]="00:00:00",o=s[1].split(/-/g),o[1]=f.mon[o[1]-1]||o[1],o[0]=+o[0],o[0]=o[0]>=0&&o[0]<=69?"20"+(o[0]<10?"0"+o[0]:o[0]+""):o[0]>=70&&o[0]<=99?"19"+o[0]:o[0]+"",parseInt(this.strtotime(o[2]+" "+o[1]+" "+o[0]+" "+s[2])+(s[4]?s[4]/1e3:""),10);var c="([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?";s=t.match(new RegExp(c,"gi"));if(s===null){try{num=e.lib.parseISO8601Date(a);if(num)return num/1e3|0}catch(h){return!1}return!1}for(r=0,i=s.length;r<i;r++)if(!l(s[r].split(" ")))return!1;return n.getTime()/1e3|0},e.lib.is=function(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e},e.lib.copy=function(e){var t={},n;for(n in e)t[n]=e[n];return t},e.lib.replaceAll=function(e,t,n){return e.split(t).join(n)},e.lib.chunkArray=function(t,n){var r=[],i=0,s=t.length;if(n<1||!e.lib.is("Array",t))return[];while(i<s)r.push(t.slice(i,i+=n));return r},e.lib.round=function(t,n,r){var i,s,o,u;n|=0,i=Math.pow(10,n),t*=i,u=t>0|-(t<0),o=t%1===.5*u,s=Math.floor(t);if(o)switch(r){case"PHP_ROUND_HALF_DOWN":t=s+(u<0);break;case"PHP_ROUND_HALF_EVEN":t=s+s%2*u;break;case"PHP_ROUND_HALF_ODD":t=s+!(s%2);break;default:t=s+(u>0)}return(o?t:Math.round(t))/i},e}(Twig||{}),Twig=function(e){e.logic={},e.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from"},e.logic.definitions=[{type:e.logic.type.if_,regex:/^if\s+([^\s].+)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!0,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i="",s=e.expression.parse.apply(this,[t.stack,n]);return r=!0,s&&(r=!1,i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!1,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i="";return r&&e.expression.parse.apply(this,[t.stack,n])===!0&&(r=!1,i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.else_,regex:/^else$/,next:[e.logic.type.endif,e.logic.type.endfor],open:!1,parse:function(t,n,r){var i="";return r&&(i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:e.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].*?)(?:\s+if\s+([^\s].*))?$/,next:[e.logic.type.else_,e.logic.type.endfor],open:!0,compile:function(t){var n=t.match[1],r=t.match[2],i=t.match[3],s=null;t.key_var=null,t.value_var=null;if(n.indexOf(",")>=0){s=n.split(",");if(s.length!==2)throw new e.Error("Invalid expression in for loop: "+n);t.key_var=s[0].trim(),t.value_var=s[1].trim()}else t.value_var=n;return t.expression=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,i&&(t.conditional=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i}]).stack),delete t.match,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.expression,n]),s=[],o,u=0,a,f=this,l=t.conditional,c=function(e,t){var r=l!==undefined;return{index:e+1,index0:e,revindex:r?undefined:t-e,revindex0:r?undefined:t-e-1,first:e===0,last:r?undefined:e===t-1,length:r?undefined:t,parent:n}},h=function(r,i){var a=e.lib.copy(n);a[t.value_var]=i,t.key_var&&(a[t.key_var]=r),a.loop=c(u,o);if(l===undefined||e.expression.parse.apply(f,[l,a]))s.push(e.parse.apply(f,[t.output,a])),u+=1};return i instanceof Array?(o=i.length,e.forEach(i,function(e){var t=u;h(t,e)})):i instanceof Object&&(i._keys!==undefined?a=i._keys:a=Object.keys(i),o=a.length,e.forEach(a,function(e){if(e==="_keys")return;h(e,i[e])})),r=s.length===0,{chain:r,output:s.join("")}}},{type:e.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:e.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2],i=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack;return t.key=n,t.expression=i,delete t.match,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.expression,n]),s=t.key;return this.context[s]=i,n[s]=i,{chain:r,context:n}}},{type:e.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[e.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=t.key;return this.context[s]=i,n[s]=i,{chain:r,context:n}}},{type:e.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:e.logic.type.filter,regex:/^filter\s+(.+)$/,next:[e.logic.type.endfilter],open:!0,compile:function(t){var n="|"+t.match[1].trim();return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=[{type:e.expression.type.string,value:i}].concat(t.stack),o=e.expression.parse.apply(this,[s,n]);return{chain:r,output:o}}},{type:e.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:e.logic.type.block,regex:/^block\s+([a-zA-Z0-9_]+)$/,next:[e.logic.type.endblock],open:!0,compile:function(e){return e.block=e.match[1].trim(),delete e.match,e},parse:function(t,n,r){var i="",s="",o=this.blocks[t.block]&&this.blocks[t.block].indexOf(e.placeholders.parent)>-1;if(this.blocks[t.block]===undefined||o||n.loop)i=e.expression.parse.apply(this,[{type:e.expression.type.string,value:e.parse.apply(this,[t.output,n])},n]),o?this.blocks[t.block]=this.blocks[t.block].replace(e.placeholders.parent,i):this.blocks[t.block]=i;return this.child.blocks[t.block]?s=this.child.blocks[t.block]:s=this.blocks[t.block],{chain:r,output:s}}},{type:e.logic.type.endblock,regex:/^endblock(?:\s+([a-zA-Z0-9_]+))?$/,next:[],open:!1},{type:e.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.stack,n]);return this.extend=i,{chain:r,output:""}}},{type:e.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.stack,n]);return this.importBlocks(i),{chain:r,output:""}}},{type:e.logic.type.include,regex:/^include\s+(ignore missing\s+)?(.+?)\s*(?:with\s+(.+?))?\s*(only)?$/,next:[],open:!0,compile:function(t){var n=t.match,r=n[1]!==undefined,i=n[2].trim(),s=n[3],o=n[4]!==undefined&&n[4].length;return delete t.match,t.only=o,t.includeMissing=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i}]).stack,s!==undefined&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:s.trim()}]).stack),t},parse:function(t,n,r){var i={},s,o,u;if(!t.only)for(o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);if(t.withStack!==undefined){s=e.expression.parse.apply(this,[t.withStack,n]);for(o in s)s.hasOwnProperty(o)&&(i[o]=s[o])}var a=e.expression.parse.apply(this,[t.stack,i]);return u=this.importFile(a),{chain:r,output:u.render(i)}}},{type:e.logic.type.spaceless,regex:/^spaceless$/,next:[e.logic.type.endspaceless],open:!0,parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=/>\s+</g,o=i.replace(s,"><").trim();return{chain:r,output:o}}},{type:e.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:e.logic.type.macro,regex:/^macro\s+([a-zA-Z0-9_]+)\s?\((([a-zA-Z0-9_]+(,\s?)?)*)\)$/,next:[e.logic.type.endmacro],open:!0,compile:function(t){var n=t.match[1],r=t.match[2].split(/[ ,]+/);for(var i=0;i<r.length;i++)for(var s=0;s<r.length;s++)if(r[i]===r[s]&&i!==s)throw new e.Error("Duplicate arguments for parameter: "+r[i]);return t.macroName=n,t.parameters=r,delete t.match,t},parse:function(t,n,r){var i=this;return this.macros[t.macroName]=function(){var n={_self:i.macros};for(var r=0;r<t.parameters.length;r++){var s=t.parameters[r];typeof arguments[r]!="undefined"?n[s]=arguments[r]:n[s]=undefined}return e.parse.apply(i,[t.output,n])},{chain:r,output:""}}},{type:e.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:e.logic.type.import_,regex:/^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim();return delete t.match,t.expression=n,t.contextName=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){if(t.expression!=="_self"){var i=e.expression.parse.apply(this,[t.stack,n]),s=this.importMacros(i||t.expression);n[t.contextName]=s.render({},{output:"macros"})}else n[t.contextName]=this.macros;return{chain:r,output:""}}},{type:e.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim().split(/[ ,]+/),i={};for(var s=0;s<r.length;s++){var o=r[s],u=o.match(/^([a-zA-Z0-9_]+)\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/);u?i[u[1].trim()]=u[2].trim():o.match(/^([a-zA-Z0-9_]+)$/)&&(i[o]=o)}return delete t.match,t.expression=n,t.macroNames=i,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i;if(t.expression!=="_self"){var s=e.expression.parse.apply(this,[t.stack,n]),o=this.importMacros(s||t.expression);i=o.render({},{output:"macros"})}else i=this.macros;for(var u in t.macroNames)i.hasOwnProperty(u)&&(n[t.macroNames[u]]=i[u]);return{chain:r,output:""}}}],e.logic.handler={},e.logic.extendType=function(t,n){n=n||"Twig.logic.type"+t,e.logic.type[t]=n},e.logic.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);if(e.logic.type[t.type])throw new e.Error("Unable to extend logic definitions. Type "+t.type+" is already defined.");e.logic.extendType(t.type),e.logic.handler[t.type]=t};while(e.logic.definitions.length>0)e.logic.extend(e.logic.definitions.shift());return e.logic.compile=function(t){var n=t.value.trim(),r=e.logic.tokenize.apply(this,[n]),i=e.logic.handler[r.type];return i.compile&&(r=i.compile.apply(this,[r]),e.log.trace("Twig.logic.compile: ","Compiled logic token to ",r)),r},e.logic.tokenize=function(t){var n={},r=null,i=null,s=null,o=null,u=null,a=null;t=t.trim();for(r in e.logic.handler)if(e.logic.handler.hasOwnProperty(r)){i=e.logic.handler[r].type,s=e.logic.handler[r].regex,o=[],s instanceof Array?o=s:o.push(s);while(o.length>0){u=o.shift(),a=u.exec(t.trim());if(a!==null)return n.type=i,n.match=a,e.log.trace("Twig.logic.tokenize: ","Matched a ",i," regular expression of ",a),n}}throw new e.Error("Unable to parse '"+t.trim()+"'")},e.logic.parse=function(t,n,r){var i="",s;return n=n||{},e.log.debug("Twig.logic.parse: ","Parsing logic token ",t),s=e.logic.handler[t.type],s.parse&&(i=s.parse.apply(this,[t,n,r])),i},e}(Twig||{}),Twig=function(e){e.expression={},e.expression.reservedWords=["true","false","null","_context"],e.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},e.expression.set={operations:[e.expression.type.filter,e.expression.type.operator.unary,e.expression.type.operator.binary,e.expression.type.array.end,e.expression.type.object.end,e.expression.type.parameter.end,e.expression.type.comma,e.expression.type.test],expressions:[e.expression.type._function,e.expression.type.bool,e.expression.type.string,e.expression.type.variable,e.expression.type.number,e.expression.type._null,e.expression.type.context,e.expression.type.parameter.start,e.expression.type.array.start,e.expression.type.object.start]},e.expression.set.operations_extended=e.expression.set.operations.concat([e.expression.type.key.period,e.expression.type.key.brackets]),e.expression.fn={compile:{push:function(e,t,n){n.push(e)},push_both:function(e,t,n){n.push(e),t.push(e)}},parse:{push:function(e,t,n){t.push(e)},push_value:function(e,t,n){t.push(e.value)}}},e.expression.definitions=[{type:e.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*)/,next:e.expression.set.operations.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=n.pop(),s=t.params&&e.expression.parse.apply(this,[t.params,r]),o=e.test(t.filter,i,s);t.modifier=="not"?n.push(!o):n.push(o)}},{type:e.expression.type.comma,regex:/^,/,next:e.expression.set.expressions.concat([e.expression.type.array.end,e.expression.type.object.end]),compile:function(t,n,r){var i=n.length-1,s;delete t.match,delete t.value;for(;i>=0;i--){s=n.pop();if(s.type===e.expression.type.object.start||s.type===e.expression.type.parameter.start||s.type===e.expression.type.array.start){n.push(s);break}r.push(s)}r.push(t)}},{type:e.expression.type.operator.binary,regex:/(^[\+\-~%\?\:]|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^and\s+|^or\s+|^in\s+|^not in\s+|^\.\.)/,next:e.expression.set.expressions.concat([e.expression.type.operator.unary]),compile:function(t,n,r){delete t.match,t.value=t.value.trim();var i=t.value,s=e.expression.operator.lookup(i,t);e.log.trace("Twig.expression.compile: ","Operator: ",s," from ",i);while(n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(s.associativity===e.expression.operator.leftToRight&&s.precidence>=n[n.length-1].precidence||s.associativity===e.expression.operator.rightToLeft&&s.precidence>n[n.length-1].precidence)){var o=n.pop();r.push(o)}if(i===":"){if(!n[n.length-1]||n[n.length-1].value!=="?"){var u=r.pop();if(u.type!==e.expression.type.string&&u.type!==e.expression.type.variable&&u.type!==e.expression.type.number)throw new e.Error("Unexpected value before ':' of "+u.type+" = "+u.value);t.key=u.value,r.push(t);return}}else n.push(s)},parse:function(t,n,r){t.key?n.push(t):e.expression.operator.parse(t.value,n)}},{type:e.expression.type.operator.unary,regex:/(^not\s+)/,next:e.expression.set.expressions,compile:function(t,n,r){delete t.match,t.value=t.value.trim();var i=t.value,s=e.expression.operator.lookup(i,t);e.log.trace("Twig.expression.compile: ","Operator: ",s," from ",i);while(n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(s.associativity===e.expression.operator.leftToRight&&s.precidence>=n[n.length-1].precidence||s.associativity===e.expression.operator.rightToLeft&&s.precidence>n[n.length-1].precidence)){var o=n.pop();r.push(o)}n.push(s)},parse:function(t,n,r){e.expression.operator.parse(t.value,n)}},{type:e.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2.)*?\1/,next:e.expression.set.operations,compile:function(t,n,r){var i=t.value;delete t.match,i.substring(0,1)==='"'?i=i.replace('\\"','"'):i=i.replace("\\'","'"),t.value=i.substring(1,i.length-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),e.log.trace("Twig.expression.compile: ","String value: ",t.value),r.push(t)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.parameter.start,regex:/^\(/,next:e.expression.set.expressions.concat([e.expression.type.parameter.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.parameter.end,regex:/^\)/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i,s=t;i=n.pop();while(n.length>0&&i.type!=e.expression.type.parameter.start)r.push(i),i=n.pop();var o=[];while(t.type!==e.expression.type.parameter.start)o.unshift(t),t=r.pop();o.unshift(t);var u=!1;t=r[r.length-1],t===undefined||t.type!==e.expression.type._function&&t.type!==e.expression.type.filter&&t.type!==e.expression.type.test&&t.type!==e.expression.type.key.brackets&&t.type!==e.expression.type.key.period?(s.expression=!0,o.pop(),o.shift(),s.params=o,r.push(s)):(s.expression=!1,t.params=o)},parse:function(t,n,r){var i=[],s=!1,o=null;if(t.expression)o=e.expression.parse.apply(this,[t.params,r]),n.push(o);else{while(n.length>0){o=n.pop();if(o&&o.type&&o.type==e.expression.type.parameter.start){s=!0;break}i.unshift(o)}if(!s)throw new e.Error("Expected end of parameter set.");n.push(i)}}},{type:e.expression.type.array.start,regex:/^\[/,next:e.expression.set.expressions.concat([e.expression.type.array.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.array.end,regex:/^\]/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i=n.length-1,s;for(;i>=0;i--){s=n.pop();if(s.type===e.expression.type.array.start)break;r.push(s)}r.push(t)},parse:function(t,n,r){var i=[],s=!1,o=null;while(n.length>0){o=n.pop();if(o.type&&o.type==e.expression.type.array.start){s=!0;break}i.unshift(o)}if(!s)throw new e.Error("Expected end of array.");n.push(i)}},{type:e.expression.type.object.start,regex:/^\{/,next:e.expression.set.expressions.concat([e.expression.type.object.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.object.end,regex:/^\}/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i=n.length-1,s;for(;i>=0;i--){s=n.pop();if(s&&s.type===e.expression.type.object.start)break;r.push(s)}r.push(t)},parse:function(t,n,r){var i={},s=!1,o=null,u=null,a=!1,f=null;while(n.length>0){o=n.pop();if(o&&o.type&&o.type===e.expression.type.object.start){s=!0;break}if(o&&o.type&&(o.type===e.expression.type.operator.binary||o.type===e.expression.type.operator.unary)&&o.key){if(!a)throw new e.Error("Missing value for key '"+o.key+"' in object definition.");i[o.key]=f,i._keys===undefined&&(i._keys=[]),i._keys.unshift(o.key),f=null,a=!1}else a=!0,f=o}if(!s)throw new e.Error("Unexpected end of object.");n.push(i)}},{type:e.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.value=e.match[1],n.push(e)},parse:function(t,n,r){var i=n.pop(),s=t.params&&e.expression.parse.apply(this,[t.params,r]);n.push(e.filter.apply(this,[t.value,i,s]))}},{type:e.expression.type._function,regex:/^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,next:e.expression.type.parameter.start,transform:function(e,t){return"("},compile:function(e,t,n){var r=e.match[1];e.fn=r,delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=t.fn,o;if(e.functions[s])o=e.functions[s].apply(this,i);else{if(typeof r[s]!="function")throw new e.Error(s+" function does not exist and is not defined in the context");o=r[s].apply(r,i)}n.push(o)}},{type:e.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,validate:function(t,n){return e.indexOf(e.expression.reservedWords,t[0])<0},parse:function(t,n,r){var i=e.expression.resolve(r[t.value],r);n.push(i)}},{type:e.expression.type.key.period,regex:/^\.([a-zA-Z0-9_]+)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.key=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=t.key,o=n.pop(),u;if(o===null||o===undefined){if(this.options.strict_variables)throw new e.Error("Can't access a key "+s+" on an null or undefined object.");return null}var a=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)};typeof o=="object"&&s in o?u=o[s]:o["get"+a(s)]!==undefined?u=o["get"+a(s)]:o["is"+a(s)]!==undefined?u=o["is"+a(s)]:u=null,n.push(e.expression.resolve(u,o,i))}},{type:e.expression.type.key.brackets,regex:/^\[([^\]]*)\]/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(t,n,r){var i=t.match[1];delete t.value,delete t.match,t.stack=e.expression.compile({value:i}).stack,r.push(t)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=e.expression.parse.apply(this,[t.stack,r]),o=n.pop(),u;if(o===null||o===undefined){if(this.options.strict_variables)throw new e.Error("Can't access a key "+s+" on an null or undefined object.");return null}typeof o=="object"&&s in o?u=o[s]:u=null,n.push(e.expression.resolve(u,o,i))}},{type:e.expression.type._null,regex:/^null/,next:e.expression.set.operations,compile:function(e,t,n){delete e.match,e.value=null,n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.context,regex:/^_context/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,parse:function(e,t,n){t.push(n)}},{type:e.expression.type.number,regex:/^\-?\d+(\.\d+)?/,next:e.expression.set.operations,compile:function(e,t,n){e.value=Number(e.value),n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.bool,regex:/^(true|false)/,next:e.expression.set.operations,compile:function(e,t,n){e.value=e.match[0]=="true",delete e.match,n.push(e)},parse:e.expression.fn.parse.push_value}],e.expression.resolve=function(e,t,n){return typeof e=="function"?e.apply(t,n||[]):e},e.expression.handler={},e.expression.extendType=function(t){e.expression.type[t]="Twig.expression.type."+t},e.expression.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.expression.handler[t.type]=t};while(e.expression.definitions.length>0)e.expression.extend(e.expression.definitions.shift());return e.expression.tokenize=function(t){var n=[],r=0,i=null,s,o,u,a,f,l=[],c;c=function(){var t=Array.prototype.slice.apply(arguments),o=t.pop(),u=t.pop();return e.log.trace("Twig.expression.tokenize","Matched a ",s," regular expression of ",t),i&&e.indexOf(i,s)<0?(l.push(s+" cannot follow a "+n[n.length-1].type+" at template:"+r+" near '"+t[0].substring(0,20)+"...'"),t[0]):e.expression.handler[s].validate&&!e.expression.handler[s].validate(t,n)?t[0]:(l=[],n.push({type:s,value:t[0],match:t}),f=!0,i=a,r+=t[0].length,e.expression.handler[s].transform?e.expression.handler[s].transform(t,n):"")},e.log.debug("Twig.expression.tokenize","Tokenizing expression ",t);while(t.length>0){t=t.trim();for(s in e.expression.handler)if(e.expression.handler.hasOwnProperty(s)){a=e.expression.handler[s].next,o=e.expression.handler[s].regex,o instanceof Array?u=o:u=[o],f=!1;while(u.length>0)o=u.pop(),t=t.replace(o,c);if(f)break}if(!f)throw l.length>0?new e.Error(l.join(" OR ")):new e.Error("Unable to parse '"+t+"' at template position"+r)}return e.log.trace("Twig.expression.tokenize","Tokenized to ",n),n},e.expression.compile=function(t){var n=t.value,r=e.expression.tokenize(n),i=null,s=[],o=[],u=null;e.log.trace("Twig.expression.compile: ","Compiling ",n);while(r.length>0)i=r.shift(),u=e.expression.handler[i.type],e.log.trace("Twig.expression.compile: ","Compiling ",i),u.compile&&u.compile(i,o,s),e.log.trace("Twig.expression.compile: ","Stack is",o),e.log.trace("Twig.expression.compile: ","Output is",s);while(o.length>0)s.push(o.pop());return e.log.trace("Twig.expression.compile: ","Final output is",s),t.stack=s,delete t.value,t},e.expression.parse=function(t,n){var r=this;t instanceof Array||(t=[t]);var i=[],s=null;return e.forEach(t,function(t){s=e.expression.handler[t.type],s.parse&&s.parse.apply(r,[t,i,n])}),i.pop()},e}(Twig||{}),Twig=function(e){e.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};var t=function(e,t){if(t.indexOf!==undefined)return e===t||e!==""&&t.indexOf(e)>-1;var n;for(n in t)if(t.hasOwnProperty(n)&&t[n]===e)return!0;return!1};return e.expression.operator.lookup=function(t,n){switch(t){case"..":case"not in":case"in":n.precidence=20,n.associativity=e.expression.operator.leftToRight;break;case",":n.precidence=18,n.associativity=e.expression.operator.leftToRight;break;case"?":case":":n.precidence=16,n.associativity=e.expression.operator.rightToLeft;break;case"or":n.precidence=14,n.associativity=e.expression.operator.leftToRight;break;case"and":n.precidence=13,n.associativity=e.expression.operator.leftToRight;break;case"==":case"!=":n.precidence=9,n.associativity=e.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":n.precidence=8,n.associativity=e.expression.operator.leftToRight;break;case"~":case"+":case"-":n.precidence=6,n.associativity=e.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":n.precidence=5,n.associativity=e.expression.operator.leftToRight;break;case"not":n.precidence=3,n.associativity=e.expression.operator.rightToLeft;break;default:throw new e.Error(t+" is an unknown operator.")}return n.operator=t,n},e.expression.operator.parse=function(n,r){e.log.trace("Twig.expression.operator.parse: ","Handling ",n);var i,s,o;switch(n){case":":break;case"?":o=r.pop(),s=r.pop(),i=r.pop(),i?r.push(s):r.push(o);break;case"+":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i+s);break;case"-":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i-s);break;case"*":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i*s);break;case"/":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i/s);break;case"//":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(parseInt(i/s));break;case"%":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i%s);break;case"~":s=r.pop(),i=r.pop(),r.push((i!==undefined?i.toString():"")+(s!==undefined?s.toString():""));break;case"not":case"!":r.push(!r.pop());break;case"<":s=r.pop(),i=r.pop(),r.push(i<s);break;case"<=":s=r.pop(),i=r.pop(),r.push(i<=s);break;case">":s=r.pop(),i=r.pop(),r.push(i>s);break;case">=":s=r.pop(),i=r.pop(),r.push(i>=s);break;case"===":s=r.pop(),i=r.pop(),r.push(i===s);break;case"==":s=r.pop(),i=r.pop(),r.push(i==s);break;case"!==":s=r.pop(),i=r.pop(),r.push(i!==s);break;case"!=":s=r.pop(),i=r.pop(),r.push(i!=s);break;case"or":s=r.pop(),i=r.pop(),r.push(i||s);break;case"and":s=r.pop(),i=r.pop(),r.push(i&&s);break;case"**":s=r.pop(),i=r.pop(),r.push(Math.pow(i,s));break;case"not in":s=r.pop(),i=r.pop(),r.push(!t(i,s));break;case"in":s=r.pop(),i=r.pop(),r.push(t(i,s));break;case"..":s=r.pop(),i=r.pop(),r.push(e.functions.range(i,s));break;default:throw new e.Error(n+" is an unknown operator.")}},e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}return e.filters={upper:function(e){return typeof e!="string"?e:e.toUpperCase()},lower:function(e){return typeof e!="string"?e:e.toLowerCase()},capitalize:function(e){return typeof e!="string"?e:e.substr(0,1).toUpperCase()+e.toLowerCase().substr(1)},title:function(e){return typeof e!="string"?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})},length:function(t){return e.lib.is("Array",t)||typeof t=="string"?t.length:e.lib.is("Object",t)?t._keys===undefined?Object.keys(t).length:t._keys.length:0},reverse:function(e){if(t("Array",e))return e.reverse();if(t("String",e))return e.split("").reverse().join("");if(e instanceof Object){var n=e._keys||Object.keys(e).reverse();return e._keys=n,e}},sort:function(e){if(t("Array",e))return e.sort();if(e instanceof Object){delete e._keys;var n=Object.keys(e),r=n.sort(function(t,n){return e[t]>e[n]});return e._keys=r,e}},keys:function(t){if(t===undefined||t===null)return;var n=t._keys||Object.keys(t),r=[];return e.forEach(n,function(e){if(e==="_keys")return;t.hasOwnProperty(e)&&r.push(e)}),r},url_encode:function(e){if(e===undefined||e===null)return;return encodeURIComponent(e)},join:function(t,n){if(t===undefined||t===null)return;var r="",i=[],s=null;return n&&n[0]&&(r=n[0]),t instanceof Array?i=t:(s=t._keys||Object.keys(t),e.forEach(s,function(e){if(e==="_keys")return;t.hasOwnProperty(e)&&i.push(t[e])})),i.join(r)},"default":function(t,n){if(n===undefined||n.length!==1)throw new e.Error("default filter expects one argument");return t===undefined||t===null||t===""?n[0]:t},json_encode:function(e){return e&&e.hasOwnProperty("_keys")&&delete e._keys,e===undefined||e===null?"null":JSON.stringify(e)},merge:function(t,n){var r=[],i=0,s=[];t instanceof Array?e.forEach(n,function(e){e instanceof Array||(r={})}):r={},r instanceof Array||(r._keys=[]),t instanceof Array?e.forEach(t,function(e){r._keys&&r._keys.push(i),r[i]=e,i++}):(s=t._keys||Object.keys(t),e.forEach(s,function(e){r[e]=t[e],r._keys.push(e);var n=parseInt(e,10);!isNaN(n)&&n>=i&&(i=n+1)})),e.forEach(n,function(t){t instanceof Array?e.forEach(t,function(e){r._keys&&r._keys.push(i),r[i]=e,i++}):(s=t._keys||Object.keys(t),e.forEach(s,function(e){r[e]||r._keys.push(e),r[e]=t[e];var n=parseInt(e,10);!isNaN(n)&&n>=i&&(i=n+1)}))});if(n.length===0)throw new e.Error("Filter merge expects at least one parameter");return r},date:function(t,n){if(t===undefined||t===null)return;var r=e.functions.date(t);return e.lib.formatDate(r,n[0])},date_modify:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length!==1)throw new e.Error("date_modify filter expects 1 argument");var r=n[0],i;return e.lib.is("Date",t)&&(i=e.lib.strtotime(r,t.getTime()/1e3)),e.lib.is("String",t)&&(i=e.lib.strtotime(r,e.lib.strtotime(t))),e.lib.is("Number",t)&&(i=e.lib.strtotime(r,t)),new Date(i*1e3)},replace:function(t,n){if(t===undefined||t===null)return;var r=n[0],i;for(i in r)r.hasOwnProperty(i)&&i!=="_keys"&&(t=e.lib.replaceAll(t,i,r[i]));return t},format:function(t,n){if(t===undefined||t===null)return;return e.lib.vsprintf(t,n)},striptags:function(t){if(t===undefined||t===null)return;return e.lib.strip_tags(t)},escape:function(e){if(e===undefined||e===null)return;return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},e:function(t){return e.filters.escape(t)},nl2br:function(t){if(t===undefined||t===null)return;var n="BACKSLASH_n_replace",r="<br />"+n;return t=e.filters.escape(t).replace(/\r\n/g,r).replace(/\r/g,r).replace(/\n/g,r),e.lib.replaceAll(t,n,"\n")},number_format:function(e,t){var n=e,r=t&&t[0]?t[0]:undefined,i=t&&t[1]!==undefined?t[1]:".",s=t&&t[2]!==undefined?t[2]:",";n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+n)?+n:0,u=isFinite(+r)?Math.abs(r):0,a="",f=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return a=(u?f(o,u):""+Math.round(o)).split("."),a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(a[1]||"").length<u&&(a[1]=a[1]||"",a[1]+=(new Array(u-a[1].length+1)).join("0")),a.join(i)},trim:function(t,n){if(t===undefined||t===null)return;var r=e.filters.escape(""+t),i;n&&n[0]?i=""+n[0]:i=" \n\r	\f\u2028\u2029";for(var s=0;s<r.length;s++)if(i.indexOf(r.charAt(s))===-1){r=r.substring(s);break}for(s=r.length-1;s>=0;s--)if(i.indexOf(r.charAt(s))===-1){r=r.substring(0,s+1);break}return i.indexOf(r.charAt(0))===-1?r:""},slice:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length<1)throw new e.Error("slice filter expects at least 1 argument");var r=n[0]||0,i=n.length>1?n[1]:t.length,s=r>=0?r:Math.max(t.length+r,0);if(e.lib.is("Array",t)){var o=[];for(var u=s;u<s+i&&u<t.length;u++)o.push(t[u]);return o}if(e.lib.is("String",t))return t.substr(s,i);throw new e.Error("slice filter expects value to be an array or string")},abs:function(e){if(e===undefined||e===null)return;return Math.abs(e)},first:function(e){if(e instanceof Array)return e[0];if(e instanceof Object){if("_keys"in e)return e[e._keys[0]]}else if(typeof e=="string")return e.substr(0,1);return},split:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length<1||n.length>2)throw new e.Error("split filter expects 1 or 2 argument");if(e.lib.is("String",t)){var r=n[0],i=n[1],s=t.split(r);if(i===undefined)return s;if(i<0)return t.split(r,s.length+i);var o=[];if(r=="")while(s.length>0){var u="";for(var a=0;a<i&&s.length>0;a++)u+=s.shift();o.push(u)}else{for(var a=0;a<i-1&&s.length>0;a++)o.push(s.shift());s.length>0&&o.push(s.join(r))}return o}throw new e.Error("split filter expects value to be a string")},last:function(t){if(e.lib.is("Object",t)){var n;return t._keys===undefined?n=Object.keys(t):n=t._keys,t[n[n.length-1]]}return t[t.length-1]},raw:function(e){return e},batch:function(t,n){var r=n.shift(),i=n.shift(),s,o,u;if(!e.lib.is("Array",t))throw new e.Error("batch filter expects items to be an array");if(!e.lib.is("Number",r))throw new e.Error("batch filter expects size to be a number");r=Math.ceil(r),s=e.lib.chunkArray(t,r);if(i&&t.length%r!=0){o=s.pop(),u=r-o.length;while(u--)o.push(i);s.push(o)}return s},round:function(t,n){n=n||[];var r=n.length>0?n[0]:0,i=n.length>1?n[1]:"common";t=parseFloat(t);if(r&&!e.lib.is("Number",r))throw new e.Error("round filter expects precision to be a number");if(i==="common")return e.lib.round(t,r);if(!e.lib.is("Function",Math[i]))throw new e.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[i](t*Math.pow(10,r))/Math.pow(10,r)}},e.filter=function(t,n,r){if(!e.filters[t])throw"Unable to find filter "+t;return e.filters[t].apply(this,[n,r])},e.filter.extend=function(t,n){e.filters[t]=n},e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}return e.functions={range:function(e,t,n){var r=[],i,s,o,u=n||1,a=!1;!isNaN(e)&&!isNaN(t)?(i=parseInt(e,10),s=parseInt(t,10)):isNaN(e)&&isNaN(t)?(a=!0,i=e.charCodeAt(0),s=t.charCodeAt(0)):(i=isNaN(e)?0:e,s=isNaN(t)?0:t),o=i>s?!1:!0;if(o)while(i<=s)r.push(a?String.fromCharCode(i):i),i+=u;else while(i>=s)r.push(a?String.fromCharCode(i):i),i-=u;return r},cycle:function(e,t){var n=t%e.length;return e[n]},dump:function(){var t="\n",n="  ",r=0,i="",s=Array.prototype.slice.call(arguments),o=function(e){var t="";while(e>0)e--,t+=n;return t},u=function(e){i+=o(r),typeof e=="object"?a(e):typeof e=="function"?i+="function()"+t:typeof e=="string"?i+="string("+e.length+') "'+e+'"'+t:typeof e=="number"?i+="number("+e+")"+t:typeof e=="boolean"&&(i+="bool("+e+")"+t)},a=function(e){var n;if(e===null)i+="NULL"+t;else if(e===undefined)i+="undefined"+t;else if(typeof e=="object"){i+=o(r)+typeof e,r++,i+="("+function(e){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(e)+") {"+t;for(n in e)i+=o(r)+"["+n+"]=> "+t,u(e[n]);r--,i+=o(r)+"}"+t}else u(e)};return s.length==0&&s.push(this.context),e.forEach(s,function(e){a(e)}),i},date:function(t,n){var r;if(t===undefined)r=new Date;else if(e.lib.is("Date",t))r=t;else if(e.lib.is("String",t))r=new Date(e.lib.strtotime(t)*1e3);else{if(!e.lib.is("Number",t))throw new e.Error("Unable to parse date "+t);r=new Date(t*1e3)}return r},block:function(e){return this.blocks[e]},parent:function(){return e.placeholders.parent},attribute:function(e,t,n){return e instanceof Object&&e.hasOwnProperty(t)?typeof e[t]=="function"?e[t].apply(undefined,n):e[t]:e[t]||undefined}},e._function=function(t,n,r){if(!e.functions[t])throw"Unable to find function "+t;return e.functions[t](n,r)},e._function.extend=function(t,n){e.functions[t]=n},e}(Twig||{}),Twig=function(e){return e.tests={empty:function(e){if(e===null||e===undefined)return!0;if(typeof e=="number")return!1;if(e.length&&e.length>0)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},odd:function(e){return e%2===1},even:function(e){return e%2===0},divisibleby:function(e,t){return e%t[0]===0},defined:function(e){return e!==undefined},none:function(e){return e===null},"null":function(e){return this.none(e)},sameas:function(e,t){return e===t[0]}},e.test=function(t,n,r){if(!e.tests[t])throw"Test "+t+" is not defined.";return e.tests[t](n,r)},e.test.extend=function(t,n){e.tests[t]=n},e}(Twig||{}),Twig=function(e){return e.exports={VERSION:e.VERSION},e.exports.twig=function(n){var r=n.id,i={strict_variables:n.strict_variables||!1,allowInlineIncludes:n.allowInlineIncludes||!1,rethrow:n.rethrow||!1};r&&e.validateId(r),n.debug!==undefined&&(e.debug=n.debug),n.trace!==undefined&&(e.trace=n.trace);if(n.data!==undefined)return new e.Template({data:n.data,module:n.module,id:r,options:i});if(n.ref!==undefined){if(n.id!==undefined)throw new e.Error("Both ref and id cannot be set on a twig.js template.");return e.Templates.load(n.ref)}if(n.href!==undefined)return e.Templates.loadRemote(n.href,{id:r,method:"ajax",base:n.base,module:n.module,precompiled:n.precompiled,async:n.async,options:i},n.load,n.error);if(n.path!==undefined)return e.Templates.loadRemote(n.path,{id:r,method:"fs",base:n.base,module:n.module,precompiled:n.precompiled,async:n.async,options:i},n.load,n.error)},e.exports.extendFilter=function(t,n){e.filter.extend(t,n)},e.exports.extendFunction=function(t,n){e._function.extend(t,n)},e.exports.extendTest=function(t,n){e.test.extend(t,n)},e.exports.extendTag=function(t){e.logic.extend(t)},e.exports.extend=function(t){t(e)},e.exports.compile=function(t,n){var r=n.filename,i=n.filename,s;return s=new e.Template({data:t,path:i,id:r,options:n.settings["twig options"]}),function(e){return s.render(e)}},e.exports.renderFile=function(t,n,r){"function"==typeof n&&(r=n,n={}),n=n||{};var i={path:t,base:n.settings.views,load:function(e){r(null,e.render(n))}},s=n.settings["twig options"];if(s)for(var o in s)s.hasOwnProperty(o)&&(i[o]=s[o]);e.exports.twig(i)},e.exports.__express=e.exports.renderFile,e.exports.cache=function(t){e.cache=t},e}(Twig||{}),Twig=function(e){return e.compiler={module:{}},e.compiler.compile=function(t,n){var r=JSON.stringify(t.tokens),i=t.id,s;if(n.module){if(e.compiler.module[n.module]===undefined)throw new e.Error("Unable to find module type "+n.module);s=e.compiler.module[n.module](i,r,n.twig)}else s=e.compiler.wrap(i,r);return s},e.compiler.module={amd:function(t,n,r){return'define(["'+r+'"], function (Twig) {\n	var twig, templates;\ntwig = Twig.twig;\ntemplates = '+e.compiler.wrap(t,n)+"\n	return templates;\n});"},node:function(t,n){return'var twig = require("twig").twig;\nexports.template = '+e.compiler.wrap(t,n)},cjs2:function(t,n,r){return'module.declare([{ twig: "'+r+'" }], function (require, exports, module) {\n'+'	var twig = require("twig").twig;\n'+"	exports.template = "+e.compiler.wrap(t,n)+"\n});"}},e.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},e}(Twig||{});typeof module!="undefined"&&module.declare?module.declare([],function(e,t,n){for(key in Twig.exports)Twig.exports.hasOwnProperty(key)&&(t[key]=Twig.exports[key])}):typeof define=="function"&&define.amd||1?timely.define("external_libs/twig",[],function(){return Twig.exports}):typeof module!="undefined"&&module.exports?module.exports=Twig.exports:(window.twig=Twig.exports.twig,window.Twig=Twig.exports),timely.define("libs/twig",["external_libs/twig"],function(e){return e.extendFunction("ai1ec_disable_content_output",function(){}),e}),timely.define("agenda",["libs/twig","agenda"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/agenda.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<div class="ai1ec-agenda-view'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:'">\n	'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"dates",match:["dates"]},{type:"Twig.expression.type.test",filter:"empty"}],output:[{type:"raw",value:'		<p class="ai1ec-no-results">\n			'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_upcoming_events",match:["text_upcoming_events"]}]},{type:"raw",value:"\n		</p>\n	"}]}},{type:"logic",token:{type:"Twig.logic.type.else",match:["else"],output:[{type:"raw",value:"		"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"date",value_var:"date_info",expression:[{type:"Twig.expression.type.variable",value:"dates",match:["dates"]}],output:[{type:"raw",value:'			<div class="ai1ec-date\n				'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n				<a class="ai1ec-date-title ai1ec-load-view"\n					href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"href"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n					'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'>\n					<div class="ai1ec-month">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"month"}]},{type:"raw",value:'</div>\n					<div class="ai1ec-day">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"day"}]},{type:"raw",value:'</div>\n					<div class="ai1ec-weekday">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"weekday"}]},{type:"raw",value:"</div>\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_year_in_agenda_dates",match:["show_year_in_agenda_dates"]}],output:[{type:"raw",value:'						<div class="ai1ec-year">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"year"}]},{type:"raw",value:"</div>\n					"}]}},{type:"raw",value:'				</a>\n				<div class="ai1ec-date-events">\n					'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"category",expression:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"events"}],output:[{type:"raw",value:"						"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"category",match:["category"]}],output:[{type:"raw",value:'							<div class="ai1ec-event\n								ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n								ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"}],output:[{type:"raw",value:"ai1ec-allday"}]}},{type:"raw",value:"								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"expanded",match:["expanded"]}],output:[{type:"raw",value:"ai1ec-expanded"}]}},{type:"raw",value:'"\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'									data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								'}]}},{type:"raw",value:'								data-end="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end"}]},{type:"raw",value:'">\n\n								<div class="ai1ec-event-header">\n									<div class="ai1ec-event-toggle">\n										<i class="ai1ec-fa ai1ec-fa-minus-circle ai1ec-fa-lg"></i>\n										<i class="ai1ec-fa ai1ec-fa-plus-circle ai1ec-fa-lg"></i>\n									</div>\n									<span class="ai1ec-event-title">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<span class="ai1ec-event-location"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n										"}]}},{type:"raw",value:"									</span>\n									"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"edit_post_link",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"edit_post_link",match:["edit_post_link"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'										<a class="post-edit-link" href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"edit_post_link",match:["edit_post_link"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n											<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n										</a>\n									"}]}},{type:"raw",value:'\n									<div class="ai1ec-event-time">\n										 '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"timespan_short"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									</div>\n								</div>\n\n								"},{type:"raw",value:'\n								<div class="ai1ec-event-summary '},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"expanded",match:["expanded"]}],output:[{type:"raw",value:"ai1ec-expanded"}]}},{type:"raw",value:'">\n\n									<div class="ai1ec-event-description">\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"content_img_url"},{type:"Twig.expression.type.test",filter:"empty"},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<a class="ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</a>\n										"}]}},{type:"raw",value:"										"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_content"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n									</div>\n\n									<div class="ai1ec-event-summary-footer">\n										<div class="ai1ec-btn-group ai1ec-actions">\n											'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"is_ticket_button_enabled",match:["is_ticket_button_enabled"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'												<a class="ai1ec-pull-right ai1ec-btn ai1ec-btn-primary\n														ai1ec-btn-xs ai1ec-buy-tickets"\n													target="_blank"\n													href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n													>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url_label"}]},{type:"raw",value:"</a>\n											"}]}},{type:"raw",value:'											<a class="ai1ec-read-more ai1ec-btn ai1ec-btn-default\n												ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_read_more",match:["text_read_more"]}]},{type:"raw",value:' <i class="ai1ec-fa ai1ec-fa-arrow-right"></i>\n											</a>\n										</div>\n										'},{type:"logic",token:{type:"Twig.logic.type.set",key:"categories",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"categories_html"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"tags",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"tags_html"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"categories",match:["categories"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'											<span class="ai1ec-categories">\n												<span class="ai1ec-field-label">\n													<i class="ai1ec-fa ai1ec-fa-folder-open"></i>\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_categories",match:["text_categories"]}]},{type:"raw",value:"\n												</span>\n												"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"categories",match:["categories"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n										"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"tags",match:["tags"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'											<span class="ai1ec-tags">\n												<span class="ai1ec-field-label">\n													<i class="ai1ec-fa ai1ec-fa-tags"></i>\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_tags",match:["text_tags"]}]},{type:"raw",value:"\n												</span>\n												"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"tags",match:["tags"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n										"}]}},{type:"raw",value:"									</div>\n								</div>\n\n							</div>\n						"}]}},{type:"raw",value:" "},{type:"raw",value:"\n					"}]}},{type:"raw",value:" "},{type:"raw",value:"\n				</div>\n			</div>\n		"}]}},{type:"raw",value:" "},{type:"raw",value:"\n	"}]}},{type:"raw",value:" "},{type:"raw",value:'\n</div>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n}),timely.define("oneday",["libs/twig","oneday"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/oneday.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<table class="ai1ec-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view-original"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:'">\n	<thead>\n		<tr>\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"date",value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:'				<th class="ai1ec-weekday\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n					'},{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_reveal_button",match:["show_reveal_button"]},{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"last"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'						<div class="ai1ec-reveal-full-day">\n							<button class="ai1ec-btn ai1ec-btn-info ai1ec-btn-xs\n									ai1ec-tooltip-trigger"\n								data-placement="left"\n								title="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_full_day",match:["text_full_day"]},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n								<i class="ai1ec-fa ai1ec-fa-expand"></i>\n							</button>\n						</div>\n					'}]}},{type:"raw",value:'					<a class="ai1ec-load-view" href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"href"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n						'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'>\n						<span class="ai1ec-weekday-date">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"day"}]},{type:"raw",value:'</span>\n						<span class="ai1ec-weekday-day">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"weekday"}]},{type:"raw",value:"</span>\n					</a>\n				</th>\n			"}]}},{type:"raw",value:"		</tr>\n		<tr>\n			"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:'				<td class="ai1ec-allday-events\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"first"}],output:[{type:"raw",value:'						<div class="ai1ec-allday-label">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_all_day",match:["text_all_day"]}]},{type:"raw",value:"</div>\n					"}]}},{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"allday"}],output:[{type:"raw",value:'						<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n							data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n							class="ai1ec-event-container ai1ec-load-event ai1ec-popup-trigger\n								ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n								ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n								ai1ec-allday\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n							>\n							<div class="ai1ec-event"\n								 style="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								 '},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'									data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								 '}]}},{type:"raw",value:'>\n								<span class="ai1ec-event-title">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<span class="ai1ec-event-location"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n									"}]}},{type:"raw",value:'								</span>\n							</div>\n						</a>\n\n						<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n									ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"										ai1ec-has-tickets-button\n									"}]}},{type:"raw",value:'">\n							'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'								<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n							"}]}},{type:"raw",value:'							<span class="ai1ec-popup-title">\n								<a class="ai1ec-load-event"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n									>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'									<span class="ai1ec-event-location"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n								"}]}},{type:"raw",value:"							</span>\n\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'								<a class="post-edit-link"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n									<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n								</a>\n							"}]}},{type:"raw",value:'\n							<div class="ai1ec-event-time">\n								'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n							</div>\n\n							<a class="ai1ec-load-event"\n								href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n								'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n							</a>\n							"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'								<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n							"}]}},{type:"raw",value:"						</div>\n\n					"}]}},{type:"raw",value:" "},{type:"raw",value:"\n\n				</td>\n			"}]}},{type:"raw",value:" "},{type:"raw",value:'\n		</tr>\n\n	</thead>\n	<tbody>\n		<tr class="ai1ec-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:'">\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:"				<td "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"}],output:[{type:"raw",value:'class="ai1ec-today"'}]}},{type:"raw",value:">\n\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"first"}],output:[{type:"raw",value:'						<div class="ai1ec-grid-container">\n							'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"h",value_var:"hour",expression:[{type:"Twig.expression.type.variable",value:"hours",match:["hours"]}],output:[{type:"raw",value:'								<div class="ai1ec-hour-marker\n									'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:8,match:["8",null]},{type:"Twig.expression.type.operator.binary",value:">=",precidence:8,associativity:"leftToRight",operator:">="},{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:18,match:["18",null]},{type:"Twig.expression.type.operator.binary",value:"<",precidence:8,associativity:"leftToRight",operator:"<"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:"ai1ec-business-hour"}]}},{type:"raw",value:'"\n									style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:60,match:["60",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"}]},{type:"raw",value:'px;">\n									<div>\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"hour",match:["hour"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									</div>\n								</div>\n								"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"quarter",expression:[{type:"Twig.expression.type.number",value:1,match:["1",null]},{type:"Twig.expression.type.number",value:3,match:["3",null]},{type:"Twig.expression.type.operator.binary",value:"..",precidence:20,associativity:"leftToRight",operator:".."}],output:[{type:"raw",value:'									<div class="ai1ec-quarter-marker"\n										style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:60,match:["60",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.variable",value:"quarter",match:["quarter"]},{type:"Twig.expression.type.number",value:15,match:["15",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.operator.binary",value:"+",precidence:6,associativity:"leftToRight",operator:"+"}]},{type:"raw",value:'px;"></div>\n								'}]}},{type:"raw",value:"							"}]}},{type:"raw",value:"							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.variable",value:"show_now",match:["show_now"]},{type:"Twig.expression.type.operator.binary",value:"or",precidence:14,associativity:"leftToRight",operator:"or"}],output:[{type:"raw",value:'								<div class="ai1ec-now-marker" style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"now_top",match:["now_top"]}]},{type:"raw",value:'px;">\n									<div>\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_now_label",match:["text_now_label"]}]},{type:"raw",value:" "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"now_text",match:["now_text"]}]},{type:"raw",value:"\n									</div>\n								</div>\n							"}]}},{type:"raw",value:"						</div>\n					"}]}},{type:"raw",value:'\n					<div class="ai1ec-day">\n\n						'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day_array",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"notallday"}],output:[{type:"raw",value:"							"},{type:"logic",token:{type:"Twig.logic.type.set",key:"event",expression:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"event"}]}},{type:"raw",value:'							<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n								class="ai1ec-event-container ai1ec-load-event ai1ec-popup-trigger\n									ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"}],output:[{type:"raw",value:"ai1ec-start-truncated"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"}],output:[{type:"raw",value:"ai1ec-end-truncated"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n								style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"top"}]},{type:"raw",value:"px;\n									height: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"height"}]},{type:"raw",value:"px;\n									left: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"indent"},{type:"Twig.expression.type.variable",value:"indent_multiplier",match:["indent_multiplier"]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.variable",value:"indent_offset",match:["indent_offset"]},{type:"Twig.expression.type.operator.binary",value:"+",precidence:6,associativity:"leftToRight",operator:"+"}]},{type:"raw",value:"px;\n									"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"faded_color",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"faded_color"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba_color",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"rgba_color"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"faded_color",match:["faded_color"]}],output:[{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba1",expression:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.05"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba3",expression:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.3"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]}},{type:"raw",value:"										border: 1px solid "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"faded_color",match:["faded_color"]}]},{type:"raw",value:";\n										border-color: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.5"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:";\n										background-image: -webkit-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -moz-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -ms-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -o-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n									"}]}},{type:"raw",value:'									">\n\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"}],output:[{type:"raw",value:'									<div class="ai1ec-start-truncator"></div>\n								'}]}},{type:"raw",value:"								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"}],output:[{type:"raw",value:'									<div class="ai1ec-end-truncator"></div>\n								'}]}},{type:"raw",value:'\n								<div class="ai1ec-event"\n									'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'										data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n									'}]}},{type:"raw",value:'>\n									<span class="ai1ec-event-time">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"short_start_time"}]},{type:"raw",value:'\n									</span>\n									<span class="ai1ec-event-title">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<span class="ai1ec-event-location"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n										"}]}},{type:"raw",value:'									</span>\n								</div>\n\n							</a>\n\n							<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n										ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n										ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"											ai1ec-has-tickets-button\n										"}]}},{type:"raw",value:'">\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'									<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n								"}]}},{type:"raw",value:'								<span class="ai1ec-popup-title">\n									<a class="ai1ec-load-event"\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<span class="ai1ec-event-location"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n									"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"is_ticket_button_enabled",match:["is_ticket_button_enabled"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<a class="ai1ec-pull-right ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs\n											ai1ec-buy-tickets" target="_blank"\n											href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url_label"}]},{type:"raw",value:"</a>\n									"}]}},{type:"raw",value:"								</span>\n\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'									<a class="post-edit-link"\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n										<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n									</a>\n								"}]}},{type:"raw",value:'\n								<div class="ai1ec-event-time">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n								</div>\n\n								<a class="ai1ec-load-event"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n								</a>\n								"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'									<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n								"}]}},{type:"raw",value:"							</div>\n\n						"}]}},{type:"raw",value:" "},{type:"raw",value:"\n					</div>\n\n				</td>\n			"}]}},{type:"raw",value:" "},{type:"raw",value:'\n		</tr>\n	</tbody>\n\n</table>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n}),timely.define("month",["libs/twig","month"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/month.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<table class="ai1ec-month-view ai1ec-popover-boundary\n	'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:"	"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"month_word_wrap",match:["month_word_wrap"]}],output:[{type:"raw",value:"ai1ec-word-wrap"}]}},{type:"raw",value:'">\n	<thead>\n		<tr>\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"weekday",expression:[{type:"Twig.expression.type.variable",value:"weekdays",match:["weekdays"]}],output:[{type:"raw",value:'				<th scope="col" class="ai1ec-weekday">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"weekday",match:["weekday"]}]},{type:"raw",value:"</th>\n			"}]}},{type:"raw",value:"		</tr>\n	</thead>\n	<tbody>\n		"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"week",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:"			"},{type:"logic",token:{type:"Twig.logic.type.set",key:"added_stretcher",expression:[{type:"Twig.expression.type.bool",value:!1}]}},{type:"raw",value:'			<tr class="ai1ec-week">\n				'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"week",match:["week"]}],output:[{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date"}],output:[{type:"raw",value:"						<td "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"}],output:[{type:"raw",value:'class="ai1ec-today"'}]}},{type:"raw",value:">\n							"},{type:"raw",value:"\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"added_stretcher",match:["added_stretcher"]},{type:"Twig.expression.type.operator.unary",value:"not",precidence:3,associativity:"rightToLeft",operator:"not"}],output:[{type:"raw",value:'								<div class="ai1ec-day-stretcher"></div>\n								'},{type:"logic",token:{type:"Twig.logic.type.set",key:"added_stretcher",expression:[{type:"Twig.expression.type.bool",value:!0}]}},{type:"raw",value:"							"}]}},{type:"raw",value:'\n							<div class="ai1ec-day">\n								<div class="ai1ec-date">\n									<a class="ai1ec-load-view"\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date_link"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date"}]},{type:"raw",value:"</a>\n								</div>\n\n								"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"events"}],output:[{type:"raw",value:'									<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:'											data-start-day="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_day"}]},{type:"raw",value:'"\n											data-end-day="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"multiday_end_day"}]},{type:"raw",value:'"\n											data-start-truncated="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"},{type:"Twig.expression.type.string",value:"true"},{type:"Twig.expression.type.string",value:"false"},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:'"\n											data-end-truncated="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"},{type:"Twig.expression.type.string",value:"true"},{type:"Twig.expression.type.string",value:"false"},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:'"\n										'}]}},{type:"raw",value:'										data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n										class="ai1ec-event-container ai1ec-load-event\n											ai1ec-popup-trigger\n											ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n											ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"}],output:[{type:"raw",value:"ai1ec-allday"}]}},{type:"raw",value:"											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n										>\n\n										<div class="ai1ec-event"\n											 style="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'												data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											'}]}},{type:"raw",value:'>\n											<span class="ai1ec-event-title">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"},{type:"Twig.expression.type.operator.unary",value:"not",precidence:3,associativity:"rightToLeft",operator:"not"}],output:[{type:"raw",value:'												<span class="ai1ec-event-time">\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"short_start_time"}]},{type:"raw",value:"\n												</span>\n											"}]}},{type:"raw",value:'										</div>\n									</a>\n\n									<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n									            ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									            ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									            "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"									                ai1ec-has-tickets-button\n									            "}]}},{type:"raw",value:'>\n									            ">\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'											<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n										"}]}},{type:"raw",value:'										<span class="ai1ec-popup-title">\n											<a class="ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'												<span class="ai1ec-event-location"\n													>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n											"}]}},{type:"raw",value:"										</span>\n\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'											<a class="post-edit-link"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n												<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n											</a>\n										"}]}},{type:"raw",value:'\n										<div class="ai1ec-event-time">\n											'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n										</div>\n\n										<a class="ai1ec-load-event"\n											href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n											'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										</a>\n										"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'											<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n										"}]}},{type:"raw",value:"									</div>\n								"}]}},{type:"raw",value:"							</div>\n						</td>\n					"}]}},{type:"logic",token:{type:"Twig.logic.type.else",match:["else"],output:[{type:"raw",value:" "},{type:"raw",value:'\n						<td class="ai1ec-empty"></td>\n					'}]}},{type:"raw",value:" "},{type:"raw",value:"\n\n				"}]}},{type:"raw",value:" "},{type:"raw",value:"\n			</tr>\n		"}]}},{type:"raw",value:" "},{type:"raw",value:'\n	</tbody>\n</table>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n}),timely.define("external_libs/jquery_history",["jquery_timely"],function(e){try{(function(t,n){var r=t.History=t.History||{};if(typeof r.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");r.Adapter={bind:function(t,n,r){e(t).bind(n,r)},trigger:function(t,n,r){e(t).trigger(n,r)},extractEventData:function(e,t,r){var i=t&&t.originalEvent&&t.originalEvent[e]||r&&r[e]||n;return i},onDomLoad:function(t){e(t)}},typeof r.init!="undefined"&&r.init()})(window),function(e,t){var n=e.document,r=e.setTimeout||r,i=e.clearTimeout||i,s=e.setInterval||s,o=e.History=e.History||{};if(typeof o.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){if(typeof o.initHtml4.initialized!="undefined")return!1;o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t=o.getHashByIndex(),n;return n=e===t,n},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return typeof e=="undefined"?t=o.savedHashes[o.savedHashes.length-1]:e<0?t=o.savedHashes[o.savedHashes.length+e]:t=o.savedHashes[e],t},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r=o.getHashByState(e),i;return i={discardedState:e,backState:n,forwardState:t},o.discardedStates[r]=i,!0},o.discardHash=function(e,t,n){var r={discardedHash:e,backState:n,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t=o.getHashByState(e),n;return n=o.discardedStates[t]||!1,n},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var t="",r,i,u,a;return o.isInternetExplorer()?(r="historyjs-iframe",i=n.createElement("iframe"),i.setAttribute("id",r),i.style.display="none",n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),u="",a=!1,o.checkerFunction=function(){if(a)return!1;a=!0;var n=o.getHash()||"",r=o.unescapeHash(i.contentWindow.document.location.hash)||"";return n!==t?(t=n,r!==n&&(u=r=n,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(n)),o.Adapter.trigger(e,"hashchange")):r!==u&&(u=r,o.setHash(r,!1)),a=!1,!0}):o.checkerFunction=function(){var n=o.getHash();return n!==t&&(t=n,o.Adapter.trigger(e,"hashchange")),!0},o.intervalList.push(s(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var r=t&&t.newURL||n.location.href,i=o.getHashByUrl(r),s=null,u=null,a=null,f;return o.isLastHash(i)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(i),i&&o.isTraditionalAnchor(i)?(o.Adapter.trigger(e,"anchorchange"),o.busy(!1),!1):(s=o.extractState(o.getFullUrl(i||n.location.href,!1),!0),o.isLastSavedState(s)?(o.busy(!1),!1):(u=o.getHashByState(s),f=o.discardedState(s),f?(o.getHashByIndex(-2)===o.getHashByState(f.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(s.data,s.title,s.url,!1),!0))))},o.Adapter.bind(e,"hashchange",o.onHashChange),o.pushState=function(t,r,i,s){if(o.getHashByUrl(i))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(s!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:s}),!1;o.busy(!0);var u=o.createStateObject(t,r,i),a=o.getHashByState(u),f=o.getState(!1),l=o.getHashByState(f),c=o.getHash();return o.storeState(u),o.expectedStateId=u.id,o.recycleState(u),o.setTitle(u),a===l?(o.busy(!1),!1):a!==c&&a!==o.getShortUrl(n.location.href)?(o.setHash(a,!1),!1):(o.saveState(u),o.Adapter.trigger(e,"statechange"),o.busy(!1),!0)},o.replaceState=function(e,t,n,r){if(o.getHashByUrl(n))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(r!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:r}),!1;o.busy(!0);var i=o.createStateObject(e,t,n),s=o.getState(!1),u=o.getStateByIndex(-2);return o.discardState(s,i,u),o.pushState(i.data,i.title,i.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,"hashchange")})},typeof o.init!="undefined"&&o.init()}(window),function(e,t){var n=e.console||t,r=e.document,i=e.navigator,s=e.sessionStorage||!1,o=e.setTimeout,u=e.clearTimeout,a=e.setInterval,f=e.clearInterval,l=e.JSON,c=e.alert,h=e.History=e.History||{},p=e.history;l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode;if(typeof h.init!="undefined")throw new Error("History.js Core has already been loaded...");h.init=function(){return typeof h.Adapter=="undefined"?!1:(typeof h.initCore!="undefined"&&h.initCore(),typeof h.initHtml4!="undefined"&&h.initHtml4(),!0)},h.initCore=function(){if(typeof h.initCore.initialized!="undefined")return!1;h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||r.title,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(typeof t!="undefined"&&t!==null){for(e=0;e<t.length;e++)f(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e=typeof n!="undefined"&&typeof n.log!="undefined"&&typeof n.log.apply!="undefined",t=r.getElementById("log"),i,s,o,u,a;e?(u=Array.prototype.slice.call(arguments),i=u.shift(),typeof n.debug!="undefined"?n.debug.apply(n,[i,u]):n.log.apply(n,[i,u])):i="\n"+arguments[0]+"\n";for(s=1,o=arguments.length;s<o;++s){a=arguments[s];if(typeof a=="object"&&typeof l!="undefined")try{a=l.stringify(a)}catch(f){}i+="\n"+a+"\n"}return t?(t.value+=i+"\n-----\n",t.scrollTop=t.scrollHeight-t.clientHeight):e||c(i),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached=typeof h.getInternetExplorerMajorVersion.cached!="undefined"?h.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement("div"),n=t.getElementsByTagName("i");while((t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n[0]);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached=typeof h.isInternetExplorer.cached!="undefined"?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=l.stringify(e),n=l.parse(t)):n={},n},h.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);if(r.location.port||!1)e+=":"+r.location.port;return e+="/",e},h.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,n="";return e.length===1&&(t=e[0],n=t.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e=h.getState(!1,!1),t=(e||{}).url||r.location.href,n;return n=t.replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+"/"}),n},h.getBasePageUrl=function(){var e=r.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},h.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t=typeof t=="undefined"?!0:t,/[a-z]+\:\/\//.test(e)||(r==="/"?n=h.getRootUrl()+e.replace(/^\/+/,""):r==="#"?n=h.getPageUrl().replace(/#.*/,"")+e:r==="?"?n=h.getPageUrl().replace(/[\?#].*/,"")+e:t?n=h.getBaseUrl()+e.replace(/^(\.\/)+/,""):n=h.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),r=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,"")),t=t.replace(r,"/"),h.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),t},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){typeof e=="undefined"&&(e=!0),typeof t=="undefined"&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t=h.extractId(e.url),n;if(!t){n=h.getStateString(e);if(typeof h.stateToId[n]!="undefined")t=h.stateToId[n];else if(typeof h.store.stateToId[n]!="undefined")t=h.store.stateToId[n];else{for(;;){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof h.idToState[t]=="undefined"&&typeof h.store.idToState[t]=="undefined")break}h.stateToId[n]=t,h.idToState[t]=e}}return t},h.normalizeState=function(e){var t,n;if(!e||typeof e!="object")e={};if(typeof e.normalized!="undefined")return e;if(!e.data||typeof e.data!="object")e.data={};t={},t.normalized=!0,t.title=e.title||"",t.url=h.getFullUrl(h.unescapeString(e.url||r.location.href)),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data);if(t.title||n)t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id;return t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t},h.createStateObject=function(e,t,n){var r={data:e,title:t,url:n};return r=h.normalizeState(r),r},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,r;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},r=l.stringify(n),r},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id,n},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash,n},h.extractId=function(e){var t,n,r;return n=/(.*)\&_suid=([0-9]+)$/.exec(e),r=n?n[1]||e:e,t=n?String(n[2]||""):"",t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n=null,r,i;return t=t||!1,r=h.extractId(e),r&&(n=h.getStateById(r)),n||(i=h.getFullUrl(e),r=h.getIdByUrl(i)||!1,r&&(n=h.getStateById(r)),!n&&t&&!h.isTraditionalAnchor(e)&&(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t=!1,n;return n=h.extractState(e.url),t=n&&n.id!==e.id,t},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1,n,r,i;return h.savedStates.length&&(n=e.id,r=h.getLastSavedState(),i=r.id,t=n===i),t},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return typeof e=="undefined"?t=h.savedStates[h.savedStates.length-1]:e<0?t=h.savedStates[h.savedStates.length+e]:t=h.savedStates[e],t},h.getHash=function(){var e=h.unescapeHash(r.location.hash);return e},h.unescapeString=function(t){var n=t,r;for(;;){r=e.unescape(n);if(r===n)break;n=r}return n},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=h.unescapeString(t),t},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},h.setHash=function(e,t){var n,i,s;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(n=h.escapeHash(e),h.busy(!0),i=h.extractState(e,!0),i&&!h.emulated.pushState?h.pushState(i.data,i.title,i.url,!1):r.location.hash!==n&&(h.bugs.setHash?(s=h.getPageUrl(),h.pushState(null,null,s+"#"+n,!1)):r.location.hash=n),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.escape(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=h.unescapeHash(t),t},h.setTitle=function(e){var t=e.title,n;t||(n=h.getStateByIndex(0),n&&n.url===e.url&&(t=n.title||h.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=t.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(i){}return r.title=t,h},h.queues=[],h.busy=function(e){typeof e!="undefined"?h.busy.flag=e:typeof h.busy.flag=="undefined"&&(h.busy.flag=!1);if(!h.busy.flag){u(h.busy.timeout);var t=function(){var e,n,r;if(h.busy.flag)return;for(e=h.queues.length-1;e>=0;--e){n=h.queues[e];if(n.length===0)continue;r=n.shift(),h.fireQueueItem(r),h.busy.timeout=o(t,h.options.busyDelay)}};h.busy.timeout=o(t,h.options.busyDelay)}return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return typeof e=="function"&&(e={callback:e}),typeof t!="undefined"&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(u(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=o(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t=h.extractState(r.location.href),n;if(!h.isLastSavedState(t))return n=t,n||(n=h.createStateObject()),h.Adapter.trigger(e,"popstate"),h;return},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;n<=e;++n)h.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=e;--n)h.back(t)}return h};if(h.emulated.pushState){var d=function(){};h.pushState=h.pushState||d,h.replaceState=h.replaceState||d}else h.onPopState=function(t,n){var i=!1,s=!1,o,u;return h.doubleCheckComplete(),o=h.getHash(),o?(u=h.extractState(o||r.location.href,!0),u?h.replaceState(u.data,u.title,u.url,!1):(h.Adapter.trigger(e,"anchorchange"),h.busy(!1)),h.expectedStateId=!1,!1):(i=h.Adapter.extractEventData("state",t,n)||!1,i?s=h.getStateById(i):h.expectedStateId?s=h.getStateById(h.expectedStateId):s=h.extractState(r.location.href),s||(s=h.createStateObject(null,null,r.location.href)),h.expectedStateId=!1,h.isLastSavedState(s)?(h.busy(!1),!1):(h.storeState(s),h.saveState(s),h.setTitle(s),h.Adapter.trigger(e,"statechange"),h.busy(!1),!0))},h.Adapter.bind(e,"popstate",h.onPopState),h.pushState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.pushState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0},h.replaceState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.replaceState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0};if(s){try{h.store=l.parse(s.getItem("History.store"))||{}}catch(v){h.store={}}h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,"beforeunload",h.clearAllIntervals),h.Adapter.bind(e,"unload",h.clearAllIntervals),h.saveState(h.storeState(h.extractState(r.location.href,!0))),s&&(h.onUnload=function(){var e,t;try{e=l.parse(s.getItem("History.store"))||{}}catch(n){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState){if(!h.idToState.hasOwnProperty(t))continue;e.idToState[t]=h.idToState[t]}for(t in h.urlToId){if(!h.urlToId.hasOwnProperty(t))continue;e.urlToId[t]=h.urlToId[t]}for(t in h.stateToId){if(!h.stateToId.hasOwnProperty(t))continue;e.stateToId[t]=h.stateToId[t]}h.store=e,h.normalizeStore(),s.setItem("History.store",l.stringify(e))},h.intervalList.push(a(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,"beforeunload",h.onUnload),h.Adapter.bind(e,"unload",h.onUnload));if(!h.emulated.pushState){h.bugs.safariPoll&&h.intervalList.push(a(h.safariStatePoll,h.options.safariPollInterval));if(i.vendor==="Apple Computer, Inc."||(i.appCodeName||"")==="Mozilla")h.Adapter.bind(e,"hashchange",function(){h.Adapter.trigger(e,"popstate")}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,"hashchange")})}},h.init()}(window)}catch(t){}}),timely.define("external_libs/jquery.tablescroller",["jquery_timely"],function(e){function n(){if(t)return t;var n=e('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>');e("body").append(n);var r=e("div",n).innerWidth();n.css("overflow-y","auto");var i=e("div",n).innerWidth();return e(n).remove(),t=r-i,t}var t=0;e.fn.tableScroll=function(t){if(t=="undo"){var r=e(this).parent().parent();r.hasClass("tablescroll_wrapper")&&(r.find(".tablescroll_head thead").prependTo(this),r.find(".tablescroll_foot tfoot").appendTo(this),r.before(this),r.empty());return}var i=e.extend({},e.fn.tableScroll.defaults,t);return i.scrollbarWidth=n(),this.each(function(){var t=i.flush,n=e(this).addClass("tablescroll_body"),r=e('<div class="tablescroll_wrapper ai1ec-popover-boundary"></div>').insertBefore(n).append(n);r.parent("div").hasClass(i.containerClass)||e("<div></div>").addClass(i.containerClass).insertBefore(r).append(r);var s=i.width?i.width:n.outerWidth(),o=i.scroll?"auto":"hidden";r.css({width:s+"px",height:i.height+"px",overflow:o}),n.css("width",s+"px");var u=r.outerWidth(),a=u-s;r.css({width:s-a-2+"px"}),n.css("width",s-a-i.scrollbarWidth+"px"),n.outerHeight()<=i.height&&(r.css({height:"auto",width:s-a+"px"}),t=!1);var f=e("thead",n).length?!0:!1,l=e("tfoot",n).length?!0:!1,c=e("thead tr:first",n),h=e("tbody tr:first",n),p=e("tfoot tr:first",n),d=0;e("th, td",c).each(function(t){d=e(this).width(),e("th:eq("+t+"), td:eq("+t+")",c).css("width",d+"px"),e("th:eq("+t+"), td:eq("+t+")",h).css("width",d+"px"),l&&e("th:eq("+t+"), td:eq("+t+")",p).css("width",d+"px")});if(f)var v=e('<table class="tablescroll_head" cellspacing="0"></table>').insertBefore(r).prepend(e("thead",n));if(l)var m=e('<table class="tablescroll_foot" cellspacing="0"></table>').insertAfter(r).prepend(e("tfoot",n));v!=undefined&&(v.css("width",s+"px"),t&&(e("tr:first th:last, tr:first td:last",v).css("width",d+i.scrollbarWidth+"px"),v.css("width",r.outerWidth()+"px"))),m!=undefined&&(m.css("width",s+"px"),t&&(e("tr:first th:last, tr:first td:last",m).css("width",d+i.scrollbarWidth+"px"),m.css("width",r.outerWidth()+"px")))}),this},e.fn.tableScroll.defaults={flush:!0,width:null,height:100,containerClass:"tablescroll",scroll:!0}}),timely.define("external_libs/jquery.scrollTo",["jquery_timely"],function(e){function n(e){return typeof e=="object"?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,r){e(window).scrollTo(t,n,r)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})},e.fn.scrollTo=function(r,i,s){return typeof i=="object"&&(s=i,i=0),typeof s=="function"&&(s={onAfter:s}),r=="max"&&(r=9e9),s=e.extend({},t.defaults,s),i=i||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(i/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function h(e){u.animate(l,i,s.easing,e&&function(){e.call(this,r,s)})}if(r==null)return;var o=this,u=e(o),a=r,f,l={},c=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)f=(a=e(a)).offset()}e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),p="scroll"+r,d=o[p],v=t.max(o,n);if(f)l[p]=f[i]+(c?0:d-u.offset()[i]),s.margin&&(l[p]-=parseInt(a.css("margin"+r))||0,l[p]-=parseInt(a.css("border"+r+"Width"))||0),l[p]+=s.offset[i]||0,s.over[i]&&(l[p]+=a[n=="x"?"width":"height"]()*s.over[i]);else{var m=a[i];l[p]=m.slice&&m.slice(-1)=="%"?parseFloat(m)/100*v:m}s.limit&&/^\d+$/.test(l[p])&&(l[p]=l[p]<=0?0:Math.min(l[p],v)),!e&&s.queue&&(d!=l[p]&&h(s.onAfterFirst),delete l[p])}),h(s.onAfter)}).end()},t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])}}),timely.define("external_libs/locales/bootstrap-datepicker.bg",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.bg={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.br",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.br={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.cs",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.cs={days:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota","Nedle"],daysShort:["Ned","Pon","te","St","tv","Pt","Sob","Ned"],daysMin:["Ne","Po","t","St","t","P","So","Ne"],months:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],monthsShort:["Led","no","Be","Dub","Kv","er","nc","Srp","Z","j","Lis","Pro"],today:"Dnes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.da",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.da={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",clear:"Nulstil"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.de",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Lschen",weekStart:1,format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.es",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado","Domingo"],daysShort:["Dom","Lun","Mar","Mi","Jue","Vie","Sb","Dom"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fi",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fi={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai","sunnuntai"],daysShort:["sun","maa","tii","kes","tor","per","lau","sun"],daysMin:["su","ma","ti","ke","to","pe","la","su"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tnn",weekStart:1,format:"d.m.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],daysMin:["D","L","Ma","Me","J","V","S","D"],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],monthsShort:["Jan","Fv","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Dc"],today:"Aujourd'hui",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.id",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.id={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab","Mgu"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa","Mg"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.is",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.is={days:["Sunnudagur","Mnudagur","rijudagur","Mivikudagur","Fimmtudagur","Fstudagur","Laugardagur","Sunnudagur"],daysShort:["Sun","Mn","ri","Mi","Fim","Fs","Lau","Sun"],daysMin:["Su","M","r","Mi","Fi","F","La","Su"],months:["Janar","Febrar","Mars","Aprl","Ma","Jn","Jl","gst","September","Oktber","Nvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Ma","Jn","Jl","g","Sep","Okt","Nv","Des"],today:" Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.it",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.it={days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato","Domenica"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab","Dom"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa","Do"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ja",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ja={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],today:"",format:"yyyy/mm/dd"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.kr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.kr={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lt={days:["Sekmadienis","Pirmadienis","Antradienis","Treiadienis","Ketvirtadienis","Penktadienis","etadienis","Sekmadienis"],daysShort:["S","Pr","A","T","K","Pn","","S"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","t","Sk"],months:["Sausis","Vasaris","Kovas","Balandis","Gegu","Birelis","Liepa","Rugpjtis","Rugsjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"iandien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lv={days:["Svtdiena","Pirmdiena","Otrdiena","Trediena","Ceturtdiena","Piektdiena","Sestdiena","Svtdiena"],daysShort:["Sv","P","O","T","C","Pk","S","Sv"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se","Sv"],months:["Janvris","Februris","Marts","Aprlis","Maijs","Jnijs","Jlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],today:"odien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ms",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ms={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu","Ahad"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab","Aha"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa","Ah"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nb",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nb={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nl={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pl={days:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota","Niedziela"],daysShort:["Nie","Pn","Wt","r","Czw","Pt","So","Nie"],daysMin:["N","Pn","Wt","r","Cz","Pt","So","N"],months:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],monthsShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],today:"Dzisiaj",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt-BR",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["pt-BR"]={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pt={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ru",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ru={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sl={days:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota","Nedelja"],daysShort:["Ned","Pon","Tor","Sre","et","Pet","Sob","Ned"],daysMin:["Ne","Po","To","Sr","e","Pe","So","Ne"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sv={days:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Mn","Tis","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","M","Ti","On","To","Fr","L","S"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",format:"yyyy-mm-dd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.th",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.th={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["..","..","..","..","..","..","..","..","..","..","..",".."],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.tr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.tr={days:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],daysShort:["Pz","Pzt","Sal","r","Pr","Cu","Cts","Pz"],daysMin:["Pz","Pzt","Sa","r","Pr","Cu","Ct","Pz"],months:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],monthsShort:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],today:"Bugn",format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-CN",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-CN"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-TW",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-TW"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/bootstrap_datepicker",["jquery_timely","ai1ec_config","external_libs/locales/bootstrap-datepicker.bg","external_libs/locales/bootstrap-datepicker.br","external_libs/locales/bootstrap-datepicker.cs","external_libs/locales/bootstrap-datepicker.da","external_libs/locales/bootstrap-datepicker.de","external_libs/locales/bootstrap-datepicker.es","external_libs/locales/bootstrap-datepicker.fi","external_libs/locales/bootstrap-datepicker.fr","external_libs/locales/bootstrap-datepicker.id","external_libs/locales/bootstrap-datepicker.is","external_libs/locales/bootstrap-datepicker.it","external_libs/locales/bootstrap-datepicker.ja","external_libs/locales/bootstrap-datepicker.kr","external_libs/locales/bootstrap-datepicker.lt","external_libs/locales/bootstrap-datepicker.lv","external_libs/locales/bootstrap-datepicker.ms","external_libs/locales/bootstrap-datepicker.nb","external_libs/locales/bootstrap-datepicker.nl","external_libs/locales/bootstrap-datepicker.pl","external_libs/locales/bootstrap-datepicker.pt-BR","external_libs/locales/bootstrap-datepicker.pt","external_libs/locales/bootstrap-datepicker.ru","external_libs/locales/bootstrap-datepicker.sl","external_libs/locales/bootstrap-datepicker.sv","external_libs/locales/bootstrap-datepicker.th","external_libs/locales/bootstrap-datepicker.tr","external_libs/locales/bootstrap-datepicker.zh-CN","external_libs/locales/bootstrap-datepicker.zh-TW"],function(e,t){function r(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return r(e.getFullYear(),e.getMonth(),e.getDate())}function s(e){return function(){return this[e].apply(this,arguments)}}function f(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r)n.test(u)&&(s=u.replace(o,function(e,t){return t.toLowerCase()}),i[s]=r[u]);return i}function l(t){var n={};if(!d[t]){t=t.split("-")[0];if(!d[t])return}var r=d[t];return e.each(p,function(e,t){t in r&&(n[t]=r[t])}),n}var n=e(window),o=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){var t=e&&e.valueOf();for(var n=0,r=this.length;n<r;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){if(!t)return;e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t)},clear:function(){this.splice(0)},copy:function(){var e=new o;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),u=function(t,n){this.dates=new o,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".ai1ec-date")?this.element.find(".ai1ec-input-group, .ai1ec-input-group-addon, .ai1ec-btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(v.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("ai1ec-datepicker-inline").appendTo(this.element):this.picker.addClass("ai1ec-datepicker-dropdown ai1ec-dropdown-menu"),this.o.rtl&&this.picker.addClass("ai1ec-datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.ai1ec-today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};u.prototype={constructor:u,_process_options:function(n){this._o=e.extend({},this._o,n);var r=this.o=e.extend({},this._o),i=r.language;d[i]||(i=i.split("-")[0],d[i]||(i=t.language,d[i]||(i=h.language))),r.language=i;switch(r.startView){case 2:case"decade":r.startView=2;break;case 1:case"year":r.startView=1;break;default:r.startView=0}switch(r.minViewMode){case 1:case"months":r.minViewMode=1;break;case 2:case"years":r.minViewMode=2;break;default:r.minViewMode=0}r.startView=Math.max(r.startView,r.minViewMode),r.multidate!==!0&&(r.multidate=Number(r.multidate)||!1,r.multidate!==!1?r.multidate=Math.max(0,r.multidate):r.multidate=1),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7;var s=v.parseFormat(r.format);r.startDate!==-Infinity&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=v.parseDate(r.startDate,s,r.language):r.startDate=-Infinity),r.endDate!==Infinity&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=v.parseDate(r.endDate,s,r.language):r.endDate=Infinity),r.daysOfWeekDisabled=r.daysOfWeekDisabled||[],e.isArray(r.daysOfWeekDisabled)||(r.daysOfWeekDisabled=r.daysOfWeekDisabled.split(/[,\s]*/)),r.daysOfWeekDisabled=e.map(r.daysOfWeekDisabled,function(e){return parseInt(e,10)});var o=String(r.orientation).toLowerCase().split(/\s+/g),u=r.orientation.toLowerCase();o=e.grep(o,function(e){return/^auto|left|right|top|bottom$/.test(e)}),r.orientation={x:"auto",y:"auto"};if(!!u&&u!=="auto")if(o.length===1)switch(o[0]){case"top":case"bottom":r.orientation.y=o[0];break;case"left":case"right":r.orientation.x=o[0]}else u=e.grep(o,function(e){return/^left|right$/.test(e)}),r.orientation.x=u[0]||"auto",u=e.grep(o,function(e){return/^top|bottom$/.test(e)}),r.orientation.y=u[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(r=undefined,i=e[t][1]):e[t].length==3&&(r=e[t][1],i=e[t][2]),n.on(i,r)},_unapplyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(i=undefined,r=e[t][1]):e[t].length==3&&(i=e[t][1],r=e[t][2]),n.off(r,i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.dates.get(-1),i=this._utc_to_local(r);this.element.trigger({type:t,date:i,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){arguments.length===0?(e=this.dates.length-1,t=this.o.format):typeof e=="string"&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return v.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide")},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+e.getTimezoneOffset()*6e4)},_local_to_utc:function(e){return e&&new Date(e.getTime()-e.getTimezoneOffset()*6e4)},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){this.update.apply(this,arguments),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){this.update.apply(this,e.map(arguments,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(t){t===undefined&&(t=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return v.formatDate(e,t,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=this.picker.outerWidth(),r=this.picker.outerHeight(),i=10,s=n.width(),o=n.height(),u=n.scrollTop(),a=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,f=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=f.left,p=f.top;this.picker.removeClass("ai1ec-datepicker-orient-top ai1ec-datepicker-orient-bottom ai1ec-datepicker-orient-right ai1ec-datepicker-orient-left"),this.o.orientation.x!=="auto"?(this.picker.addClass("ai1ec-datepicker-orient-"+this.o.orientation.x),this.o.orientation.x==="right"&&(h-=t-c)):(this.picker.addClass("ai1ec-datepicker-orient-left"),f.left<0?h-=f.left-i:f.left+t>s&&(h=s-t-i));var d=this.o.orientation.y,v,m;d==="auto"&&(v=-u+f.top-r,m=u+o-(f.top+l+r),Math.max(v,m)===m?d="top":d="bottom"),this.picker.addClass("ai1ec-datepicker-orient-"+d),d==="top"?p+=l:p-=r+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:h,zIndex:a})},_allow_update:!0,update:function(){if(!this._allow_update)return;var t=this.dates.copy(),n=[],r=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),r=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n&&this.o.multidate?n=n.split(this.o.multidateSeparator):n=[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return v.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),r?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="ai1ec-cw">&nbsp;</th>';t+=n,this.picker.find(".ai1ec-datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7)t+='<th class="ai1ec-dow">'+d[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".ai1ec-datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="ai1ec-month">'+d[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".ai1ec-datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i?n.push("ai1ec-old"):(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i)&&n.push("ai1ec-new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("ai1ec-focused"),this.o.todayHighlight&&t.getUTCFullYear()==s.getFullYear()&&t.getUTCMonth()==s.getMonth()&&t.getUTCDate()==s.getDate()&&n.push("ai1ec-today"),this.dates.contains(t)!==-1&&n.push("ai1ec-active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("ai1ec-disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("ai1ec-range"),e.inArray(t.valueOf(),this.range)!=-1&&n.push("ai1ec-selected")),n},fill:function(){var t=new Date(this.viewDate),n=t.getUTCFullYear(),i=t.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f,l;this.picker.find(".ai1ec-datepicker-days thead th.ai1ec-datepicker-switch").text(d[this.o.language].months[i]+" "+n),this.picker.find("tfoot th.ai1ec-today").text(d[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.ai1ec-clear").text(d[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var c=r(n,i-1,28),h=v.getDaysInMonth(c.getUTCFullYear(),c.getUTCMonth());c.setUTCDate(h),c.setUTCDate(h-(c.getUTCDay()-this.o.weekStart+7)%7);var p=new Date(c);p.setUTCDate(p.getUTCDate()+42),p=p.valueOf();var m=[],g;while(c.valueOf()<p){if(c.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+c+(this.o.weekStart-c.getUTCDay()-7)%7*864e5),b=new Date(+y+(11-y.getUTCDay())%7*864e5),w=new Date(+(w=r(b.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="ai1ec-cw">'+E+"</td>")}}g=this.getClassNames(c),g.push("ai1ec-day");if(this.o.beforeShowDay!==e.noop){var S=this.o.beforeShowDay(this._utc_to_local(c));S===undefined?S={}:typeof S=="boolean"?S={enabled:S}:typeof S=="string"&&(S={classes:S}),S.enabled===!1&&g.push("ai1ec-disabled"),S.classes&&(g=g.concat(S.classes.split(/\s+/))),S.tooltip&&(f=S.tooltip)}g=e.unique(g),m.push('<td class="'+g.join(" ")+'"'+(f?' title="'+f+'"':"")+">"+c.getUTCDate()+"</td>"),c.getUTCDay()==this.o.weekEnd&&m.push("</tr>"),c.setUTCDate(c.getUTCDate()+1)}this.picker.find(".ai1ec-datepicker-days tbody").empty().append(m.join(""));var x=this.picker.find(".ai1ec-datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("ai1ec-active");e.each(this.dates,function(e,t){t.getUTCFullYear()==n&&x.eq(t.getUTCMonth()).addClass("ai1ec-active")}),(n<s||n>u)&&x.addClass("ai1ec-disabled"),n==s&&x.slice(0,o).addClass("ai1ec-disabled"),n==u&&x.slice(a+1).addClass("ai1ec-disabled"),m="",n=parseInt(n/10,10)*10;var T=this.picker.find(".ai1ec-datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;var N=e.map(this.dates,function(e){return e.getUTCFullYear()}),C;for(var k=-1;k<11;k++)C=["ai1ec-year"],k===-1?C.push("ai1ec-old"):k===10&&C.push("ai1ec-new"),e.inArray(n,N)!==-1&&C.push("ai1ec-active"),(n<s||n>u)&&C.push("ai1ec-disabled"),m+='<span class="'+C.join(" ")+'">'+n+"</span>",n+=1;T.html(m)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"})}},click:function(t){t.preventDefault();var n=e(t.target).closest("span, td, th"),i,s,o;if(n.length==1)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"ai1ec-datepicker-switch":this.showMode(1);break;case"ai1ec-prev":case"ai1ec-next":var u=v.modes[this.viewMode].navStep*(n[0].className=="ai1ec-prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,u),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,u),this.viewMode===1&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"ai1ec-today":var a=new Date;a=r(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var f=this.o.todayBtn=="linked"?null:"view";this._setDate(a,f);break;case"ai1ec-clear":var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input")),l&&l.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":n.is(".ai1ec-disabled")||(this.viewDate.setUTCDate(1),n.is(".ai1ec-month")?(o=1,s=n.parent().find("span").index(n),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1&&this._setDate(r(i,s,o))):(o=1,s=0,i=parseInt(n.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(r(i,s,o))),this.showMode(-1),this.fill());break;case"td":n.is(".ai1ec-day")&&!n.is(".ai1ec-disabled")&&(o=parseInt(n.text(),10)||1,i=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),n.is(".ai1ec-old")?s===0?(s=11,i-=1):s-=1:n.is(".ai1ec-new")&&(s==11?(s=0,i+=1):s+=1),this._setDate(r(i,s,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);e?t!==-1?this.dates.remove(t):this.dates.push(e):this.dates.clear();if(typeof this.o.multidate=="number")while(this.dates.length>this.o.multidate)this.dates.remove(0)},_setDate:function(e,t){(!t||t=="date")&&this._toggle_multidate(e&&new Date(e));if(!t||t=="view")this.viewDate=e&&new Date(e);this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),this.o.autoclose&&(!t||t=="date")&&this.hide()},moveMonth:function(e,t){if(!e)return undefined;if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,s,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n),s=new Date(o),s.setUTCDate(o.getUTCDate()+n)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n*7),s=new Date(o),s.setUTCDate(o.getUTCDate()+n*7)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:o=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(o),t=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(t){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".ai1ec-datepicker-"+v.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var a=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};a.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(this.updating)return;this.updating=!0;var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1)return;e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(r)});if(r<this.dates[i])while(i>=0&&r<this.dates[i])this.pickers[i--].setUTCDate(r);else if(r>this.dates[i])while(i<s&&r>this.dates[i])this.pickers[i++].setUTCDate(r);this.updateDates(),delete this.updating},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var c=e.fn.datepicker;e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof t=="object"&&t;if(!s){var c=f(this,"date"),p=e.extend({},h,c,o),d=l(p.language),v=e.extend({},h,d,c,o);if(i.is(".ai1ec-input-daterange")||v.inputs){var m={inputs:v.inputs||i.find("input").toArray()};i.data("datepicker",s=new a(this,e.extend(v,m)))}else i.data("datepicker",s=new u(this,v))}if(typeof t=="string"&&typeof s[t]=="function"){r=s[t].apply(s,n);if(r!==undefined)return!1}}),r!==undefined?r:this};var h=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=u;var d=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},v={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,v.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(t,n,i){if(!t)return undefined;if(t instanceof Date)return t;typeof n=="string"&&(n=v.parseFormat(n));if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){var s=/([\-+]\d+)([dmwy])/,o=t.match(/([\-+]\d+)([dmwy])/g),a,f;t=new Date;for(var l=0;l<o.length;l++){a=s.exec(o[l]),f=parseInt(a[1]);switch(a[2]){case"d":t.setUTCDate(t.getUTCDate()+f);break;case"m":t=u.prototype.moveMonth.call(u.prototype,t,f);break;case"w":t.setUTCDate(t.getUTCDate()+f*7);break;case"y":t=u.prototype.moveYear.call(u.prototype,t,f)}}return r(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}var o=t&&t.match(this.nonpunctuation)||[],t=new Date,c={},h=["yyyy","yy","M","MM","m","mm","d","dd"],p={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;p.M=p.MM=p.mm=p.m,p.dd=p.d,t=r(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var y=n.parts.slice();o.length!=y.length&&(y=e(y).filter(function(t,n){return e.inArray(n,h)!==-1}).toArray());if(o.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(o[l],10),a=y[l];if(isNaN(m))switch(a){case"MM":g=e(d[i].months).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].months)+1;break;case"M":g=e(d[i].monthsShort).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].monthsShort)+1}c[a]=m}for(var l=0,w,E;l<h.length;l++)E=h[l],E in c&&!isNaN(c[E])&&(w=new Date(t),p[E](w,c[E]),isNaN(w)||(t=w))}return t},formatDate:function(t,n,r){if(!t)return"";typeof n=="string"&&(n=v.parseFormat(n));var i={d:t.getUTCDate(),D:d[r].daysShort[t.getUTCDay()],DD:d[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:d[r].monthsShort[t.getUTCMonth()],MM:d[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="ai1ec-prev"><i class="ai1ec-fa ai1ec-fa-arrow-left"></i></th><th colspan="5" class="ai1ec-datepicker-switch"></th><th class="ai1ec-next"><i class="ai1ec-fa ai1ec-fa-arrow-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="ai1ec-today"></th></tr><tr><th colspan="7" class="ai1ec-clear"></th></tr></tfoot>'};v.template='<div class="timely ai1ec-datepicker"><div class="ai1ec-datepicker-days"><table class=" ai1ec-table-condensed">'+v.headTemplate+"<tbody></tbody>"+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-months">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-years">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=v,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=c,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),n.datepicker("show")}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()});for(var m=2,g=arguments.length;m<g;m++)arguments[m].localize()}),timely.define("external_libs/bootstrap/alert",["jquery_timely"],function(e){var t='[data-dismiss="ai1ec-alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed.bs.alert").remove()}var n=e(this),r=n.attr("data-target");r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var i=e(r);t&&t.preventDefault(),i.length||(i=n.hasClass("ai1ec-alert")?n:n.parent()),i.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;i.removeClass("ai1ec-in"),e.support.transition&&i.hasClass("ai1ec-fade")?i.one(e.support.transition.end,s).emulateTransitionEnd(150):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}),timely.define("external_libs/jquery_cookie",["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),timely.define("scripts/calendar/load_views",["jquery_timely","scripts/calendar/print","scripts/calendar/agenda_view","scripts/calendar/month_view","libs/frontend_utils","libs/utils","ai1ec_calendar","ai1ec_config","scripts/common_scripts/frontend/common_frontend","libs/select2_multiselect_helper","external_libs/twig","agenda","oneday","month","external_libs/jquery_history","external_libs/jquery.tablescroller","external_libs/jquery.scrollTo","external_libs/bootstrap_datepicker","external_libs/bootstrap/alert","external_libs/jquery_cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){e.cookie.json=!0;var d="ai1ec_saved_filter",v=!e("#save_filtered_views").hasClass("ai1ec-hide");timely.renderer_map||(timely.renderer_map={}),e.extend(timely.renderer_map,{agenda:c,oneday:h,week:h,month:p});var m=function(t){var n=t.find("#ai1ec-view-dropdown .ai1ec-dropdown-menu .ai1ec-active a"),i=u.week_view_ends_at-u.week_view_starts_at,s=i*60;t.find("table.ai1ec-week-view-original").tableScroll({height:s,containerClass:"ai1ec-week-view ai1ec-popover-boundary",scroll:!1}),t.find("table.ai1ec-oneday-view-original").tableScroll({height:s,containerClass:"ai1ec-oneday-view ai1ec-popover-boundary",scroll:!1});if(t.find(".ai1ec-week-view").length||t.find(".ai1ec-oneday-view").length)t.find(".ai1ec-oneday-view .tablescroll_wrapper, .ai1ec-week-view .tablescroll_wrapper").scrollTo(t.find(".ai1ec-hour-marker:eq("+u.week_view_starts_at+")")),t.find(".ai1ec-hour-marker:eq("+u.week_view_starts_at+")").addClass("ai1ec-first-visible");t.find(".ai1ec-month-view .ai1ec-multiday").length&&r.extend_multiday_events(t),t.find(".ai1ec-calendar-view-container").data("ai1ec-inited",!0).trigger("initialize_view.ai1ec"),t.find(".ai1ec-calendar-toolbar").trigger("ai1ec-affix.reinit"),e(".ai1ec-event[data-ticket-url], .ai1ec-has-tickets-button").each(function(){var t=e(this),n=t.data("ticket-url"),r=e.merge(e(".ai1ec-sas-action-tickets",t),e(".ai1ec-sas-action-tickets",t.parent("a").next(".ai1ec-popover"))).attr("href",n)})},g=function(t){t.find(".ai1ec-calendar-view-container").trigger("destroy_view.ai1ec");var n=t.find(".ai1ec-minical-trigger").data("datepicker");typeof n!="undefined"&&(n.picker.remove(),e(document).off("changeDate",".ai1ec-minical-trigger")),t.find(".ai1ec-tooltip.ai1ec-in, .ai1ec-popup").remove(),t.find(".ai1ec-calendar-toolbar .ai1ec-btn-toolbar").remove()},y=function(){var t=[],n=[],r=[],i;e(".ai1ec-category-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){t.push(e(this).data("term"))}),e(".ai1ec-tag-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){n.push(e(this).data("term"))}),e(".ai1ec-author-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){r.push(e(this).data("term"))});var s={};return s.cat_ids=t,s.tag_ids=n,s.auth_ids=r,i=e(".ai1ec-views-dropdown .ai1ec-dropdown-menu .ai1ec-active").data("action"),s.action=i,s},b=function(){var t=History.getState(),n=e.cookie(d);if(null===n||undefined===n)n={};var r=y();u.is_calendar_page?n.calendar_page=r:n[t.url]=r,e.cookie(d,n,{path:"/",expires:365}),e("#save_filtered_views").addClass("ai1ec-active").attr("data-original-title",u.clear_saved_filter_text);var i=s.make_alert(u.save_filter_text_ok,"success");e("#ai1ec-calendar").prepend(i)},w=function(t){t.stopImmediatePropagation();var n=e.cookie(d);if(u.is_calendar_page)delete n.calendar_page;else{var r=History.getState();delete n[r.url]}e.cookie(d,n,{path:"/",expires:365}),e("#save_filtered_views").removeClass("ai1ec-active").attr("data-original-title",u.reset_saved_filter_text),v||e("#save_filtered_views").addClass("ai1ec-hide");var i=s.make_alert(u.remove_filter_text_ok,"success");e("#ai1ec-calendar").prepend(i)},E=!1,S={},x=function(t,n,r){D(t,n),t.find(".ai1ec-calendar-view-loading").fadeIn("fast").end().find(".ai1ec-calendar-view").fadeTo("fast",.3,function(){var i={request_type:r,ai1ec_doing_ajax:!0};e("#ai1ec-container > .ai1ec-alert").remove(),E&&1===E.readyState&&E.abort("ai1ec_abort");var o="-"+i.request_type;S[n+o]?E=S[n+o]:(E=e.ajax({url:n,dataType:r,data:i,method:"GET"}),S[n+o]=E.promise()),E.done(function(i){e(document).trigger("calendar_view_loaded.ai1ec",t),g(t),typeof i.views_dropdown=="string"&&t.find(".ai1ec-views-dropdown").replaceWith(i.views_dropdown),typeof i.categories=="string"&&t.find(".ai1ec-category-filter").replaceWith(i.categories),typeof i.authors=="string"&&t.find(".ai1ec-author-filter").replaceWith(i.authors),typeof i.tags=="string"&&t.find(".ai1ec-tag-filter").replaceWith(i.tags);if(typeof i.custom_filters=="string"){var s=t.find("li.ai1ec-custom-filter").parent();t.find("li.ai1ec-custom-filter").remove(),s.append(i.custom_filters)}typeof i.subscribe_buttons=="string"&&t.find(".ai1ec-subscribe-container").empty().append(i.subscribe_buttons),typeof i.save_view_btngroup=="string"&&t.find("#save_filtered_views").closest(".ai1ec-btn-group").replaceWith(i.save_view_btngroup),v=i.are_filters_set;var o;if(i.is_json){var u=i.html.type;if(!timely.renderer_map[u]){x(t,n.replace(/\~json/,"~html"),r);return}o=timely.renderer_map[u]}t.find(".ai1ec-calendar-view").html(o?o.render(i.html):e(i.html).find(".ai1ec-calendar-view").length?e(i.html).find(".ai1ec-calendar-view").html():i.html),m(t);var a=t.offset().top-21;e(window).scrollTop()>a&&window.scrollTo(0,a)}),E.fail(function(n,r,i){if("ai1ec_abort"===r)return;var o=u.load_views_error;o=o.replace("%STATUS%",n.status),o=o.replace("%ERROR%",i),o=o+"<br/>"+s.make_popup_content_link(u.load_views_error_link_popup,u.load_views_error_popup_title,n.responseText);var a=s.make_alert(o,"error",!0);e("#ai1ec-container").prepend(a),g(t),m(t)}),E.always(function(){t.find(".ai1ec-calendar-view-loading").fadeOut("fast"),t.find(".ai1ec-calendar-view").fadeTo("fast",1)})})},T=!1,N=function(t){var n=History.getState(),r=e(".ai1ec-calendar:first");if(n.data.ai1ec!==undefined&&!0===n.data.ai1ec||!0===T)T=!0,x(r,n.url,"json")},C=function(e,t,n){if(t==="json"){var r={ai1ec:!0};null===n.match(/^http/)&&(n=location.protocol+n),History.pushState(r,document.title,decodeURI(n))}else x(e,n,"jsonp")},k=function(t){var n=e(this),r=n.closest(".ai1ec-calendar");t.preventDefault(),C(r,n.data("type"),n.attr("href"))},L=function(t){var n=e(this);t.preventDefault();if(typeof n.data("datepicker")=="undefined"){n.datepicker({todayBtn:"linked",todayHighlight:!0,language:n.data("lang")});var r=n.data("datepicker");if(n.closest(".ai1ec-pull-right").length>0){r.picker.addClass("ai1ec-right-aligned");var i=r.place;r.place=function(){i.call(this);var t=this.component?this.component:this.element,n=t.offset();this.picker.css({left:"auto",right:e(document).width()-n.left-t.outerWidth()})}}e(document).one("changeDate",".ai1ec-minical-trigger",A)}n.datepicker("show")},A=function(t){var n,r=e(this),i=r.closest(".ai1ec-calendar"),s;r.datepicker("hide"),n=r.data("href"),s=t.format(),s=s.replace(/\//g,"-"),n=n.replace("__DATE__",s),C(i,r.data("type"),n)},O=function(t){var n;typeof t.added!="undefined"?n=e(t.added.element).data("href"):n=e("option[value="+t.removed.id+"]",t.target).data("href");var r={ai1ec:!0};History.pushState(r,null,n)},M=function(){var t=e(this).closest(".ai1ec-calendar");return C(t,e(this).attr("data-type"),e(this).attr("data-href")),!1},_=u.ai1ec_permalinks_enabled?"/":"|",D=function(t,n){var r={},i=function(i,s){var o=e(".ai1ec-filters .ai1ec-load-view."+s.filter_class,t),u=e(s.filter_button,t),a=new RegExp(i+"~((,?[0-9]+)+)"),f=n.match(a),l=n.match(/action~(\w+)/),l=l&&l[1]?l[1]:null,f=f&&f[1]?e.map(f[1].split(","),function(e){return parseInt(e,10)}):[];r[i]=f.join(","),o.each(function(){var t=this.href,n=e(this).closest("[data-term]"),r=n.data("term"),s=e.extend(!0,[],f);-1<e.inArray(r,f)?(s=e.grep(s,function(e){return r!=e}),n.addClass("ai1ec-active")):(s.push(r),n.removeClass("ai1ec-active"));var o=s.length?i+"~"+s.join(","):"";t.match(a)?this.href=t.replace(a,o):s.length&&(this.href+=_+o),l&&(this.href=this.href.replace(/action~(\w+)/,"action~"+l)),this.href=P(this.href)}),e(s.filter_items,t).length?u.addClass("ai1ec-active"):u.removeClass("ai1ec-active"),e(".ai1ec-clear-filter",u).each(function(){e(this).attr("data-href",P(e(this).attr("data-href").replace(a,"").replace(/action~(\w+)/,"action~"+l)))})},s={};e("ul.ai1ec-filters > li",t).each(function(){var t=e(this),n=t.data("slug");s[n+"_ids"]={filter_class:"ai1ec-"+n,filter_button:"li.ai1ec-"+n+"-filter",filter_items:".ai1ec-"+n+"-filter .ai1ec-active"}});for(var o in s)i(o,s[o]);for(var o in r){var u=r[o],a=new RegExp(o+"~((,?[0-9]+)+)");e(".ai1ec-filters .ai1ec-load-view").each(function(){if(e(this).hasClass(s[o].filter_class))return;u?this.href.match(a)?this.href=this.href.replace(a,o+"~"+u):this.href=this.href+_+o+"~"+u:this.href=P(this.href.replace(a,""))}),e(".ai1ec-clear-filter",t).each(function(){var t=e(this),n=t.closest("[data-slug]").data("slug");n===o.substr(0,o.length-4)||!u?t.attr("data-href",P(t.attr("data-href").replace(a,""))):t.attr("data-href").match(a)?t.attr("data-href",P(t.attr("data-href").replace(a,o+"~"+u))):t.attr("data-href",P(t.attr("data-href")+_+o+"~"+u))})}},P=function(e){return"/"===_?e.replace(/\/\//g,"/").replace(/\/\//g,"/").replace(/:\//g,"://"):e.replace(/\|\|/g,"|").replace(/\|\|/g,"|")};return{initialize_view:m,handle_click_on_link_to_load_view:k,handle_minical_trigger:L,handle_minical_change_date:A,clear_filters:M,handle_state_change:N,load_view:x,save_current_filter:b,remove_current_filter:w,load_view_from_select2_filter:O,load_view_according_to_datatype:C}}),timely.define("scripts/calendar/calendar-affix",["jquery_timely","ai1ec_config"],function(e,t){var n=function(n){var r=n.find(".ai1ec-calendar-toolbar");r.length||(r=e("<div />",{"class":"timely ai1ec-calendar-toolbar ai1ec-empty-toolbar ai1ec-clearfix"}),n.prepend(r));var i=n.find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").css("clear","both"),s=r.find(".ai1ec-dropdown-toggle"),o=n.find("#ai1ec-calendar-view"),u=e("#wpadminbar"),a=r.offset().top,f=0,l=null,c=function(){return e("#ai1ec-bs-modes div:visible:first").text()},h=function(){var t=["xs","sm","md","lg"],n=e('<div id="ai1ec-bs-modes"></div>');for(var r in t)e('<div class="ai1ec-device-'+t[r]+" ai1ec-visible-"+t[r]+'">'+t[r]+"</div>").appendTo(n);n.appendTo("body")},p=function(){return parseInt(t["affix_vertical_offset_"+c()]||0)},d=function(){s.each(function(){e(this).contents().eq(-3).wrap('<div class="ai1ec-hidden" />')})},v=function(){s.find(".ai1ec-hidden").contents().unwrap()},m=function(){var e=0;"fixed"===u.css("position")&&(e=u.height()),r.css("top",e+p()+"px")},g=function(){return f},y=function(){f=a-("fixed"===u.css("position")?u.height():0)-p()},b=function(){r.height()>r.data("original_height")?(d(),r.height()>r.data("original_height")&&v()):v()},w=function(){n.find(".ai1ec-affix .ai1ec-views-dropdown").closest("div.ai1ec-clearfix").remove(),i=n.find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix"),s=r.find(".ai1ec-dropdown-toggle"),r.trigger("ai1ec-affix-top.bs.affix").find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").hide().end().end().data({original_height:r.height()}).find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").show().end().end().filter(".ai1ec-affix").trigger("ai1ec-affix.bs.affix")},E=function(){r.hasClass("ai1ec-affix")&&r.addClass("ai1ec-was-affixed"),y(),r.removeClass("ai1ec-affix").css("width",n.width()).find(".ai1ec-btn-toolbar").hide().end().data({original_height:r.height()}),m(),a=r.offset().top,r.filter(".ai1ec-was-affixed").addClass("ai1ec-affix").removeClass("ai1ec-was-affixed").find(".ai1ec-btn-toolbar").show(),l=null};return h(),y(),r.data({original_height:r.height()}).css("width",n.width()).affix({offset:{top:g,bottom:0}}).on("ai1ec-affix.bs.affix",function(){var t=o.offset().top;i.hide().appendTo(r).show().css("opacity",0).animate({opacity:1},400),b(),m(),o.css("margin-top",r.outerHeight(!0)+parseInt(r.css("margin-bottom"))+"px"),e("body").addClass("ai1ec-has-affixed-toolbar")}).on("ai1ec-affix-top.bs.affix",function(){i.hide(),o.prepend(i),i.show().css("opacity",0).animate({opacity:1},400),v(),m(),o.css("margin-top",0),r.data("original_height",r.height()),e("body").removeClass("ai1ec-has-affixed-toolbar")}).on("ai1ec-affix.reinit",w).filter(".ai1ec-affix").trigger("ai1ec-affix.bs.affix"),e(window).on("resize.affix",function(){clearTimeout(l),l=setTimeout(E,100)}),n};return{initialize_affixed_toolbar:n}}),timely.define("external_libs/bootstrap/transition",["jquery_timely"],function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})}),timely.define("external_libs/bootstrap/modal",["jquery_timely"],function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r);if(this.isShown||r.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="ai1ec-modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("ai1ec-fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("ai1ec-in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".ai1ec-modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)})},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("ai1ec-in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("ai1ec-fade")?"ai1ec-fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="ai1ec-modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("ai1ec-in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("ai1ec-in"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="ai1ec-modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".ai1ec-modal",function(){e(document.body).addClass("ai1ec-modal-open")}).on("hidden.bs.modal",".ai1ec-modal",function(){e(document.body).removeClass("ai1ec-modal-open")})}),timely.define("scripts/calendar",["jquery_timely","domReady","scripts/calendar/load_views","scripts/calendar/print","scripts/calendar/agenda_view","scripts/calendar/month_view","scripts/calendar/calendar-affix","ai1ec_calendar","ai1ec_config","scripts/common_scripts/frontend/common_frontend","libs/utils","libs/select2_multiselect_helper","external_libs/bootstrap/transition","external_libs/bootstrap/modal","external_libs/jquery.scrollTo","external_libs/jquery_cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=function(){if(u.selector!==undefined&&u.selector!==""&&e(u.selector).length===1){var t=e(":header:contains("+u.title+"):first");t.length||(t=e('<h1 class="page-title"></h1>'),t.text(u.title));var n=e(".ai1ec-main-container:first").detach().before(t);e(u.selector).empty().append(n).hide().css("visibility","visible").fadeIn("fast")}},p=function(){var t=e(this).data("instanceId"),n=e(this).closest(".ai1ec-calendar");n.find(".ai1ec-event-instance-id-"+t).addClass("ai1ec-hover")},d=function(){var t=e(this).data("instanceId"),n=e(this).closest(".ai1ec-calendar");n.find(".ai1ec-event-instance-id-"+t).removeClass("ai1ec-hover")},v=function(){var t=e(this),n=t.closest(".ai1ec-calendar"),r=t.data("instanceId");t.delay(500).queue(function(){n.find(".ai1ec-event-instance-id-"+r).addClass("ai1ec-raised")})},m=function(t){var n=e(this),r=n.closest(".ai1ec-calendar"),i=n.data("instanceId"),s=e(t.toElement||t.relatedTarget),o=r.find(".ai1ec-event-instance-id-"+i);if(s.is(o)||s.parent().is(o))return;r.find(".ai1ec-event-instance-id-"+i).clearQueue().removeClass("ai1ec-raised")},g=function(){h()},y=function(){e(document).on({mouseenter:p,mouseleave:d},".ai1ec-event-container.ai1ec-multiday"),e(document).on({mouseenter:v,mouseleave:m},".ai1ec-oneday-view .ai1ec-oneday .ai1ec-event-container, .ai1ec-week-view .ai1ec-week .ai1ec-event-container"),e(document).on("click",".ai1ec-agenda-view .ai1ec-event-header",i.toggle_event),e(document).on("click","#ai1ec-agenda-expand-all",i.expand_all),e(document).on("click","#ai1ec-agenda-collapse-all",i.collapse_all),e(document).on("click","a.ai1ec-load-view",n.handle_click_on_link_to_load_view),e(document).on("click",".ai1ec-minical-trigger",n.handle_minical_trigger),e(document).on("click",".ai1ec-clear-filter",n.clear_filters),e(document).on("click","#ai1ec-print-button",r.handle_click_on_print_button),e(document).on("click",".ai1ec-reveal-full-day button",function(){var t=e(this).closest(".ai1ec-calendar");e(this).fadeOut();var n=t.find(".ai1ec-oneday-view-original, .ai1ec-week-view-original"),r=t.find(".tablescroll_wrapper").offset().top-n.offset().top;e(window).scrollTo("+="+r+"px",400);var i=1442;t.find(".tablescroll_wrapper").scrollTo("-="+r+"px",400).animate({height:i+"px"})}),History.Adapter.bind(window,"statechange",n.handle_state_change),e(document).on("click","#ai1ec-calendar-view .ai1ec-load-event",function(t){e.cookie.raw=!1,e.cookie("ai1ec_calendar_url",document.URL,{path:a.cookie_path})})},b=function(){c.init(e(".ai1ec-select2-filters")),e(document).on("change",".ai1ec-select2-multiselect-selector",n.load_view_from_select2_filter)};t(function(){var t=e(".ai1ec-calendar"),r=e(".ai1ec-calendar:visible").first();g(),a.use_select2&&b(),y(),t.each(function(){n.initialize_view(e(this))}),a.affix_filter_menu&&1===r.length&&o.initialize_affixed_toolbar(r)});var w=function(){};return{start:w,initialize_view:n.initialize_view}});

==================================================
FILE PATH: ./public/js/widget/common_widget.js
==================================================
timely.require(["scripts/calendar","scripts/calendar/load_views","scripts/event","scripts/common_scripts/frontend/common_frontend","domReady","jquery_timely","ai1ec_calendar","ai1ec_config","libs/utils","libs/gmaps"],function(e,t,n,r,i,s,o,u,a){if(window.timely.js_widgets_inited)return;window.timely.js_widgets_inited=1;var f='<h2 class="ai1ec-widget-loading ai1ec-text-center"><small>			<i class="ai1ec-fa ai1ec-fa-lg ai1ec-fa-fw ai1ec-fa-spin				ai1ec-fa-spinner"></i> '+u.calendar_loading+"</small></h2>",l=function(e){e.find(".ai1ec-widget-loading").fadeOut("slow",function(){s(this).remove()})},c=function(e){var t=u.javascript_widgets[e.widget];if(!t)return!1;var n=(e.widget.match(/superwidget/)?o.full_calendar_url:u.site_url)+"?ai1ec_js_widget="+e.widget+"&render=true";s.each(t,function(t,r){undefined!==e[t]&&(n+="&"+t+"="+e[t])});var r=location.hash.match(/^#view\|(.+)/);return r&&e.widget.match(/superwidget/)&&(n=o.calendar_url+"?"+r[1].replace(/\|/g,"&").replace(/\~/g,"="),history.pushState(null,document.title,location.pathname)),n},h=function(e,t,n,r){var i=s(this),t=t||i.attr("href"),o="jsonp",u=i.closest(".timely"),c={request_type:o,ai1ec_doing_ajax:!0,ai1ec:a.create_ai1ec_to_send(u)},h=s("#ai1ec-event-modal"),p=i.closest(".ai1ec-event, .ai1ec-popover").length?i.closest(".ai1ec-event, .ai1ec-popover"):i,n=n||p.attr("class").match(/ai1ec-event-instance-id-(\d+)/)[1],r=r||function(){var e=t.match(/\/event\/([\w-]+)/);return e||(e=t.match(/\?ai1ec_event=([\w-]+)&/)),e?e[1]:undefined},d="#event|"+r()+"|"+n;return h.modal("show").find(".ai1ec-modal-body").html(f),s(".ai1ec-popup").hide(),location.hash!=d&&History.pushState(n,r,d),s.ajax({url:t,dataType:o,data:c,method:"get",crossDomain:!0,success:function(e){h.modal("show").find(".ai1ec-modal-body").append(e.html),s(".ai1ec-subscribe-container",h).hide(),s("a.ai1ec-category, a.ai1ec-tag",h).each(function(){s(this).removeAttr("href")}),s(".ai1ec-calendar-link",h).attr("data-dismiss","ai1ec-modal"),timely.require(["scripts/event"],function(e){e.start()})},complete:function(){l(h)}}),!1},p=function(){s(".ai1ec-load-view, .ai1ec-clear-filter").each(function(){var e=s(this),t=e.closest(".timely-widget").attr("data-widget-type"),n=e.attr("href")||e.attr("data-href"),r=a.add_query_arg(n,["ai1ec_source",t]);e.attr({href:r,"data-href":r})})};i(function(){s("#ai1ec-event-modal").length||s("body").append('<div id="ai1ec-event-modal" class="timely ai1ec-modal ai1ec-fade"					role="dialog" aria-hidden="true" tabindex="-1">					<div class="ai1ec-modal-dialog">						<div class="ai1ec-modal-content">							<button data-dismiss="ai1ec-modal" class="ai1ec-close ai1ec-pull-right">&times;</button>							<div class="ai1ec-modal-body ai1ec-clearfix single-ai1ec_event">							</div>						</div>					</div>				</div>');var t=s('[data-widget^="ai1ec"]').not("[data-added]").map(function(t,n){var r=s(n),i=r.data("widget"),o=s("<div />",{"class":"timely timely-widget"+(i.match(/ai1ec(_|-)superwidget/)?" timely-calendar":"")}).attr("data-widget-type",i).html(f).insertAfter(r).css(-1<s.inArray(i,["ai1ec_superwidget","ai1ecfe_fe_widget"])?{"min-height":"392px"}:{}),u=c(r.data()),p={ai1ec_doing_ajax:!0,request_type:"jsonp",ai1ec:a.create_ai1ec_to_send(n),ai1ec_source:i};return!1===u?(r.remove(),o.remove(),!1):(o.on("click",".ai1ec-cog-item-name a",h),s.ajax({url:u,dataType:"jsonp",data:p,success:function(t){o.append(t.html),r.attr("data-added",1),e.initialize_view(o.find(".ai1ec-calendar"))},error:function(){o.append("<p>An error occurred while retrieving the data.</p>")},complete:function(){l(o)}}))}).get();s.when.apply(s,t).done(function(){r.are_event_listeners_attached()||r.start(),s.each(o.extension_urls,function(e,t){timely.require([t.url])}),p(),top.postMessage("ai1ec-widget-loaded",top.document.URL),s(document).trigger("page_ready.ai1ec").data("ai1ec-widget-loaded",1)});var n=document.title;s(document).on("click","a.ai1ec-load-event",h).on("initialize_view.ai1ec",p).on("hide.bs.modal","#ai1ec-event-modal",function(){location.hash&&history.pushState(null,n,location.pathname)});var i=function(){var e=decodeURIComponent(location.hash),t=e;e=e.match(/^#event\|([\w-]+)\|(\d+)/),t=t.match(/^#view\|(.+)/);if(e){var n=function(){return e[1]},r=e[2];o.permalinks_structure?href=u.site_url+"event/"+n()+"/?instance_id="+r:href=u.site_url+"?ai1ec_event="+n()+"&instance_id="+r,h(null,href,r,n)}else t||s("#ai1ec-event-modal").modal("hide")};i(),History.Adapter.bind(window,"popstate",function(e){e.originalEvent&&i()})})});

==================================================
FILE PATH: ./public/js/pages/widget-creator.js
==================================================
timely.require(["scripts/widget-creator"],function(){});

==================================================
FILE PATH: ./public/js/pages/add_new_event.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: button.js v3.0.3
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* =========================================================
 * bootstrap-datepicker.js
 * Repo: https://github.com/eternicode/bootstrap-datepicker/
 * Demo: http://eternicode.github.io/bootstrap-datepicker/
 * Docs: http://bootstrap-datepicker.readthedocs.org/
 * Forked from http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Started by Stefan Petre; improvements by Andrew Rowls + contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ========================================================================
 * Bootstrap: transition.js v3.0.3
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.0.3
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.0.3
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: alert.js v3.0.3
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/*
Copyright 2012 Igor Vaynberg

Version: 3.3.1 Timestamp: Wed Feb 20 09:57:22 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("scripts/add_new_event/event_location/input_coordinates_utility_functions",["jquery_timely","ai1ec_config","libs/utils"],function(e,t,n){var r=function(){e("#ai1ec_input_coordinates:checked").length>0&&e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){this.value=n.convert_comma_to_dot(this.value)})},i=function(t,n){var r=e("<div />",{text:n,"class":"ai1ec-error"});e(t).after(r)},s=function(t,n){t.target.id==="post"&&(t.stopImmediatePropagation(),t.preventDefault(),e("#publish").removeClass("button-primary-disabled"),e("#publish").siblings(".spinner").css("visibility","hidden")),e(n).focus()},o=function(){var t=n.field_has_value("ai1ec_address"),r=!0;return e("input.ai1ec-coordinates").each(function(){var e=n.field_has_value(this.id);e||(r=!1)}),t||r},u=function(n){var r=!0,o=!1;return e("#ai1ec_input_coordinates:checked").length>0&&(e("div.ai1ec-error").remove(),e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){var n=e(this).hasClass("latitude"),s=n?t.error_message_not_entered_lat:t.error_message_not_entered_long;this.value===""&&(r=!1,o===!1&&(o=this),i(this,s))})),r===!1&&s(n,o),r},a=function(r){if(e("#ai1ec_input_coordinates:checked").length===1){e("div.ai1ec-error").remove();var o=!0,u=!1,a=!1;return e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){if(this.value===""){a=!0;return}var r=e(this).hasClass("latitude"),s=r?t.error_message_not_valid_lat:t.error_message_not_valid_long;n.is_valid_coordinate(this.value,r)||(o=!1,u===!1&&(u=this),i(this,s))}),o===!1&&s(r,u),a===!0&&(o=!1),o}};return{ai1ec_convert_commas_to_dots_for_coordinates:r,ai1ec_show_error_message_after_element:i,check_if_address_or_coordinates_are_set:o,ai1ec_check_lat_long_fields_filled_when_publishing_event:u,ai1ec_check_lat_long_ok_for_search:a}}),timely.define("external_libs/jquery.autocomplete_geomod",["jquery_timely"],function(e){e.fn.extend({autocomplete:function(t,n){var r=typeof t=="string";return n=e.extend({},e.Autocompleter.defaults,{url:r?t:null,data:r?null:t,delay:r?e.Autocompleter.defaults.delay:10,max:n&&!n.scroll?10:150},n),n.highlight=n.highlight||function(e){return e},n.formatMatch=n.formatMatch||n.formatItem,this.each(function(){new e.Autocompleter(this,n)})},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,n){function d(){var r=h.selected();if(!r)return!1;var s=r.result;o=s;if(n.multiple){var u=m(i.val());if(u.length>1){var a=n.multipleSeparator.length,f=e(t).selection().start,l,c=0;e.each(u,function(e,t){c+=t.length;if(f<=c)return l=e,!1;c+=a}),u[l]=s,s=u.join(n.multipleSeparator)}s+=n.multipleSeparator}return i.val(s),w(),i.trigger("result",[r.data,r.value]),!0}function v(e,t){if(f==r.DEL){h.hide();return}var s=i.val();if(!t&&s==o)return;o=s,s=g(s),s.length>=n.minChars?(i.addClass(n.loadingClass),n.matchCase||(s=s.toLowerCase()),S(s,E,w)):(T(),h.hide())}function m(t){return t?n.multiple?e.map(t.split(n.multipleSeparator),function(n){return e.trim(t).length?e.trim(n):null}):[e.trim(t)]:[""]}function g(r){if(!n.multiple)return r;var i=m(r);if(i.length==1)return i[0];var s=e(t).selection().start;return s==r.length?i=m(r):i=m(r.replace(r.substring(s),"")),i[i.length-1]}function y(s,u){n.autoFill&&g(i.val()).toLowerCase()==s.toLowerCase()&&f!=r.BACKSPACE&&(i.val(i.val()+u.substring(g(o).length)),e(t).selection(o.length,o.length+u.length))}function b(){clearTimeout(s),s=setTimeout(w,200)}function w(){var e=h.visible();h.hide(),clearTimeout(s),T(),n.mustMatch&&i.search(function(e){if(!e)if(n.multiple){var t=m(i.val()).slice(0,-1);i.val(t.join(n.multipleSeparator)+(t.length?n.multipleSeparator:""))}else i.val(""),i.trigger("result",null)})}function E(e,t){t&&t.length&&a?(T(),h.display(t,e),y(e,t[0].value),h.show()):w()}function S(r,i,s){n.matchCase||(r=r.toLowerCase());var o=u.load(r);if(o&&o.length)i(r,o);else if(n.geocoder){var a=g(r),f={address:a};n.region&&(f.region=n.region),n.geocoder.geocode(f,function(e,t){var s=n.parse(e,t,a);u.add(r,s),i(r,s)})}else if(typeof n.url=="string"&&n.url.length>0){var l={timestamp:+(new Date)};e.each(n.extraParams,function(e,t){l[e]=typeof t=="function"?t():t}),e.ajax({mode:"abort",port:"autocomplete"+t.name,dataType:n.dataType,url:n.url,data:e.extend({q:g(r),limit:n.max},l),success:function(e){var t=n.parse&&n.parse(e)||x(e);u.add(r,t),i(r,t)}})}else h.emptyList(),s(r)}function x(t){var r=[],i=t.split("\n");for(var s=0;s<i.length;s++){var o=e.trim(i[s]);o&&(o=o.split("|"),r[r.length]={data:o,value:o[0],result:n.formatResult&&n.formatResult(o,o[0])||o[0]})}return r}function T(){i.removeClass(n.loadingClass)}var r={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},i=e(t).attr("autocomplete","off").addClass(n.inputClass),s,o="",u=e.Autocompleter.Cache(n),a=0,f,l=navigator.userAgent.match(/opera/i),c={mouseDownOnSelect:!1},h=e.Autocompleter.Select(n,t,d,c),p;l&&e(t.form).bind("submit.autocomplete",function(){if(p)return p=!1,!1}),i.bind((l?"keypress":"keydown")+".autocomplete",function(t){a=1,f=t.keyCode;switch(t.keyCode){case r.UP:t.preventDefault(),h.visible()?h.prev():v(0,!0);break;case r.DOWN:t.preventDefault(),h.visible()?h.next():v(0,!0);break;case r.PAGEUP:t.preventDefault(),h.visible()?h.pageUp():v(0,!0);break;case r.PAGEDOWN:t.preventDefault(),h.visible()?h.pageDown():v(0,!0);break;case n.multiple&&e.trim(n.multipleSeparator)==","&&r.COMMA:case r.TAB:case r.RETURN:if(d())return t.preventDefault(),p=!0,!1;break;case r.ESC:h.hide();break;default:clearTimeout(s),s=setTimeout(v,n.delay)}}).focus(function(){a++}).blur(function(){a=0,c.mouseDownOnSelect||b()}).click(function(){a++>1&&!h.visible()&&v(0,!0)}).bind("search",function(){function n(e,n){var r;if(n&&n.length)for(var s=0;s<n.length;s++)if(n[s].result.toLowerCase()==e.toLowerCase()){r=n[s];break}typeof t=="function"?t(r):i.trigger("result",r&&[r.data,r.value])}var t=arguments.length>1?arguments[1]:null;e.each(m(i.val()),function(e,t){S(t,n,n)})}).bind("flushCache",function(){u.flush()}).bind("setOptions",function(){e.extend(n,arguments[1]),"data"in arguments[1]&&u.populate()}).bind("unautocomplete",function(){h.unbind(),i.unbind(),e(t.form).unbind(".autocomplete")})},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){function i(e,n){t.matchCase||(e=e.toLowerCase());var r=e.indexOf(n);return t.matchContains=="word"&&(r=e.toLowerCase().search("\\b"+n.toLowerCase())),r==-1?!1:r==0||t.matchContains}function s(e,i){r>t.cacheLength&&u(),n[e]||r++,n[e]=i}function o(){if(!t.data)return!1;var n={},r=0;t.url||(t.cacheLength=1),n[""]=[];for(var i=0,o=t.data.length;i<o;i++){var u=t.data[i];u=typeof u=="string"?[u]:u;var a=t.formatMatch(u,i+1,t.data.length);if(a===!1)continue;var f=a.charAt(0).toLowerCase();n[f]||(n[f]=[]);var l={value:a,data:u,result:t.formatResult&&t.formatResult(u)||a};n[f].push(l),r++<t.max&&n[""].push(l)}e.each(n,function(e,n){t.cacheLength++,s(e,n)})}function u(){n={},r=0}var n={},r=0;return setTimeout(o,25),{flush:u,add:s,populate:o,load:function(s){if(!t.cacheLength||!r)return null;if(!t.url&&t.matchContains){var o=[];for(var u in n)if(u.length>0){var a=n[u];e.each(a,function(e,t){i(t.value,s)&&o.push(t)})}return o}if(n[s])return n[s];if(t.matchSubset)for(var f=s.length-1;f>=t.minChars;f--){var a=n[s.substr(0,f)];if(a){var o=[];return e.each(a,function(e,t){i(t.value,s)&&(o[o.length]=t)}),o}}return null}}},e.Autocompleter.Select=function(t,n,r,i){function p(){if(!l)return;c=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),h=e("<ul/>").appendTo(c).mouseover(function(t){d(t).nodeName&&d(t).nodeName.toUpperCase()=="LI"&&(u=e("li",h).removeClass(s.ACTIVE).index(d(t)),e(d(t)).addClass(s.ACTIVE))}).click(function(t){return e(d(t)).addClass(s.ACTIVE),r(),n.focus(),!1}).mousedown(function(){i.mouseDownOnSelect=!0}).mouseup(function(){i.mouseDownOnSelect=!1}),t.width>0&&c.css("width",t.width),l=!1}function d(e){var t=e.target;while(t&&t.tagName!="LI")t=t.parentNode;return t?t:[]}function v(e){o.slice(u,u+1).removeClass(s.ACTIVE),m(e);var n=o.slice(u,u+1).addClass(s.ACTIVE);if(t.scroll){var r=0;o.slice(0,u).each(function(){r+=this.offsetHeight}),r+n[0].offsetHeight-h.scrollTop()>h[0].clientHeight?h.scrollTop(r+n[0].offsetHeight-h.innerHeight()):r<h.scrollTop()&&h.scrollTop(r)}}function m(e){u+=e,u<0?u=o.size()-1:u>=o.size()&&(u=0)}function g(e){return t.max&&t.max<e?t.max:e}function y(){h.empty();var n=g(a.length);for(var r=0;r<n;r++){if(!a[r])continue;var i=t.formatItem(a[r].data,r+1,n,a[r].value,f);if(i===!1)continue;var l=e("<li/>").html(t.highlight(i,f)).addClass(r%2==0?"ac_even":"ac_odd").appendTo(h)[0];e.data(l,"ac_data",a[r])}o=h.find("li"),t.selectFirst&&(o.slice(0,1).addClass(s.ACTIVE),u=0),e.fn.bgiframe&&h.bgiframe()}var s={ACTIVE:"ac_over"},o,u=-1,a,f="",l=!0,c,h;return{display:function(e,t){p(),a=e,f=t,y()},next:function(){v(1)},prev:function(){v(-1)},pageUp:function(){u!=0&&u-8<0?v(-u):v(-8)},pageDown:function(){u!=o.size()-1&&u+8>o.size()?v(o.size()-1-u):v(8)},hide:function(){c&&c.hide(),o&&o.removeClass(s.ACTIVE),u=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(o.filter("."+s.ACTIVE)[0]||t.selectFirst&&o[0])},show:function(){var r=e(n).offset();c.css({width:typeof t.width=="string"||t.width>0?t.width:e(n).width(),top:r.top+n.offsetHeight,left:r.left}).show();if(t.scroll){h.scrollTop(0),h.css({maxHeight:t.scrollHeight,overflow:"auto"});if(navigator.userAgent.match(/msie/i)&&typeof document.body.style.maxHeight=="undefined"){var i=0;o.each(function(){i+=this.offsetHeight});var s=i>t.scrollHeight;h.css("height",s?t.scrollHeight:i),s||o.width(h.width()-parseInt(o.css("padding-left"))-parseInt(o.css("padding-right")))}}},selected:function(){var t=o&&o.filter("."+s.ACTIVE).removeClass(s.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){h&&h.empty()},unbind:function(){c&&c.remove()}}},e.fn.selection=function(e,t){if(e!==undefined)return this.each(function(){if(this.createTextRange){var n=this.createTextRange();t===undefined||e==t?(n.move("character",e),n.select()):(n.collapse(!0),n.moveStart("character",e),n.moveEnd("character",t),n.select())}else this.setSelectionRange?this.setSelectionRange(e,t):this.selectionStart&&(this.selectionStart=e,this.selectionEnd=t)});var n=this[0];if(n.createTextRange){var r=document.selection.createRange(),i=n.value,s="<->",o=r.text.length;r.text=s;var u=n.value.indexOf(s);return n.value=i,this.selection(u,u+o),{start:u,end:u+o}}if(n.selectionStart!==undefined)return{start:n.selectionStart,end:n.selectionEnd}}}),timely.define("external_libs/geo_autocomplete",["jquery_timely","external_libs/jquery.autocomplete_geomod"],function(e){e.fn.extend({geo_autocomplete:function(t,n){return options=e.extend({},e.Autocompleter.defaults,{geocoder:t,mapwidth:100,mapheight:100,maptype:"terrain",mapkey:"ABQIAAAAbnvDoAoYOSW2iqoXiGTpYBT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQNumU68AwGqjbSNF9YO8NokKst8w",mapsensor:!1,parse:function(t,n,r){var i=[];return t&&n&&n=="OK"&&e.each(t,function(t,n){if(n.geometry&&n.geometry.viewport){var s=n.formatted_address.split(","),o=s[0];e.each(s,function(t,n){if(n.toLowerCase().indexOf(r.toLowerCase())!=-1)return o=e.trim(n),!1}),i.push({data:n,value:o,result:o})}}),i},formatItem:function(e,t,n,r){var i="https://maps.google.com/maps/api/staticmap?visible="+e.geometry.viewport.getSouthWest().toUrlValue()+"|"+e.geometry.viewport.getNorthEast().toUrlValue()+"&size="+options.mapwidth+"x"+options.mapheight+"&maptype="+options.maptype+"&key="+options.mapkey+"&sensor="+(options.mapsensor?"true":"false"),s=e.formatted_address.replace(/,/gi,",<br/>");return'<img src="'+i+'" width="'+options.mapwidth+'" height="'+options.mapheight+'" /> '+s+'<br clear="both"/>'}},n),options.highlight=options.highlight||function(e){return e},options.formatMatch=options.formatMatch||options.formatItem,options.resultsClass="ai1ec-geo-ac-results-not-ready",this.each(function(){e(this).one("focus",function(){var t=setInterval(function(){var n=e(".ai1ec-geo-ac-results-not-ready");n.length&&(n.removeClass("ai1ec-geo-ac-results-not-ready").addClass("ai1ec-geo-ac-results").children("ul").addClass("ai1ec-dropdown-menu"),clearInterval(t))},500)}),new e.Autocompleter(this,options)})}})}),timely.define("scripts/add_new_event/event_location/gmaps_helper",["jquery_timely","domReady","ai1ec_config","scripts/add_new_event/event_location/input_coordinates_utility_functions","external_libs/jquery.autocomplete_geomod","external_libs/geo_autocomplete"],function(e,t,n,r){var i,s,o,u,a,f,l=function(t){e("#ai1ec_latitude").val(t.latLng.lat()),e("#ai1ec_longitude").val(t.latLng.lng()),e("#ai1ec_input_coordinates:checked").length===0&&e("#ai1ec_input_coordinates").trigger("click")},c=function(){n.disable_autocompletion||e("#ai1ec_address").geo_autocomplete(new google.maps.Geocoder,{selectFirst:!1,minChars:3,cacheLength:50,width:300,scroll:!0,scrollHeight:330,region:n.region}).result(function(e,t){t&&p(t)}).change(function(){if(e(this).val().length>0){var t=e(this).val();i.geocode({address:t,region:n.region},function(e,t){t===google.maps.GeocoderStatus.OK&&p(e[0])})}})},h=function(){i=new google.maps.Geocoder,s=new google.maps.LatLng(9.965,-83.327),o={zoom:0,mapTypeId:google.maps.MapTypeId.ROADMAP,center:s},t(function(){e("#ai1ec_map_canvas").length>0&&(u=new google.maps.Map(e("#ai1ec_map_canvas").get(0),o),a=new google.maps.Marker({map:u,draggable:!0}),google.maps.event.addListener(a,"dragend",l),a.setPosition(s),c(),v(),e('a[href="#ai1ec-event-location-box"]').on("click",function(){window.setTimeout(function(){google.maps.event.trigger(u,"resize"),u.setCenter(a.getPosition())},150)}))})},p=function(t){u.setCenter(t.geometry.location),u.setZoom(15),a.setPosition(t.geometry.location),e("#ai1ec_address").val(t.formatted_address),e("#ai1ec_latitude").val(t.geometry.location.lat()),e("#ai1ec_longitude").val(t.geometry.location.lng()),e("#ai1ec_input_coordinates").is(":checked")||e("#ai1ec_input_coordinates").click();var n="",r="",i="",s=0,o=0,f="",l;for(var c=0;c<t.address_components.length;c++)switch(t.address_components[c].types[0]){case"street_number":n=t.address_components[c].long_name;break;case"route":r=t.address_components[c].long_name;break;case"locality":i=t.address_components[c].long_name;break;case"administrative_area_level_1":f=t.address_components[c].long_name;break;case"postal_code":s=t.address_components[c].long_name;break;case"country":l=t.address_components[c].short_name,o=t.address_components[c].long_name}var h=n.length>0?n+" ":"";h+=r.length>0?r:"",s=s!==0?s:"",e("#ai1ec_city").val(i),e("#ai1ec_province").val(f),e("#ai1ec_postal_code").val(s),e("#ai1ec_country").val(o),e("#ai1ec_country_short").val(l)},d=function(){var t=parseFloat(e("#ai1ec_latitude").val()),n=parseFloat(e("#ai1ec_longitude").val()),r=new google.maps.LatLng(t,n);u.setCenter(r),u.setZoom(15),a.setPosition(r)},v=function(){e("#ai1ec_input_coordinates:checked").length===0?(e("#ai1ec_table_coordinates").hide(),e("#ai1ec_address").change()):d()},m=function(){return a},g=function(){return f};return{init_gmaps:h,ai1ec_update_map_from_coordinates:d,get_marker:m,get_position:g}}),timely.define("scripts/add_new_event/event_location/input_coordinates_event_handlers",["jquery_timely","scripts/add_new_event/event_location/input_coordinates_utility_functions","scripts/add_new_event/event_location/gmaps_helper","ai1ec_config"],function(e,t,n,r){var i=function(t){this.checked?e(".ai1ec-map-preview").addClass("ai1ec-map-visible"):e(".ai1ec-map-preview").removeClass("ai1ec-map-visible")},s=function(t){this.checked?e("#ai1ec_table_coordinates").fadeIn("fast"):e("#ai1ec_table_coordinates").fadeOut("fast")},o=function(e){t.ai1ec_convert_commas_to_dots_for_coordinates();var r=t.ai1ec_check_lat_long_ok_for_search(e);r===!0&&n.ai1ec_update_map_from_coordinates()};return{toggle_visibility_of_google_map_on_click:i,toggle_visibility_of_coordinate_fields_on_click:s,update_map_from_coordinates_on_blur:o}}),timely.define("external_libs/jquery.calendrical_timespan",["jquery_timely"],function(e){function l(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function c(e,t){return typeof e=="string"&&(e=new Date(e)),typeof t=="string"&&(t=new Date(t)),e.getUTCDate()===t.getUTCDate()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCFullYear()===t.getUTCFullYear()?!0:!1}function h(e,t){if(e instanceof Date)return h(e.getUTCFullYear(),e.getUTCMonth());if(t==1){var n=e%4==0&&(e%100!=0||e%400==0);return n?29:28}return t==3||t==5||t==8||t==10?30:31}function p(e){return new Date(e.getTime()+864e5)}function d(e){return new Date(e.getTime()-864e5)}function v(e,t){return t==11?new Date(e+1,0,1):new Date(e,t+1,1)}function m(t,n,r,i){var s=i.monthNames.split(","),o=e("<thead />"),u=e("<tr />").appendTo(o);e("<th />").addClass("monthCell").append(e('<a href="javascript:;">&laquo;</a>').addClass("prevMonth").mousedown(function(e){g(t,r==0?n-1:n,r==0?11:r-1,i),e.preventDefault()})).appendTo(u),e("<th />").addClass("monthCell").attr("colSpan",5).append(e('<a href="javascript:;">'+s[r]+" "+n+"</a>").addClass("monthName")).appendTo(u),e("<th />").addClass("monthCell").append(e('<a href="javascript:;">&raquo;</a>').addClass("nextMonth").mousedown(function(){g(t,r==11?n+1:n,r==11?0:r+1,i)})).appendTo(u);var a=i.dayNames.split(","),f=parseInt(i.weekStartDay),l=[];for(var c=0,h=a.length;c<h;c++)l[c]=a[(c+f)%h];var p=e("<tr />").appendTo(o);return e.each(l,function(t,n){e("<td />").addClass("dayName").append(n).appendTo(p)}),o}function g(t,n,r,i){i=i||{};var s=parseInt(i.weekStartDay),o=i.today?i.today:l();o.setHours(0),o.setMinutes(0);var u=new Date(n,r,1),a=v(n,r),f=Math.abs(o.getTimezoneOffset());f!=0&&(o.setHours(o.getHours()+f/60),o.setMinutes(o.getMinutes()+f%60),u.setHours(u.getHours()+f/60),u.setMinutes(u.getMinutes()+f%60),a.setHours(a.getHours()+f/60),a.setMinutes(a.getMinutes()+f%60));var h=a.getUTCDay()-s;h<0?h=Math.abs(h)-1:h=6-h;for(var g=0;g<h;g++)a=p(a);var y=e("<table />");m(t,n,r,i).appendTo(y);var b=e("<tbody />").appendTo(y),w=e("<tr />"),E=u.getUTCDay()-s;E<0&&(E=7+E);for(var g=0;g<E;g++)u=d(u);while(u<=a){var S=e("<td />").addClass("day").append(e('<a href="javascript:;">'+u.getUTCDate()+"</a>").click(function(){var e=u;return function(){i&&i.selectDate&&i.selectDate(e)}}())).appendTo(w),x=c(u,o),T=i.selected&&c(i.selected,u);x&&S.addClass("today"),T&&S.addClass("selected"),x&&T&&S.addClass("today_selected"),u.getUTCMonth()!=r&&S.addClass("nonMonth");var N=u.getUTCDay();(N+1)%7==s&&(b.append(w),w=e("<tr />")),u=p(u)}w.children().length?b.append(w):w.remove(),t.empty().append(y)}function y(t,n){var r=n.selection&&f(n.selection);r&&(r.minute=Math.floor(r.minute/15)*15);var i=n.startTime&&n.startTime.hour*60+n.startTime.minute,s,o=e("<ul />");for(var a=0;a<24;a++)for(var l=0;l<60;l+=15){if(i&&i>a*60+l)continue;(function(){var t=u(a,l,n.isoTime),f=t;if(i!=null){var c=a*60+l-i;c<60?f+=" ("+c+" min)":c==60?f+=" (1 hr)":f+=" ("+Math.floor(c/60)+" hr "+c%60+" min)"}var h=e("<li />").append(e('<a href="javascript:;">'+f+"</a>").click(function(){n&&n.selectTime&&n.selectTime(t)}).mousemove(function(){e("li.selected",o).removeClass("selected")})).appendTo(o);!s&&a==n.defaultHour&&(s=h),r&&r.hour==a&&r.minute==l&&(h.addClass("selected"),s=h)})()}s&&setTimeout(function(){t[0].scrollTop=s[0].offsetTop-s.height()*2},0),t.empty().append(o)}function b(e){e.addClass("error").fadeOut("normal",function(){e.val(e.data("timespan.stored")).removeClass("error").fadeIn("fast")})}function w(){e(this).data("timespan.stored",this.value)}function E(t,n,r,i,a,f,l,c,h,p){r.val(r.data("timespan.initial_value")),f.val(f.data("timespan.initial_value")),l.get(0).checked=l.data("timespan.initial_value");var d=s(r,p,0,15);n.val(u(d.getUTCHours(),d.getUTCMinutes(),c)),t.val(o(d,h));var v=s(f,d.getTime(),1,15);a.val(u(v.getUTCHours(),v.getUTCMinutes(),c)),l.get(0).checked&&v.setUTCDate(v.getUTCDate()-1),i.val(o(v,h)),t.each(w),n.each(w),i.each(w),a.each(w),l.trigger("change.timespan"),e("#ai1ec_instant_event").trigger("change.timespan")}var t={us:{pattern:/([\d]{1,2})\/([\d]{1,2})\/([\d]{4}|[\d]{2})/,format:"m/d/y",order:"middleEndian",zeroPad:!1},iso:{pattern:/([\d]{4}|[\d]{2})-([\d]{1,2})-([\d]{1,2})/,format:"y-m-d",order:"bigEndian",zeroPad:!0},dot:{pattern:/([\d]{1,2}).([\d]{1,2}).([\d]{4}|[\d]{2})/,format:"d.m.y",order:"littleEndian",zeroPad:!1},def:{pattern:/([\d]{1,2})\/([\d]{1,2})\/([\d]{4}|[\d]{2})/,format:"d/m/y",order:"littleEndian",zeroPad:!1}},n=function(e){return e<10?"0"+e:e},r=function(e,t){typeof t=="undefined"&&(t=!1);var r=e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate());return t&&(r+="T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":00"),r},i=function(e,t){var n=e.val(),r=null;if(n.length<4)r=new Date(t);else{r=new Date(n);var i=n.split("T"),s=i[0].split("-"),o=i[1].split(":");r.setUTCFullYear(s[0],s[1]-1,s[2]),r.setUTCHours(o[0],o[1],o[2],0)}return r},s=function(e,t,n,r){return t+=n*36e5,t-=t%(r*6e4),i(e,t)},o=function(e,n,r){var i,s,o;typeof t[n]=="undefined"&&(n="def"),typeof r=="undefined"&&(r=!1),!0===r?(i=e.getFullYear().toString(),s=(e.getMonth()+1).toString(),o=e.getDate().toString()):(i=e.getUTCFullYear().toString(),s=(e.getUTCMonth()+1).toString(),o=e.getUTCDate().toString()),t[n].zeroPad&&(s.length==1&&(s="0"+s),o.length==1&&(o="0"+o));var u=t[n].format;return u=u.replace("d",o),u=u.replace("m",s),u=u.replace("y",i),u},u=function(e,t,n){var r=t;t<10&&(r="0"+t);if(n){var i=e;return i<10&&(i="0"+e),i+":"+r}var i=e%12;i==0&&(i=12);var s=e<12?"am":"pm";return i+":"+r+s},a=function(e,n){typeof t[n]=="undefined"&&(n="def");var r=e.match(t[n].pattern);if(!r||r.length!=4)return Date("invalid");switch(t[n].order){case"bigEndian":var i=r[3],s=r[2],o=r[1];break;case"littleEndian":var i=r[1],s=r[2],o=r[3];break;case"middleEndian":var i=r[2],s=r[1],o=r[3];break;default:var i=r[1],s=r[2],o=r[3]}return o.length==2&&(o=(new Date).getUTCFullYear().toString().substr(0,2)+o),new Date(s+"/"+i+"/"+o+" GMT")},f=function(e){var t=t=/(\d+)\s*[:\-\.,]\s*(\d+)\s*(am|pm)?/i.exec(e);if(t&&t.length>=3){var n=Number(t[1]),r=Number(t[2]);return n==12&&t[3]&&(n-=12),t[3]&&t[3].toLowerCase()=="pm"&&(n+=12),{hour:n,minute:r}}return null};e.fn.calendricalDate=function(t){return t=t||{},t.padding=t.padding||4,t.monthNames=t.monthNames||"January,February,March,April,May,June,July,August,September,October,November,December",t.dayNames=t.dayNames||"S,M,T,W,T,F,S",t.weekStartDay=t.weekStartDay||0,this.each(function(){var n=e(this),r,i=!1;n.bind("focus",function(){if(r)return;var s=n.position(),u=n.css("padding-left");r=e("<div />").addClass("calendricalDatePopup").mouseenter(function(){i=!0}).mouseleave(function(){i=!1}).mousedown(function(e){e.preventDefault()}).css({position:"absolute",left:s.left,top:s.top+n.height()+t.padding*2}),n.after(r);var f=a(n.val(),t.dateFormat);f.getUTCFullYear()||(f=t.today?t.today:l()),g(r,f.getUTCFullYear(),f.getUTCMonth(),{today:t.today,selected:f,monthNames:t.monthNames,dayNames:t.dayNames,weekStartDay:t.weekStartDay,selectDate:function(e){i=!1,n.val(o(e,t.dateFormat)),r.remove(),r=null;if(t.endDate){var s=a(t.endDate.val(),t.dateFormat);s>=f&&t.endDate.val(o(new Date(e.getTime()+s.getTime()-f.getTime()),t.dateFormat))}}})}).blur(function(){if(i){r&&n.focus();return}if(!r)return;r.remove(),r=null})})},e.fn.calendricalDateRange=function(t){return this.length>=2&&(e(this[0]).calendricalDate(e.extend({endDate:e(this[1])},t)),e(this[1]).calendricalDate(t)),this},e.fn.calendricalDateRangeSingle=function(t){return this.length==1&&e(this).calendricalDate(t),this},e.fn.calendricalTime=function(t){return t=t||{},t.padding=t.padding||4,this.each(function(){var n=e(this),r,i=!1;n.bind("focus click",function(){if(r)return;var s=t.startTime;s&&t.startDate&&t.endDate&&!c(a(t.startDate.val()),a(t.endDate.val()))&&(s=!1);var o=n.position();r=e("<div />").addClass("calendricalTimePopup").mouseenter(function(){i=!0}).mouseleave(function(){i=!1}).mousedown(function(e){e.preventDefault()}).css({position:"absolute",left:o.left,top:o.top+n.height()+t.padding*2}),s&&r.addClass("calendricalEndTimePopup"),n.after(r);var u={selection:n.val(),selectTime:function(e){i=!1,n.val(e),r.remove(),r=null},isoTime:t.isoTime||!1,defaultHour:t.defaultHour!=null?t.defaultHour:8};s&&(u.startTime=f(t.startTime.val())),y(r,u)}).blur(function(){if(i){r&&n.focus();return}if(!r)return;r.remove(),r=null})})},e.fn.calendricalTimeRange=function(t){return this.length>=2&&(e(this[0]).calendricalTime(t),e(this[1]).calendricalTime(e.extend({startTime:e(this[0])},t))),this},e.fn.calendricalDateTimeRange=function(t){return this.length>=4&&(e(this[0]).calendricalDate(e.extend({endDate:e(this[2])},t)),e(this[1]).calendricalTime(t),e(this[2]).calendricalDate(t),e(this[3]).calendricalTime(e.extend({startTime:e(this[1]),startDate:e(this[0]),endDate:e(this[2])},t))),this};var S={allday:"#allday",start_date_input:"#start-date-input",start_time_input:"#start-time-input",start_time:"#start-time",end_date_input:"#end-date-input",end_time_input:"#end-time-input",end_time:"#end-time",twentyfour_hour:!1,date_format:"def",now:new Date},x={init:function(t){function C(){var e=a(s.val(),n.date_format).getTime()/1e3,t=f(l.val());e+=t.hour*3600+t.minute*60;var r=a(h.val(),n.date_format).getTime()/1e3,i=f(p.val());return r+=i.hour*3600+i.minute*60,r-e}function k(){var e=a(s.data("timespan.stored"),n.date_format),t=f(l.data("timespan.stored")),r=e.getTime()/1e3+t.hour*3600+t.minute*60+s.data("time_diff");return r=new Date(r*1e3),h.val(o(r,n.date_format)),p.val(u(r.getUTCHours(),r.getUTCMinutes(),n.twentyfour_hour)),!0}function L(){var e=a(s.val(),n.date_format).getTime()/1e3;if(!isNaN(e)){if(!i.get(0).checked){var t=f(l.val());t?e+=t.hour*3600+t.minute*60:e=""}}else e="";e>0&&c.val(r(new Date(e*1e3),!0));var o=a(h.val(),n.date_format).getTime()/1e3;if(!isNaN(o))if(i.get(0).checked)o+=86400;else{var t=f(p.val());t?o+=t.hour*3600+t.minute*60:o=""}else o="";o>0&&d.val(r(new Date(o*1e3),!0))}var n=e.extend({},S,t),i=e(n.allday),s=e(n.start_date_input),l=e(n.start_time_input),c=e(n.start_time),h=e(n.end_date_input),p=e(n.end_time_input),d=e(n.end_time),v=e("#ai1ec_instant_event"),m=h.add(p),g=s.add(n.end_date_input),y=l.add(n.end_time_input),x=s.add(n.start_time_input).add(n.end_date_input).add(n.end_time_input);x.bind("focus.timespan",w),v.bind("change.timespan",function(){this.checked?(m.closest("tr").fadeOut(),i.attr("disabled",!0)):(i.removeAttr("disabled"),m.closest("tr").fadeIn())});var T=new Date(n.now.getFullYear(),n.now.getMonth(),n.now.getDate()),N=!1;return i.bind("change.timespan",function(){this.checked?(y.fadeOut(),v.attr("disabled",!0)):(v.removeAttr("disabled"),y.fadeIn()),N||(N=!0,x.calendricalDateTimeRange({today:T,dateFormat:n.date_format,isoTime:n.twentyfour_hour,monthNames:n.month_names,dayNames:n.day_names,weekStartDay:n.week_start_day}))}).get().checked=!1,g.bind("blur.timespan",function(){var t=a(this.value,n.date_format);isNaN(t)?b(e(this)):(e(this).data("timespan.stored",this.value),e(this).val(o(t,n.date_format)))}),y.bind("blur.timespan",function(){var t=f(this.value);t?(e(this).data("timespan.stored",this.value),e(this).val(u(t.hour,t.minute,n.twentyfour_hour))):b(e(this))}),s.add(n.start_time_input).bind("focus.timespan",function(){s.data("time_diff",C())}).bind("blur.timespan",function(){s.data("time_diff")<0&&s.data("time_diff",900);var e=k()}),h.add(n.start_time_input).bind("blur.timespan",function(){if(C()<0){s.data("time_diff",900);var e=k()}}),s.closest("form").bind("submit.timespan",L),s.closest("form").find("#ai1ec_start-date-input, #ai1ec_end-date-input, 				 #ai1ec_start-time-input, #ai1ec_end-time-input").on("change",L),s.closest(".ai1ec-form").on("click",L),c.data("timespan.initial_value",c.val()),d.data("timespan.initial_value",d.val()),i.data("timespan.initial_value",i.get(0).checked),E(s,l,c,h,p,d,i,n.twentyfour_hour,n.date_format,n.now),this},reset:function(t){var n=e.extend({},S,t);return E(e(n.start_date_input),e(n.start_time_input),e(n.start_time),e(n.end_date_input),e(n.end_time_input),e(n.end_time),e(n.allday),n.twentyfour_hour,n.date_format,n.now),this},destroy:function(t){return t=e.extend({},S,t),e.each(t,function(t,n){e(n).unbind(".timespan")}),e(t.start_date_input).closest("form").unbind(".timespan"),this}};return e.timespan=function(t){if(x[t])return x[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return x.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timespan")},{formatDate:o,parseDate:a}}),timely.define("scripts/add_new_event/event_date_time/date_time_utility_functions",["jquery_timely","ai1ec_config","libs/utils","external_libs/jquery.calendrical_timespan"],function(e,t,n,r){var i=n.get_ajax_url(),s=function(t,n,r,i,s,o){e(t).val(i),e("#ai1ec_repeat_box").modal("hide");var u=e.trim(e(n).text());u.lastIndexOf(":")===-1&&(u=u.substring(0,u.length-3),e(n).html(u+":")),e(s).attr("disabled",!1),e(r).fadeOut("fast",function(){e(this).html(o.message),e(this).fadeIn("fast")})},o=function(t,n,r,i){e("#ai1ec_repeat_box .ai1ec-alert-danger").text(r.message).removeClass("ai1ec-hide"),e(i).attr("disabled",!1),e(t).val("");var s=e.trim(e(n).text());s.lastIndexOf("...")===-1&&(s=s.substring(0,s.length-1),e(n).text(s+"...")),e(this).closest("tr").find(".ai1ec_rule_text").text()===""&&e(t).siblings("input:checkbox").removeAttr("checked")},u=function(t,n,r,i,s){e(document).on("click",t,function(){if(!e(n).is(":checked")){e(n).attr("checked",!0);var t=e.trim(e(r).text());t=t.substring(0,t.length-3),e(r).text(t+":")}return c(i,s),!1})},a=function(t,n,r,i,s){e(t).click(function(){if(e(this).is(":checked"))this.id==="ai1ec_repeat"&&e("#ai1ec_exclude").removeAttr("disabled"),c(i,s);else{this.id==="ai1ec_repeat"&&(e("#ai1ec_exclude").removeAttr("checked").attr("disabled",!0),e("#ai1ec_exclude_text > a").text("")),e(n).text("");var t=e.trim(e(r).text());t=t.substring(0,t.length-1),e(r).text(t+"...")}})},f=function(t,n,r){if(e.trim(e(t).text())===""){e(n).removeAttr("checked"),e("#ai1ec_repeat").is(":checked")||e("#ai1ec_exclude").attr("disabled",!0);var i=e.trim(e(r).text());i.lastIndexOf("...")===-1&&(i=i.substring(0,i.length-1),e(r).text(i+"..."))}},l=function(){e("#ai1ec_count, #ai1ec_daily_count, #ai1ec_weekly_count,			#ai1ec_monthly_count, #ai1ec_yearly_count").rangeinput({css:{input:"ai1ec-range",slider:"ai1ec-slider",progress:"ai1ec-progress",handle:"ai1ec-handle"}});var n=e("#ai1ec_recurrence_calendar");n.datepicker({multidate:!0,weekStart:t.week_start_day}),n.on("changeDate",function(n){var i=[],s=[];for(var o=0;o<n.dates.length;o++){var u=new Date(n.dates[o]),a=""+u.getFullYear()+("0"+(u.getMonth()+1)).slice(-2)+("0"+u.getDate()).slice(-2)+"T000000Z",f='<span class="ai1ec-label ai1ec-label-default">'+r.formatDate(u,t.date_format,!0)+"</span>";i.push(a),s.push(f)}e("#ai1ec_rec_dates_list").html(s.join(" ")),e("#ai1ec_rec_custom_dates").val(i.join(","))});var i={start_date_input:"#ai1ec_until-date-input",start_time:"#ai1ec_until-time",date_format:t.date_format,month_names:t.month_names,day_names:t.day_names,week_start_day:t.week_start_day,twentyfour_hour:t.twentyfour_hour,now:new Date(t.now*1e3)};e.inputdate(i),e(document).trigger("ai1ec.recurrence-modal.inited")},c=function(t,n){var r=e("#ai1ec_repeat_box"),s=e(".ai1ec-loading",r);r.modal({backdrop:"static"}),e.post(i,t,function(e){e.error?(window.alert(e.message),r.modal("hide")):(s.addClass("ai1ec-hide").after(e.message),typeof n=="function"&&n())},"json")};return{show_repeat_tabs:c,init_modal_widgets:l,click_on_modal_cancel:f,click_on_checkbox:a,click_on_ics_rule_text:u,repeat_form_error:o,repeat_form_success:s}}),timely.define("external_libs/bootstrap/button",["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();e+="Text",i.resetText||n.data("resetText",n[r]()),n[r](i[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass("ai1ec-"+t).attr(t,t):n.removeClass("ai1ec-"+t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="ai1ec-buttons"]'),t=!0;if(e.length){var n=this.$element.find("input");n.prop("type")==="radio"&&(n.prop("checked")&&this.$element.hasClass("ai1ec-active")?t=!1:e.find(".ai1ec-active").removeClass("ai1ec-active")),t&&n.prop("checked",!this.$element.hasClass("ai1ec-active")).trigger("change")}t&&this.$element.toggleClass("ai1ec-active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=ai1ec-button]",function(t){var n=e(t.target);n.hasClass("ai1ec-btn")||(n=n.closest(".ai1ec-btn")),n.button("toggle"),t.preventDefault()})}),timely.define("scripts/add_new_event/event_date_time/date_time_event_handlers",["jquery_timely","ai1ec_config","scripts/add_new_event/event_date_time/date_time_utility_functions","external_libs/jquery.calendrical_timespan","libs/utils","external_libs/bootstrap/button"],function(e,t,n,r,i){var s=i.get_ajax_url(),o=function(){var t=e("#ai1ec_end option:selected").val();switch(t){case"0":e("#ai1ec_until_holder, #ai1ec_count_holder").collapse("hide");break;case"1":e("#ai1ec_until_holder").collapse("hide"),e("#ai1ec_count_holder").collapse("show");break;case"2":e("#ai1ec_count_holder").collapse("hide"),e("#ai1ec_until_holder").collapse("show")}},u=function(){e("#publish").trigger("click")},a=function(){var i=e(this),o="",u=e("#ai1ec_repeat_box .ai1ec-tab-pane.ai1ec-active"),a=u.data("freq"),f=!0;switch(a){case"daily":o+="FREQ=DAILY;";var l=e("#ai1ec_daily_count").val();l>1&&(o+="INTERVAL="+l+";");break;case"weekly":o+="FREQ=WEEKLY;";var c=e("#ai1ec_weekly_count").val();c>1&&(o+="INTERVAL="+c+";");var h=e('input[name="ai1ec_weekly_date_select"]:first').val(),p=e('#ai1ec_weekly_date_select > div:first > input[type="hidden"]:first').val();h.length>0&&(o+="WKST="+p+";BYday="+h+";");break;case"monthly":o+="FREQ=MONTHLY;";var d=e("#ai1ec_monthly_count").val(),v=e('input[name="ai1ec_monthly_type"]:checked').val();d>1&&(o+="INTERVAL="+d+";");var m=e('input[name="ai1ec_montly_date_select"]:first').val();if(m.length>0&&v==="bymonthday")o+="BYMONTHDAY="+m+";";else if(v==="byday"){var g=e("#ai1ec_monthly_byday_num").val(),y=e("#ai1ec_monthly_byday_weekday").val();o+="BYday="+g+y+";"}break;case"yearly":o+="FREQ=YEARLY;";var b=e("#ai1ec_yearly_count").val();b>1&&(o+="INTERVAL="+b+";");var w=e('input[name="ai1ec_yearly_date_select"]:first').val();w.length>0&&(o+="BYMONTH="+w+";");break;case"custom":"1"===e("#ai1ec_is_box_repeat").val()?o+="RDATE=":o+="EXDATE=",o+=e("#ai1ec_rec_custom_dates").val(),f=!1}var E=e("#ai1ec_end").val();if("1"===E&&f)o+="COUNT="+e("#ai1ec_count").val()+";";else if("2"===E&&f){var S=e("#ai1ec_until-date-input").val();S=r.parseDate(S,t.date_format);var x=e("#ai1ec_start-time").val();x=r.parseDate(x,t.date_format),x=new Date(x);var T=S.getUTCDate(),N=S.getUTCMonth()+1,C=x.getUTCHours(),k=x.getUTCMinutes();N=N<10?"0"+N:N,T=T<10?"0"+T:T,C=C<10?"0"+C:C,k=k<10?"0"+k:k,S=S.getUTCFullYear()+""+N+T+"T235959Z",o+="UNTIL="+S+";"}var L={action:"ai1ec_rrule_to_text",rrule:o};i.button("loading").next().addClass("ai1ec-disabled"),e.post(s,L,function(t){t.error?(i.button("reset").next().removeClass("ai1ec-disabled"),"1"===e("#ai1ec_is_box_repeat").val()?n.repeat_form_error("#ai1ec_rrule","#ai1ec_repeat_label",t,i):n.repeat_form_error("#ai1ec_exrule","#ai1ec_exclude_label",t,i)):"1"===e("#ai1ec_is_box_repeat").val()?n.repeat_form_success("#ai1ec_rrule","#ai1ec_repeat_label","#ai1ec_repeat_text > a",o,i,t):n.repeat_form_success("#ai1ec_exrule","#ai1ec_exclude_label","#ai1ec_exclude_text > a",o,i,t)},"json")},f=function(){return e("#ai1ec_is_box_repeat").val()==="1"?n.click_on_modal_cancel("#ai1ec_repeat_text > a","#ai1ec_repeat","#ai1ec_repeat_label"):n.click_on_modal_cancel("#ai1ec_exclude_text > a","#ai1ec_exclude","#ai1ec_exclude_label"),e("#ai1ec_repeat_box").modal("hide"),!1},l=function(){e(this).is("#ai1ec_monthly_type_bymonthday")?(e("#ai1ec_repeat_monthly_byday").collapse("hide"),e("#ai1ec_repeat_monthly_bymonthday").collapse("show")):(e("#ai1ec_repeat_monthly_bymonthday").collapse("hide"),e("#ai1ec_repeat_monthly_byday").collapse("show"))},c=function(){var t=e(this),n=[],r=t.closest(".ai1ec-btn-group-grid"),i;t.toggleClass("ai1ec-active"),e("a",r).each(function(){var t=e(this);t.is(".ai1ec-active")&&(i=t.next().val(),n.push(i))}),r.next().val(n.join())},h=function(){n.click_on_ics_rule_text("#ai1ec_repeat_text > a","#ai1ec_repeat","#ai1ec_repeat_label",{action:"ai1ec_get_repeat_box",repeat:1,post_id:e("#post_ID").val()},n.init_modal_widgets),n.click_on_ics_rule_text("#ai1ec_exclude_text > a","#ai1ec_exclude","#ai1ec_exclude_label",{action:"ai1ec_get_repeat_box",repeat:0,post_id:e("#post_ID").val()},n.init_modal_widgets),n.click_on_checkbox("#ai1ec_repeat","#ai1ec_repeat_text > a","#ai1ec_repeat_label",{action:"ai1ec_get_repeat_box",repeat:1,post_id:e("#post_ID").val()},n.init_modal_widgets),n.click_on_checkbox("#ai1ec_exclude","#ai1ec_exclude_text > a","#ai1ec_exclude_label",{action:"ai1ec_get_repeat_box",repeat:0,post_id:e("#post_ID").val()},n.init_modal_widgets)},p=function(t){return e("#ai1ec_widget_calendar").toggle(),!1},d=function(){e(".ai1ec-modal-content",this).not(".ai1ec-loading ").remove().end().removeClass("ai1ec-hide")},v=function(){var t=e("#ai1ec_repeat_box").find("ul.ai1ec-nav").find("li.ai1ec-active"),n=e("#ai1ec_repeat_box").find(".ai1ec-end-field");t.hasClass("ai1ec-freq-custom")?n.addClass("ai1ec-hidden"):n.removeClass("ai1ec-hidden"),t.hasClass("ai1ec-freq-monthly")&&l()},m=function(){var t=e("#ai1ec-tab-content").data("activeFreq"),n=e("#ai1ec_recurrence_calendar");e(".ai1ec-freq").removeClass("ai1ec-active"),e(".ai1ec-freq-"+t).addClass("ai1ec-active"),e(document).on("shown.bs.tab",v),o(),v()};return e(document).on("ai1ec.recurrence-modal.inited",m),{show_end_fields:o,trigger_publish:u,handle_click_on_apply_button:a,handle_click_on_cancel_modal:f,handle_checkbox_monthly_tab_modal:l,execute_pseudo_handlers:h,handle_animation_of_calendar_widget:p,handle_click_on_toggle_buttons:c,handle_modal_hide:d}}),timely.define("scripts/add_new_event/event_cost_helper",["jquery_timely","ai1ec_config"],function(e,t){var n=e(".ai1ec-tickets-cost"),r=e(".ai1ec-tickets-url-text"),i=e(".ai1ec-register-url-text");e('input[name="ai1ec_cost_type"]').on("click change",function(){var t=e(".ai1ec-no-tickets"),n=e(".ai1ec-tickets-form, .ai1ec-tickets-list-container"),r=e(".ai1ec-tickets-external");"free"===this.value?(n.hide(),r.hide(),t.show()):"tickets"===this.value?(n.show(),r.hide(),t.hide()):(n.hide(),r.show(),t.show())}),e('input[name="ai1ec_cost_type"]:checked').click(),e("#ai1ec_is_free").on("click",function(){this.checked?(n.addClass("ai1ec-hidden"),r.addClass("ai1ec-hidden"),i.removeClass("ai1ec-hidden")):(n.removeClass("ai1ec-hidden"),r.removeClass("ai1ec-hidden"),i.addClass("ai1ec-hidden"))})}),timely.define("external_libs/jquery.inputdate",["jquery_timely","external_libs/jquery.calendrical_timespan"],function(e,t){function n(e){e.addClass("error").fadeOut("normal",function(){e.val(e.data("timespan.stored")).removeClass("error").fadeIn("fast")})}function r(){e(this).data("timespan.stored",this.value)}function i(e,n,i,s,o){n.val(n.data("timespan.initial_value"));var u=parseInt(n.val());isNaN(parseInt(u))?u=new Date(o):u=new Date(parseInt(u)*1e3),e.val(t.formatDate(u,s)),e.each(r)}var s={start_date_input:"date-input",start_time:"time",twentyfour_hour:!1,date_format:"def",now:new Date},o={init:function(o){var u=e.extend({},s,o),a=e(u.start_date_input),f=e(u.start_time),l=a,c=a;return c.bind("focus.timespan",r),l.calendricalDate({today:new Date(u.now.getFullYear(),u.now.getMonth(),u.now.getDate()),dateFormat:u.date_format,monthNames:u.month_names,dayNames:u.day_names,weekStartDay:u.week_start_day}),l.bind("blur.timespan",function(){var r=t.parseDate(this.value,u.date_format);isNaN(r)?n(e(this)):(e(this).data("timespan.stored",this.value),e(this).val(t.formatDate(r,u.date_format)))}),a.bind("focus.timespan",function(){var e=t.parseDate(a.val(),u.date_format).getTime()/1e3}).bind("blur.timespan",function(){var e=t.parseDate(a.data("timespan.stored"),u.date_format)}),a.closest("form").bind("submit.timespan",function(){var e=t.parseDate(a.val(),u.date_format).getTime()/1e3;isNaN(e)&&(e=""),f.val(e)}),f.data("timespan.initial_value",f.val()),i(a,f,u.twentyfour_hour,u.date_format,u.now),this},reset:function(t){var n=e.extend({},s,t);return i(e(n.start_date_input),e(n.start_time),n.twentyfour_hour,n.date_format,n.now),this},destroy:function(t){return t=e.extend({},s,t),e.each(t,function(t,n){e(n).unbind(".timespan")}),e(t.start_date_input).closest("form").unbind(".timespan"),this}};e.inputdate=function(t){if(o[t])return o[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return o.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timespan")}}),timely.define("external_libs/jquery.tools",["jquery_timely"],function(e){function i(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function s(e,t){var n=parseInt(e.css(t),10);if(n)return n;var r=e[0].currentStyle;return r&&r.width&&parseInt(r.width,10)}function o(e){var t=e.data("events");return t&&t.onSlide}function u(t,n){function x(e,s,o,u){o===undefined?o=s/h*m:u&&(o-=n.min),g&&(o=Math.round(o/g)*g);if(s===undefined||g)s=o*h/m;if(isNaN(o))return r;s=Math.max(0,Math.min(s,h)),o=s/h*m;if(u||!f)o+=n.min;f&&(u?s=h-s:o=n.max-o),o=i(o,y);var a=e.type=="click";if(S&&l!==undefined&&!a){e.type="onSlide",E.trigger(e,[o,s]);if(e.isDefaultPrevented())return r}var c=a?n.speed:0,b=a?function(){e.type="change",E.trigger(e,[o])}:null;return f?(d.animate({top:s},c,b),n.progress&&v.animate({height:h-s+d.height()/2},c)):(d.animate({left:s},c,b),n.progress&&v.animate({width:s+d.width()/2},c)),l=o,p=s,t.val(o),r}function T(){f=n.vertical||s(a,"height")>s(a,"width"),f?(h=s(a,"height")-s(d,"height"),c=a.offset().top+h):(h=s(a,"width")-s(d,"width"),c=a.offset().left)}function N(){T(),r.setValue(n.value!==undefined?n.value:n.min)}var r=this,u=n.css,a=e("<div><div/><a href='#'/></div>").data("rangeinput",r),f,l,c,h,p;t.before(a);var d=a.addClass(u.slider).find("a").addClass(u.handle),v=a.find("div").addClass(u.progress);e.each("min,max,step,value".split(","),function(e,r){var i=t.attr(r);parseFloat(i)&&(n[r]=parseFloat(i,10))});var m=n.max-n.min,g=n.step=="any"?0:n.step,y=n.precision;y===undefined&&(y=g.toString().split("."),y=y.length===2?y[1].length:0);if(t.attr("type")=="range"){var b=t.clone().wrap("<div/>").parent().html(),w=e(b.replace(/type/i,"type=text data-orig-type"));w.val(n.value),t.replaceWith(w),t=w}t.addClass(u.input);var E=e(r).add(t),S=!0;e.extend(r,{getValue:function(){return l},setValue:function(t,n){return T(),x(n||e.Event("api"),undefined,t,!0)},getConf:function(){return n},getProgress:function(){return v},getHandle:function(){return d},getInput:function(){return t},step:function(t,i){i=i||e.Event();var s=n.step=="any"?1:n.step;r.setValue(l+s*(t||1),i)},stepUp:function(e){return r.step(e||1)},stepDown:function(e){return r.step(-e||-1)}}),e.each("onSlide,change".split(","),function(t,i){e.isFunction(n[i])&&e(r).on(i,n[i]),r[i]=function(t){return t&&e(r).on(i,t),r}}),d.drag({drag:!1}).on("dragStart",function(){T(),S=o(e(r))||o(t)}).on("drag",function(e,n,r){if(t.is(":disabled"))return!1;x(e,f?n:r)}).on("dragEnd",function(e){e.isDefaultPrevented()||(e.type="change",E.trigger(e,[l]))}).click(function(e){return e.preventDefault()}),a.click(function(e){if(t.is(":disabled")||e.target==d[0])return e.preventDefault();T();var n=f?d.height()/2:d.width()/2;x(e,f?h-c-n+e.pageY:e.pageX-c-n)}),n.keyboard&&t.keydown(function(n){if(t.attr("readonly"))return;var i=n.keyCode,s=e([75,76,38,33,39]).index(i)!=-1,o=e([74,72,40,34,37]).index(i)!=-1;if((s||o)&&!(n.shiftKey||n.altKey||n.ctrlKey))return s?r.step(i==33?10:1,n):o&&r.step(i==34?-10:-1,n),n.preventDefault()}),t.blur(function(t){var n=e(this).val();n!==l&&r.setValue(n,t)}),e.extend(t[0],{stepUp:r.stepUp,stepDown:r.stepDown}),N(),h||e(window).load(N)}e.tools=e.tools||{version:"1.2.7"};var t;t=e.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:undefined,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var n,r;e.fn.drag=function(t){return document.ondragstart=function(){return!1},t=e.extend({x:!0,y:!0,drag:!0},t),n=n||e(document).on("mousedown mouseup",function(i){var s=e(i.target);if(i.type=="mousedown"&&s.data("drag")){var o=s.position(),u=i.pageX-o.left,a=i.pageY-o.top,f=!0;n.on("mousemove.drag",function(e){var n=e.pageX-u,i=e.pageY-a,o={};t.x&&(o.left=n),t.y&&(o.top=i),f&&(s.trigger("dragStart"),f=!1),t.drag&&s.css(o),s.trigger("drag",[i,n]),r=s}),i.preventDefault()}else try{r&&r.trigger("dragEnd")}finally{n.off("mousemove.drag"),r=null}}),this.data("drag",!0)},e.expr[":"].range=function(t){var n=t.getAttribute("type");return n&&n=="range"||!!e(t).filter("input").data("rangeinput")},e.fn.rangeinput=function(n){if(this.data("rangeinput"))return this;n=e.extend(!0,{},t.conf,n);var r;return this.each(function(){var t=new u(e(this),e.extend(!0,{},n)),i=t.getInput().data("rangeinput",t);r=r?r.add(i):i}),r?r:this}}),timely.define("external_libs/locales/bootstrap-datepicker.bg",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.bg={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.br",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.br={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.cs",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.cs={days:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota","Nedle"],daysShort:["Ned","Pon","te","St","tv","Pt","Sob","Ned"],daysMin:["Ne","Po","t","St","t","P","So","Ne"],months:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],monthsShort:["Led","no","Be","Dub","Kv","er","nc","Srp","Z","j","Lis","Pro"],today:"Dnes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.da",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.da={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",clear:"Nulstil"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.de",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Lschen",weekStart:1,format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.es",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado","Domingo"],daysShort:["Dom","Lun","Mar","Mi","Jue","Vie","Sb","Dom"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fi",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fi={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai","sunnuntai"],daysShort:["sun","maa","tii","kes","tor","per","lau","sun"],daysMin:["su","ma","ti","ke","to","pe","la","su"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tnn",weekStart:1,format:"d.m.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],daysMin:["D","L","Ma","Me","J","V","S","D"],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],monthsShort:["Jan","Fv","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Dc"],today:"Aujourd'hui",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.id",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.id={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab","Mgu"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa","Mg"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.is",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.is={days:["Sunnudagur","Mnudagur","rijudagur","Mivikudagur","Fimmtudagur","Fstudagur","Laugardagur","Sunnudagur"],daysShort:["Sun","Mn","ri","Mi","Fim","Fs","Lau","Sun"],daysMin:["Su","M","r","Mi","Fi","F","La","Su"],months:["Janar","Febrar","Mars","Aprl","Ma","Jn","Jl","gst","September","Oktber","Nvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Ma","Jn","Jl","g","Sep","Okt","Nv","Des"],today:" Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.it",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.it={days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato","Domenica"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab","Dom"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa","Do"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ja",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ja={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],today:"",format:"yyyy/mm/dd"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.kr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.kr={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lt={days:["Sekmadienis","Pirmadienis","Antradienis","Treiadienis","Ketvirtadienis","Penktadienis","etadienis","Sekmadienis"],daysShort:["S","Pr","A","T","K","Pn","","S"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","t","Sk"],months:["Sausis","Vasaris","Kovas","Balandis","Gegu","Birelis","Liepa","Rugpjtis","Rugsjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"iandien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lv={days:["Svtdiena","Pirmdiena","Otrdiena","Trediena","Ceturtdiena","Piektdiena","Sestdiena","Svtdiena"],daysShort:["Sv","P","O","T","C","Pk","S","Sv"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se","Sv"],months:["Janvris","Februris","Marts","Aprlis","Maijs","Jnijs","Jlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],today:"odien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ms",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ms={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu","Ahad"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab","Aha"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa","Ah"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nb",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nb={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nl={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pl={days:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota","Niedziela"],daysShort:["Nie","Pn","Wt","r","Czw","Pt","So","Nie"],daysMin:["N","Pn","Wt","r","Cz","Pt","So","N"],months:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],monthsShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],today:"Dzisiaj",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt-BR",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["pt-BR"]={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pt={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ru",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ru={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sl={days:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota","Nedelja"],daysShort:["Ned","Pon","Tor","Sre","et","Pet","Sob","Ned"],daysMin:["Ne","Po","To","Sr","e","Pe","So","Ne"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sv={days:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Mn","Tis","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","M","Ti","On","To","Fr","L","S"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",format:"yyyy-mm-dd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.th",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.th={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["..","..","..","..","..","..","..","..","..","..","..",".."],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.tr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.tr={days:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],daysShort:["Pz","Pzt","Sal","r","Pr","Cu","Cts","Pz"],daysMin:["Pz","Pzt","Sa","r","Pr","Cu","Ct","Pz"],months:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],monthsShort:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],today:"Bugn",format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-CN",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-CN"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-TW",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-TW"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/bootstrap_datepicker",["jquery_timely","ai1ec_config","external_libs/locales/bootstrap-datepicker.bg","external_libs/locales/bootstrap-datepicker.br","external_libs/locales/bootstrap-datepicker.cs","external_libs/locales/bootstrap-datepicker.da","external_libs/locales/bootstrap-datepicker.de","external_libs/locales/bootstrap-datepicker.es","external_libs/locales/bootstrap-datepicker.fi","external_libs/locales/bootstrap-datepicker.fr","external_libs/locales/bootstrap-datepicker.id","external_libs/locales/bootstrap-datepicker.is","external_libs/locales/bootstrap-datepicker.it","external_libs/locales/bootstrap-datepicker.ja","external_libs/locales/bootstrap-datepicker.kr","external_libs/locales/bootstrap-datepicker.lt","external_libs/locales/bootstrap-datepicker.lv","external_libs/locales/bootstrap-datepicker.ms","external_libs/locales/bootstrap-datepicker.nb","external_libs/locales/bootstrap-datepicker.nl","external_libs/locales/bootstrap-datepicker.pl","external_libs/locales/bootstrap-datepicker.pt-BR","external_libs/locales/bootstrap-datepicker.pt","external_libs/locales/bootstrap-datepicker.ru","external_libs/locales/bootstrap-datepicker.sl","external_libs/locales/bootstrap-datepicker.sv","external_libs/locales/bootstrap-datepicker.th","external_libs/locales/bootstrap-datepicker.tr","external_libs/locales/bootstrap-datepicker.zh-CN","external_libs/locales/bootstrap-datepicker.zh-TW"],function(e,t){function r(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return r(e.getFullYear(),e.getMonth(),e.getDate())}function s(e){return function(){return this[e].apply(this,arguments)}}function f(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r)n.test(u)&&(s=u.replace(o,function(e,t){return t.toLowerCase()}),i[s]=r[u]);return i}function l(t){var n={};if(!d[t]){t=t.split("-")[0];if(!d[t])return}var r=d[t];return e.each(p,function(e,t){t in r&&(n[t]=r[t])}),n}var n=e(window),o=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){var t=e&&e.valueOf();for(var n=0,r=this.length;n<r;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){if(!t)return;e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t)},clear:function(){this.splice(0)},copy:function(){var e=new o;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),u=function(t,n){this.dates=new o,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".ai1ec-date")?this.element.find(".ai1ec-input-group, .ai1ec-input-group-addon, .ai1ec-btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(v.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("ai1ec-datepicker-inline").appendTo(this.element):this.picker.addClass("ai1ec-datepicker-dropdown ai1ec-dropdown-menu"),this.o.rtl&&this.picker.addClass("ai1ec-datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.ai1ec-today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};u.prototype={constructor:u,_process_options:function(n){this._o=e.extend({},this._o,n);var r=this.o=e.extend({},this._o),i=r.language;d[i]||(i=i.split("-")[0],d[i]||(i=t.language,d[i]||(i=h.language))),r.language=i;switch(r.startView){case 2:case"decade":r.startView=2;break;case 1:case"year":r.startView=1;break;default:r.startView=0}switch(r.minViewMode){case 1:case"months":r.minViewMode=1;break;case 2:case"years":r.minViewMode=2;break;default:r.minViewMode=0}r.startView=Math.max(r.startView,r.minViewMode),r.multidate!==!0&&(r.multidate=Number(r.multidate)||!1,r.multidate!==!1?r.multidate=Math.max(0,r.multidate):r.multidate=1),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7;var s=v.parseFormat(r.format);r.startDate!==-Infinity&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=v.parseDate(r.startDate,s,r.language):r.startDate=-Infinity),r.endDate!==Infinity&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=v.parseDate(r.endDate,s,r.language):r.endDate=Infinity),r.daysOfWeekDisabled=r.daysOfWeekDisabled||[],e.isArray(r.daysOfWeekDisabled)||(r.daysOfWeekDisabled=r.daysOfWeekDisabled.split(/[,\s]*/)),r.daysOfWeekDisabled=e.map(r.daysOfWeekDisabled,function(e){return parseInt(e,10)});var o=String(r.orientation).toLowerCase().split(/\s+/g),u=r.orientation.toLowerCase();o=e.grep(o,function(e){return/^auto|left|right|top|bottom$/.test(e)}),r.orientation={x:"auto",y:"auto"};if(!!u&&u!=="auto")if(o.length===1)switch(o[0]){case"top":case"bottom":r.orientation.y=o[0];break;case"left":case"right":r.orientation.x=o[0]}else u=e.grep(o,function(e){return/^left|right$/.test(e)}),r.orientation.x=u[0]||"auto",u=e.grep(o,function(e){return/^top|bottom$/.test(e)}),r.orientation.y=u[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(r=undefined,i=e[t][1]):e[t].length==3&&(r=e[t][1],i=e[t][2]),n.on(i,r)},_unapplyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(i=undefined,r=e[t][1]):e[t].length==3&&(i=e[t][1],r=e[t][2]),n.off(r,i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.dates.get(-1),i=this._utc_to_local(r);this.element.trigger({type:t,date:i,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){arguments.length===0?(e=this.dates.length-1,t=this.o.format):typeof e=="string"&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return v.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide")},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+e.getTimezoneOffset()*6e4)},_local_to_utc:function(e){return e&&new Date(e.getTime()-e.getTimezoneOffset()*6e4)},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){this.update.apply(this,arguments),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){this.update.apply(this,e.map(arguments,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(t){t===undefined&&(t=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return v.formatDate(e,t,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=this.picker.outerWidth(),r=this.picker.outerHeight(),i=10,s=n.width(),o=n.height(),u=n.scrollTop(),a=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,f=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=f.left,p=f.top;this.picker.removeClass("ai1ec-datepicker-orient-top ai1ec-datepicker-orient-bottom ai1ec-datepicker-orient-right ai1ec-datepicker-orient-left"),this.o.orientation.x!=="auto"?(this.picker.addClass("ai1ec-datepicker-orient-"+this.o.orientation.x),this.o.orientation.x==="right"&&(h-=t-c)):(this.picker.addClass("ai1ec-datepicker-orient-left"),f.left<0?h-=f.left-i:f.left+t>s&&(h=s-t-i));var d=this.o.orientation.y,v,m;d==="auto"&&(v=-u+f.top-r,m=u+o-(f.top+l+r),Math.max(v,m)===m?d="top":d="bottom"),this.picker.addClass("ai1ec-datepicker-orient-"+d),d==="top"?p+=l:p-=r+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:h,zIndex:a})},_allow_update:!0,update:function(){if(!this._allow_update)return;var t=this.dates.copy(),n=[],r=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),r=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n&&this.o.multidate?n=n.split(this.o.multidateSeparator):n=[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return v.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),r?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="ai1ec-cw">&nbsp;</th>';t+=n,this.picker.find(".ai1ec-datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7)t+='<th class="ai1ec-dow">'+d[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".ai1ec-datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="ai1ec-month">'+d[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".ai1ec-datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i?n.push("ai1ec-old"):(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i)&&n.push("ai1ec-new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("ai1ec-focused"),this.o.todayHighlight&&t.getUTCFullYear()==s.getFullYear()&&t.getUTCMonth()==s.getMonth()&&t.getUTCDate()==s.getDate()&&n.push("ai1ec-today"),this.dates.contains(t)!==-1&&n.push("ai1ec-active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("ai1ec-disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("ai1ec-range"),e.inArray(t.valueOf(),this.range)!=-1&&n.push("ai1ec-selected")),n},fill:function(){var t=new Date(this.viewDate),n=t.getUTCFullYear(),i=t.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f,l;this.picker.find(".ai1ec-datepicker-days thead th.ai1ec-datepicker-switch").text(d[this.o.language].months[i]+" "+n),this.picker.find("tfoot th.ai1ec-today").text(d[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.ai1ec-clear").text(d[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var c=r(n,i-1,28),h=v.getDaysInMonth(c.getUTCFullYear(),c.getUTCMonth());c.setUTCDate(h),c.setUTCDate(h-(c.getUTCDay()-this.o.weekStart+7)%7);var p=new Date(c);p.setUTCDate(p.getUTCDate()+42),p=p.valueOf();var m=[],g;while(c.valueOf()<p){if(c.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+c+(this.o.weekStart-c.getUTCDay()-7)%7*864e5),b=new Date(+y+(11-y.getUTCDay())%7*864e5),w=new Date(+(w=r(b.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="ai1ec-cw">'+E+"</td>")}}g=this.getClassNames(c),g.push("ai1ec-day");if(this.o.beforeShowDay!==e.noop){var S=this.o.beforeShowDay(this._utc_to_local(c));S===undefined?S={}:typeof S=="boolean"?S={enabled:S}:typeof S=="string"&&(S={classes:S}),S.enabled===!1&&g.push("ai1ec-disabled"),S.classes&&(g=g.concat(S.classes.split(/\s+/))),S.tooltip&&(f=S.tooltip)}g=e.unique(g),m.push('<td class="'+g.join(" ")+'"'+(f?' title="'+f+'"':"")+">"+c.getUTCDate()+"</td>"),c.getUTCDay()==this.o.weekEnd&&m.push("</tr>"),c.setUTCDate(c.getUTCDate()+1)}this.picker.find(".ai1ec-datepicker-days tbody").empty().append(m.join(""));var x=this.picker.find(".ai1ec-datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("ai1ec-active");e.each(this.dates,function(e,t){t.getUTCFullYear()==n&&x.eq(t.getUTCMonth()).addClass("ai1ec-active")}),(n<s||n>u)&&x.addClass("ai1ec-disabled"),n==s&&x.slice(0,o).addClass("ai1ec-disabled"),n==u&&x.slice(a+1).addClass("ai1ec-disabled"),m="",n=parseInt(n/10,10)*10;var T=this.picker.find(".ai1ec-datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;var N=e.map(this.dates,function(e){return e.getUTCFullYear()}),C;for(var k=-1;k<11;k++)C=["ai1ec-year"],k===-1?C.push("ai1ec-old"):k===10&&C.push("ai1ec-new"),e.inArray(n,N)!==-1&&C.push("ai1ec-active"),(n<s||n>u)&&C.push("ai1ec-disabled"),m+='<span class="'+C.join(" ")+'">'+n+"</span>",n+=1;T.html(m)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"})}},click:function(t){t.preventDefault();var n=e(t.target).closest("span, td, th"),i,s,o;if(n.length==1)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"ai1ec-datepicker-switch":this.showMode(1);break;case"ai1ec-prev":case"ai1ec-next":var u=v.modes[this.viewMode].navStep*(n[0].className=="ai1ec-prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,u),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,u),this.viewMode===1&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"ai1ec-today":var a=new Date;a=r(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var f=this.o.todayBtn=="linked"?null:"view";this._setDate(a,f);break;case"ai1ec-clear":var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input")),l&&l.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":n.is(".ai1ec-disabled")||(this.viewDate.setUTCDate(1),n.is(".ai1ec-month")?(o=1,s=n.parent().find("span").index(n),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1&&this._setDate(r(i,s,o))):(o=1,s=0,i=parseInt(n.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(r(i,s,o))),this.showMode(-1),this.fill());break;case"td":n.is(".ai1ec-day")&&!n.is(".ai1ec-disabled")&&(o=parseInt(n.text(),10)||1,i=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),n.is(".ai1ec-old")?s===0?(s=11,i-=1):s-=1:n.is(".ai1ec-new")&&(s==11?(s=0,i+=1):s+=1),this._setDate(r(i,s,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);e?t!==-1?this.dates.remove(t):this.dates.push(e):this.dates.clear();if(typeof this.o.multidate=="number")while(this.dates.length>this.o.multidate)this.dates.remove(0)},_setDate:function(e,t){(!t||t=="date")&&this._toggle_multidate(e&&new Date(e));if(!t||t=="view")this.viewDate=e&&new Date(e);this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),this.o.autoclose&&(!t||t=="date")&&this.hide()},moveMonth:function(e,t){if(!e)return undefined;if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,s,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n),s=new Date(o),s.setUTCDate(o.getUTCDate()+n)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n*7),s=new Date(o),s.setUTCDate(o.getUTCDate()+n*7)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:o=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(o),t=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(t){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".ai1ec-datepicker-"+v.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var a=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};a.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(this.updating)return;this.updating=!0;var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1)return;e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(r)});if(r<this.dates[i])while(i>=0&&r<this.dates[i])this.pickers[i--].setUTCDate(r);else if(r>this.dates[i])while(i<s&&r>this.dates[i])this.pickers[i++].setUTCDate(r);this.updateDates(),delete this.updating},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var c=e.fn.datepicker;e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof t=="object"&&t;if(!s){var c=f(this,"date"),p=e.extend({},h,c,o),d=l(p.language),v=e.extend({},h,d,c,o);if(i.is(".ai1ec-input-daterange")||v.inputs){var m={inputs:v.inputs||i.find("input").toArray()};i.data("datepicker",s=new a(this,e.extend(v,m)))}else i.data("datepicker",s=new u(this,v))}if(typeof t=="string"&&typeof s[t]=="function"){r=s[t].apply(s,n);if(r!==undefined)return!1}}),r!==undefined?r:this};var h=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=u;var d=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},v={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,v.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(t,n,i){if(!t)return undefined;if(t instanceof Date)return t;typeof n=="string"&&(n=v.parseFormat(n));if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){var s=/([\-+]\d+)([dmwy])/,o=t.match(/([\-+]\d+)([dmwy])/g),a,f;t=new Date;for(var l=0;l<o.length;l++){a=s.exec(o[l]),f=parseInt(a[1]);switch(a[2]){case"d":t.setUTCDate(t.getUTCDate()+f);break;case"m":t=u.prototype.moveMonth.call(u.prototype,t,f);break;case"w":t.setUTCDate(t.getUTCDate()+f*7);break;case"y":t=u.prototype.moveYear.call(u.prototype,t,f)}}return r(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}var o=t&&t.match(this.nonpunctuation)||[],t=new Date,c={},h=["yyyy","yy","M","MM","m","mm","d","dd"],p={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;p.M=p.MM=p.mm=p.m,p.dd=p.d,t=r(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var y=n.parts.slice();o.length!=y.length&&(y=e(y).filter(function(t,n){return e.inArray(n,h)!==-1}).toArray());if(o.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(o[l],10),a=y[l];if(isNaN(m))switch(a){case"MM":g=e(d[i].months).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].months)+1;break;case"M":g=e(d[i].monthsShort).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].monthsShort)+1}c[a]=m}for(var l=0,w,E;l<h.length;l++)E=h[l],E in c&&!isNaN(c[E])&&(w=new Date(t),p[E](w,c[E]),isNaN(w)||(t=w))}return t},formatDate:function(t,n,r){if(!t)return"";typeof n=="string"&&(n=v.parseFormat(n));var i={d:t.getUTCDate(),D:d[r].daysShort[t.getUTCDay()],DD:d[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:d[r].monthsShort[t.getUTCMonth()],MM:d[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="ai1ec-prev"><i class="ai1ec-fa ai1ec-fa-arrow-left"></i></th><th colspan="5" class="ai1ec-datepicker-switch"></th><th class="ai1ec-next"><i class="ai1ec-fa ai1ec-fa-arrow-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="ai1ec-today"></th></tr><tr><th colspan="7" class="ai1ec-clear"></th></tr></tfoot>'};v.template='<div class="timely ai1ec-datepicker"><div class="ai1ec-datepicker-days"><table class=" ai1ec-table-condensed">'+v.headTemplate+"<tbody></tbody>"+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-months">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-years">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=v,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=c,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),n.datepicker("show")}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()});for(var m=2,g=arguments.length;m<g;m++)arguments[m].localize()}),timely.define("external_libs/bootstrap/transition",["jquery_timely"],function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})}),timely.define("external_libs/bootstrap/collapse",["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("ai1ec-width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("ai1ec-in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .ai1ec-panel > .ai1ec-in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("ai1ec-collapse").addClass("ai1ec-collapsing")[i](0),this.transitioning=1;var s=function(){this.$element.removeClass("ai1ec-collapsing").addClass("ai1ec-in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("ai1ec-in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("ai1ec-collapsing").removeClass("ai1ec-collapse").removeClass("ai1ec-in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("ai1ec-collapsing").addClass("ai1ec-collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)},t.prototype.toggle=function(){this[this.$element.hasClass("ai1ec-in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=ai1ec-collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning)f&&f.find('[data-toggle=ai1ec-collapse][data-parent="'+a+'"]').not(n).addClass("ai1ec-collapsed"),n[s.hasClass("ai1ec-in")?"addClass":"removeClass"]("ai1ec-collapsed");s.collapse(u)})}),timely.define("external_libs/bootstrap/modal",["jquery_timely"],function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r);if(this.isShown||r.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="ai1ec-modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("ai1ec-fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("ai1ec-in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".ai1ec-modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)})},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("ai1ec-in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("ai1ec-fade")?"ai1ec-fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="ai1ec-modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("ai1ec-in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("ai1ec-in"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="ai1ec-modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".ai1ec-modal",function(){e(document.body).addClass("ai1ec-modal-open")}).on("hidden.bs.modal",".ai1ec-modal",function(){e(document.body).removeClass("ai1ec-modal-open")})}),timely.define("external_libs/bootstrap/alert",["jquery_timely"],function(e){var t='[data-dismiss="ai1ec-alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed.bs.alert").remove()}var n=e(this),r=n.attr("data-target");r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var i=e(r);t&&t.preventDefault(),i.length||(i=n.hasClass("ai1ec-alert")?n:n.parent()),i.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;i.removeClass("ai1ec-in"),e.support.transition&&i.hasClass("ai1ec-fade")?i.one(e.support.transition.end,s).emulateTransitionEnd(150):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}),timely.define("external_libs/select2",["jquery_timely"],function(e){(function(e){typeof e.fn.each2=="undefined"&&e.fn.extend({each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})})(e),function(e,t){function l(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(c(e,t[n]))return n;return-1}function c(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e===n+"":n.constructor===String?n===e+"":!1}function h(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r}function p(e){return e.outerWidth(!1)-e.width()}function d(n){var r="keyup-change-value";n.bind("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.bind("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function v(n){n.bind("mousemove",function(n){var r=a;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function m(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function g(e){var t=!1,n;return function(){return t===!1&&(n=e(),t=!0),n}}function y(e,t){var n=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){l(e.target,t.get())>=0&&n(e)})}function b(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus(),t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",n),r.select())},0)}function w(e){e.preventDefault(),e.stopPropagation()}function E(e){e.preventDefault(),e.stopImmediatePropagation()}function S(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),u.attr("class","select2-sizer"),e("body").append(u)}return u.text(t.val()),u.width()}function x(t,n,r){var i,s=[],o;i=t.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")===0&&s.push(this)}),i=n.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),typeof o=="string"&&o.length>0&&s.push(this))}),t.attr("class",s.join(" "))}function T(e,t,n,r){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function N(t){var n,r=0,i=null,s=t.quietMillis||100,o=t.url,u=this;return function(a){window.clearTimeout(n),n=window.setTimeout(function(){r+=1;var n=r,s=t.data,f=o,l=t.transport||e.ajax,c=t.type||"GET",h={};s=s?s.call(u,a.term,a.page,a.context):null,f=typeof f=="function"?f.call(u,a.term,a.page,a.context):f,null!==i&&i.abort(),t.params&&(e.isFunction(t.params)?e.extend(h,t.params.call(u)):e.extend(h,t.params)),e.extend(h,{url:f,dataType:t.dataType,data:s,type:c,cache:!1,success:function(e){if(n<r)return;var i=t.results(e,a.page);a.callback(i)}}),i=l.call(u,h)},s)}}function C(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=n.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function k(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o)}}function L(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function A(t){return e.isFunction(t)?t():t}function O(t){var n=0;return e.each(t,function(e,t){t.children?n+=O(t.children):n++}),n}function M(e,n,r,i){var s=e,o=!1,u,a,f,l,h;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){h=i.tokenSeparators[f],a=e.indexOf(h);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+h.length);if(u.length>0){u=i.createSearchChoice(u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(c(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function _(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}var n,r,i,s,o,u,a,f;n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},f=e(document),o=function(){var e=1;return function(){return e++}}(),f.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}}),r=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results",u;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=g(function(){return n.element.closest("body")}),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(A(n.containerCss)),this.container.addClass(A(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabIndex"),this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(A(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=r=this.container.find(s),this.search=i=this.container.find("input.select2-input"),i.attr("tabIndex",this.elementTabIndex),this.resultsPage=0,this.context=null,this.initContainer(),v(this.results),this.dropdown.delegate(s,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent)),y(80,this.results),this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop(),o;i>0&&s-i<=0?(r.scrollTop(0),w(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),w(e))}),d(i),i.bind("keyup-change input paste",this.bind(this.updateResults)),i.bind("focus",function(){i.addClass("select2-focused")}),i.bind("blur",function(){i.removeClass("select2-focused")}),this.dropdown.delegate(s,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show())},prepareOpts:function(n){var r,i,s,o;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,s){var o,u,a,f,l=this.opts.id,c=this;o=function(r,i,u){var a,f,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(a=0,f=r.length;a<f;a+=1)h=r[a],d=h.disabled===!0,p=!d&&l(h)!==t,v=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+u),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(c.opts.formatResultCssClass(h)),g=e(document.createElement("div")),g.addClass("select2-result-label"),b=n.formatResult(h,g,s,c.opts.escapeMarkup),b!==t&&g.html(b),m.append(g),v&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),o(h.children,y,u+1),m.append(y)),m.data("select2-data",h),i.append(m)},o(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(s=n.id,n.id=function(e){return e[s]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.attr("data-select2-tags")}i?(n.query=this.bind(function(n){var i={results:[],more:!1},s=n.term,o,u,a;a=function(e,t){var r;e.is("option")?n.matcher(s,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:c(e.attr("disabled"),"disabled")}):e.is("optgroup")&&(r={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){a(t,r.children)}),r.children.length>0&&t.push(r))},o=r.children(),this.getPlaceholder()!==t&&o.length>0&&(u=o[0],e(u).text()===""&&(o=o.not(u))),o.each2(function(e,t){a(t,i.results)}),n.callback(i)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(o=n.element.data("ajax-url"),o&&o.length>0&&(n.ajax.url=o),n.query=N.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=k(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(h(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){if(c(this.id,t))return r=this.text,!1}),i.push({id:t,text:r})}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var e,t,n=this;e=this.opts.element.attr("disabled")!=="disabled",t=this.opts.element.attr("readonly")==="readonly",e=e&&!t,this.enabled!==e&&(e?this.enable():this.disable()),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),e.bind("propertychange.select2 DOMAttrModified.select2",t),typeof WebKitMutationObserver!="undefined"&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)}),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=this.dropdown.outerHeight(!1),s=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),u=t.top+n,a=t.left,f=u+i<=o,l=t.top-i>=this.body().scrollTop(),c=this.dropdown.outerWidth(!1),h=a+c<=s,p=this.dropdown.hasClass("select2-drop-above"),d,v,m;this.body().css("position")!=="static"&&(d=this.body().offset(),u-=d.top,a-=d.left),p?(v=!0,!l&&f&&(v=!1)):(v=!1,!f&&l&&(v=!0)),h||(a=t.left+r-c),v?(u=t.top-i,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),m=e.extend({top:u,left:a,width:r},A(this.opts.dropdownCss)),this.dropdown.css(m)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.clearDropdownAlignmentPreference(),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.updateResults(!0),s=e("#select2-drop-mask"),s.length==0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body()),s.bind("mousedown touchstart",function(t){var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),s.show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible();var o=this;this.container.parents().add(window).each(function(){e(this).bind(r+" "+n+" "+i,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),o.positionDropdown()})}),this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(n).unbind(r).unbind(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices(),i=e(n[r]),s=i.offset().top+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!0),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=i.offset().top-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return l(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),r=e(n[t]),r.addClass("select2-highlighted"),this.ensureHighlightVisible(),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"highlight",val:this.id(i),choice:i})},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=-1,i=this.resultsPage+1,s=this,o=this.search.val(),u=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:u,matcher:this.opts.matcher,callback:this.bind(function(n){if(!s.opened())return;s.opts.populateResults.call(this,e,n.results,{term:o,page:i,context:u}),n.more===!0?(t.detach().appendTo(e).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):t.remove(),s.positionDropdown(),s.resultsPage=i,s.context=n.context})}))},tokenize:function(){},updateResults:function(n){function f(){i.scrollTop(0),r.removeClass("select2-active"),u.positionDropdown()}function l(e){i.html(e),f()}var r=this.search,i=this.results,s=this.opts,o,u=this,a;if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;r.addClass("select2-active");var h=this.getMaximumSelectionSize();if(h>=1){o=this.data();if(e.isArray(o)&&o.length>=h&&L(s.formatSelectionTooBig,"formatSelectionTooBig")){l("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(h)+"</li>");return}}if(r.val().length<s.minimumInputLength){L(s.formatInputTooShort,"formatInputTooShort")?l("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>"):l("");return}s.formatSearching()&&n===!0&&l("<li class='select2-searching'>"+s.formatSearching()+"</li>");if(s.maximumInputLength&&r.val().length>s.maximumInputLength){L(s.formatInputTooLong,"formatInputTooLong")?l("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>"):l("");return}a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(null,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return c(u.id(this),u.id(a))}).length===0&&o.results.unshift(a));if(o.results.length===0&&L(s.formatNoMatches,"formatNoMatches")){l("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&L(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),f()})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){b(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r&&(this.highlight(t),this.onSelect(r,e))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,r,i,s,o;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s+=1){i=r[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(i!==null&&i.length>=1)return i[1]}}return this.opts.width==="resolve"?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);r!==null&&this.container.css("width",r)}}),i=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments),this.focusser.attr("disabled","disabled"),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),b(this.focusser)},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var e,t=this.container,r=this.dropdown,i=!1;this.showSearch(this.opts.minimumResultsForSearch>=0),this.selection=e=t.find(".select2-choice"),this.focusser=t.find(".select2-focusser"),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.TAB:case n.ENTER:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}})),this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC)return;if(this.opts.openOnEnter===!1&&e.which===n.ENTER){w(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){this.open(),w(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){this.opts.allowClear&&this.clear(),w(e);return}})),d(this.focusser),this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open(),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.focusser.val(""),w(e)})),e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear(),E(e),this.close(),this.selection.focus()})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?this.close():this.enabled&&this.open(),w(e),i=!1})),r.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(e){w(e)})),this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active")})),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),this.opts.element.trigger({type:"removed",val:this.id(e),choice:e}),this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()==="")this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(t,n){var r=t.find(":selected");e.isFunction(n)&&n({id:r.attr("value"),text:r.text(),element:r})}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val();t.query({matcher:function(e,n,r){return c(i,t.id(r))},callback:e.isFunction(r)?function(e){r(e.results.length?e.results[0]:null)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.select.find("option").first().text()!==""?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,t){var n=0,r=this,i=!0;this.findHighlightableChoices().each2(function(e,t){if(c(r.id(t.data("select2-data")),r.opts.element.val()))return n=e,!1}),this.highlight(n);if(t===!0){var s=this.opts.minimumResultsForSearch;i=s<0?!1:O(e.results)>=s,this.showSearch(i)}},showSearch:function(t){this.showSearchInput=t,this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var n=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.close(),(!t||!t.noFocus)&&this.selection.focus(),c(n,this.id(e))||this.triggerChange()},updateSelection:function(e){var n=this.selection.find("span"),r;this.selection.data("select2-data",e),n.empty(),r=this.opts.formatSelection(e,n),r!==t&&n.append(this.opts.escapeMarkup(r)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=!1,r=null,i=this;if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1]);if(this.select)this.select.val(e).find(":selected").each2(function(e,t){return r={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e&&e!==0){this.clear(),n&&this.triggerChange();return}this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange()})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;!e||e===""?this.clear():(this.opts.element.val(e?this.id(e):""),this.updateSelection(e))}}),s=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var n=[];e.find(":selected").each2(function(e,t){n.push({id:t.attr("value"),text:t.text(),element:t[0]})}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=h(n.val(),t.separator);t.query({matcher:function(n,r,s){return e.grep(i,function(e){return c(e,t.id(s))}).length},callback:e.isFunction(r)?function(e){r(e.results)}:e.noop})}),t},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(t),this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;this.opened()||this.open()})),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.BACKSPACE&&this.search.val()===""){this.close();var t,i=r.find(".select2-search-choice-focus");if(i.length>0){this.unselect(i.first()),this.search.width(10),w(e);return}t=r.find(".select2-search-choice:not(.select2-locked)"),t.length>0&&t.last().addClass("select2-search-choice-focus")}else r.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.ENTER:case n.TAB:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC)return;if(e.which===n.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN)&&w(e)})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.opened()||this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()})),this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0)},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus(),this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){l(i.id(this),n)<0&&(n.push(i.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){i.addSelectedChoice(this)}),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a=this.getVal(),f;f=this.opts.formatSelection(n,o.find("div")),f!=t&&o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(f)+"</div>"),r&&o.find(".select2-search-choice-close").bind("mousedown",w).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),w(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),a.push(u),this.setVal(a)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";n=e.data("select2-data");if(!n)return;r=l(this.id(n).toString(),t),r>=0&&(t.splice(r,1),this.setVal(t),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(n),choice:n}),this.triggerChange({removed:n})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),n=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,n){var i=r.id(n.data("select2-data"));l(i,e)>=0&&(n.addClass("select2-selected"),n.find(".select2-result-selectable").addClass("select2-selected"))}),n.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&r.highlight(0)},resizeSearch:function(){var e,t,n,r,i,s=p(this.search);e=S(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(i)},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),h(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){l(this,n)<0&&n.push(this)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator)))},val:function(){var n,r=!1,i=[],s=this;if(arguments.length===0)return this.getVal();n=arguments[0],arguments.length>1&&(r=arguments[1]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange();return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n=this,r;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();t||(t=[]),r=e.map(t,function(e){return n.opts.id(e)}),this.setVal(r),this.updateSelection(t),this.clearSearch()}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?a=r.element.attr("multiple"):(a=r.multiple||!1,"tags"in r&&(r.multiple=a=!0)),o=a?new s:new i,o.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(l(n[0],f)<0)throw"Unknown method: "+n[0];u=t,o=e(this).data("select2");if(o===t)return;n[0]==="container"?u=o.container:u=o[n[0]].apply(o,n.slice(1));if(u!==t)return!1}}),u===t?this:u},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return T(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n){return e?e.text:t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please enter "+n+" less character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}}}(e)}),timely.define("scripts/add_new_event",["jquery_timely","domReady","libs/utils","ai1ec_config","scripts/add_new_event/event_location/gmaps_helper","scripts/add_new_event/event_location/input_coordinates_event_handlers","scripts/add_new_event/event_location/input_coordinates_utility_functions","scripts/add_new_event/event_date_time/date_time_event_handlers","scripts/add_new_event/event_cost_helper","external_libs/jquery.calendrical_timespan","external_libs/jquery.inputdate","external_libs/jquery.tools","external_libs/bootstrap_datepicker","external_libs/bootstrap/transition","external_libs/bootstrap/collapse","external_libs/bootstrap/modal","external_libs/bootstrap/alert","external_libs/bootstrap/tab","external_libs/select2"],function(e,t,n,r,i,s,o,u,a,f){var l=function(){var t=new Date(r.now*1e3),n={allday:"#ai1ec_all_day_event",start_date_input:"#ai1ec_start-date-input",start_time_input:"#ai1ec_start-time-input",start_time:"#ai1ec_start-time",end_date_input:"#ai1ec_end-date-input",end_time_input:"#ai1ec_end-time-input",end_time:"#ai1ec_end-time",date_format:r.date_format,month_names:r.month_names,day_names:r.day_names,week_start_day:r.week_start_day,twentyfour_hour:r.twentyfour_hour,now:t};e.timespan(n)},c=function(){e(".ai1ec-panel-collapse").on("hide",function(){e(this).parent().removeClass("ai1ec-overflow-visible")}),e(".ai1ec-panel-collapse").on("shown",function(){var t=e(this);window.setTimeout(function(){t.parent().addClass("ai1ec-overflow-visible")},350)})},h=function(){l(),timely.require(["libs/gmaps"],function(e){e(i.init_gmaps)})},p=function(t,n){var r=null;"[object Array]"===Object.prototype.toString.call(n)?r=n.join("<br>"):r=n,e("#ai1ec_event_inline_alert").html(r),e("#ai1ec_event_inline_alert").removeClass("ai1ec-hidden"),t.preventDefault(),e("#publish, #ai1ec_bottom_publish").removeClass("button-primary-disabled"),e("#publish, #ai1ec_bottom_publish").removeClass("disabled"),e("#publish, #ai1ec_bottom_publish").siblings("#ajax-loading, .spinner").css("visibility","hidden")},d=function(t){o.ai1ec_check_lat_long_fields_filled_when_publishing_event(t)===!0&&(o.ai1ec_convert_commas_to_dots_for_coordinates(),o.ai1ec_check_lat_long_ok_for_search(t));var i=!1,s=[];e("#ai1ec_ticket_ext_url, #ai1ec_contact_url").each(function(){var t=this.value;e(this).removeClass("ai1ec-input-warn");var o=e(this).closest(".ai1ec-panel-collapse").parent().find(".ai1ec-panel-heading .ai1ec-fa-warning");i||o.addClass("ai1ec-hidden").parent().removeClass("ai1ec-tab-title-error");var u=e(this).attr("id"),a="ai1ec_ticket_ext_url"===u;if(""!==t&&!1===n.isValidUrl(t,a)){o.removeClass("ai1ec-hidden").parent().addClass("ai1ec-tab-title-error"),i||e(this).closest(".ai1ec-panel-collapse").collapse("show"),i=!0;var f=u+"_not_valid";s.push(r[f]),e(this).addClass("ai1ec-input-warn")}});var u=e("#ai1ec_contact_email"),a=u.closest(".ai1ec-panel-collapse").parent().find(".ai1ec-panel-heading .ai1ec-fa-warning");u.removeClass("ai1ec-input-warn"),i||a.addClass("ai1ec-hidden").parent().removeClass("ai1ec-tab-title-error");var f=e.trim(u.val());if(""!==f&&!1===n.isValidEmail(f)){a.removeClass("ai1ec-hidden").parent().addClass("ai1ec-tab-title-error"),i||u.closest(".ai1ec-panel-collapse").collapse("show"),i=!0;var l=u.attr("id")+"_not_valid";s.push(r[l]),u.addClass("ai1ec-input-warn")}var c=e("#title, #ai1ec_contact_name, #ai1ec_contact_email, #ai1ec_contact_phone, #content");if(e("#ai1ec_has_tickets").prop("checked")){c.addClass("ai1ec-required"),E(),e("#content").hasClass("ai1ec-error")?T(!0):T(!1);if(e(".ai1ec-error").not(".ai1ec-hidden .ai1ec-error").length||e(".ai1ec-tax-options-button").hasClass("ai1ec-required-error"))i=!0,e("#ai1ec-add-new-event-accordion > .ai1ec-panel-default > .ai1ec-panel-collapse").removeClass("ai1ec-collapse").css("height","auto"),s.push(r.ticketing_required_fields);e("#ai1ec_repeat").prop("checked")===!0&&(i=!0,s.push(r.ticketing_repeat_not_supported));if(!1===i){var h=0,d=0;e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").each(function(){var t=e(this),n=!1;t.find(".ai1ec-tickets-fields").remove(),t.find("select, input").each(function(){if(!this.name)return;"remove"===this.name&&(n=!0);var r=this.value;"checkbox"==this.type&&(1==this.checked?r="on":r="off"),e("<input />",{type:"hidden",name:"ai1ec_tickets["+h+"]["+this.name+"]","class":"ai1ec-tickets-fields",value:r}).appendTo(t)}),n||d++,h++}),0===d&&(i=!0,s.push(r.ticketing_no_tickets_included))}}else c.removeClass("ai1ec-required");i?p(t,s):(e(".ai1ec-tickets-form-template").remove(),e(".ai1ec-tickets-edit-form").find("input, select").not(".ai1ec-tickets-fields").prop("disabled",!0))},v=function(){e("#ai1ec_google_map").click(s.toggle_visibility_of_google_map_on_click),e("#ai1ec_input_coordinates").change(s.toggle_visibility_of_coordinate_fields_on_click),e("#post").submit(d),e("input.ai1ec-coordinates").blur(s.update_map_from_coordinates_on_blur),e("#ai1ec_bottom_publish").on("click",u.trigger_publish),e(document).on("change","#ai1ec_end",u.show_end_fields).on("click","#ai1ec_repeat_apply",u.handle_click_on_apply_button).on("click","#ai1ec_repeat_cancel",u.handle_click_on_cancel_modal).on("click","#ai1ec_monthly_type_bymonthday, #ai1ec_monthly_type_byday",u.handle_checkbox_monthly_tab_modal).on("click",".ai1ec-btn-group-grid a",u.handle_click_on_toggle_buttons),e("#ai1ec_repeat_box").on("hidden.bs.modal",u.handle_modal_hide),u.execute_pseudo_handlers(),e("#widgetField > a").on("click",u.handle_animation_of_calendar_widget),e(document).on("click",".ai1ec-set-banner-image",m),e(document).on("click",".ai1ec-remove-banner",g),e(document).on("click","#ai1ec_tax_options, #ai1ec_update_tax_options",k)},m=function(){var t={};return t._frame=wp.media({state:"featured-image",states:[new wp.media.controller.FeaturedImage,new wp.media.controller.EditImage]}),t._frame.open(),e(".media-frame:last ").addClass("ai1ec-banner-image-frame"),e(".media-frame-title:last h1").text(e(".ai1ec-set-banner-block .ai1ec-set-banner-image").text()),e(".media-frame-toolbar:last").append(e(".ai1ec-media-toolbar").clone().removeClass("ai1ec-media-toolbar ai1ec-hidden")),e(".ai1ec-save-banner-image").off().on("click",function(){var n=e(".attachments:visible li.selected img").attr("src"),r=e(".attachment-details:visible input[type=text]").val();return n&&r&&e("#ai1ec_event_banner .inside").find(".ai1ec-banner-image-block").removeClass("ai1ec-hidden").find("img").attr("src",n).end().find("input").val(r).end().end().find(".ai1ec-set-banner-block").addClass("ai1ec-hidden").end().find(".ai1ec-remove-banner-block").removeClass("ai1ec-hidden"),t._frame.close(),!1}),!1},g=function(){return e("#ai1ec_event_banner .inside").find(".ai1ec-remove-banner-block").addClass("ai1ec-hidden").end().find(".ai1ec-banner-image-block").addClass("ai1ec-hidden").find("input").val("").end().find("img").attr("src","").end().end().find(".ai1ec-set-banner-block").removeClass("ai1ec-hidden"),!1},y=function(){e("#ai1ec_event").insertAfter("#ai1ec_event_inline_alert"),e("#post").addClass("ai1ec-visible")},b=function(){e("#timezone-select").select2()},w=function(){e(".ai1ec-tickets-datepicker").not(".ai1ec-tickets-datepicker-inited").not(".ai1ec-tickets-form-template .ai1ec-tickets-datepicker").each(function(){var t=e(this),n=t.closest(".ai1ec-tickets-dates-block"),r=e(".ai1ec-tickets-time",n),i=e("input.ai1ec-tickets-full-date",n),s=i.val();t.val(s.substr(0,10)),r.val(s.substr(11,5)),r.on("change",function(){s=i.val(),i.val(s.substr(0,10)+" "+this.value+":00")}),t.addClass("ai1ec-tickets-datepicker-inited").datepicker({autoclose:!0}).on("changeDate",function(e){i.val(this.value+" "+r.val()+":00")})})},E=function(){e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").not(".ai1ec-hidden").find('input[id="ai1ec_ticket_unlimited"]').each(function(){var t=e(this),n=t.closest(".ai1ec-tickets-edit-form"),r=e('input[id="ai1ec_ticket_quantity"]',n);!1===t.prop("checked")?(r.val()==0&&r.val(""),r.addClass("ai1ec-required")):r.removeClass("ai1ec-required")}),e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").not(".ai1ec-hidden").find('input[id="ai1ec_ticket_avail"]').each(function(){var t=e(this);t.closest(".ai1ec-tickets-edit-form").find('input[id="ai1ec_ticket_sale_start_date"],input[id="ai1ec_ticket_sale_end_date"]').each(function(){!1===t.prop("checked")?e(this).addClass("ai1ec-required"):e(this).removeClass("ai1ec-required")})}),e(".ai1ec-ticket-field-error").hide(),e(".ai1ec-required").not(".ai1ec-tickets-form-template .ai1ec-required").each(function(){var t=e(this);t.removeClass("ai1ec-error");if(!e.trim(t.val())||"checkbox"===t.attr("type")&&!t.prop("checked"))t.addClass("ai1ec-error"),t.parent().find(".ai1ec-ticket-field-error").show()}),e('[name="ticket_sale_start_date"], [name="ticket_sale_end_date"]').not(".ai1ec-tickets-form-template input").each(function(){var t=e(this),n=t.closest(".ai1ec-tickets-dates-block").find('input[type="text"]');n.removeClass("ai1ec-error"),!t.closest(".ai1ec-avail-block").find('input[name="availibility"]:checked').length&&null===this.value.match(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})$/)&&n.addClass("ai1ec-error")});var t=e("#ai1ec_editing_ticket").val();return 0==t&&!e("#ai1ec_tax_inputs input").length?e(".ai1ec-tax-options-button").addClass("ai1ec-required-error").show():e(".ai1ec-tax-options-button").removeClass("ai1ec-required-error").hide(),e(".ai1ec-ticket-field-error:visible").length?!1:!0},S=function(t){var n=t.closest(".ai1ec-tickets-edit-form"),r=e("#ai1ec_ticket_quantity",n);1==t.prop("checked")?r.hide():r.show()},x=function(t){var n=t.closest(".ai1ec-tickets-edit-form"),r=e(".ai1ec-tickets-dates",n);1==t.prop("checked")?r.hide():r.show()},T=function(t){e("#ai1ec-event-description-field-error").remove(),t&&e("#postdivrich").before('<div id="ai1ec-event-description-field-error"><strong style="color: red;">* The Event description is required.</strong></div>')},N=function(){e(document).on("click change",'[id="ai1ec_ticket_unlimited"]',function(){S(e(this))}),e(document).on("click change",'[id="ai1ec_ticket_avail"]',function(){x(e(this))}),e(document).on("click change",'[id="ai1ec_new_ticket_status"]',function(){var t=e(this),n=t.closest(".ai1ec-tickets-panel"),i=t.find(":selected");if("canceled"===i.val()){var s=e("#ai1ec-ticket-taken",n);if(0<s.val()){e("#ai1ec-ticket-status-message",n).text(r.ticketing.cancel_message);return}}n.find("#ai1ec-ticket-status-message").text("")}),e(document).on("click",".ai1ec-remove-ticket",function(){var t=e(this).closest(".ai1ec-tickets-panel"),i=e("#ai1ec-ticket-taken",t);return 0<i.val()?n.alert(r.ticketing.information,r.ticketing.no_delete_text):t.addClass("ai1ec-hidden").append('<input type="hidden" name="remove" value="1">'),!1});var t=function(){var t=e(".ai1ec-tickets-form-template").clone();return t.removeClass("ai1ec-tickets-form-template").appendTo("#ai1ec-ticket-forms"),$checkbox=e("#ai1ec_ticket_unlimited",t),$checkbox.prop("checked",!0),S($checkbox),$checkbox=e("#ai1ec_ticket_avail",t),$checkbox.prop("checked",!0),x($checkbox),w(),!1};e("#ai1ec_add_new_ticket").on("click",t),e(".ai1ec-tickets-edit-form").not(".ai1ec-tickets-form-template").length||t()},C=function(){var t=function(){e(".ai1ec_review_modal").modal("hide"),e(".ai1ec_review_modal").hide()},n=function(){var n=e(".ai1ec_review_negative_feedback, .ai1ec_review_contact_name, .ai1ec_review_contact_email, .ai1ec_review_site_url");n.each(function(){var t=e(this);t.removeClass("ai1ec-error"),t.closest("td").find(".ai1ec-required-message").hide(),t.closest("td").find(".ai1ec-invalid-email-message").hide(),t.closest("td").find(".ai1ec-invalid-site-message").hide();if(!e.trim(t.val()))t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-required-message").show();else if(t.hasClass("ai1ec_review_contact_email")){var n=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;!1===n.test(t.val())&&(t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-invalid-email-message").show())}else if(t.hasClass("ai1ec_review_site_url")){var r=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi;!1===r.test(t.val())&&(t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-invalid-site-message").show())}}),!1===n.hasClass("ai1ec-error")&&(e(".ai1ec_review_send_feedback").button("loading"),n.prop("disabled",!0),e.ajax({url:r.ajax_url,type:"POST",data:{action:"ai1ec_send_feedback_message",message:e(".ai1ec_review_negative_feedback").val(),name:e(".ai1ec_review_contact_name").val(),email:e(".ai1ec_review_contact_email").val(),site:e(".ai1ec_review_site_url").val()},success:function(n){e(".ai1ec_review_messages").remove(),e(".ai1ec-review-form").prepend('<div class="timely ai1ec-alert ai1ec-alert-success ai1ec_review_messages"><strong>'+r.review.message_sent+"</strong></div>"),setTimeout(function(){e(".ai1ec_review_send_feedback").button("reset"),e(".ai1ec_not_enjoying_popup").prop("disabled",!0),t()},3e3)},error:function(t){n.prop("disabled",!1),e(".ai1ec_review_messages").remove(),e(".ai1ec-review-form").prepend('<div class="timely ai1ec-alert ai1ec-alert-danger ai1ec_review_messages"><strong>Error!</strong> '+r.review.message_error+"</div>")}}))},i=function(){o("y")},s=function(){o("n")},o=function(n){t(),e.ajax({url:r.ajax_url,type:"POST",data:{action:"ai1ec_save_feedback_review",feedback:n}})};e(".ai1ec_review_enjoying_no_rating, .ai1ec_review_enjoying_go_wordpress").on("click",i),e(".ai1ec_review_send_feedback").on("click",n),e(".ai1ec_review_not_enjoying_no_rating").on("click",s)},k=function(){var t=e("#ai1ec_tax_box"),n=e(".ai1ec-modal-content",t),r=e(".ai1ec-loading",t);if(t.hasClass("ai1ec-active")){t.modal("show");return}t.addClass("ai1ec-active").modal({backdrop:"static"}),e.post(ajaxurl,{action:"ai1ec_get_tax_box",ai1ec_event_id:e("#post_ID").val()},function(t){var n=e("#ai1ec_tax_frame").get(0).contentWindow.document;r.remove(),e("#ai1ec_tax_frame").removeClass("ai1ec-hidden"),n.open(),n.write(t.message.body),n.close();var i=0,s=0,o=e("#ai1ec_tax_frame");setInterval(function(){s=o.contents().find("body").height(),s!=i&&o.css("height",(i=s)+"px")},500)},"json")};window.addEventListener("message",function(t){var n=t.data.toString(),r="timely_tax_options_",i="timely_tax_cancel",s=e("#ai1ec_tax_inputs");if(n===i){e("#ai1ec_tax_box").modal("hide");return}if(0!==n.indexOf(r))return;n=JSON.parse(n.substr(r.length)),e("#ai1ec_tax_box").modal("hide"),e("#ai1ec_tax_options").addClass("ai1ec-hidden"),e("#ai1ec_update_tax_options").removeClass("ai1ec-hidden"),s.html("");for(var o in n)s.append(e("<input />",{type:"hidden",name:"tax_options["+o+"]",value:n[o]}))},!1);var L=function(){h(),t(function(){c(),y(),v(),b(),N(),w(),C()})};return{start:L}}),timely.require(["scripts/add_new_event"],function(e){e.start()}),timely.define("pages/add_new_event",function(){});

==================================================
FILE PATH: ./public/js/pages/calendar_feeds.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/*
Copyright 2012 Igor Vaynberg

Version: 3.3.1 Timestamp: Wed Feb 20 09:57:22 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

/* ========================================================================
 * Bootstrap: alert.js v3.0.3
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.0.3
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: button.js v3.0.3
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.0.3
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("scripts/calendar_feeds/ics/ics_ajax_handlers",["jquery_timely","libs/utils"],function(e,t){var n=function(n){var r=e("#ai1ec_add_new_ics"),o=e("#ai1ec_feed_url");r.button("reset");if(n.error){var u=t.make_alert(n.message,"error");e("#ics-alerts").append(u).prependTo("#import")}else{s(),e("#ai1ec-feeds-after").addClass("ai1ec-well ai1ec-well-sm").insertAfter("#ics .ai1ec-form-horizontal");var a=n.update.data.ics_id,f=e(n.message),l=e('.ai1ec_feed_id[value="'+a+'"] ').closest(".ai1ec-feed-container");f.find(".ai1ec-collapse").removeClass("ai1ec-collapse");var l=e('.ai1ec_feed_id[value="'+a+'"] ').closest(".ai1ec-feed-container");l.length?l.replaceWith(f):e("#ics .ai1ec-ics-feeds-list").append(f),e('a[href="#ics"]').click(),n.update&&n.update.data&&!n.update.data.error&&i(n.update.data)}},r=function(n){var r=e("input[value="+n.ics_id+"]").closest(".ai1ec-feed-container"),i=n.error?"error":"success",s=t.make_alert(n.message,i);n.error?e(".ai1ec_update_ics",r).button("reset"):r.remove(),e("#ics-alerts").append(s)},i=function(n){var r=e("input[value="+n.ics_id+"]").closest(".ai1ec-feed-container"),i=n.error?"error":"success",s=t.make_alert(n.message,i);e(".ai1ec_update_ics",r).button("reset"),e("#ics-alerts").append(s).prependTo("#ics")},s=function(){e("#ai1ec_feed_url").val(" ").prop("readonly",!1),e('#ai1ec-feeds-after input[type="checkbox"]').prop("checked",!1),e("#ai1ec_feed_id").remove(),e("#ai1ec_feed_category").select2("val",""),e("#ai1ec_feed_tags").select2("val",""),e('[id^="ai1ec_feed_cfg_"]').select2("val",""),e("#ai1ec_ics_add_new, #ai1ec_add_new_ics > i").removeClass("ai1ec-hidden"),e("#ai1ec_ics_update").addClass("ai1ec-hidden"),e("#ics .ai1ec-alert").remove()};return{handle_add_new_ics:n,handle_delete_ics:r,handle_update_ics:i,reset_form:s}}),timely.define("external_libs/select2",["jquery_timely"],function(e){(function(e){typeof e.fn.each2=="undefined"&&e.fn.extend({each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})})(e),function(e,t){function l(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(c(e,t[n]))return n;return-1}function c(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e===n+"":n.constructor===String?n===e+"":!1}function h(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r}function p(e){return e.outerWidth(!1)-e.width()}function d(n){var r="keyup-change-value";n.bind("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.bind("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function v(n){n.bind("mousemove",function(n){var r=a;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function m(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function g(e){var t=!1,n;return function(){return t===!1&&(n=e(),t=!0),n}}function y(e,t){var n=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){l(e.target,t.get())>=0&&n(e)})}function b(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus(),t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",n),r.select())},0)}function w(e){e.preventDefault(),e.stopPropagation()}function E(e){e.preventDefault(),e.stopImmediatePropagation()}function S(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),u.attr("class","select2-sizer"),e("body").append(u)}return u.text(t.val()),u.width()}function x(t,n,r){var i,s=[],o;i=t.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")===0&&s.push(this)}),i=n.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),typeof o=="string"&&o.length>0&&s.push(this))}),t.attr("class",s.join(" "))}function T(e,t,n,r){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function N(t){var n,r=0,i=null,s=t.quietMillis||100,o=t.url,u=this;return function(a){window.clearTimeout(n),n=window.setTimeout(function(){r+=1;var n=r,s=t.data,f=o,l=t.transport||e.ajax,c=t.type||"GET",h={};s=s?s.call(u,a.term,a.page,a.context):null,f=typeof f=="function"?f.call(u,a.term,a.page,a.context):f,null!==i&&i.abort(),t.params&&(e.isFunction(t.params)?e.extend(h,t.params.call(u)):e.extend(h,t.params)),e.extend(h,{url:f,dataType:t.dataType,data:s,type:c,cache:!1,success:function(e){if(n<r)return;var i=t.results(e,a.page);a.callback(i)}}),i=l.call(u,h)},s)}}function C(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=n.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function k(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o)}}function L(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function A(t){return e.isFunction(t)?t():t}function O(t){var n=0;return e.each(t,function(e,t){t.children?n+=O(t.children):n++}),n}function M(e,n,r,i){var s=e,o=!1,u,a,f,l,h;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){h=i.tokenSeparators[f],a=e.indexOf(h);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+h.length);if(u.length>0){u=i.createSearchChoice(u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(c(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function _(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}var n,r,i,s,o,u,a,f;n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},f=e(document),o=function(){var e=1;return function(){return e++}}(),f.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}}),r=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results",u;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=g(function(){return n.element.closest("body")}),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(A(n.containerCss)),this.container.addClass(A(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabIndex"),this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(A(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=r=this.container.find(s),this.search=i=this.container.find("input.select2-input"),i.attr("tabIndex",this.elementTabIndex),this.resultsPage=0,this.context=null,this.initContainer(),v(this.results),this.dropdown.delegate(s,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent)),y(80,this.results),this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop(),o;i>0&&s-i<=0?(r.scrollTop(0),w(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),w(e))}),d(i),i.bind("keyup-change input paste",this.bind(this.updateResults)),i.bind("focus",function(){i.addClass("select2-focused")}),i.bind("blur",function(){i.removeClass("select2-focused")}),this.dropdown.delegate(s,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show())},prepareOpts:function(n){var r,i,s,o;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,s){var o,u,a,f,l=this.opts.id,c=this;o=function(r,i,u){var a,f,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(a=0,f=r.length;a<f;a+=1)h=r[a],d=h.disabled===!0,p=!d&&l(h)!==t,v=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+u),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(c.opts.formatResultCssClass(h)),g=e(document.createElement("div")),g.addClass("select2-result-label"),b=n.formatResult(h,g,s,c.opts.escapeMarkup),b!==t&&g.html(b),m.append(g),v&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),o(h.children,y,u+1),m.append(y)),m.data("select2-data",h),i.append(m)},o(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(s=n.id,n.id=function(e){return e[s]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.attr("data-select2-tags")}i?(n.query=this.bind(function(n){var i={results:[],more:!1},s=n.term,o,u,a;a=function(e,t){var r;e.is("option")?n.matcher(s,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:c(e.attr("disabled"),"disabled")}):e.is("optgroup")&&(r={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){a(t,r.children)}),r.children.length>0&&t.push(r))},o=r.children(),this.getPlaceholder()!==t&&o.length>0&&(u=o[0],e(u).text()===""&&(o=o.not(u))),o.each2(function(e,t){a(t,i.results)}),n.callback(i)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(o=n.element.data("ajax-url"),o&&o.length>0&&(n.ajax.url=o),n.query=N.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=k(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(h(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){if(c(this.id,t))return r=this.text,!1}),i.push({id:t,text:r})}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var e,t,n=this;e=this.opts.element.attr("disabled")!=="disabled",t=this.opts.element.attr("readonly")==="readonly",e=e&&!t,this.enabled!==e&&(e?this.enable():this.disable()),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),e.bind("propertychange.select2 DOMAttrModified.select2",t),typeof WebKitMutationObserver!="undefined"&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)}),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=this.dropdown.outerHeight(!1),s=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),u=t.top+n,a=t.left,f=u+i<=o,l=t.top-i>=this.body().scrollTop(),c=this.dropdown.outerWidth(!1),h=a+c<=s,p=this.dropdown.hasClass("select2-drop-above"),d,v,m;this.body().css("position")!=="static"&&(d=this.body().offset(),u-=d.top,a-=d.left),p?(v=!0,!l&&f&&(v=!1)):(v=!1,!f&&l&&(v=!0)),h||(a=t.left+r-c),v?(u=t.top-i,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),m=e.extend({top:u,left:a,width:r},A(this.opts.dropdownCss)),this.dropdown.css(m)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.clearDropdownAlignmentPreference(),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.updateResults(!0),s=e("#select2-drop-mask"),s.length==0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body()),s.bind("mousedown touchstart",function(t){var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),s.show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible();var o=this;this.container.parents().add(window).each(function(){e(this).bind(r+" "+n+" "+i,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),o.positionDropdown()})}),this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(n).unbind(r).unbind(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices(),i=e(n[r]),s=i.offset().top+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!0),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=i.offset().top-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return l(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),r=e(n[t]),r.addClass("select2-highlighted"),this.ensureHighlightVisible(),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"highlight",val:this.id(i),choice:i})},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=-1,i=this.resultsPage+1,s=this,o=this.search.val(),u=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:u,matcher:this.opts.matcher,callback:this.bind(function(n){if(!s.opened())return;s.opts.populateResults.call(this,e,n.results,{term:o,page:i,context:u}),n.more===!0?(t.detach().appendTo(e).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):t.remove(),s.positionDropdown(),s.resultsPage=i,s.context=n.context})}))},tokenize:function(){},updateResults:function(n){function f(){i.scrollTop(0),r.removeClass("select2-active"),u.positionDropdown()}function l(e){i.html(e),f()}var r=this.search,i=this.results,s=this.opts,o,u=this,a;if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;r.addClass("select2-active");var h=this.getMaximumSelectionSize();if(h>=1){o=this.data();if(e.isArray(o)&&o.length>=h&&L(s.formatSelectionTooBig,"formatSelectionTooBig")){l("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(h)+"</li>");return}}if(r.val().length<s.minimumInputLength){L(s.formatInputTooShort,"formatInputTooShort")?l("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>"):l("");return}s.formatSearching()&&n===!0&&l("<li class='select2-searching'>"+s.formatSearching()+"</li>");if(s.maximumInputLength&&r.val().length>s.maximumInputLength){L(s.formatInputTooLong,"formatInputTooLong")?l("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>"):l("");return}a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(null,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return c(u.id(this),u.id(a))}).length===0&&o.results.unshift(a));if(o.results.length===0&&L(s.formatNoMatches,"formatNoMatches")){l("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&L(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),f()})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){b(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r&&(this.highlight(t),this.onSelect(r,e))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,r,i,s,o;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s+=1){i=r[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(i!==null&&i.length>=1)return i[1]}}return this.opts.width==="resolve"?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);r!==null&&this.container.css("width",r)}}),i=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments),this.focusser.attr("disabled","disabled"),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),b(this.focusser)},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var e,t=this.container,r=this.dropdown,i=!1;this.showSearch(this.opts.minimumResultsForSearch>=0),this.selection=e=t.find(".select2-choice"),this.focusser=t.find(".select2-focusser"),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.TAB:case n.ENTER:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}})),this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC)return;if(this.opts.openOnEnter===!1&&e.which===n.ENTER){w(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){this.open(),w(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){this.opts.allowClear&&this.clear(),w(e);return}})),d(this.focusser),this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open(),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.focusser.val(""),w(e)})),e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear(),E(e),this.close(),this.selection.focus()})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?this.close():this.enabled&&this.open(),w(e),i=!1})),r.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(e){w(e)})),this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active")})),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),this.opts.element.trigger({type:"removed",val:this.id(e),choice:e}),this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()==="")this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(t,n){var r=t.find(":selected");e.isFunction(n)&&n({id:r.attr("value"),text:r.text(),element:r})}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val();t.query({matcher:function(e,n,r){return c(i,t.id(r))},callback:e.isFunction(r)?function(e){r(e.results.length?e.results[0]:null)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.select.find("option").first().text()!==""?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,t){var n=0,r=this,i=!0;this.findHighlightableChoices().each2(function(e,t){if(c(r.id(t.data("select2-data")),r.opts.element.val()))return n=e,!1}),this.highlight(n);if(t===!0){var s=this.opts.minimumResultsForSearch;i=s<0?!1:O(e.results)>=s,this.showSearch(i)}},showSearch:function(t){this.showSearchInput=t,this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var n=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.close(),(!t||!t.noFocus)&&this.selection.focus(),c(n,this.id(e))||this.triggerChange()},updateSelection:function(e){var n=this.selection.find("span"),r;this.selection.data("select2-data",e),n.empty(),r=this.opts.formatSelection(e,n),r!==t&&n.append(this.opts.escapeMarkup(r)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=!1,r=null,i=this;if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1]);if(this.select)this.select.val(e).find(":selected").each2(function(e,t){return r={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e&&e!==0){this.clear(),n&&this.triggerChange();return}this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange()})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;!e||e===""?this.clear():(this.opts.element.val(e?this.id(e):""),this.updateSelection(e))}}),s=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var n=[];e.find(":selected").each2(function(e,t){n.push({id:t.attr("value"),text:t.text(),element:t[0]})}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=h(n.val(),t.separator);t.query({matcher:function(n,r,s){return e.grep(i,function(e){return c(e,t.id(s))}).length},callback:e.isFunction(r)?function(e){r(e.results)}:e.noop})}),t},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(t),this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;this.opened()||this.open()})),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.BACKSPACE&&this.search.val()===""){this.close();var t,i=r.find(".select2-search-choice-focus");if(i.length>0){this.unselect(i.first()),this.search.width(10),w(e);return}t=r.find(".select2-search-choice:not(.select2-locked)"),t.length>0&&t.last().addClass("select2-search-choice-focus")}else r.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.ENTER:case n.TAB:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC)return;if(e.which===n.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN)&&w(e)})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.opened()||this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()})),this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0)},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus(),this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){l(i.id(this),n)<0&&(n.push(i.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){i.addSelectedChoice(this)}),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a=this.getVal(),f;f=this.opts.formatSelection(n,o.find("div")),f!=t&&o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(f)+"</div>"),r&&o.find(".select2-search-choice-close").bind("mousedown",w).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),w(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),a.push(u),this.setVal(a)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";n=e.data("select2-data");if(!n)return;r=l(this.id(n).toString(),t),r>=0&&(t.splice(r,1),this.setVal(t),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(n),choice:n}),this.triggerChange({removed:n})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),n=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,n){var i=r.id(n.data("select2-data"));l(i,e)>=0&&(n.addClass("select2-selected"),n.find(".select2-result-selectable").addClass("select2-selected"))}),n.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&r.highlight(0)},resizeSearch:function(){var e,t,n,r,i,s=p(this.search);e=S(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(i)},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),h(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){l(this,n)<0&&n.push(this)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator)))},val:function(){var n,r=!1,i=[],s=this;if(arguments.length===0)return this.getVal();n=arguments[0],arguments.length>1&&(r=arguments[1]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange();return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n=this,r;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();t||(t=[]),r=e.map(t,function(e){return n.opts.id(e)}),this.setVal(r),this.updateSelection(t),this.clearSearch()}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?a=r.element.attr("multiple"):(a=r.multiple||!1,"tags"in r&&(r.multiple=a=!0)),o=a?new s:new i,o.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(l(n[0],f)<0)throw"Unknown method: "+n[0];u=t,o=e(this).data("select2");if(o===t)return;n[0]==="container"?u=o.container:u=o[n[0]].apply(o,n.slice(1));if(u!==t)return!1}}),u===t?this:u},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return T(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n){return e?e.text:t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please enter "+n+" less character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}}}(e)}),timely.define("scripts/calendar_feeds/ics/ics_event_handlers",["jquery_timely","scripts/calendar_feeds/ics/ics_ajax_handlers","libs/utils","ai1ec_config","external_libs/select2"],function(e,t,n,r){var i=n.get_ajax_url(),s=function(){var s=e(this),o=e("#ai1ec_feed_url"),u=o.val().replace("webcal://","http://"),a=e("#ai1ec_feed_id").val(),f=!1,l;e(".ai1ec-feed-url, #ai1ec_feed_url").css("border-color","#DFDFDF"),e("#ai1ec-feed-error").remove(),a||e(".ai1ec-feed-url").each(function(){this.value===u&&(e(this).css("border-color","#FF0000"),f=!0,l=r.duplicate_feed_message)}),n.isUrl(u)||(f=!0,l=r.invalid_url_message);if(f)o.addClass("input-error").focus().before(n.make_alert(l,"error"));else{s.button("loading");var c=e("#ai1ec_comments_enabled").is(":checked")?1:0,h=e("#ai1ec_map_display_enabled").is(":checked")?1:0,p=e("#ai1ec_add_tag_categories").is(":checked")?1:0,d=e("#ai1ec_keep_old_events").is(":checked")?1:0,v=e("#ai1ec_feed_import_timezone").is(":checked")?1:0,m={action:"ai1ec_add_ics",nonce:r.calendar_feeds_nonce,feed_url:u,feed_category:e("#ai1ec_feed_category").val(),feed_tags:e("#ai1ec_feed_tags").val(),comments_enabled:c,map_display_enabled:h,keep_tags_categories:p,keep_old_events:d,feed_import_timezone:v};e(".ai1ec-feed-field").each(function(){var t=e(this).val();"checkbox"===e(this).attr("type")&&!e(this).prop("checked")&&(t=0),m[e(this).attr("name")]=t}),a&&(m.feed_id=a),e.post(i,m,t.handle_add_new_ics,"json")}},o=function(){var t=e(this),n=t.closest(".ai1ec-feed-container"),r=e("#ai1ec-feeds-after"),i=e("#ai1ec_ics_add_new, #ai1ec_add_new_ics > i"),s=e("#ai1ec_ics_update"),o=(e(".ai1ec-feed-category",n).data("ids")||"").toString(),u=(e(".ai1ec-feed-tags",n).data("ids")||"").toString(),a=e(".ai1ec-cfg-feed",n),f=[];a.each(function(){var t=e(this);f[t.attr("data-group_name")]=t.attr("data-terms")}),e("#ai1ec_feed_url").val(e(".ai1ec-feed-url",n).val()).prop("readonly",!0),e("#ai1ec_comments_enabled").prop("checked",e(".ai1ec-feed-comments-enabled",n).data("state")),e("#ai1ec_map_display_enabled").prop("checked",e(".ai1ec-feed-map-display-enabled",n).data("state")),e("#ai1ec_add_tag_categories").prop("checked",e(".ai1ec-feed-keep-tags-categories",n).data("state")),e("#ai1ec_keep_old_events").prop("checked",e(".ai1ec-feed-keep-old-events",n).data("state")),e("#ai1ec_feed_import_timezone").prop("checked",e(".ai1ec-feed-import-timezone",n).data("state")),i.addClass("ai1ec-hidden"),s.removeClass("ai1ec-hidden"),e('<input type="hidden" id="ai1ec_feed_id" name="ai1ec_feed_id">').val(e(".ai1ec_feed_id",n).val()).appendTo(r),e("#ai1ec_feed_category").select2("val",o.split(",")),e("#ai1ec_feed_tags").select2("val",u.split(","));for(var l in f)e('[id="ai1ec_feed_cfg_'+l.toLowerCase()+'"]').select2("val",f[l].split(",")||f[l]);var c=e(".ai1ec-feed-content",n);c.hide(),e("#ai1ec_cancel_ics").show(),e("#ai1ec-feeds-after").removeClass("ai1ec-well ai1ec-well-sm").insertAfter(c),e("#ics .ai1ec-alert").remove()},u=function(n){return e("#ai1ec-feeds-after").addClass("ai1ec-well ai1ec-well-sm").appendTo("#import"),e(".ai1ec-feed-content").show(),t.reset_form(),e("#ai1ec_cancel_ics").hide(),!1},a=function(n){n.preventDefault();var r=e(this).hasClass("remove")?!0:!1,s=e(e(this).data("el")),o=s.closest(".ai1ec-feed-container"),u=e(".ai1ec_feed_id",o).val(),a={action:"ai1ec_delete_ics",ics_id:u,remove_events:r};s.button("loading"),e("#ai1ec-ics-modal").modal("hide"),e.post(i,a,t.handle_delete_ics,"json")},f=function(){e("#ai1ec-ics-modal .ai1ec-btn").data("el",this),e("#ai1ec-ics-modal").modal({backdrop:"static"})},l=function(){var n=e(this),r=n.closest(".ai1ec-feed-container"),s=e(".ai1ec_feed_id",r).val(),o={action:"ai1ec_update_ics",ics_id:s};n.button("loading"),e.post(i,o,t.handle_update_ics,"json")};return{add_new_feed:s,submit_delete_modal:a,open_delete_modal:f,update_feed:l,edit_feed:o,edit_cancel:u}}),timely.define("libs/select2_multiselect_helper",["jquery_timely","external_libs/select2"],function(e){var t=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""&&(s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> '),s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},n=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""?s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> ':s+='<span class="ai1ec-color-swatch-empty"></span> ',s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},r=function(r){typeof r=="undefined"&&(r=e(document)),e(".ai1ec-select2-multiselect-selector",r).select2({allowClear:!0,formatResult:n,formatSelection:t,escapeMarkup:function(e){return e}})},i=function(t){e(".ai1ec-select2-multiselect-selector.select2-container",t).each(function(){e(this).data("select2").resizeSearch()})};return{init:r,refresh:i}}),timely.define("libs/tags_select",["jquery_timely","external_libs/select2"],function(e){var t=function(t){typeof t=="undefined"&&(t=e(document)),e(".ai1ec-tags-selector",t).each(function(){var t=e(this);t.select2({tags:t.data("ai1ecTags"),tokenSeparators:[","]})})},n=function(t){e(".ai1ec-tags-selector.select2-container",t).each(function(){e(this).data("select2").resizeSearch()})};return{init:t,refresh:n}}),timely.define("libs/gmaps",["ai1ec_config"],function(e){var t=e.language,n=e.google_maps_api_key,r="async!https://maps.googleapis.com/maps/api/js?language="+t;return""!=n&&(r=r+"&key="+n),function(e){typeof google=="object"&&typeof google.maps=="object"?e():timely.require([r],e)}}),timely.define("external_libs/jquery_cookie",["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),timely.define("external_libs/bootstrap/alert",["jquery_timely"],function(e){var t='[data-dismiss="ai1ec-alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed.bs.alert").remove()}var n=e(this),r=n.attr("data-target");r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var i=e(r);t&&t.preventDefault(),i.length||(i=n.hasClass("ai1ec-alert")?n:n.parent()),i.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;i.removeClass("ai1ec-in"),e.support.transition&&i.hasClass("ai1ec-fade")?i.one(e.support.transition.end,s).emulateTransitionEnd(150):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}),timely.define("external_libs/bootstrap/modal",["jquery_timely"],function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r);if(this.isShown||r.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="ai1ec-modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("ai1ec-fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("ai1ec-in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".ai1ec-modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)})},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("ai1ec-in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("ai1ec-fade")?"ai1ec-fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="ai1ec-modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("ai1ec-in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("ai1ec-in"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="ai1ec-modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".ai1ec-modal",function(){e(document.body).addClass("ai1ec-modal-open")}).on("hidden.bs.modal",".ai1ec-modal",function(){e(document.body).removeClass("ai1ec-modal-open")})}),timely.define("external_libs/bootstrap/button",["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();e+="Text",i.resetText||n.data("resetText",n[r]()),n[r](i[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass("ai1ec-"+t).attr(t,t):n.removeClass("ai1ec-"+t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="ai1ec-buttons"]'),t=!0;if(e.length){var n=this.$element.find("input");n.prop("type")==="radio"&&(n.prop("checked")&&this.$element.hasClass("ai1ec-active")?t=!1:e.find(".ai1ec-active").removeClass("ai1ec-active")),t&&n.prop("checked",!this.$element.hasClass("ai1ec-active")).trigger("change")}t&&this.$element.toggleClass("ai1ec-active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=ai1ec-button]",function(t){var n=e(t.target);n.hasClass("ai1ec-btn")||(n=n.closest(".ai1ec-btn")),n.button("toggle"),t.preventDefault()})}),timely.define("external_libs/bootstrap/collapse",["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("ai1ec-width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("ai1ec-in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .ai1ec-panel > .ai1ec-in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("ai1ec-collapse").addClass("ai1ec-collapsing")[i](0),this.transitioning=1;var s=function(){this.$element.removeClass("ai1ec-collapsing").addClass("ai1ec-in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("ai1ec-in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("ai1ec-collapsing").removeClass("ai1ec-collapse").removeClass("ai1ec-in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("ai1ec-collapsing").addClass("ai1ec-collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)},t.prototype.toggle=function(){this[this.$element.hasClass("ai1ec-in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=ai1ec-collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning)f&&f.find('[data-toggle=ai1ec-collapse][data-parent="'+a+'"]').not(n).addClass("ai1ec-collapsed"),n[s.hasClass("ai1ec-in")?"addClass":"removeClass"]("ai1ec-collapsed");s.collapse(u)})}),timely.define("scripts/add_new_event/event_location/input_coordinates_utility_functions",["jquery_timely","ai1ec_config","libs/utils"],function(e,t,n){var r=function(){e("#ai1ec_input_coordinates:checked").length>0&&e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){this.value=n.convert_comma_to_dot(this.value)})},i=function(t,n){var r=e("<div />",{text:n,"class":"ai1ec-error"});e(t).after(r)},s=function(t,n){t.target.id==="post"&&(t.stopImmediatePropagation(),t.preventDefault(),e("#publish").removeClass("button-primary-disabled"),e("#publish").siblings(".spinner").css("visibility","hidden")),e(n).focus()},o=function(){var t=n.field_has_value("ai1ec_address"),r=!0;return e("input.ai1ec-coordinates").each(function(){var e=n.field_has_value(this.id);e||(r=!1)}),t||r},u=function(n){var r=!0,o=!1;return e("#ai1ec_input_coordinates:checked").length>0&&(e("div.ai1ec-error").remove(),e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){var n=e(this).hasClass("latitude"),s=n?t.error_message_not_entered_lat:t.error_message_not_entered_long;this.value===""&&(r=!1,o===!1&&(o=this),i(this,s))})),r===!1&&s(n,o),r},a=function(r){if(e("#ai1ec_input_coordinates:checked").length===1){e("div.ai1ec-error").remove();var o=!0,u=!1,a=!1;return e("#ai1ec_table_coordinates input.ai1ec-coordinates").each(function(){if(this.value===""){a=!0;return}var r=e(this).hasClass("latitude"),s=r?t.error_message_not_valid_lat:t.error_message_not_valid_long;n.is_valid_coordinate(this.value,r)||(o=!1,u===!1&&(u=this),i(this,s))}),o===!1&&s(r,u),a===!0&&(o=!1),o}};return{ai1ec_convert_commas_to_dots_for_coordinates:r,ai1ec_show_error_message_after_element:i,check_if_address_or_coordinates_are_set:o,ai1ec_check_lat_long_fields_filled_when_publishing_event:u,ai1ec_check_lat_long_ok_for_search:a}}),timely.define("external_libs/jquery.autocomplete_geomod",["jquery_timely"],function(e){e.fn.extend({autocomplete:function(t,n){var r=typeof t=="string";return n=e.extend({},e.Autocompleter.defaults,{url:r?t:null,data:r?null:t,delay:r?e.Autocompleter.defaults.delay:10,max:n&&!n.scroll?10:150},n),n.highlight=n.highlight||function(e){return e},n.formatMatch=n.formatMatch||n.formatItem,this.each(function(){new e.Autocompleter(this,n)})},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,n){function d(){var r=h.selected();if(!r)return!1;var s=r.result;o=s;if(n.multiple){var u=m(i.val());if(u.length>1){var a=n.multipleSeparator.length,f=e(t).selection().start,l,c=0;e.each(u,function(e,t){c+=t.length;if(f<=c)return l=e,!1;c+=a}),u[l]=s,s=u.join(n.multipleSeparator)}s+=n.multipleSeparator}return i.val(s),w(),i.trigger("result",[r.data,r.value]),!0}function v(e,t){if(f==r.DEL){h.hide();return}var s=i.val();if(!t&&s==o)return;o=s,s=g(s),s.length>=n.minChars?(i.addClass(n.loadingClass),n.matchCase||(s=s.toLowerCase()),S(s,E,w)):(T(),h.hide())}function m(t){return t?n.multiple?e.map(t.split(n.multipleSeparator),function(n){return e.trim(t).length?e.trim(n):null}):[e.trim(t)]:[""]}function g(r){if(!n.multiple)return r;var i=m(r);if(i.length==1)return i[0];var s=e(t).selection().start;return s==r.length?i=m(r):i=m(r.replace(r.substring(s),"")),i[i.length-1]}function y(s,u){n.autoFill&&g(i.val()).toLowerCase()==s.toLowerCase()&&f!=r.BACKSPACE&&(i.val(i.val()+u.substring(g(o).length)),e(t).selection(o.length,o.length+u.length))}function b(){clearTimeout(s),s=setTimeout(w,200)}function w(){var e=h.visible();h.hide(),clearTimeout(s),T(),n.mustMatch&&i.search(function(e){if(!e)if(n.multiple){var t=m(i.val()).slice(0,-1);i.val(t.join(n.multipleSeparator)+(t.length?n.multipleSeparator:""))}else i.val(""),i.trigger("result",null)})}function E(e,t){t&&t.length&&a?(T(),h.display(t,e),y(e,t[0].value),h.show()):w()}function S(r,i,s){n.matchCase||(r=r.toLowerCase());var o=u.load(r);if(o&&o.length)i(r,o);else if(n.geocoder){var a=g(r),f={address:a};n.region&&(f.region=n.region),n.geocoder.geocode(f,function(e,t){var s=n.parse(e,t,a);u.add(r,s),i(r,s)})}else if(typeof n.url=="string"&&n.url.length>0){var l={timestamp:+(new Date)};e.each(n.extraParams,function(e,t){l[e]=typeof t=="function"?t():t}),e.ajax({mode:"abort",port:"autocomplete"+t.name,dataType:n.dataType,url:n.url,data:e.extend({q:g(r),limit:n.max},l),success:function(e){var t=n.parse&&n.parse(e)||x(e);u.add(r,t),i(r,t)}})}else h.emptyList(),s(r)}function x(t){var r=[],i=t.split("\n");for(var s=0;s<i.length;s++){var o=e.trim(i[s]);o&&(o=o.split("|"),r[r.length]={data:o,value:o[0],result:n.formatResult&&n.formatResult(o,o[0])||o[0]})}return r}function T(){i.removeClass(n.loadingClass)}var r={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},i=e(t).attr("autocomplete","off").addClass(n.inputClass),s,o="",u=e.Autocompleter.Cache(n),a=0,f,l=navigator.userAgent.match(/opera/i),c={mouseDownOnSelect:!1},h=e.Autocompleter.Select(n,t,d,c),p;l&&e(t.form).bind("submit.autocomplete",function(){if(p)return p=!1,!1}),i.bind((l?"keypress":"keydown")+".autocomplete",function(t){a=1,f=t.keyCode;switch(t.keyCode){case r.UP:t.preventDefault(),h.visible()?h.prev():v(0,!0);break;case r.DOWN:t.preventDefault(),h.visible()?h.next():v(0,!0);break;case r.PAGEUP:t.preventDefault(),h.visible()?h.pageUp():v(0,!0);break;case r.PAGEDOWN:t.preventDefault(),h.visible()?h.pageDown():v(0,!0);break;case n.multiple&&e.trim(n.multipleSeparator)==","&&r.COMMA:case r.TAB:case r.RETURN:if(d())return t.preventDefault(),p=!0,!1;break;case r.ESC:h.hide();break;default:clearTimeout(s),s=setTimeout(v,n.delay)}}).focus(function(){a++}).blur(function(){a=0,c.mouseDownOnSelect||b()}).click(function(){a++>1&&!h.visible()&&v(0,!0)}).bind("search",function(){function n(e,n){var r;if(n&&n.length)for(var s=0;s<n.length;s++)if(n[s].result.toLowerCase()==e.toLowerCase()){r=n[s];break}typeof t=="function"?t(r):i.trigger("result",r&&[r.data,r.value])}var t=arguments.length>1?arguments[1]:null;e.each(m(i.val()),function(e,t){S(t,n,n)})}).bind("flushCache",function(){u.flush()}).bind("setOptions",function(){e.extend(n,arguments[1]),"data"in arguments[1]&&u.populate()}).bind("unautocomplete",function(){h.unbind(),i.unbind(),e(t.form).unbind(".autocomplete")})},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){function i(e,n){t.matchCase||(e=e.toLowerCase());var r=e.indexOf(n);return t.matchContains=="word"&&(r=e.toLowerCase().search("\\b"+n.toLowerCase())),r==-1?!1:r==0||t.matchContains}function s(e,i){r>t.cacheLength&&u(),n[e]||r++,n[e]=i}function o(){if(!t.data)return!1;var n={},r=0;t.url||(t.cacheLength=1),n[""]=[];for(var i=0,o=t.data.length;i<o;i++){var u=t.data[i];u=typeof u=="string"?[u]:u;var a=t.formatMatch(u,i+1,t.data.length);if(a===!1)continue;var f=a.charAt(0).toLowerCase();n[f]||(n[f]=[]);var l={value:a,data:u,result:t.formatResult&&t.formatResult(u)||a};n[f].push(l),r++<t.max&&n[""].push(l)}e.each(n,function(e,n){t.cacheLength++,s(e,n)})}function u(){n={},r=0}var n={},r=0;return setTimeout(o,25),{flush:u,add:s,populate:o,load:function(s){if(!t.cacheLength||!r)return null;if(!t.url&&t.matchContains){var o=[];for(var u in n)if(u.length>0){var a=n[u];e.each(a,function(e,t){i(t.value,s)&&o.push(t)})}return o}if(n[s])return n[s];if(t.matchSubset)for(var f=s.length-1;f>=t.minChars;f--){var a=n[s.substr(0,f)];if(a){var o=[];return e.each(a,function(e,t){i(t.value,s)&&(o[o.length]=t)}),o}}return null}}},e.Autocompleter.Select=function(t,n,r,i){function p(){if(!l)return;c=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),h=e("<ul/>").appendTo(c).mouseover(function(t){d(t).nodeName&&d(t).nodeName.toUpperCase()=="LI"&&(u=e("li",h).removeClass(s.ACTIVE).index(d(t)),e(d(t)).addClass(s.ACTIVE))}).click(function(t){return e(d(t)).addClass(s.ACTIVE),r(),n.focus(),!1}).mousedown(function(){i.mouseDownOnSelect=!0}).mouseup(function(){i.mouseDownOnSelect=!1}),t.width>0&&c.css("width",t.width),l=!1}function d(e){var t=e.target;while(t&&t.tagName!="LI")t=t.parentNode;return t?t:[]}function v(e){o.slice(u,u+1).removeClass(s.ACTIVE),m(e);var n=o.slice(u,u+1).addClass(s.ACTIVE);if(t.scroll){var r=0;o.slice(0,u).each(function(){r+=this.offsetHeight}),r+n[0].offsetHeight-h.scrollTop()>h[0].clientHeight?h.scrollTop(r+n[0].offsetHeight-h.innerHeight()):r<h.scrollTop()&&h.scrollTop(r)}}function m(e){u+=e,u<0?u=o.size()-1:u>=o.size()&&(u=0)}function g(e){return t.max&&t.max<e?t.max:e}function y(){h.empty();var n=g(a.length);for(var r=0;r<n;r++){if(!a[r])continue;var i=t.formatItem(a[r].data,r+1,n,a[r].value,f);if(i===!1)continue;var l=e("<li/>").html(t.highlight(i,f)).addClass(r%2==0?"ac_even":"ac_odd").appendTo(h)[0];e.data(l,"ac_data",a[r])}o=h.find("li"),t.selectFirst&&(o.slice(0,1).addClass(s.ACTIVE),u=0),e.fn.bgiframe&&h.bgiframe()}var s={ACTIVE:"ac_over"},o,u=-1,a,f="",l=!0,c,h;return{display:function(e,t){p(),a=e,f=t,y()},next:function(){v(1)},prev:function(){v(-1)},pageUp:function(){u!=0&&u-8<0?v(-u):v(-8)},pageDown:function(){u!=o.size()-1&&u+8>o.size()?v(o.size()-1-u):v(8)},hide:function(){c&&c.hide(),o&&o.removeClass(s.ACTIVE),u=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(o.filter("."+s.ACTIVE)[0]||t.selectFirst&&o[0])},show:function(){var r=e(n).offset();c.css({width:typeof t.width=="string"||t.width>0?t.width:e(n).width(),top:r.top+n.offsetHeight,left:r.left}).show();if(t.scroll){h.scrollTop(0),h.css({maxHeight:t.scrollHeight,overflow:"auto"});if(navigator.userAgent.match(/msie/i)&&typeof document.body.style.maxHeight=="undefined"){var i=0;o.each(function(){i+=this.offsetHeight});var s=i>t.scrollHeight;h.css("height",s?t.scrollHeight:i),s||o.width(h.width()-parseInt(o.css("padding-left"))-parseInt(o.css("padding-right")))}}},selected:function(){var t=o&&o.filter("."+s.ACTIVE).removeClass(s.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){h&&h.empty()},unbind:function(){c&&c.remove()}}},e.fn.selection=function(e,t){if(e!==undefined)return this.each(function(){if(this.createTextRange){var n=this.createTextRange();t===undefined||e==t?(n.move("character",e),n.select()):(n.collapse(!0),n.moveStart("character",e),n.moveEnd("character",t),n.select())}else this.setSelectionRange?this.setSelectionRange(e,t):this.selectionStart&&(this.selectionStart=e,this.selectionEnd=t)});var n=this[0];if(n.createTextRange){var r=document.selection.createRange(),i=n.value,s="<->",o=r.text.length;r.text=s;var u=n.value.indexOf(s);return n.value=i,this.selection(u,u+o),{start:u,end:u+o}}if(n.selectionStart!==undefined)return{start:n.selectionStart,end:n.selectionEnd}}}),timely.define("external_libs/geo_autocomplete",["jquery_timely","external_libs/jquery.autocomplete_geomod"],function(e){e.fn.extend({geo_autocomplete:function(t,n){return options=e.extend({},e.Autocompleter.defaults,{geocoder:t,mapwidth:100,mapheight:100,maptype:"terrain",mapkey:"ABQIAAAAbnvDoAoYOSW2iqoXiGTpYBT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQNumU68AwGqjbSNF9YO8NokKst8w",mapsensor:!1,parse:function(t,n,r){var i=[];return t&&n&&n=="OK"&&e.each(t,function(t,n){if(n.geometry&&n.geometry.viewport){var s=n.formatted_address.split(","),o=s[0];e.each(s,function(t,n){if(n.toLowerCase().indexOf(r.toLowerCase())!=-1)return o=e.trim(n),!1}),i.push({data:n,value:o,result:o})}}),i},formatItem:function(e,t,n,r){var i="https://maps.google.com/maps/api/staticmap?visible="+e.geometry.viewport.getSouthWest().toUrlValue()+"|"+e.geometry.viewport.getNorthEast().toUrlValue()+"&size="+options.mapwidth+"x"+options.mapheight+"&maptype="+options.maptype+"&key="+options.mapkey+"&sensor="+(options.mapsensor?"true":"false"),s=e.formatted_address.replace(/,/gi,",<br/>");return'<img src="'+i+'" width="'+options.mapwidth+'" height="'+options.mapheight+'" /> '+s+'<br clear="both"/>'}},n),options.highlight=options.highlight||function(e){return e},options.formatMatch=options.formatMatch||options.formatItem,options.resultsClass="ai1ec-geo-ac-results-not-ready",this.each(function(){e(this).one("focus",function(){var t=setInterval(function(){var n=e(".ai1ec-geo-ac-results-not-ready");n.length&&(n.removeClass("ai1ec-geo-ac-results-not-ready").addClass("ai1ec-geo-ac-results").children("ul").addClass("ai1ec-dropdown-menu"),clearInterval(t))},500)}),new e.Autocompleter(this,options)})}})}),timely.define("scripts/calendar_feeds",["jquery_timely","domReady","scripts/calendar_feeds/ics/ics_event_handlers","libs/select2_multiselect_helper","libs/tags_select","libs/utils","ai1ec_config","libs/gmaps","external_libs/jquery_cookie","external_libs/bootstrap/tab","external_libs/bootstrap/alert","external_libs/bootstrap/modal","external_libs/bootstrap/button","external_libs/bootstrap/collapse","scripts/add_new_event/event_location/input_coordinates_utility_functions","external_libs/jquery.autocomplete_geomod","external_libs/geo_autocomplete"],function(e,t,n,r,i,s,o,u){var a=function(){var t=e(this.hash);r.refresh(t),i.refresh(t)},f=function(t){var n=e(this).attr("href");e.cookie("feeds_active_tab",n),"#suggested"===n&&g()},l=function(){var t=e("#ai1ec-feeds-after"),s=e(".ai1ec_submit_wrapper"),l=e(".ai1ec_file_upload_tags_categories");r.init(t),i.init(t),r.init(s),i.init(s),r.init(l),i.init(l),e("ul.ai1ec-nav a").on("click",f),e("ul.ai1ec-nav a").on("shown",a),e('select[name="cron_freq"]').on("change",function(){e.ajax({url:ajaxurl,type:"POST",data:{action:"ai1ec_feeds_page_post",cron_freq:this.value}})}),e("#ai1ec-ics-modal").on("click",".remove, .keep",n.submit_delete_modal),e(document).on("click","#ai1ec_add_new_ics",n.add_new_feed).on("click",".ai1ec_delete_ics",n.open_delete_modal).on("click",".ai1ec_update_ics",n.update_feed).on("click",".ai1ec_edit_ics",n.edit_feed).on("click","#ai1ec_cancel_ics",n.edit_cancel).on("click",".ai1ec-panel-heading > a",n.edit_cancel).on("click",'.ai1ec-feed-container .ai1ec-panel-heading a, .ai1ec-nav-tabs a[href="#import"]',n.edit_cancel),e(document).on("click",".ai1ec-suggested-import-event",function(){var t=e(this),n=t.closest(".ai1ec-suggested-event-import"),r=e.parseJSON(t.closest(".ai1ec-infowindow, tr").attr("data-event"));return e("a.ai1ec-suggested-processing",n).removeClass("ai1ec-hidden"),t.addClass("ai1ec-hidden"),e.ajax({url:o.ajax_url,type:"POST",data:{action:"ai1ec_import_suggested_event",ai1ec_feed_url:r.url,ai1ec_feed_id:r.feed_id,ai1ec_event_id:r.id},success:function(t){e("a.ai1ec-suggested-processing",n).addClass("ai1ec-hidden"),t.error?(e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden"),e("#ai1ec-discovery-status").addClass("ai1ec-error").text(o.discovery_event_error).hide().fadeIn()):(e("a.ai1ec-suggested-remove-event",n).removeClass("ai1ec-hidden"),e("#ai1ec-discovery-status").removeClass("ai1ec-error").text(o.discovery_event_success).hide().fadeIn())},error:function(){e("a.ai1ec-suggested-processing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden"),e("#ai1ec-discovery-status").addClass("ai1ec-error").text(o.discovery_event_error).hide().fadeIn()}}),!1}),e(document).on("click",".ai1ec-suggested-remove-event",function(){var t=e(this),n=t.closest(".ai1ec-suggested-event-import, .ai1ec-myfeeds-event"),r=t.closest(".ai1ec-infowindow, tr"),i=t.closest(".ai1ec-myfeeds-event"),s=r.length?e.parseJSON(r.attr("data-event")):null,u=s?s.id:i.attr("data-event-id"),a=s?s.feed_id:i.attr("data-feed-id");return e("a.ai1ec-suggested-removing",n).removeClass("ai1ec-hidden"),t.addClass("ai1ec-hidden"),i.addClass("ai1ec-myfeeds-removing"),e.ajax({url:o.ajax_url,type:"POST",data:{action:"ai1ec_remove_suggested_event",ai1ec_event_id:u,ai1ec_feed_id:a,ai1ec_delete:!0},success:function(t){e("a.ai1ec-suggested-removing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-import-event",n).removeClass("ai1ec-hidden"),i.length&&!i.closest(".ai1ec-feed-category").find(".ai1ec-myfeeds-event").not(".ai1ec-myfeeds-removing").length&&i.closest(".ai1ec-feed-container").remove(),i.remove()},error:function(){e("a.ai1ec-suggested-removing",n).addClass("ai1ec-hidden"),e("a.ai1ec-suggested-remove-event",n).removeClass("ai1ec-hidden")}}),!1}),e(document).on("click",".ai1ec-suggested-view-selector > a",function(){var t=e(this),n=t.parent(),r=t.attr("data-ai1ec-view");return e("#suggested").removeClass(function(e,t){return(t.match(/(^|\s)ai1ec-feeds-\S+/g)||[]).join(" ")}).addClass("ai1ec-feeds-"+r),n.find("a.ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active").blur(),e("[data-ai1ec-show]").hide().filter('[data-ai1ec-show~="'+r+'"]').show(),"list"!==r&&u(function(){d(!0)}),!1}),e(document).on("click","a.ai1ec-suggested-title",function(){var t=e(this),n=t.closest("tr"),r=e.parseJSON(n.attr("data-event"));if(n.hasClass("ai1ec-suggested-hover"))e("#ai1ec_events_map_canvas").removeClass("goes-left"),n.removeClass("ai1ec-suggested-hover");else{e(".ai1ec-suggested-hover").removeClass("ai1ec-suggested-hover"),n.addClass("ai1ec-suggested-hover"),e("#ai1ec_events_map_canvas").addClass("goes-left");var i=e("#ai1ec_events_extra_details").html("");r.image_url&&i.append(e("<img />",{src:r.image_url,alt:""})),i.append(e('<a href="#" class="ai1ec-btn ai1ec-btn-primary ai1ec-btn-sm 						ai1ec-open-event" target="_blank">						<i class="ai1ec-fa ai1ec-fa-external-link ai1ec-fa-xs ai1ec-fa-fw"></i>						Open</a>')).append(e('<div class="ai1ec-extra-title"></div>').text(r.title)).append(e('<div class="ai1ec-extra-date"></div>').text(r.dtstart)).append(e('<div class="ai1ec-extra-venue"></div>').text(r.venue_name)).append(e('<div class="ai1ec-extra-location"></div>').text(r.location)).append(e('<div class="ai1ec-extra-description"></div>').text(e("<div />").html(r.description).text()))}return t.blur(),!1}),e(document).on("click",".ai1ec-feeds-list-container a.page-numbers",function(){var t=this.href.match(/pagenum=(\d+)/);return t&&1<t.length&&(t=t[1],e(".ai1ec-suggested-events").addClass("ai1ec-feeds-loading"),m({page:t})),!1}),e("#ai1ec_suggested_search").on("click",function(){return e("#ai1ec_events_map_canvas").removeClass("goes-left"),e("tr.ai1ec-suggested-hover a.ai1ec-suggested-title").click(),m(),!1}),e("#ai1ec_suggested_term").on("keydown change",function(){e(this).removeClass("ai1ec-error")})},c,h=[],p,d=function(t){var n={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,zoomControl:!0,scaleControl:!0},r=null,i=null,s=e(".ai1ec-suggested-events-actions-template").html(),o=new google.maps.InfoWindow({maxWidth:260}),u=function(e){var t='<div class="ai1ec-infowindow" data-event-id="'+e.id+'"><div class="ai1ec-infowindow-title"><b>'+e.title+"</b></div>"+e.dtstart.substr(0,10)+" @ "+e.venue_name+"<br>"+s+"</div>";o.setContent(t)},a=!t;p=function(){var t=[];for(var n=0;n<h.length;n++)e('tr[data-event-id="'+h[n].event_id+'"]').length?t.push(h[n].event_id):(h[n].setMap(null),h[n]=null);e("tr.ai1ec-suggested-event").each(function(){var n=e(this),r=e.parseJSON(n.attr("data-event"));if(!r||!r.latitude||!r.longitude)return;if(-1!=e.inArray(t,r.id))return;var i=new google.maps.Marker({map:c,title:r.title,position:new google.maps.LatLng(r.latitude,r.longitude)});i.event_id=r.id,i.addListener("click",function(){u(r),o.open(c,this)}),i.addListener("mouseover",function(){e('tr[data-event-id="'+this.event_id+'"]').addClass("ai1ec-suggested-hover")}),i.addListener("mouseout",function(){e('tr[data-event-id="'+this.event_id+'"]').removeClass("ai1ec-suggested-hover")}),h.push(i)}),h=h.filter(function(e){return e!==null})},t&&(c=new google.maps.Map(e("#ai1ec_events_map_canvas").get(0),n)),p(),v(t);var f=function(t,n){if("zoom_changed"===t&&!n)return a=!0,!1;clearTimeout(r),i&&4!=i.readystate&&(i.abort(),i=null,e(".ai1ec-suggested-events").removeClass("ai1ec-feeds-loading")),r=setTimeout(function(){var n=c.getCenter(),r=n.lat(),s=n.lng(),o=c.getBounds();e(".ai1ec-suggested-events").addClass("ai1ec-feeds-loading"),i=m({lat:r,lng:s,radius:b(r,s,o.getNorthEast().lat(),o.getNorthEast().lng(),o.getSouthWest().lat(),o.getSouthWest().lng())},p,t)},1e3)};t&&(c.addListener("dragend",function(){f("dragend",!0)},!1),c.addListener("zoom_changed",function(){f("zoom_changed",a)},!1))},v=function(t){if(!h.length||!t)return;var n=new google.maps.LatLngBounds,r=parseFloat(e("#ai1ec_suggested_lat").val()),i=parseFloat(e("#ai1ec_suggested_lng").val()),s=parseFloat(e("#ai1ec_suggested_radius").val());for(var o=0;o<h.length;o++)n.extend(h[o].getPosition());c.fitBounds(n),new google.maps.Circle({center:new google.maps.LatLng(r,i),fillOpacity:.05,strokeOpacity:.3,strokeWeight:1,map:c,radius:s*1e3})},m=function(t,n,r){return e("#ai1ec_suggested_term").removeClass("ai1ec-error"),t=e.extend({action:"ai1ec_search_events",term:e.trim(e("#ai1ec_suggested_term").val()),location:e.trim(e("#ai1ec_suggested_location").val()),lat:e("#ai1ec_suggested_lat").val(),lng:e("#ai1ec_suggested_lng").val(),radius:e("#ai1ec_suggested_radius").val()},t),e.ajax({url:o.ajax_url,type:"POST",data:t,success:function(i){i=e.parseJSON(i);if(!i)return;i.total?(e("#suggested").addClass("ai1ec-has-map"),e(".ai1ec-suggested-results").show(),e(".ai1ec-suggested-no-results").hide(),e(".ai1ec-feeds-list-container").html(i.list),e(".ai1ec-suggested-results-found").text(i.total),u(function(){d(!t||!n)}),e(".ai1ec-feeds-list-container tr.ai1ec-suggested-event").each(function(){var t=e(this),n=e.parseJSON(t.attr("data-event"));for(var r=0;r<i.imported.length;r++)if(i.imported[r].feed_id==n.feed_id&&i.imported[r].feed_events_uids[n.id]){e(".ai1ec-suggested-remove-event",t).removeClass("ai1ec-hidden"),e(".ai1ec-suggested-import-event",t).addClass("ai1ec-hidden");break}})):(e(".ai1ec-suggested-results-found").text("0"),r||(e("#suggested").removeClass("ai1ec-has-map"),e(".ai1ec-suggested-results").hide(),e(".ai1ec-suggested-no-results").show()),e(".ai1ec-feeds-list-container").html("")),n&&n.apply()}})},g=function(){setTimeout(function(){u(function(){d(!0)})},0)},y=function(){var t=e("#ai1ec_suggested_location"),n=e("#ai1ec_suggested_radius"),r=e("#ai1ec_suggested_lat"),i=e("#ai1ec_suggested_lng"),s=function(){n.val(""),r.val(""),i.val("")};e("#ai1ec_suggested_location").on("change",function(){s()}).geo_autocomplete(new google.maps.Geocoder,{selectFirst:!0,minChars:2,cacheLength:100,width:400,scroll:!0,scrollHeight:500,autoFill:!0}).result(function(e,o){if(o&&o.geometry&&o.formatted_address){var u=o.formatted_address,a=o.geometry.location.lat(),f=o.geometry.location.lng(),l=o.geometry.viewport;t.val(u),n.val(b(a,f,l.getNorthEast().lat(),l.getNorthEast().lng(),l.getSouthWest().lat(),l.getSouthWest().lng())),r.val(a),i.val(f)}else s()})},b=function(e,t,n,r,i,s){var o=n-i,u=r-s,a=o/.009,f=u/.009/Math.cos(e*Math.PI/180),l=Math.max(a,f),c=l/2;return c},w=function(){var n=E("suggestion");t(function(){n==undefined?s.activate_saved_tab_on_page_load(e.cookie("feeds_active_tab")):(s.activate_saved_tab_on_page_load("#import"),e("#ai1ec_feed_url").val(decodeURI(n))),l(),u(y)})},E=function(t){var n=decodeURIComponent(window.location.search.substring(1)),r=n.split("&"),i,s;for(s=0;s<r.length;s++){i=r[s].split("=");if(i[0]===t)return i[1]===undefined?!0:i[1]}};return{start:w}}),timely.require(["scripts/calendar_feeds"],function(e){e.start()}),timely.define("pages/calendar_feeds",function(){});

==================================================
FILE PATH: ./public/js/pages/admin_settings.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: button.js v3.0.3
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: transition.js v3.0.3
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.0.3
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* =========================================================
 * bootstrap-datepicker.js
 * Repo: https://github.com/eternicode/bootstrap-datepicker/
 * Demo: http://eternicode.github.io/bootstrap-datepicker/
 * Docs: http://bootstrap-datepicker.readthedocs.org/
 * Forked from http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Started by Stefan Petre; improvements by Andrew Rowls + contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("scripts/setting/cache/cache_ajax_handlers",["jquery_timely","libs/utils"],function(e,t){var n=function(n){var r=e("#ai1ec-button-refresh"),i=e("#ai1ec-cache-scan-success"),s=e("#ai1ec-cache-scan-danger"),o;r.button("reset"),n.error?o=t.make_alert(n.message,"error"):"0"===n.state?(i.toggleClass("ai1ec-hide",!0),s.toggleClass("ai1ec-hide",!1)):(i.toggleClass("ai1ec-hide",!1),s.toggleClass("ai1ec-hide",!0))};return{handle_rescan_cache:n}}),timely.define("scripts/setting/cache/cache_event_handlers",["jquery_timely","scripts/setting/cache/cache_ajax_handlers","libs/utils"],function(e,t,n){var r=n.get_ajax_url(),i=function(){var n=e(this);n.button("loading");var i={action:"ai1ec_rescan_cache"};return e.post(r,i,t.handle_rescan_cache,"json"),!1};return{perform_rescan:i}}),timely.define("external_libs/bootstrap/button",["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();e+="Text",i.resetText||n.data("resetText",n[r]()),n[r](i[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass("ai1ec-"+t).attr(t,t):n.removeClass("ai1ec-"+t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="ai1ec-buttons"]'),t=!0;if(e.length){var n=this.$element.find("input");n.prop("type")==="radio"&&(n.prop("checked")&&this.$element.hasClass("ai1ec-active")?t=!1:e.find(".ai1ec-active").removeClass("ai1ec-active")),t&&n.prop("checked",!this.$element.hasClass("ai1ec-active")).trigger("change")}t&&this.$element.toggleClass("ai1ec-active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=ai1ec-button]",function(t){var n=e(t.target);n.hasClass("ai1ec-btn")||(n=n.closest(".ai1ec-btn")),n.button("toggle"),t.preventDefault()})}),timely.define("external_libs/bootstrap/transition",["jquery_timely"],function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})}),timely.define("external_libs/bootstrap/collapse",["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("ai1ec-width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("ai1ec-in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .ai1ec-panel > .ai1ec-in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("ai1ec-collapse").addClass("ai1ec-collapsing")[i](0),this.transitioning=1;var s=function(){this.$element.removeClass("ai1ec-collapsing").addClass("ai1ec-in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("ai1ec-in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("ai1ec-collapsing").removeClass("ai1ec-collapse").removeClass("ai1ec-in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("ai1ec-collapsing").addClass("ai1ec-collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)},t.prototype.toggle=function(){this[this.$element.hasClass("ai1ec-in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=ai1ec-collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning)f&&f.find('[data-toggle=ai1ec-collapse][data-parent="'+a+'"]').not(n).addClass("ai1ec-collapsed"),n[s.hasClass("ai1ec-in")?"addClass":"removeClass"]("ai1ec-collapsed");s.collapse(u)})}),timely.define("libs/collapse_helper",["jquery_timely","domReady","external_libs/bootstrap/transition","external_libs/bootstrap/collapse"],function(e,t){t(function(){e(document).on("click",'[data-toggle="ai1ec-collapse"]',function(){e(this).toggleClass("ai1ec-active"),e(".ai1ec-fa-caret-down, .ai1ec-fa-caret-up, .ai1ec-fa-chevron-down, .ai1ec-fa-chevron-up, .ai1ec-fa-arrow-down, .ai1ec-fa-arrow-up",this).toggleClass("ai1ec-hide")})})}),timely.define("external_libs/locales/bootstrap-datepicker.bg",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.bg={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.br",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.br={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.cs",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.cs={days:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota","Nedle"],daysShort:["Ned","Pon","te","St","tv","Pt","Sob","Ned"],daysMin:["Ne","Po","t","St","t","P","So","Ne"],months:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],monthsShort:["Led","no","Be","Dub","Kv","er","nc","Srp","Z","j","Lis","Pro"],today:"Dnes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.da",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.da={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",clear:"Nulstil"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.de",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Lschen",weekStart:1,format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.es",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado","Domingo"],daysShort:["Dom","Lun","Mar","Mi","Jue","Vie","Sb","Dom"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fi",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fi={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai","sunnuntai"],daysShort:["sun","maa","tii","kes","tor","per","lau","sun"],daysMin:["su","ma","ti","ke","to","pe","la","su"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tnn",weekStart:1,format:"d.m.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],daysMin:["D","L","Ma","Me","J","V","S","D"],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],monthsShort:["Jan","Fv","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Dc"],today:"Aujourd'hui",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.id",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.id={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab","Mgu"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa","Mg"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.is",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.is={days:["Sunnudagur","Mnudagur","rijudagur","Mivikudagur","Fimmtudagur","Fstudagur","Laugardagur","Sunnudagur"],daysShort:["Sun","Mn","ri","Mi","Fim","Fs","Lau","Sun"],daysMin:["Su","M","r","Mi","Fi","F","La","Su"],months:["Janar","Febrar","Mars","Aprl","Ma","Jn","Jl","gst","September","Oktber","Nvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Ma","Jn","Jl","g","Sep","Okt","Nv","Des"],today:" Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.it",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.it={days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato","Domenica"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab","Dom"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa","Do"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ja",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ja={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],today:"",format:"yyyy/mm/dd"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.kr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.kr={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lt={days:["Sekmadienis","Pirmadienis","Antradienis","Treiadienis","Ketvirtadienis","Penktadienis","etadienis","Sekmadienis"],daysShort:["S","Pr","A","T","K","Pn","","S"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","t","Sk"],months:["Sausis","Vasaris","Kovas","Balandis","Gegu","Birelis","Liepa","Rugpjtis","Rugsjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"iandien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lv={days:["Svtdiena","Pirmdiena","Otrdiena","Trediena","Ceturtdiena","Piektdiena","Sestdiena","Svtdiena"],daysShort:["Sv","P","O","T","C","Pk","S","Sv"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se","Sv"],months:["Janvris","Februris","Marts","Aprlis","Maijs","Jnijs","Jlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],today:"odien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ms",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ms={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu","Ahad"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab","Aha"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa","Ah"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nb",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nb={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nl={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pl={days:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota","Niedziela"],daysShort:["Nie","Pn","Wt","r","Czw","Pt","So","Nie"],daysMin:["N","Pn","Wt","r","Cz","Pt","So","N"],months:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],monthsShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],today:"Dzisiaj",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt-BR",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["pt-BR"]={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pt={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ru",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ru={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sl={days:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota","Nedelja"],daysShort:["Ned","Pon","Tor","Sre","et","Pet","Sob","Ned"],daysMin:["Ne","Po","To","Sr","e","Pe","So","Ne"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sv={days:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Mn","Tis","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","M","Ti","On","To","Fr","L","S"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",format:"yyyy-mm-dd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.th",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.th={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["..","..","..","..","..","..","..","..","..","..","..",".."],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.tr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.tr={days:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],daysShort:["Pz","Pzt","Sal","r","Pr","Cu","Cts","Pz"],daysMin:["Pz","Pzt","Sa","r","Pr","Cu","Ct","Pz"],months:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],monthsShort:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],today:"Bugn",format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-CN",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-CN"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-TW",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-TW"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/bootstrap_datepicker",["jquery_timely","ai1ec_config","external_libs/locales/bootstrap-datepicker.bg","external_libs/locales/bootstrap-datepicker.br","external_libs/locales/bootstrap-datepicker.cs","external_libs/locales/bootstrap-datepicker.da","external_libs/locales/bootstrap-datepicker.de","external_libs/locales/bootstrap-datepicker.es","external_libs/locales/bootstrap-datepicker.fi","external_libs/locales/bootstrap-datepicker.fr","external_libs/locales/bootstrap-datepicker.id","external_libs/locales/bootstrap-datepicker.is","external_libs/locales/bootstrap-datepicker.it","external_libs/locales/bootstrap-datepicker.ja","external_libs/locales/bootstrap-datepicker.kr","external_libs/locales/bootstrap-datepicker.lt","external_libs/locales/bootstrap-datepicker.lv","external_libs/locales/bootstrap-datepicker.ms","external_libs/locales/bootstrap-datepicker.nb","external_libs/locales/bootstrap-datepicker.nl","external_libs/locales/bootstrap-datepicker.pl","external_libs/locales/bootstrap-datepicker.pt-BR","external_libs/locales/bootstrap-datepicker.pt","external_libs/locales/bootstrap-datepicker.ru","external_libs/locales/bootstrap-datepicker.sl","external_libs/locales/bootstrap-datepicker.sv","external_libs/locales/bootstrap-datepicker.th","external_libs/locales/bootstrap-datepicker.tr","external_libs/locales/bootstrap-datepicker.zh-CN","external_libs/locales/bootstrap-datepicker.zh-TW"],function(e,t){function r(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return r(e.getFullYear(),e.getMonth(),e.getDate())}function s(e){return function(){return this[e].apply(this,arguments)}}function f(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r)n.test(u)&&(s=u.replace(o,function(e,t){return t.toLowerCase()}),i[s]=r[u]);return i}function l(t){var n={};if(!d[t]){t=t.split("-")[0];if(!d[t])return}var r=d[t];return e.each(p,function(e,t){t in r&&(n[t]=r[t])}),n}var n=e(window),o=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){var t=e&&e.valueOf();for(var n=0,r=this.length;n<r;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){if(!t)return;e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t)},clear:function(){this.splice(0)},copy:function(){var e=new o;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),u=function(t,n){this.dates=new o,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".ai1ec-date")?this.element.find(".ai1ec-input-group, .ai1ec-input-group-addon, .ai1ec-btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(v.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("ai1ec-datepicker-inline").appendTo(this.element):this.picker.addClass("ai1ec-datepicker-dropdown ai1ec-dropdown-menu"),this.o.rtl&&this.picker.addClass("ai1ec-datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.ai1ec-today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};u.prototype={constructor:u,_process_options:function(n){this._o=e.extend({},this._o,n);var r=this.o=e.extend({},this._o),i=r.language;d[i]||(i=i.split("-")[0],d[i]||(i=t.language,d[i]||(i=h.language))),r.language=i;switch(r.startView){case 2:case"decade":r.startView=2;break;case 1:case"year":r.startView=1;break;default:r.startView=0}switch(r.minViewMode){case 1:case"months":r.minViewMode=1;break;case 2:case"years":r.minViewMode=2;break;default:r.minViewMode=0}r.startView=Math.max(r.startView,r.minViewMode),r.multidate!==!0&&(r.multidate=Number(r.multidate)||!1,r.multidate!==!1?r.multidate=Math.max(0,r.multidate):r.multidate=1),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7;var s=v.parseFormat(r.format);r.startDate!==-Infinity&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=v.parseDate(r.startDate,s,r.language):r.startDate=-Infinity),r.endDate!==Infinity&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=v.parseDate(r.endDate,s,r.language):r.endDate=Infinity),r.daysOfWeekDisabled=r.daysOfWeekDisabled||[],e.isArray(r.daysOfWeekDisabled)||(r.daysOfWeekDisabled=r.daysOfWeekDisabled.split(/[,\s]*/)),r.daysOfWeekDisabled=e.map(r.daysOfWeekDisabled,function(e){return parseInt(e,10)});var o=String(r.orientation).toLowerCase().split(/\s+/g),u=r.orientation.toLowerCase();o=e.grep(o,function(e){return/^auto|left|right|top|bottom$/.test(e)}),r.orientation={x:"auto",y:"auto"};if(!!u&&u!=="auto")if(o.length===1)switch(o[0]){case"top":case"bottom":r.orientation.y=o[0];break;case"left":case"right":r.orientation.x=o[0]}else u=e.grep(o,function(e){return/^left|right$/.test(e)}),r.orientation.x=u[0]||"auto",u=e.grep(o,function(e){return/^top|bottom$/.test(e)}),r.orientation.y=u[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(r=undefined,i=e[t][1]):e[t].length==3&&(r=e[t][1],i=e[t][2]),n.on(i,r)},_unapplyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(i=undefined,r=e[t][1]):e[t].length==3&&(i=e[t][1],r=e[t][2]),n.off(r,i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.dates.get(-1),i=this._utc_to_local(r);this.element.trigger({type:t,date:i,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){arguments.length===0?(e=this.dates.length-1,t=this.o.format):typeof e=="string"&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return v.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide")},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+e.getTimezoneOffset()*6e4)},_local_to_utc:function(e){return e&&new Date(e.getTime()-e.getTimezoneOffset()*6e4)},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){this.update.apply(this,arguments),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){this.update.apply(this,e.map(arguments,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(t){t===undefined&&(t=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return v.formatDate(e,t,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=this.picker.outerWidth(),r=this.picker.outerHeight(),i=10,s=n.width(),o=n.height(),u=n.scrollTop(),a=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,f=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=f.left,p=f.top;this.picker.removeClass("ai1ec-datepicker-orient-top ai1ec-datepicker-orient-bottom ai1ec-datepicker-orient-right ai1ec-datepicker-orient-left"),this.o.orientation.x!=="auto"?(this.picker.addClass("ai1ec-datepicker-orient-"+this.o.orientation.x),this.o.orientation.x==="right"&&(h-=t-c)):(this.picker.addClass("ai1ec-datepicker-orient-left"),f.left<0?h-=f.left-i:f.left+t>s&&(h=s-t-i));var d=this.o.orientation.y,v,m;d==="auto"&&(v=-u+f.top-r,m=u+o-(f.top+l+r),Math.max(v,m)===m?d="top":d="bottom"),this.picker.addClass("ai1ec-datepicker-orient-"+d),d==="top"?p+=l:p-=r+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:h,zIndex:a})},_allow_update:!0,update:function(){if(!this._allow_update)return;var t=this.dates.copy(),n=[],r=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),r=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n&&this.o.multidate?n=n.split(this.o.multidateSeparator):n=[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return v.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),r?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="ai1ec-cw">&nbsp;</th>';t+=n,this.picker.find(".ai1ec-datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7)t+='<th class="ai1ec-dow">'+d[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".ai1ec-datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="ai1ec-month">'+d[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".ai1ec-datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i?n.push("ai1ec-old"):(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i)&&n.push("ai1ec-new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("ai1ec-focused"),this.o.todayHighlight&&t.getUTCFullYear()==s.getFullYear()&&t.getUTCMonth()==s.getMonth()&&t.getUTCDate()==s.getDate()&&n.push("ai1ec-today"),this.dates.contains(t)!==-1&&n.push("ai1ec-active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("ai1ec-disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("ai1ec-range"),e.inArray(t.valueOf(),this.range)!=-1&&n.push("ai1ec-selected")),n},fill:function(){var t=new Date(this.viewDate),n=t.getUTCFullYear(),i=t.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f,l;this.picker.find(".ai1ec-datepicker-days thead th.ai1ec-datepicker-switch").text(d[this.o.language].months[i]+" "+n),this.picker.find("tfoot th.ai1ec-today").text(d[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.ai1ec-clear").text(d[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var c=r(n,i-1,28),h=v.getDaysInMonth(c.getUTCFullYear(),c.getUTCMonth());c.setUTCDate(h),c.setUTCDate(h-(c.getUTCDay()-this.o.weekStart+7)%7);var p=new Date(c);p.setUTCDate(p.getUTCDate()+42),p=p.valueOf();var m=[],g;while(c.valueOf()<p){if(c.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+c+(this.o.weekStart-c.getUTCDay()-7)%7*864e5),b=new Date(+y+(11-y.getUTCDay())%7*864e5),w=new Date(+(w=r(b.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="ai1ec-cw">'+E+"</td>")}}g=this.getClassNames(c),g.push("ai1ec-day");if(this.o.beforeShowDay!==e.noop){var S=this.o.beforeShowDay(this._utc_to_local(c));S===undefined?S={}:typeof S=="boolean"?S={enabled:S}:typeof S=="string"&&(S={classes:S}),S.enabled===!1&&g.push("ai1ec-disabled"),S.classes&&(g=g.concat(S.classes.split(/\s+/))),S.tooltip&&(f=S.tooltip)}g=e.unique(g),m.push('<td class="'+g.join(" ")+'"'+(f?' title="'+f+'"':"")+">"+c.getUTCDate()+"</td>"),c.getUTCDay()==this.o.weekEnd&&m.push("</tr>"),c.setUTCDate(c.getUTCDate()+1)}this.picker.find(".ai1ec-datepicker-days tbody").empty().append(m.join(""));var x=this.picker.find(".ai1ec-datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("ai1ec-active");e.each(this.dates,function(e,t){t.getUTCFullYear()==n&&x.eq(t.getUTCMonth()).addClass("ai1ec-active")}),(n<s||n>u)&&x.addClass("ai1ec-disabled"),n==s&&x.slice(0,o).addClass("ai1ec-disabled"),n==u&&x.slice(a+1).addClass("ai1ec-disabled"),m="",n=parseInt(n/10,10)*10;var T=this.picker.find(".ai1ec-datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;var N=e.map(this.dates,function(e){return e.getUTCFullYear()}),C;for(var k=-1;k<11;k++)C=["ai1ec-year"],k===-1?C.push("ai1ec-old"):k===10&&C.push("ai1ec-new"),e.inArray(n,N)!==-1&&C.push("ai1ec-active"),(n<s||n>u)&&C.push("ai1ec-disabled"),m+='<span class="'+C.join(" ")+'">'+n+"</span>",n+=1;T.html(m)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"})}},click:function(t){t.preventDefault();var n=e(t.target).closest("span, td, th"),i,s,o;if(n.length==1)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"ai1ec-datepicker-switch":this.showMode(1);break;case"ai1ec-prev":case"ai1ec-next":var u=v.modes[this.viewMode].navStep*(n[0].className=="ai1ec-prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,u),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,u),this.viewMode===1&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"ai1ec-today":var a=new Date;a=r(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var f=this.o.todayBtn=="linked"?null:"view";this._setDate(a,f);break;case"ai1ec-clear":var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input")),l&&l.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":n.is(".ai1ec-disabled")||(this.viewDate.setUTCDate(1),n.is(".ai1ec-month")?(o=1,s=n.parent().find("span").index(n),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1&&this._setDate(r(i,s,o))):(o=1,s=0,i=parseInt(n.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(r(i,s,o))),this.showMode(-1),this.fill());break;case"td":n.is(".ai1ec-day")&&!n.is(".ai1ec-disabled")&&(o=parseInt(n.text(),10)||1,i=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),n.is(".ai1ec-old")?s===0?(s=11,i-=1):s-=1:n.is(".ai1ec-new")&&(s==11?(s=0,i+=1):s+=1),this._setDate(r(i,s,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);e?t!==-1?this.dates.remove(t):this.dates.push(e):this.dates.clear();if(typeof this.o.multidate=="number")while(this.dates.length>this.o.multidate)this.dates.remove(0)},_setDate:function(e,t){(!t||t=="date")&&this._toggle_multidate(e&&new Date(e));if(!t||t=="view")this.viewDate=e&&new Date(e);this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),this.o.autoclose&&(!t||t=="date")&&this.hide()},moveMonth:function(e,t){if(!e)return undefined;if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,s,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n),s=new Date(o),s.setUTCDate(o.getUTCDate()+n)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n*7),s=new Date(o),s.setUTCDate(o.getUTCDate()+n*7)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:o=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(o),t=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(t){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".ai1ec-datepicker-"+v.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var a=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};a.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(this.updating)return;this.updating=!0;var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1)return;e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(r)});if(r<this.dates[i])while(i>=0&&r<this.dates[i])this.pickers[i--].setUTCDate(r);else if(r>this.dates[i])while(i<s&&r>this.dates[i])this.pickers[i++].setUTCDate(r);this.updateDates(),delete this.updating},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var c=e.fn.datepicker;e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof t=="object"&&t;if(!s){var c=f(this,"date"),p=e.extend({},h,c,o),d=l(p.language),v=e.extend({},h,d,c,o);if(i.is(".ai1ec-input-daterange")||v.inputs){var m={inputs:v.inputs||i.find("input").toArray()};i.data("datepicker",s=new a(this,e.extend(v,m)))}else i.data("datepicker",s=new u(this,v))}if(typeof t=="string"&&typeof s[t]=="function"){r=s[t].apply(s,n);if(r!==undefined)return!1}}),r!==undefined?r:this};var h=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=u;var d=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},v={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,v.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(t,n,i){if(!t)return undefined;if(t instanceof Date)return t;typeof n=="string"&&(n=v.parseFormat(n));if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){var s=/([\-+]\d+)([dmwy])/,o=t.match(/([\-+]\d+)([dmwy])/g),a,f;t=new Date;for(var l=0;l<o.length;l++){a=s.exec(o[l]),f=parseInt(a[1]);switch(a[2]){case"d":t.setUTCDate(t.getUTCDate()+f);break;case"m":t=u.prototype.moveMonth.call(u.prototype,t,f);break;case"w":t.setUTCDate(t.getUTCDate()+f*7);break;case"y":t=u.prototype.moveYear.call(u.prototype,t,f)}}return r(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}var o=t&&t.match(this.nonpunctuation)||[],t=new Date,c={},h=["yyyy","yy","M","MM","m","mm","d","dd"],p={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;p.M=p.MM=p.mm=p.m,p.dd=p.d,t=r(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var y=n.parts.slice();o.length!=y.length&&(y=e(y).filter(function(t,n){return e.inArray(n,h)!==-1}).toArray());if(o.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(o[l],10),a=y[l];if(isNaN(m))switch(a){case"MM":g=e(d[i].months).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].months)+1;break;case"M":g=e(d[i].monthsShort).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].monthsShort)+1}c[a]=m}for(var l=0,w,E;l<h.length;l++)E=h[l],E in c&&!isNaN(c[E])&&(w=new Date(t),p[E](w,c[E]),isNaN(w)||(t=w))}return t},formatDate:function(t,n,r){if(!t)return"";typeof n=="string"&&(n=v.parseFormat(n));var i={d:t.getUTCDate(),D:d[r].daysShort[t.getUTCDay()],DD:d[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:d[r].monthsShort[t.getUTCMonth()],MM:d[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="ai1ec-prev"><i class="ai1ec-fa ai1ec-fa-arrow-left"></i></th><th colspan="5" class="ai1ec-datepicker-switch"></th><th class="ai1ec-next"><i class="ai1ec-fa ai1ec-fa-arrow-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="ai1ec-today"></th></tr><tr><th colspan="7" class="ai1ec-clear"></th></tr></tfoot>'};v.template='<div class="timely ai1ec-datepicker"><div class="ai1ec-datepicker-days"><table class=" ai1ec-table-condensed">'+v.headTemplate+"<tbody></tbody>"+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-months">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-years">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=v,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=c,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),n.datepicker("show")}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()});for(var m=2,g=arguments.length;m<g;m++)arguments[m].localize()}),timely.define("external_libs/bootstrap/tooltip",["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}),timely.define("external_libs/jquery_cookie",["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),timely.define("scripts/admin_settings",["jquery_timely","domReady","ai1ec_config","libs/utils","scripts/setting/cache/cache_event_handlers","external_libs/bootstrap/button","libs/collapse_helper","external_libs/bootstrap/tab","external_libs/bootstrap_datepicker","external_libs/bootstrap/tooltip","external_libs/jquery_cookie"],function(e,t,n,r,i){var s=function(){var t=!0;e("#ai1ec-plugins-settings input:text").each(function(){this.value!==""&&(t=!1)}),t===!0&&e("#ai1ec-plugins-settings").remove()},o=function(t){var n=e(this).attr("href");e.cookie("ai1ec_general_settings_active_tab",n)},u=function(){var t=e("#week_view_starts_at"),r=e("#week_view_ends_at"),i=parseInt(t.val(),10),s=parseInt(r.val(),10);if(s<i)return window.alert(n.end_must_be_after_start),r.focus(),!1;var o=s-i;if(o<6)return window.alert(n.show_at_least_six_hours),r.focus(),!1},a=function(){e(".ai1ec-gzip-causes-js-failure").remove()},f=function(){e("#ai1ec_save_settings").on("click",function(t){var r=e("#require_disclaimer").is(":checked"),i=e("#disclaimer").val();!0===r&&""===i&&(alert(n.require_desclaimer),e('#ai1ec-general-settings ul.ai1ec-nav a[href="#ai1ec-advanced"]').tab("show"),e("#disclaimer").focus(),t.preventDefault())})},l=function(){e("fieldset.ai1ec-captcha_provider").addClass("ai1ec-hidden"),e(".ai1ec-"+e(this).val()).removeClass("ai1ec-hidden")},c=function(){t(function(){f(),a(),r.activate_saved_tab_on_page_load(e.cookie("ai1ec_general_settings_active_tab")),e(document).on("click",'#ai1ec-general-settings .ai1ec-nav a[data-toggle="ai1ec-tab"]',o),e(document).on("click","#disable_standard_filter_menu_toggler",function(e){e.preventDefault()}),e(document).on("click","#ai1ec-button-refresh",i.perform_rescan);var t=e("#exact_date");t.datepicker({autoclose:!0}),s(),e(document).on("click",".ai1ec-admin-view-settings .ai1ec-toggle-view",function(){var t=e(this),n=t.parent().index()+1;if(0===t.closest("tr").siblings().find("td:nth-child("+n+") .ai1ec-toggle-view:checked").length)return!1;if(t.parent().next("td").find(".ai1ec-toggle-default-view").is(":checked"))return!1});var n=function(){var t=e(this).closest(".ai1ec-form-group").nextAll(".ai1ec-form-group").slice(0,4);e(this).prop("checked")?t.show():t.hide()};n.apply(e("#affix_filter_menu").on("click",n)[0]),e(document).on("click",".ai1ec-admin-view-settings .ai1ec-toggle-default-view",function(){e(this).parent().prev("td").children(".ai1ec-toggle-view").prop("checked",!0)}),e(document).on("change","#captcha_provider",l),r.init_autoselect();var c=e.cookie("ai1ec_api_signup_hidden");1!=c&&e(".ai1ec-signup-show").click(),e("#ai1ec_save_settings").on("click",u),e("#show_create_event_button").trigger("ready")})};return e('[name="ai1ec_tickets_signin"]').on("click",function(){e(".ai1ec-ticket-field-error").hide(),e(".ai1ec-required:visible").each(function(){var t=e(this);t.removeClass("ai1ec-error");if(!e.trim(t.val())||"checkbox"===t.attr("type")&&!this.checked)t.addClass("ai1ec-error"),t.closest("td").find(".ai1ec-ticket-field-error").show()});if(!e(".ai1ec-ticket-field-error:visible").length){e(".ai1ec-noauto").remove();var t=e("#ai1ec-api-signup-form"),n=t.attr("data-action"),r=e("<form></form",{method:"POST",action:n,"class":"ai1ec-hidden"});t.appendTo(r),r.appendTo("body").submit()}return!1}),e('[name="ai1ec_signing"]').on("click",function(){e(".ai1ec-error").removeClass("ai1ec-error"),"2"===this.value?(e(".ai1ec-ticketing-signup tr").not(":first").not(".signin").hide(),e(".signin").removeClass("ai1ec-hidden")):(e(".ai1ec-ticketing-signup tr").show(),e(".signin:last").addClass("ai1ec-hidden"))}),e("#ai1ec-api-signout").on("click",function(){return e("#ai1ec-api-signout-confirm").show(),e(this).hide(),!1}),e("#ai1ec-api-signout-cancel").on("click",function(){return e("#ai1ec-api-signout-confirm").hide(),e("#ai1ec-api-signout").show(),!1}),e("#ai1ec-api-signout-confirm").on("click",function(){if(!e("#ai1ec-api-signout-confirm:visible").length)return!1;var t=e("#ai1ec-api-signed-in"),n=e("#ai1ec-api-signout").attr("data-action"),r=e('<input type="hidden" name="ai1ec_signout" value="1" />'),i=e("<form></form",{method:"POST",action:n,"class":"ai1ec-hidden"});return i.append(r,t).appendTo("body").submit(),!1}),e(".ai1ec-api-signup-hide").on("click",function(){return e("#ai1ec-api-signup-form").addClass("ai1ec-hidden"),e(".ai1ec-signup-show").removeClass("ai1ec-hidden").show(),e(this).hide(),e.cookie("ai1ec_api_signup_hidden",1),!1}),e(".ai1ec-signup-show").on("click",function(){return e("#ai1ec-api-signup-form").removeClass("ai1ec-hidden"),e(".ai1ec-api-signup-hide").removeClass("ai1ec-hidden").show(),e(this).hide(),e.cookie("ai1ec_api_signup_hidden",0),!1}),{start:c}}),timely.require(["scripts/admin_settings"],function(e){e.start()}),timely.define("pages/admin_settings",function(){});

==================================================
FILE PATH: ./public/js/pages/event.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("scripts/event/gmaps_helper",["jquery_timely"],function(e){var t=function(){var t=e("#ai1ec-gmap-address")[0].value.split(","),n=parseFloat(t[0]),r=parseFloat(t[1]),i=new google.maps.LatLng(n,r),s={zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1},o=new google.maps.Map(e("#ai1ec-gmap-canvas")[0],s),u=new google.maps.Marker({map:o}),a=new google.maps.Geocoder;n&&r&&i?(o.setCenter(i),u.setPosition(i)):a.geocode({address:e("#ai1ec-gmap-address")[0].value},function(e,t){t===google.maps.GeocoderStatus.OK&&(o.setCenter(e[0].geometry.location),u.setPosition(e[0].geometry.location))})},n=function(){var t=e(".ai1ec-gmap-container-hidden:first");e(this).remove(),t.hide(),t.removeClass("ai1ec-gmap-container-hidden"),t.fadeIn()};return{handle_show_map_when_clicking_on_placeholder:n,init_gmaps:t}}),timely.define("scripts/event",["jquery_timely","domReady","ai1ec_config","scripts/event/gmaps_helper"],function(e,t,n,r){var i=function(){e("#ai1ec-gmap-canvas").length>0&&timely.require(["libs/gmaps"],function(e){e(r.init_gmaps)})},s=function(){e(".ai1ec-gmap-placeholder:first").click(r.handle_show_map_when_clicking_on_placeholder),e(document).on("click","#ai1ec_tickets_submit",function(){return e(this).closest("form").submit(),!1})},o=function(){e("img[data-ai1ec-hidden]","#timely-description, #ai1ec-event-modal").each(function(){var t=e(this),n=e("#timely-event-poster img").attr("src");t.attr("src")!=n&&t.removeAttr("data-ai1ec-hidden")})},u=function(){t(function(){i(),s(),o(),e(document).trigger("event_page_ready.ai1ec"),e("body").addClass("ai1ec-event-details-ready")})};return{start:u}}),timely.require(["scripts/event"],function(e){e.start()}),timely.define("pages/event",function(){});

==================================================
FILE PATH: ./public/js/pages/less_variables_editing.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("external_libs/bootstrap_colorpicker",["jquery_timely"],function(e){var t=function(e){this.value={h:1,s:1,b:1,a:1},this.setColor(e)};t.prototype={constructor:t,setColor:function(t){t=t.toLowerCase();var n=this;e.each(r.stringParsers,function(e,i){var s=i.re.exec(t),o=s&&i.parse(s),u=i.space||"rgba";if(o)return u=="hsla"?n.value=r.RGBtoHSB.apply(null,r.HSLtoRGB.apply(null,o)):n.value=r.RGBtoHSB.apply(null,o),!1})},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt((1-e)*100,10)/100},toRGB:function(e,t,n,r){e||(e=this.value.h,t=this.value.s,n=this.value.b),e*=360;var i,s,o,u,a;return e=e%360/60,a=n*t,u=a*(1-Math.abs(e%2-1)),i=s=o=n-a,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],{r:Math.round(i*255),g:Math.round(s*255),b:Math.round(o*255),a:r||this.value.a}},toHex:function(e,t,n,r){var i=this.toRGB(e,t,n,r);return"#"+(1<<24|parseInt(i.r)<<16|parseInt(i.g)<<8|parseInt(i.b)).toString(16).substr(1)},toHSL:function(e,t,n,r){e||(e=this.value.h,t=this.value.s,n=this.value.b);var i=e,s=(2-t)*n,o=t*n;return s>0&&s<=1?o/=s:o/=2-s,s/=2,o>1&&(o=1),{h:i,s:o,l:s,a:r||this.value.a}}};var n=function(t,n){this.element=e(t);var i=n.format||this.element.data("color-format")||"hex";this.format=r.translateFormats[i],this.isInput=this.element.is("input"),this.component=this.element.is(".color")?this.element.find(".ai1ec-input-group-addon"):!1,this.picker=e(r.template).appendTo("body").on("mousedown",e.proxy(this.mousedown,this)),this.isInput?this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on({click:e.proxy(this.show,this)}):this.element.on({click:e.proxy(this.show,this)});if(i=="rgba"||i=="hsla")this.picker.addClass("alpha"),this.alpha=this.picker.find(".colorpicker-alpha")[0].style;this.component?(this.picker.find(".colorpicker-color").hide(),this.preview=this.element.find("i")[0].style):this.preview=this.picker.find("div:last")[0].style,this.base=this.picker.find("div:first")[0].style,this.update()};n.prototype={constructor:n,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),this.isInput||t&&(t.stopPropagation(),t.preventDefault()),e(document).on({mousedown:e.proxy(this.hide,this)}),this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new t(this.isInput?this.element.prop("value"):this.element.data("color")),this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a)),this.previewColor()},hide:function(){this.picker.hide(),e(window).off("resize",this.place),this.isInput?this.element.prop("value",this.format.call(this)):(e(document).off({mousedown:this.hide}),this.component&&this.element.find("input").prop("value",this.format.call(this)),this.element.data("color",this.format.call(this))),this.element.trigger({type:"hide",color:this.color})},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},previewColor:function(){this.preview.backgroundColor=this.format.call(this),this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1),this.alpha&&(this.alpha.backgroundColor=this.color.toHex())},pointer:null,slider:null,mousedown:function(t){t.stopPropagation(),t.preventDefault();var n=e(t.target),i=n.closest("div");if(!i.is(".colorpicker")){i.is(".colorpicker-saturation")?this.slider=e.extend({},r.sliders.saturation):i.is(".colorpicker-hue")?this.slider=e.extend({},r.sliders.hue):i.is(".colorpicker-alpha")&&(this.slider=e.extend({},r.sliders.alpha));var s=i.offset();this.slider.knob=i.find("i")[0].style,this.slider.left=t.pageX-s.left,this.slider.top=t.pageY-s.top,this.pointer={left:t.pageX,top:t.pageY},e(document).on({mousemove:e.proxy(this.mousemove,this),mouseup:e.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((e.pageX||this.pointer.left)-this.pointer.left))),n=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((e.pageY||this.pointer.top)-this.pointer.top)));return this.slider.knob.left=t+"px",this.slider.knob.top=n+"px",this.slider.callLeft&&this.color[this.slider.callLeft].call(this.color,t/100),this.slider.callTop&&this.color[this.slider.callTop].call(this.color,n/100),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),e(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),!1}},e.fn.colorpicker=function(t){return this.each(function(){var r=e(this),i=r.data("colorpicker"),s=typeof t=="object"&&t;i||r.data("colorpicker",i=new n(this,e.extend({},e.fn.colorpicker.defaults,s))),typeof t=="string"&&i[t]()})},e.fn.colorpicker.defaults={},e.fn.colorpicker.Constructor=n;var r={translateFormats:{rgb:function(){var e=this.color.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.color.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hsl:function(){var e=this.color.toHSL();return"hsl("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%)"},hsla:function(){var e=this.color.toHSL();return"hsla("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%,"+e.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},RGBtoHSB:function(e,t,n,r){e/=255,t/=255,n/=255;var i,s,o,u;return o=Math.max(e,t,n),u=o-Math.min(e,t,n),i=u==0?null:o==e?(t-n)/u:o==t?(n-e)/u+2:(e-t)/u+4,i=(i+360)%6*60/360,s=u==0?0:u/o,{h:i||1,s:s,b:o,a:r||1}},HueToRGB:function(e,t,n){return n<0?n+=1:n>1&&(n-=1),n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e},HSLtoRGB:function(e,t,n,i){t<0&&(t=0);if(n<=.5)var s=n*(1+t);else var s=n+t-n*t;var o=2*n-s,u=e+1/3,a=e,f=e-1/3,l=Math.round(r.HueToRGB(o,s,u)*255),c=Math.round(r.HueToRGB(o,s,a)*255),h=Math.round(r.HueToRGB(o,s,f)*255);return[l,c,h,i||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}}],template:'<div class="colorpicker ai1ec-dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}}),timely.define("external_libs/jquery_cookie",["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),timely.define("scripts/less_variables_editing",["jquery_timely","domReady","ai1ec_config","libs/utils","external_libs/bootstrap_colorpicker","external_libs/bootstrap/tab","external_libs/jquery_cookie"],function(e,t,n,r){var i=function(t){var n=e(this).attr("href");e.cookie("less_variables_active_tab",n)},s=function(t){t===null?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},o=function(){e(this).val()==="custom"?e(this).closest(".ai1ec-form-group").find(".ai1ec-custom-font").removeClass("ai1ec-hide"):e(this).closest(".ai1ec-form-group").find(".ai1ec-custom-font").addClass("ai1ec-hide")},u=function(){return window.confirm(n.confirm_reset_theme)},a=function(){var t=!0;return e(".ai1ec-less-variable-size").each(function(){var r=e(this),i=r.closest(".ai1ec-form-group"),s=e.trim(r.val());i.removeClass("ai1ec-has-warning");if(""===s)return;var o=/^auto$|^[+-]?[0-9]+\.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)?$/ig;if(!o.test(s)){t=!1;var u=i.closest(".ai1ec-tab-pane").attr("id");return i.closest(".ai1ec-tabbable").find('a[data-toggle="ai1ec-tab"][href="#'+u+'"]').trigger("click"),i.addClass("ai1ec-has-warning"),window.alert(n.size_less_variable_not_ok),r.trigger("focus"),!1}}),t};t(function(){e(".colorpickers").colorpicker(),r.activate_saved_tab_on_page_load(e.cookie("less_variables_active_tab")),e(document).on("click","ul.ai1ec-nav a",i).on("click","#ai1ec_reset_themes_options",u).on("change",".ai1ec_font",o),e("#ai1ec_save_themes_options").closest("form").on("submit",a)})}),timely.require(["scripts/less_variables_editing"]),timely.define("pages/less_variables_editing",function(){});

==================================================
FILE PATH: ./public/js/pages/event_category.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/colorpicker",["jquery_timely"],function(e){var t=function(){var t={},n,r=65,i,s='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',o={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},u=function(t,n){var r=q(t);e(n).data("colorpicker").fields.eq(1).val(r.r).end().eq(2).val(r.g).end().eq(3).val(r.b).end()},a=function(t,n){e(n).data("colorpicker").fields.eq(4).val(t.h).end().eq(5).val(t.s).end().eq(6).val(t.b).end()},f=function(t,n){e(n).data("colorpicker").fields.eq(0).val(U(t)).end()},l=function(t,n){e(n).data("colorpicker").selector.css("backgroundColor","#"+U({h:t.h,s:100,b:100})),e(n).data("colorpicker").selectorIndic.css({left:parseInt(150*t.s/100,10),top:parseInt(150*(100-t.b)/100,10)})},c=function(t,n){e(n).data("colorpicker").hue.css("top",parseInt(150-150*t.h/360,10))},h=function(t,n){e(n).data("colorpicker").currentColor.css("backgroundColor","#"+U(t))},p=function(t,n){e(n).data("colorpicker").newColor.css("backgroundColor","#"+U(t))},d=function(t){var n=t.charCode||t.keyCode||-1;if(n>r&&n<=90||n==32)return!1;var i=e(this).parent().parent();i.data("colorpicker").livePreview===!0&&v.apply(this)},v=function(t){var n=e(this).parent().parent(),r;this.parentNode.className.indexOf("_hex")>0?n.data("colorpicker").color=r=F(B(this.value)):this.parentNode.className.indexOf("_hsb")>0?n.data("colorpicker").color=r=P({h:parseInt(n.data("colorpicker").fields.eq(4).val(),10),s:parseInt(n.data("colorpicker").fields.eq(5).val(),10),b:parseInt(n.data("colorpicker").fields.eq(6).val(),10)}):n.data("colorpicker").color=r=I(H({r:parseInt(n.data("colorpicker").fields.eq(1).val(),10),g:parseInt(n.data("colorpicker").fields.eq(2).val(),10),b:parseInt(n.data("colorpicker").fields.eq(3).val(),10)})),t&&(u(r,n.get(0)),f(r,n.get(0)),a(r,n.get(0))),l(r,n.get(0)),c(r,n.get(0)),p(r,n.get(0)),n.data("colorpicker").onChange.apply(n,[r,U(r),q(r)])},m=function(t){var n=e(this).parent().parent();n.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},g=function(){r=this.parentNode.className.indexOf("_hex")>0?70:65,e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),e(this).parent().addClass("colorpicker_focus")},y=function(t){var n=e(this).parent().find("input").focus(),r={el:e(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:n,val:parseInt(n.val(),10),preview:e(this).parent().parent().data("colorpicker").livePreview};e(document).bind("mouseup",r,w),e(document).bind("mousemove",r,b)},b=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&v.apply(e.data.field.get(0),[!0]),!1},w=function(t){return v.apply(t.data.field.get(0),[!0]),t.data.el.removeClass("colorpicker_slider").find("input").focus(),e(document).unbind("mouseup",w),e(document).unbind("mousemove",b),!1},E=function(t){var n={cal:e(this).parent(),y:e(this).offset().top};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,x),e(document).bind("mousemove",n,S)},S=function(e){return v.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},x=function(t){return u(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),f(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",x),e(document).unbind("mousemove",S),!1},T=function(t){var n={cal:e(this).parent(),pos:e(this).offset()};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,C),e(document).bind("mousemove",n,N)},N=function(e){return v.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},C=function(t){return u(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),f(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",C),e(document).unbind("mousemove",N),!1},k=function(t){e(this).addClass("colorpicker_focus")},L=function(t){e(this).removeClass("colorpicker_focus")},A=function(t){var n=e(this).parent(),r=n.data("colorpicker").color;n.data("colorpicker").origColor=r,h(r,n.get(0)),n.data("colorpicker").onSubmit(r,U(r),q(r),n.data("colorpicker").el)},O=function(t){var n=e("#"+e(this).data("colorpickerId"));n.data("colorpicker").onBeforeShow.apply(this,[n.get(0)]);var r=e(this).offset(),i=D(),s=e("#tag-color").offset(),o=s.top+e("#tag-color").height(),u=s.left+1;return n.css({left:u+"px",top:o+"px"}),n.data("colorpicker").onShow.apply(this,[n.get(0)])!=0&&n.show(),e(document).bind("mousedown",{cal:n},M),!1},M=function(t){_(t.data.cal.get(0),t.target,t.data.cal.get(0))||(t.data.cal.data("colorpicker").onHide.apply(this,[t.data.cal.get(0)])!=0&&t.data.cal.hide(),e(document).unbind("mousedown",M))},_=function(e,t,n){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(e.compareDocumentPosition(t)&16);var r=t.parentNode;while(r&&r!=n){if(r==e)return!0;r=r.parentNode}return!1},D=function(){var e=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},P=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},H=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},B=function(e){var t=6-e.length;if(t>0){var n=[];for(var r=0;r<t;r++)n.push("0");n.push(e),e=n.join("")}return e},j=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}},F=function(e){return I(j(e))},I=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-n;return t.b=r,r!=0,t.s=r!=0?255*i/r:0,t.s!=0?e.r==r?t.h=(e.g-e.b)/i:e.g==r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},q=function(e){var t={},n=Math.round(e.h),r=Math.round(e.s*255/100),i=Math.round(e.b*255/100);if(r==0)t.r=t.g=t.b=i;else{var s=i,o=(255-r)*i/255,u=(s-o)*(n%60)/60;n==360&&(n=0),n<60?(t.r=s,t.b=o,t.g=o+u):n<120?(t.g=s,t.b=o,t.r=s-u):n<180?(t.g=s,t.r=o,t.b=o+u):n<240?(t.b=s,t.r=o,t.g=s-u):n<300?(t.b=s,t.g=o,t.r=o+u):n<360?(t.r=s,t.g=o,t.b=s-u):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},R=function(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(n,function(e,t){t.length==1&&(n[e]="0"+t)}),n.join("")},U=function(e){return R(q(e))},z=function(){var t=e(this).parent(),n=t.data("colorpicker").origColor;t.data("colorpicker").color=n,u(n,t.get(0)),f(n,t.get(0)),a(n,t.get(0)),l(n,t.get(0)),c(n,t.get(0)),p(n,t.get(0))};return{init:function(t){t=e.extend({},o,t||{});if(typeof t.color=="string")t.color=F(t.color);else if(t.color.r!=undefined&&t.color.g!=undefined&&t.color.b!=undefined)t.color=I(t.color);else{if(t.color.h==undefined||t.color.s==undefined||t.color.b==undefined)return this;t.color=P(t.color)}return this.each(function(){if(!e(this).data("colorpickerId")){var n=e.extend({},t);n.origColor=t.color;var r="collorpicker_"+parseInt(Math.random()*1e3);e(this).data("colorpickerId",r);var i=e(s).attr("id",r);n.flat?i.appendTo(this).show():i.appendTo(document.body),n.fields=i.find("input").bind("keyup",d).bind("change",v).bind("blur",m).bind("focus",g),i.find("span").bind("mousedown",y).end().find(">div.colorpicker_current_color").bind("click",z),n.selector=i.find("div.colorpicker_color").bind("mousedown",T),n.selectorIndic=n.selector.find("div div"),n.el=this,n.hue=i.find("div.colorpicker_hue div"),i.find("div.colorpicker_hue").bind("mousedown",E),n.newColor=i.find("div.colorpicker_new_color"),n.currentColor=i.find("div.colorpicker_current_color"),i.data("colorpicker",n),i.find("div.colorpicker_submit").bind("mouseenter",k).bind("mouseleave",L).bind("click",A),u(n.color,i.get(0)),a(n.color,i.get(0)),f(n.color,i.get(0)),c(n.color,i.get(0)),l(n.color,i.get(0)),h(n.color,i.get(0)),p(n.color,i.get(0)),n.flat?i.css({position:"relative",display:"block"}):e(this).bind(n.eventName,O)}})},showPicker:function(){return this.each(function(){e(this).data("colorpickerId")&&O.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colorpickerId")&&e("#"+e(this).data("colorpickerId")).hide()})},setColor:function(t){if(typeof t=="string")t=F(t);else if(t.r!=undefined&&t.g!=undefined&&t.b!=undefined)t=I(t);else{if(t.h==undefined||t.s==undefined||t.b==undefined)return this;t=P(t)}return this.each(function(){if(e(this).data("colorpickerId")){var n=e("#"+e(this).data("colorpickerId"));n.data("colorpicker").color=t,n.data("colorpicker").origColor=t,u(t,n.get(0)),a(t,n.get(0)),f(t,n.get(0)),c(t,n.get(0)),l(t,n.get(0)),h(t,n.get(0)),p(t,n.get(0))}})}}}();e.fn.extend({ColorPicker:t.init,ColorPickerHide:t.hidePicker,ColorPickerShow:t.showPicker,ColorPickerSetColor:t.setColor})}),timely.define("scripts/event_category",["jquery_timely","ai1ec_config","domReady","external_libs/colorpicker"],function(e,t,n){var r,i=function(n){n.preventDefault(),typeof r=="undefined"&&(r=wp.media.frames.file_frame=wp.media({title:t.choose_image_message,button:{text:t.choose_image_message},multiple:!1}),r.on("select",function(){var t=r.state().get("selection").first().toJSON();e("#ai1ec_category_imag_preview").attr("src",t.url),e("#ai1ec_category_image_url").val(t.url)})),r.open()};e("#tag-color").click(function(){var t=e("#tag-color").offset(),n=t.top+e("#tag-color").height(),r=t.left+1,i=e('<ul class="timely colorpicker-list"></ul>'),o=e('<li class="ai1ec-btn ai1ec-btn-xs ai1ec-btn-default ai1ec-btn-block"><i class="ai1ec-fa ai1ec-fa-ellipsis-h ai1ec-fa-lg"></i></li>'),a="",f;for(f=1;f<=32;f++)a+='<li class="color-'+f+'"></li>';a=e(a),o.ColorPicker({onSubmit:function(t,n,r,s){e("#tag-color-background").css("background-color","#"+n),e("#tag-color-value").val("#"+n),e(s).ColorPickerHide(),i.remove()},onBeforeShow:function(){i.hide(),e(document).unbind("mousedown",u);var t=e("#tag-color-value").val();t=t.length>0?t:"#ffffff",e(this).ColorPickerSetColor(t)}}),a.click(function(){var t=e(this).css("background-color");t="rgba(0, 0, 0, 0)"===t?"":s(t),e("#tag-color-background").css("background-color",t),e("#tag-color-value").val(t),i.remove()}),i.append(a).append(o),i.appendTo("body").css({top:n+"px",left:r+"px"}),e(document).bind("mousedown",{ls:i},u)}),e("#tag-color-value-remove").click(function(){e("#tag-color-background").css("background-color",""),e("#tag-color-value").val("")});var s=function(e){return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+o(e[1])+o(e[2])+o(e[3])},o=function(e){return("0"+parseInt(e,10).toString(16)).slice(-2)},u=function(t){a(t.data.ls.get(0),t.target,t.data.ls.get(0))||(e(t.data.ls.get(0)).remove(),e(document).unbind("mousedown",u))},a=function(e,t,n){if(e===t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(e.compareDocumentPosition(t)&16);var r=t.parentNode;while(r&&r!==n){if(r===e)return!0;r=r.parentNode}return!1},f=function(){n(function(){e("#ai1ec_category_image_uploader").click(i);var t=e("#ai1ec_category_imag_preview").attr("src");t&&t.length>0&&e("#ai1ec_category_image_url").val(t)})};return{start:f}}),timely.require(["scripts/event_category"],function(e){e.start()}),timely.define("pages/event_category",function(){});

==================================================
FILE PATH: ./public/js/pages/common_backend.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/**
	 * AJAX result after clicking Dismiss in license warning.
	 * @param  {object} response Data returned by HTTP response
	 */

/**
	 * Dismiss button clicked in invalid license warning.
	 *
	 * @param  {Event} e jQuery event object
	 */

/*
 * The MIT License
 *
 * Copyright (c) 2012 James Allardice
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.0.3
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.0.3
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("scripts/common_scripts/backend/common_ajax_handlers",["jquery_timely"],function(e){var t=function(t){t&&(typeof t.message!="undefined"?window.alert(t.message):e(".ai1ec-facebook-cron-dismiss-notification").closest(".message").fadeOut())},n=function(t){t.error?window.alert(t.message):e(".ai1ec-dismiss-notification").closest(".message").fadeOut()},r=function(t){t.error?window.alert(t.message):e(".ai1ec-dismiss-intro-video").closest(".message").fadeOut()},i=function(t){t.error?window.alert(t.message):e(".ai1ec-dismiss-license-warning").closest(".message").fadeOut()};return{handle_dismiss_plugins:t,handle_dismiss_notification:n,handle_dismiss_intro_video:r,handle_dismiss_license_warning:i}}),timely.define("scripts/common_scripts/backend/common_event_handlers",["jquery_timely","scripts/common_scripts/backend/common_ajax_handlers"],function(e,t){var n=function(n){var r={action:"ai1ec_facebook_cron_dismiss"};e.post(ajaxurl,r,t.handle_dismiss_plugins,"json")},r=function(n){var r=e(this);r.attr("disabled",!0);var i={action:"ai1ec_disable_notification",note:!1};e.post(ajaxurl,i,t.handle_dismiss_notification)},i=function(n){var r=e(this);r.attr("disabled",!0);var i={action:"ai1ec_disable_intro_video",note:!1};e.post(ajaxurl,i,t.handle_dismiss_intro_video)},s=function(n){var r=e(this);r.attr("disabled",!0);var i={action:"ai1ec_set_license_warning",value:"dismissed"};e.post(ajaxurl,i,t.handle_dismiss_license_warning)},o=function(t){e(this).parent().next(".ai1ec-limit-by-options-container").toggle().find("option").removeAttr("selected")},u=function(t){$document=e(document.body),$one_shot_popup=e("#ai1ec-one-shot-popup",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-one-shot-popup" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><strong><div id="ai1ec-one-shot-popup-title"/></strong></div><div class="ai1ec-modal-body ai1ec-clearfix"><textarea class="ai1ec-form-control code" rows="8" cols="40" id="ai1ec-one-shot-popup-text"></textarea></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-one-shot-popup",$document));var n=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(n.data("alert-title")),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n.data("alert-text")),$one_shot_popup.modal("show")};return{dismiss_plugins_messages_handler:n,dismiss_notification_handler:r,dismiss_intro_video_handler:i,dismiss_license_warning_handler:s,handle_multiselect_containers_widget_page:o,handle_alert_click:u}}),timely.define("external_libs/Placeholders",[],function(){function e(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent)return e.attachEvent("on"+t,n)}function t(e,t){var n,r;for(n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1}function n(e,t){var n;e.createTextRange?(n=e.createTextRange(),n.move("character",t),n.select()):e.selectionStart&&(e.focus(),e.setSelectionRange(t,t))}function r(e,t){try{return e.type=t,!0}catch(n){return!1}}function P(e){var t;return e.value===e.getAttribute(h)&&e.getAttribute(p)==="true"?(e.setAttribute(p,"false"),e.value="",e.className=e.className.replace(f,""),t=e.getAttribute(d),t&&(e.type=t),!0):!1}function H(e){var t;return e.value===""?(e.setAttribute(p,"true"),e.value=e.getAttribute(h),e.className+=" "+a,t=e.getAttribute(d),t?e.type="text":e.type==="password"&&S.changeType(e,"text")&&e.setAttribute(d,"password"),!0):!1}function B(e,t){var n,r,i,s,o;if(e&&e.getAttribute(h))t(e);else{n=e?e.getElementsByTagName("input"):n,r=e?e.getElementsByTagName("textarea"):r;for(o=0,s=n.length+r.length;o<s;o++)i=o<n.length?n[o]:r[o-n.length],t(i)}}function j(e){B(e,P)}function F(e){B(e,H)}function I(e){return function(){x&&e.value===e.getAttribute(h)&&e.getAttribute(p)==="true"?S.moveCaret(e,0):P(e)}}function q(e){return function(){H(e)}}function R(e){return function(t){N=e.value;if(e.getAttribute(p)==="true")return N!==e.getAttribute(h)||!S.inArray(o,t.keyCode)}}function U(e){return function(){var t;e.getAttribute(p)==="true"&&e.value!==N&&(e.className=e.className.replace(f,""),e.value=e.value.replace(e.getAttribute(h),""),e.setAttribute(p,!1),t=e.getAttribute(d),t&&(e.type=t)),e.value===""&&(e.blur(),S.moveCaret(e,0))}}function z(e){return function(){e===document.activeElement&&e.value===e.getAttribute(h)&&e.getAttribute(p)==="true"&&S.moveCaret(e,0)}}function W(e){return function(){j(e)}}function X(e){e.form&&(O=e.form,O.getAttribute(v)||(S.addEventListener(O,"submit",W(O)),O.setAttribute(v,"true"))),S.addEventListener(e,"focus",I(e)),S.addEventListener(e,"blur",q(e)),x&&(S.addEventListener(e,"keydown",R(e)),S.addEventListener(e,"keyup",U(e)),S.addEventListener(e,"click",z(e))),e.setAttribute(m,"true"),e.setAttribute(h,L),H(e)}var i={Utils:{addEventListener:e,inArray:t,moveCaret:n,changeType:r}},s=["text","search","url","tel","email","password","number","textarea"],o=[27,33,34,35,36,37,38,39,40,8,46],u="#ccc",a="placeholdersjs",f=new RegExp("\\b"+a+"\\b"),l,c,h="data-placeholder-value",p="data-placeholder-active",d="data-placeholder-type",v="data-placeholder-submit",m="data-placeholder-bound",g="data-placeholder-focus",y="data-placeholder-live",b=document.createElement("input"),w=document.getElementsByTagName("head")[0],E=document.documentElement,S=i.Utils,x,T,N,C,k,L,A,O,M,_,D;if(b.placeholder===void 0){l=document.getElementsByTagName("input"),c=document.getElementsByTagName("textarea"),x=E.getAttribute(g)==="false",T=E.getAttribute(y)!=="false",C=document.createElement("style"),C.type="text/css",k=document.createTextNode("."+a+" { color:"+u+"; }"),C.styleSheet?C.styleSheet.cssText=k.nodeValue:C.appendChild(k),w.insertBefore(C,w.firstChild);for(D=0,_=l.length+c.length;D<_;D++)M=D<l.length?l[D]:c[D-l.length],L=M.getAttribute("placeholder"),L&&S.inArray(s,M.type)&&X(M);A=setInterval(function(){for(D=0,_=l.length+c.length;D<_;D++){M=D<l.length?l[D]:c[D-l.length],L=M.getAttribute("placeholder");if(L&&S.inArray(s,M.type)){M.getAttribute(m)||X(M);if(L!==M.getAttribute(h)||M.type==="password"&&!M.getAttribute(d))M.type==="password"&&!M.getAttribute(d)&&S.changeType(M,"text")&&M.setAttribute(d,"password"),M.value===M.getAttribute(h)&&(M.value=L),M.setAttribute(h,L)}}T||clearInterval(A)},100)}return i.disable=j,i.enable=F,i}),timely.define("external_libs/bootstrap/tooltip",["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}),timely.define("external_libs/bootstrap/popover",["jquery_timely","external_libs/bootstrap/tooltip"],function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="ai1ec-popover"><div class="ai1ec-arrow"></div><h3 class="ai1ec-popover-title"></h3><div class="ai1ec-popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".ai1ec-popover-title")[this.options.html?"html":"text"](t),e.find(".ai1ec-popover-content")[this.options.html?"html":"text"](n),e.removeClass("ai1ec-fade ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right ai1ec-in"),e.find(".ai1ec-popover-title").html()||e.find(".ai1ec-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}),timely.define("external_libs/bootstrap/modal",["jquery_timely"],function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r);if(this.isShown||r.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="ai1ec-modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("ai1ec-fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("ai1ec-in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".ai1ec-modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)})},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("ai1ec-in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("ai1ec-fade")?"ai1ec-fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="ai1ec-modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("ai1ec-in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("ai1ec-in"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="ai1ec-modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".ai1ec-modal",function(){e(document.body).addClass("ai1ec-modal-open")}).on("hidden.bs.modal",".ai1ec-modal",function(){e(document.body).removeClass("ai1ec-modal-open")})}),timely.define("external_libs/bootstrap/dropdown",["jquery_timely"],function(e){function i(){e(t).remove(),e(n).each(function(t){var n=s(e(this));if(!n.hasClass("ai1ec-open"))return;n.trigger(t=e.Event("hide.bs.dropdown"));if(t.isDefaultPrevented())return;n.removeClass("ai1ec-open").trigger("hidden.bs.dropdown")})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".ai1ec-dropdown-backdrop",n="[data-toggle=ai1ec-dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".ai1ec-disabled, :disabled"))return;var r=s(n),o=r.hasClass("ai1ec-open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".ai1ec-navbar-nav").length&&e('<div class="ai1ec-dropdown-backdrop"/>').insertAfter(e(this)).on("click",i),r.trigger(t=e.Event("show.bs.dropdown"));if(t.isDefaultPrevented())return;r.toggleClass("ai1ec-open").trigger("shown.bs.dropdown"),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".ai1ec-disabled, :disabled"))return;var i=s(r),o=i.hasClass("ai1ec-open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=e("[role=menu] li:not(.ai1ec-divider):visible a",i);if(!u.length)return;var a=u.index(u.filter(":focus"));t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<u.length-1&&a++,~a||(a=0),u.eq(a).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".ai1ec-dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)}),timely.define("scripts/common_scripts/backend/common_backend",["jquery_timely","domReady","ai1ec_config","scripts/common_scripts/backend/common_event_handlers","external_libs/Placeholders","external_libs/bootstrap/tooltip","external_libs/bootstrap/popover","external_libs/bootstrap/modal","external_libs/bootstrap/dropdown"],function(e,t,n,r){var i=function(){e("#ai1ec-facebook-filter option[value=exportable]:selected").length>0&&e("table.wp-list-table tr.no-items").length===0&&n.facebook_logged_in==="1"&&(e("<option>").val("export-facebook").text("Export to facebook").appendTo("select[name='action']"),e("<option>").val("export-facebook").text("Export to facebook").appendTo("select[name='action2']"))},s=function(){if(n.platform_active==="1"){e("#menu-posts-ai1ec_event li").each(function(){var t=e(this);if(t.has('a[href$="all-in-one-event-calendar-themes"], a[href$="all-in-one-event-calendar-edit-css"], a[href$="all-in-one-event-calendar-settings"]').length){if(t.is(".current")){var n=e("a",t).attr("href");e('#adminmenu a:not(.current)[href="'+n+'"]').parent().andSelf().addClass("current").end().closest("li.menu-top").find("> a.menu-top").andSelf().addClass("wp-has-current-submenu wp-menu-open").removeClass("wp-not-current-submenu"),t.closest("li.menu-top").find("> a.menu-top").andSelf().removeClass("wp-has-current-submenu wp-menu-open").addClass("wp-not-current-submenu")}t.hide()}});if(e("body.options-reading-php").length){var t=function(){e("#page_on_front").attr("disabled","disabled")};t(),e("#front-static-pages input:radio").change(t),e("#page_on_front").after('<span class="description">'+n.page_on_front_description+"</span>")}n.strict_mode==="1"&&(e("#dashboard-widgets .postbox").not("#ai1ec-calendar-tasks, #dashboard_right_now").remove(),e("#adminmenu > li").not(".wp-menu-separator, #menu-dashboard, #menu-posts-ai1ec_event, #menu-media, #menu-appearance, #menu-users, #menu-settings").remove(),e("#menu-appearance > .wp-submenu li, #menu-settings > .wp-submenu li").not(':has(a[href*="all-in-one-event-calendar"])').remove())}},o=function(){e("#ai1ec-video").length&&(e.ajax({cache:!0,async:!0,dataType:"script",url:"//www.youtube.com/iframe_api"}),window.onYouTubeIframeAPIReady=function(){var t=new YT.Player("ai1ec-video",{height:"368",width:"600",videoId:window.ai1ecVideo.youtubeId});e("#ai1ec-video").css("display","block"),e("#ai1ec-video-modal").on("hide",function(){t.stopVideo()})})},u=function(){e(document).on("click",".ai1ec-facebook-cron-dismiss-notification",r.dismiss_plugins_messages_handler).on("click",".ai1ec-dismiss-notification",r.dismiss_notification_handler).on("click",".ai1ec-dismiss-intro-video",r.dismiss_intro_video_handler).on("click",".ai1ec-dismiss-license-warning",r.dismiss_license_warning_handler).on("click",".ai1ec-limit-by-cat, .ai1ec-limit-by-tag, .ai1ec-limit-by-event",r.handle_multiselect_containers_widget_page).on("click",".ai1ec-dismissable",function(){var t={action:"ai1ec_dismiss_notice",key:e(this).data("key")},n=this;e.post(ajaxurl,t,function(t){e(n).closest(".ai1ec-message").remove()})}),e(document).on("click",".ai1ec-alert-trigger",r.handle_alert_click)},a=function(){e("#ai1ec-support .ai1ec-download a[title]").popover({placement:"left"}),e(".ai1ec-tooltip-toggle").tooltip({container:"body"})},f=function(){var t=e(".ai1ec-taxonomy-header"),n=e(".ai1ec-taxonomy-edit-link"),r;t.length&&(e("form#edittag").length||n.removeClass("ai1ec-hide").appendTo(".wrap > h2:first"),e(".wrap").prepend(t.removeClass("ai1ec-hide")),t.find("li.ai1ec-active").length||(r=e("[data-ai1ec_active_tab]").data("ai1ec_active_tab"),r&&e(r).addClass("ai1ec-active")),e('#menu-posts-ai1ec_event a[href="edit-tags.php?taxonomy=events_categories&post_type=ai1ec_event"]').closest("li").addClass("current"))},l=function(){t(function(){i(),f(),o(),u(),s(),a()})};return{start:l}}),timely.require(["scripts/common_scripts/backend/common_backend"],function(e){e.start()}),timely.define("pages/common_backend",function(){});

==================================================
FILE PATH: ./public/js/pages/common_frontend.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: affix.js v3.1.1
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.0.3
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap/affix",["jquery_timely"],function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="ai1ec-affix ai1ec-affix-top ai1ec-affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("ai1ec-affix");var e=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;this.affixed=="top"&&(i.top+=r),typeof s!="object"&&(u=o=s),typeof o=="function"&&(o=s.top(this.$element)),typeof u=="function"&&(u=s.bottom(this.$element));var a=this.unpin!=null&&r+this.unpin<=i.top?!1:u!=null&&i.top+this.$element.height()>=n-u?"bottom":o!=null&&r<=o?"top":!1;if(this.affixed===a)return;this.unpin&&this.$element.css("top","");var f="ai1ec-affix"+(a?"-"+a:""),l=e.Event(f+".bs.affix");this.$element.trigger(l);if(l.isDefaultPrevented())return;this.affixed=a,this.unpin=a=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(f).trigger(e.Event(f.replace("affix","affixed"))),a=="bottom"&&this.$element.offset({top:n-u-this.$element.height()})};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="ai1ec-affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}),timely.define("scripts/common_scripts/frontend/common_event_handlers",["jquery_timely","external_libs/bootstrap/affix"],function(e){var t=function(t){var n=e(this),r=n.next(".ai1ec-popup"),i,s,o;if(r.length===0)return;i=r.html(),s=r.attr("class");var u=n.closest("#ai1ec-calendar-view");u.length===0&&(u=e("body")),n.offset().left-u.offset().left>182?o="left":o="right",n.constrained_popover({content:i,title:"",placement:o,trigger:"manual",html:!0,template:'<div class="timely ai1ec-popover '+s+'">'+'<div class="ai1ec-arrow"></div>'+'<div class="ai1ec-popover-inner">'+'<div class="ai1ec-popover-content"><div></div></div>'+"</div>"+"</div>",container:"body"}).constrained_popover("show")},n=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-popup").length===0&&e(this).constrained_popover("hide")},r=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip").length===0&&(e(this).remove(),e("body > .ai1ec-tooltip").remove())},i=function(t){if("ontouchstart"in document.documentElement){t.preventDefault();return}var n=e(this),r={template:'<div class="timely ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"manual",container:"body"};if(n.is(".ai1ec-category .ai1ec-color-swatch")||n.is(".ai1ec-custom-filter .ai1ec-color-swatch"))return;n.is(".ai1ec-tooltip-auto")&&(r.placement=u(250)),n.tooltip(r),n.tooltip("show")},s=function(t){e(this).tooltip("hide")},o=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip-trigger").length===0&&e(this).remove(),n.closest(".ai1ec-popup").length===0&&e("body > .ai1ec-popup").remove()},u=function(t){return function(n,r){var i,s,o=e(r),u=o.attr("data-placement"),a=e.extend({},o.offset(),{width:r.offsetWidth,height:r.offsetHeight}),f=function(){return!1===i?!1:(i=a.left-t>=0,i?"left":!1)},l=function(){return!1===s?!1:(s=a.left+t<=e(window).width(),s?"right":!1)};switch(u){case"top":return"top";case"bottom":return"bottom";case"left":if(f())return"left";case"right":if(l())return"right";default:if(f())return"left";if(l())return"right";return u}}};return{handle_popover_over:t,handle_popover_out:n,handle_popover_self_out:r,handle_tooltip_over:i,handle_tooltip_out:s,handle_tooltip_self_out:o}}),timely.define("external_libs/modernizr",[],function(){var e=function(e,t,n){function S(e){f.cssText=e}function x(e,t){return S(h.join(e+";")+(t||""))}function T(e,t){return typeof e===t}function N(e,t){return!!~(""+e).indexOf(t)}function C(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:T(s,"function")?s.bind(r||t):s}return!1}var r="2.5.3",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p={},d={},v={},m=[],g=m.slice,y,b=function(e,n,r,i){var s,a,f,l=t.createElement("div"),c=t.body,h=c?c:t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),l.appendChild(f);return s=["&#173;","<style>",e,"</style>"].join(""),l.id=u,(c?l:h).innerHTML+=s,h.appendChild(l),c||(h.style.background="",o.appendChild(h)),a=n(l,e),c?l.parentNode.removeChild(l):h.parentNode.removeChild(h),!!a},w={}.hasOwnProperty,E;!T(w,"undefined")&&!T(w.call,"undefined")?E=function(e,t){return w.call(e,t)}:E=function(e,t){return t in e&&T(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=g.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(g.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(g.call(arguments)))};return i});var k=function(n,r){var s=n.join(""),o=r.length;b(s,function(n,r){var s=t.styleSheets[t.styleSheets.length-1],u=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"",a=n.childNodes,f={};while(o--)f[a[o].id]=a[o];i.touch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||(f.touch&&f.touch.offsetTop)===9},o,r)}([,["@media (",h.join("touch-enabled),("),u,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);p.touch=function(){return i.touch};for(var L in p)E(p,L)&&(y=L.toLowerCase(),i[y]=p[L](),m.push((i[y]?"":"no-")+y));return S(""),a=l=null,i._version=r,i._prefixes=h,i.testStyles=b,o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+m.join(" "):""),i}(window,window.document);return e}),timely.define("external_libs/bootstrap/tooltip",["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}),timely.define("external_libs/bootstrap/popover",["jquery_timely","external_libs/bootstrap/tooltip"],function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="ai1ec-popover"><div class="ai1ec-arrow"></div><h3 class="ai1ec-popover-title"></h3><div class="ai1ec-popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".ai1ec-popover-title")[this.options.html?"html":"text"](t),e.find(".ai1ec-popover-content")[this.options.html?"html":"text"](n),e.removeClass("ai1ec-fade ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right ai1ec-in"),e.find(".ai1ec-popover-title").html()||e.find(".ai1ec-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}),timely.define("external_libs/constrained_popover",["jquery_timely","external_libs/bootstrap/popover"],function(e){var t=function(e,t){this.init("constrained_popover",e,t)};t.DEFAULTS=e.extend({},e.fn.popover.Constructor.DEFAULTS,{container:"",content:this.options}),t.prototype=e.extend({},e.fn.popover.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.applyPlacement=function(t,n){e.fn.popover.Constructor.prototype.applyPlacement.call(this,t,n);var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=this.getPosition(),u={};switch(n){case"left":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left-i:u.left=newPos.left-i,r.offset(u);break;case"right":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left+o.width:u.left=newPos.left+o.width,r.offset(u)}},t.prototype.defineBounds=function(t){var n,r,i,s,o,u={},a=e("body"===this.options.container?document:this.options.container);return a.length?(n=a.offset()||{top:0,left:0},r=n.top,i=n.left,s=r+a.height(),o=i+a.width(),t.top+t.height/2<r&&(u.top=r),t.top+t.height/2>s&&(u.top=s),t.left-t.width/2<i&&(u.left=i),t.left-t.width/2>o&&(u.left=o),u):!1};var n=e.fn.popover;e.fn.constrained_popover=function(n){return this.each(function(){var r=e(this),i=r.data("ai1ec.constrained_popover"),s=typeof n=="object"&&n;i||r.data("ai1ec.constrained_popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.constrained_popover.Constructor=t,e.fn.constrained_popover.noConflict=function(){return e.fn.constrained_popover=n,this}}),timely.define("external_libs/bootstrap/dropdown",["jquery_timely"],function(e){function i(){e(t).remove(),e(n).each(function(t){var n=s(e(this));if(!n.hasClass("ai1ec-open"))return;n.trigger(t=e.Event("hide.bs.dropdown"));if(t.isDefaultPrevented())return;n.removeClass("ai1ec-open").trigger("hidden.bs.dropdown")})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".ai1ec-dropdown-backdrop",n="[data-toggle=ai1ec-dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".ai1ec-disabled, :disabled"))return;var r=s(n),o=r.hasClass("ai1ec-open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".ai1ec-navbar-nav").length&&e('<div class="ai1ec-dropdown-backdrop"/>').insertAfter(e(this)).on("click",i),r.trigger(t=e.Event("show.bs.dropdown"));if(t.isDefaultPrevented())return;r.toggleClass("ai1ec-open").trigger("shown.bs.dropdown"),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".ai1ec-disabled, :disabled"))return;var i=s(r),o=i.hasClass("ai1ec-open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=e("[role=menu] li:not(.ai1ec-divider):visible a",i);if(!u.length)return;var a=u.index(u.filter(":focus"));t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<u.length-1&&a++,~a||(a=0),u.eq(a).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".ai1ec-dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)}),timely.define("scripts/common_scripts/frontend/common_frontend",["jquery_timely","domReady","scripts/common_scripts/frontend/common_event_handlers","ai1ec_calendar","external_libs/modernizr","external_libs/bootstrap/tooltip","external_libs/constrained_popover","external_libs/bootstrap/dropdown"],function(e,t,n,r,i){var s=!1,o=function(){s=!0,e(document).on("mouseenter",".ai1ec-popup-trigger",n.handle_popover_over),e(document).on("mouseleave",".ai1ec-popup-trigger",n.handle_popover_out),e(document).on("mouseleave",".ai1ec-popup",n.handle_popover_self_out),e(document).on("mouseenter",".ai1ec-tooltip-trigger",n.handle_tooltip_over),e(document).on("mouseleave",".ai1ec-tooltip-trigger",n.handle_tooltip_out),e(document).on("mouseleave",".ai1ec-tooltip",n.handle_tooltip_self_out)},u=function(){t(function(){o()})},a=function(){return s};return{start:u,are_event_listeners_attached:a}}),timely.require(["scripts/common_scripts/frontend/common_frontend"],function(e){e.start()}),timely.define("pages/common_frontend",function(){});

==================================================
FILE PATH: ./public/js/pages/ticketing.js
==================================================
timely.require(["scripts/ticketing"],function(){});

==================================================
FILE PATH: ./public/js/pages/calendar.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: affix.js v3.1.1
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.0.3
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/*
Copyright 2012 Igor Vaynberg

Version: 3.3.1 Timestamp: Wed Feb 20 09:57:22 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

/**
 * Twig.js 0.7.2
 *
 * @copyright 2011-2013 John Roepke
 * @license   Available under the BSD 2-Clause License
 * @link      https://github.com/justjohn/twig.js
 */

//     Twig.js
//     Copyright (c) 2011-2013 John Roepke
//     Available under the BSD 2-Clause License
//     https://github.com/justjohn/twig.js

// The following methods are from MDN and are available under a
// [MIT License](http://www.opensource.org/licenses/mit-license.php) or are
// [Public Domain](https://developer.mozilla.org/Project:Copyrights).
//
// See:
// * [Object.keys - MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)

// ## twig.lib.js
//
// This file contains 3rd party libraries used within twig.
//
// Copies of the licenses for the code included here can be found in the
// LICENSES.md file.
//

/**
     * jPaq - A fully customizable JavaScript/JScript library
     * http://jpaq.org/
     *
     * Copyright (c) 2011 Christopher West
     * Licensed under the MIT license.
     * http://jpaq.org/license/
     *
     * Version: 1.0.6.0000W
     * Revised: April 6, 2011
     */

//     Twig.js
//     Copyright (c) 2011-2013 John Roepke
//                   2012 Hadrien Lanneau
//     Available under the BSD 2-Clause License
//     https://github.com/justjohn/twig.js

/**
				 * History.js jQuery Adapter
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
				 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
				 */

/**
				 * History.js HTML4 Support
				 * Depends on the HTML5 Support
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
				 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
				 */

/**
		 * History.js Core
		 * @author Benjamin Arthur Lupton <contact@balupton.com>
		 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
		 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
		 */

/**
				 * History.getInternetExplorerMajorVersion()
				 * Get's the major version of Internet Explorer
				 * @return {integer}
				 * @license Public Domain
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @author James Padolsey <https://gist.github.com/527683>
				 */

/**
				 * History.isInternetExplorer()
				 * Are we using Internet Explorer?
				 * @return {boolean}
				 * @license Public Domain
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 */

/*

Copyright (c) 2009 Dimas Begunoff, http://www.farinspace.com

Licensed under the MIT license
http://en.wikipedia.org/wiki/MIT_License

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

*/

/*!
 * jQuery.ScrollTo
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 12/14/2012
 *
 * @projectDescription Easy element scrolling using jQuery.
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @author Ariel Flesler
 * @version 1.4.5 BETA
 *
 * @id jQuery.scrollTo
 * @id jQuery.fn.scrollTo
 * @param {String, Number, DOMElement, jQuery, Object} target Where to scroll the matched elements.
 *	  The different options for target are:
 *		- A number position (will be applied to all axes).
 *		- A string position ('44', '100px', '+=90', etc ) will be applied to all axes
 *		- A jQuery/DOM element ( logically, child of the element to scroll )
 *		- A string selector, that will be relative to the element to scroll ( 'li:eq(2)', etc )
 *		- A hash { top:x, left:y }, x and y can be any kind of number/string like above.
 *		- A percentage of the container's dimension/s, for example: 50% to go to the middle.
 *		- The string 'max' for go-to-end.
 * @param {Number, Function} duration The OVERALL length of the animation, this argument can be the settings object instead.
 * @param {Object,Function} settings Optional set of settings or the onAfter callback.
 *	 @option {String} axis Which axis must be scrolled, use 'x', 'y', 'xy' or 'yx'.
 *	 @option {Number, Function} duration The OVERALL length of the animation.
 *	 @option {String} easing The easing method for the animation.
 *	 @option {Boolean} margin If true, the margin of the target element will be deducted from the final position.
 *	 @option {Object, Number} offset Add/deduct from the end position. One number for both axes or { top:x, left:y }.
 *	 @option {Object, Number} over Add/deduct the height/width multiplied by 'over', can be { top:x, left:y } when using both axes.
 *	 @option {Boolean} queue If true, and both axis are given, the 2nd axis will only be animated after the first one ends.
 *	 @option {Function} onAfter Function to be called after the scrolling ends.
 *	 @option {Function} onAfterFirst If queuing is activated, this function will be called after the first scrolling ends.
 * @return {jQuery} Returns the same jQuery object, for chaining.
 *
 * @desc Scroll to a fixed position
 * @example $('div').scrollTo( 340 );
 *
 * @desc Scroll relatively to the actual position
 * @example $('div').scrollTo( '+=340px', { axis:'y' } );
 *
 * @desc Scroll using a selector (relative to the scrolled element)
 * @example $('div').scrollTo( 'p.paragraph:eq(2)', 500, { easing:'swing', queue:true, axis:'xy' } );
 *
 * @desc Scroll to a DOM element (same for jQuery object)
 * @example var second_child = document.getElementById('container').firstChild.nextSibling;
 *			$('#container').scrollTo( second_child, { duration:500, axis:'x', onAfter:function(){
 *				alert('scrolled!!');
 *			}});
 *
 * @desc Scroll on both axes, to different values
 * @example $('div').scrollTo( { top: 300, left:'+=200' }, { axis:'xy', offset:-20 } );
 */

/* =========================================================
 * bootstrap-datepicker.js
 * Repo: https://github.com/eternicode/bootstrap-datepicker/
 * Demo: http://eternicode.github.io/bootstrap-datepicker/
 * Docs: http://bootstrap-datepicker.readthedocs.org/
 * Forked from http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Started by Stefan Petre; improvements by Andrew Rowls + contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ========================================================================
 * Bootstrap: alert.js v3.0.3
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: transition.js v3.0.3
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.0.3
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("scripts/calendar/print",["jquery_timely"],function(e){var t=function(t){t.preventDefault();var n=e("body"),r=e("html"),i=e(this).closest(".ai1ec-calendar").html(),s=n.html();s=s.replace(/<script.*?>([\s\S]*?)<\/script>/gmi,""),n.empty(),n.addClass("timely"),r.addClass("ai1ec-print"),n.html(i),e("span").click(function(){return!1}),e(".ai1ec-agenda-view a").each(function(){e(this).data("href",e(this).attr("href")),e(this).attr("href","#")}),window.print(),e(".ai1ec-agenda-view a").each(function(){e(this).attr("href",e(this).data("href")),e(this).data("href","")}),n.removeClass("timely"),r.removeClass("ai1ec-print"),n.html(s)};return{handle_click_on_print_button:t}}),timely.define("scripts/calendar/agenda_view",["jquery_timely"],function(e){var t=function(){e(this).closest(".ai1ec-event").toggleClass("ai1ec-expanded").find(".ai1ec-event-summary").slideToggle(300)},n=function(){var t=e(this).closest(".ai1ec-calendar");t.find(".ai1ec-expanded .ai1ec-event-toggle").click()},r=function(){var t=e(this).closest(".ai1ec-calendar");t.find(".ai1ec-event:not(.ai1ec-expanded) .ai1ec-event-toggle").click()};return{toggle_event:t,collapse_all:n,expand_all:r}}),timely.define("external_libs/modernizr",[],function(){var e=function(e,t,n){function S(e){f.cssText=e}function x(e,t){return S(h.join(e+";")+(t||""))}function T(e,t){return typeof e===t}function N(e,t){return!!~(""+e).indexOf(t)}function C(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:T(s,"function")?s.bind(r||t):s}return!1}var r="2.5.3",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p={},d={},v={},m=[],g=m.slice,y,b=function(e,n,r,i){var s,a,f,l=t.createElement("div"),c=t.body,h=c?c:t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),l.appendChild(f);return s=["&#173;","<style>",e,"</style>"].join(""),l.id=u,(c?l:h).innerHTML+=s,h.appendChild(l),c||(h.style.background="",o.appendChild(h)),a=n(l,e),c?l.parentNode.removeChild(l):h.parentNode.removeChild(h),!!a},w={}.hasOwnProperty,E;!T(w,"undefined")&&!T(w.call,"undefined")?E=function(e,t){return w.call(e,t)}:E=function(e,t){return t in e&&T(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=g.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(g.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(g.call(arguments)))};return i});var k=function(n,r){var s=n.join(""),o=r.length;b(s,function(n,r){var s=t.styleSheets[t.styleSheets.length-1],u=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"",a=n.childNodes,f={};while(o--)f[a[o].id]=a[o];i.touch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||(f.touch&&f.touch.offsetTop)===9},o,r)}([,["@media (",h.join("touch-enabled),("),u,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);p.touch=function(){return i.touch};for(var L in p)E(p,L)&&(y=L.toLowerCase(),i[y]=p[L](),m.push((i[y]?"":"no-")+y));return S(""),a=l=null,i._version=r,i._prefixes=h,i.testStyles=b,o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+m.join(" "):""),i}(window,window.document);return e}),timely.define("scripts/calendar/month_view",["jquery_timely","external_libs/modernizr"],function(e,t){var n=navigator.userAgent.match(/opera/i),r=navigator.userAgent.match(/webkit/i),i=function(t){var n=t.find(".ai1ec-day"),r=t.find(".ai1ec-week:first .ai1ec-day").length;t.find(".ai1ec-month-view .ai1ec-multiday").each(function(){var t=this.parentNode,r=e(this).outerHeight(!0),i=e(".ai1ec-date",t),u=parseInt(i.text(),10),a=e(this).data("endTruncated"),f=parseInt(a?e(n[n.length-1]).text():e(this).data("endDay"),10),l=e(this),c=e(".ai1ec-event",l)[0].style.backgroundColor,h=0,p=f-u+1,d=p,v,m=0;n.each(function(t){var n=e(".ai1ec-date",this),r=e(this.parentNode),i=r.index(),a=parseInt(n.text(),10);if(a>=u&&a<=f){a===u&&(v=parseInt(n.css("marginBottom"),10)+16,newMargin=v,$week=n.closest(".ai1ec-week"),$multidayEvents=$week.find("a.ai1ec-multiday[data-end-day]").filter(function(){return e(this).offset().left<n.offset().left&&e(this).offset().left+e(this).width()>n.offset().left}),$multidayEvents.each(function(){var t=e(this).prop("offsetTop");if(null===newMargin||t>newMargin)newMargin=t}),null!==newMargin&&$multidayEvents.length&&newMargin>v&&(newMargin+=19,v=newMargin,n.css("marginBottom",newMargin+"px"))),h===0&&m++;if(i===0&&a>u&&d!==0){var p=l.next(".ai1ec-popup").andSelf().clone(!1);n.parent().append(p);var g=p.first();g.addClass("ai1ec-multiday-bar ai1ec-multiday-clone"),g.css({position:"absolute",left:"1px",top:parseInt(n.css("marginBottom"),10)+13,backgroundColor:c});var y=d>7?7:d;g.css("width",s(y)),d>7&&g.append(o(1,c)),g.append(o(2,c))}h===0?n.css({marginBottom:v+"px"}):n.css({marginBottom:"+=16px"}),d--,d>0&&i===6&&h++}});if(a){var g=l.find("."+l[0].className.replace(/\s+/igm,".")).last();g.append(o(1,c))}e(this).css({position:"absolute",top:i.outerHeight(!0)-r-1+"px",left:"1px",width:s(m)}),h>0&&e(this).append(o(1,c)),e(this).data("startTruncated")&&e(this).append(o(2,c)).addClass("ai1ec-multiday-bar")}),n.each(function(){var t=e(".ai1ec-date",this),n=parseInt(t.text(),10),r=t.closest(".ai1ec-week"),i=e(this).find("a.ai1ec-event-container:not(.ai1ec-multiday)").length,s=null,o;if(0===i)return;o=r.find("a.ai1ec-multiday[data-end-day]").filter(function(){return e(this).offsetLeft<=t.offset().left&&e(this).offsetLeft+e(this).width()>=t.offset().left}),o.each(function(){var t=e(this).prop("offsetTop");if(null===s||t>s)s=t}),null!==s&&(s+=3,t.css("marginBottom",s))})},s=function(e){var t;switch(e){case 1:t=97.5;break;case 2:t=198.7;break;case 3:t=300;break;case 4:t=401;break;case 5:r||n?t=507:t=503.4;break;case 6:r||n?t=608:t=603.5;break;case 7:r||n?t=709:t=705}return t+"%"},o=function(t,n){var r=e('<div class="ai1ec-multiday-arrow'+t+'"></div>');return t===1?r.css({borderLeftColor:n}):r.css({borderTopColor:n,borderRightColor:n,borderBottomColor:n}),r};return{extend_multiday_events:i}}),timely.define("libs/frontend_utils",[],function(){var e=function(e){var t,n;t=function(e){if(/&[^;]+;/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.firstChild?t.firstChild.nodeValue:e}return e};if(typeof e=="string")return t(e);if(typeof e=="object")for(n in e)typeof e[n]=="string"&&(e[n]=t(e[n]));return e},t=function(e,t,n){var r,i,s,o,u;if("#"===e.charAt(0)||"?"===e.charAt(0))e=e.substring(1);r={},e=e.split(t);for(i=0;i<e.length;i++)o=e[i].trim(),-1!==(u=o.indexOf(n))?(s=o.substring(0,u).trim(),o=o.substring(u+1).trim()):(s=o,o=!0),r[s]=o;return r},n=function(e){var n,r,i,s,o;e=t(e,"&","="),i=Object.keys(e),n={ai1ec:{},action:"month"};for(r=0;r<i.length;r++)if("ai1ec"===i[r]){var u=t(e[i[r]],"|",":");for(s in u)if(""!==u[s]){if("action"===s||"view"===s)n.action=u[s];n.ai1ec[s]=u[s]}}else"ai1ec_"===i[r].substring(0,6)?n.ai1ec[i[r].substring(6)]=e[i[r]]:n[i[r]]=e[i[r]];"ai1ec_"!==n.action.substring(0,6)&&(n.action="ai1ec_"+n.action),o="action="+n.action+"&ai1ec=";for(s in n.ai1ec)n.ai1ec.hasOwnProperty(s)&&(o+=escape(s)+":"+escape(n.ai1ec[s])+"|");o=o.substring(0,o.length-1);for(s in n)"ai1ec"!==s&&"action"!==s&&(o+="&"+s+"="+escape(n[s]));return o};return{ai1ec_convert_entities:e,ai1ec_map_internal_query:n,ai1ec_tokenize_uri:t}}),timely.define("external_libs/bootstrap/tab",["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})}),timely.define("libs/utils",["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t}),timely.define("external_libs/bootstrap/affix",["jquery_timely"],function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="ai1ec-affix ai1ec-affix-top ai1ec-affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("ai1ec-affix");var e=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;this.affixed=="top"&&(i.top+=r),typeof s!="object"&&(u=o=s),typeof o=="function"&&(o=s.top(this.$element)),typeof u=="function"&&(u=s.bottom(this.$element));var a=this.unpin!=null&&r+this.unpin<=i.top?!1:u!=null&&i.top+this.$element.height()>=n-u?"bottom":o!=null&&r<=o?"top":!1;if(this.affixed===a)return;this.unpin&&this.$element.css("top","");var f="ai1ec-affix"+(a?"-"+a:""),l=e.Event(f+".bs.affix");this.$element.trigger(l);if(l.isDefaultPrevented())return;this.affixed=a,this.unpin=a=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(f).trigger(e.Event(f.replace("affix","affixed"))),a=="bottom"&&this.$element.offset({top:n-u-this.$element.height()})};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="ai1ec-affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}),timely.define("scripts/common_scripts/frontend/common_event_handlers",["jquery_timely","external_libs/bootstrap/affix"],function(e){var t=function(t){var n=e(this),r=n.next(".ai1ec-popup"),i,s,o;if(r.length===0)return;i=r.html(),s=r.attr("class");var u=n.closest("#ai1ec-calendar-view");u.length===0&&(u=e("body")),n.offset().left-u.offset().left>182?o="left":o="right",n.constrained_popover({content:i,title:"",placement:o,trigger:"manual",html:!0,template:'<div class="timely ai1ec-popover '+s+'">'+'<div class="ai1ec-arrow"></div>'+'<div class="ai1ec-popover-inner">'+'<div class="ai1ec-popover-content"><div></div></div>'+"</div>"+"</div>",container:"body"}).constrained_popover("show")},n=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-popup").length===0&&e(this).constrained_popover("hide")},r=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip").length===0&&(e(this).remove(),e("body > .ai1ec-tooltip").remove())},i=function(t){if("ontouchstart"in document.documentElement){t.preventDefault();return}var n=e(this),r={template:'<div class="timely ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"manual",container:"body"};if(n.is(".ai1ec-category .ai1ec-color-swatch")||n.is(".ai1ec-custom-filter .ai1ec-color-swatch"))return;n.is(".ai1ec-tooltip-auto")&&(r.placement=u(250)),n.tooltip(r),n.tooltip("show")},s=function(t){e(this).tooltip("hide")},o=function(t){var n=e(t.toElement||t.relatedTarget);n.closest(".ai1ec-tooltip-trigger").length===0&&e(this).remove(),n.closest(".ai1ec-popup").length===0&&e("body > .ai1ec-popup").remove()},u=function(t){return function(n,r){var i,s,o=e(r),u=o.attr("data-placement"),a=e.extend({},o.offset(),{width:r.offsetWidth,height:r.offsetHeight}),f=function(){return!1===i?!1:(i=a.left-t>=0,i?"left":!1)},l=function(){return!1===s?!1:(s=a.left+t<=e(window).width(),s?"right":!1)};switch(u){case"top":return"top";case"bottom":return"bottom";case"left":if(f())return"left";case"right":if(l())return"right";default:if(f())return"left";if(l())return"right";return u}}};return{handle_popover_over:t,handle_popover_out:n,handle_popover_self_out:r,handle_tooltip_over:i,handle_tooltip_out:s,handle_tooltip_self_out:o}}),timely.define("external_libs/bootstrap/tooltip",["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}),timely.define("external_libs/bootstrap/popover",["jquery_timely","external_libs/bootstrap/tooltip"],function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="ai1ec-popover"><div class="ai1ec-arrow"></div><h3 class="ai1ec-popover-title"></h3><div class="ai1ec-popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".ai1ec-popover-title")[this.options.html?"html":"text"](t),e.find(".ai1ec-popover-content")[this.options.html?"html":"text"](n),e.removeClass("ai1ec-fade ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right ai1ec-in"),e.find(".ai1ec-popover-title").html()||e.find(".ai1ec-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}),timely.define("external_libs/constrained_popover",["jquery_timely","external_libs/bootstrap/popover"],function(e){var t=function(e,t){this.init("constrained_popover",e,t)};t.DEFAULTS=e.extend({},e.fn.popover.Constructor.DEFAULTS,{container:"",content:this.options}),t.prototype=e.extend({},e.fn.popover.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.applyPlacement=function(t,n){e.fn.popover.Constructor.prototype.applyPlacement.call(this,t,n);var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=this.getPosition(),u={};switch(n){case"left":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left-i:u.left=newPos.left-i,r.offset(u);break;case"right":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left+o.width:u.left=newPos.left+o.width,r.offset(u)}},t.prototype.defineBounds=function(t){var n,r,i,s,o,u={},a=e("body"===this.options.container?document:this.options.container);return a.length?(n=a.offset()||{top:0,left:0},r=n.top,i=n.left,s=r+a.height(),o=i+a.width(),t.top+t.height/2<r&&(u.top=r),t.top+t.height/2>s&&(u.top=s),t.left-t.width/2<i&&(u.left=i),t.left-t.width/2>o&&(u.left=o),u):!1};var n=e.fn.popover;e.fn.constrained_popover=function(n){return this.each(function(){var r=e(this),i=r.data("ai1ec.constrained_popover"),s=typeof n=="object"&&n;i||r.data("ai1ec.constrained_popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.constrained_popover.Constructor=t,e.fn.constrained_popover.noConflict=function(){return e.fn.constrained_popover=n,this}}),timely.define("external_libs/bootstrap/dropdown",["jquery_timely"],function(e){function i(){e(t).remove(),e(n).each(function(t){var n=s(e(this));if(!n.hasClass("ai1ec-open"))return;n.trigger(t=e.Event("hide.bs.dropdown"));if(t.isDefaultPrevented())return;n.removeClass("ai1ec-open").trigger("hidden.bs.dropdown")})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".ai1ec-dropdown-backdrop",n="[data-toggle=ai1ec-dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".ai1ec-disabled, :disabled"))return;var r=s(n),o=r.hasClass("ai1ec-open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".ai1ec-navbar-nav").length&&e('<div class="ai1ec-dropdown-backdrop"/>').insertAfter(e(this)).on("click",i),r.trigger(t=e.Event("show.bs.dropdown"));if(t.isDefaultPrevented())return;r.toggleClass("ai1ec-open").trigger("shown.bs.dropdown"),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".ai1ec-disabled, :disabled"))return;var i=s(r),o=i.hasClass("ai1ec-open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=e("[role=menu] li:not(.ai1ec-divider):visible a",i);if(!u.length)return;var a=u.index(u.filter(":focus"));t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<u.length-1&&a++,~a||(a=0),u.eq(a).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".ai1ec-dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)}),timely.define("scripts/common_scripts/frontend/common_frontend",["jquery_timely","domReady","scripts/common_scripts/frontend/common_event_handlers","ai1ec_calendar","external_libs/modernizr","external_libs/bootstrap/tooltip","external_libs/constrained_popover","external_libs/bootstrap/dropdown"],function(e,t,n,r,i){var s=!1,o=function(){s=!0,e(document).on("mouseenter",".ai1ec-popup-trigger",n.handle_popover_over),e(document).on("mouseleave",".ai1ec-popup-trigger",n.handle_popover_out),e(document).on("mouseleave",".ai1ec-popup",n.handle_popover_self_out),e(document).on("mouseenter",".ai1ec-tooltip-trigger",n.handle_tooltip_over),e(document).on("mouseleave",".ai1ec-tooltip-trigger",n.handle_tooltip_out),e(document).on("mouseleave",".ai1ec-tooltip",n.handle_tooltip_self_out)},u=function(){t(function(){o()})},a=function(){return s};return{start:u,are_event_listeners_attached:a}}),timely.define("external_libs/select2",["jquery_timely"],function(e){(function(e){typeof e.fn.each2=="undefined"&&e.fn.extend({each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})})(e),function(e,t){function l(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(c(e,t[n]))return n;return-1}function c(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e===n+"":n.constructor===String?n===e+"":!1}function h(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r}function p(e){return e.outerWidth(!1)-e.width()}function d(n){var r="keyup-change-value";n.bind("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.bind("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function v(n){n.bind("mousemove",function(n){var r=a;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function m(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function g(e){var t=!1,n;return function(){return t===!1&&(n=e(),t=!0),n}}function y(e,t){var n=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){l(e.target,t.get())>=0&&n(e)})}function b(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus(),t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",n),r.select())},0)}function w(e){e.preventDefault(),e.stopPropagation()}function E(e){e.preventDefault(),e.stopImmediatePropagation()}function S(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),u.attr("class","select2-sizer"),e("body").append(u)}return u.text(t.val()),u.width()}function x(t,n,r){var i,s=[],o;i=t.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")===0&&s.push(this)}),i=n.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),typeof o=="string"&&o.length>0&&s.push(this))}),t.attr("class",s.join(" "))}function T(e,t,n,r){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function N(t){var n,r=0,i=null,s=t.quietMillis||100,o=t.url,u=this;return function(a){window.clearTimeout(n),n=window.setTimeout(function(){r+=1;var n=r,s=t.data,f=o,l=t.transport||e.ajax,c=t.type||"GET",h={};s=s?s.call(u,a.term,a.page,a.context):null,f=typeof f=="function"?f.call(u,a.term,a.page,a.context):f,null!==i&&i.abort(),t.params&&(e.isFunction(t.params)?e.extend(h,t.params.call(u)):e.extend(h,t.params)),e.extend(h,{url:f,dataType:t.dataType,data:s,type:c,cache:!1,success:function(e){if(n<r)return;var i=t.results(e,a.page);a.callback(i)}}),i=l.call(u,h)},s)}}function C(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=n.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function k(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o)}}function L(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function A(t){return e.isFunction(t)?t():t}function O(t){var n=0;return e.each(t,function(e,t){t.children?n+=O(t.children):n++}),n}function M(e,n,r,i){var s=e,o=!1,u,a,f,l,h;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){h=i.tokenSeparators[f],a=e.indexOf(h);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+h.length);if(u.length>0){u=i.createSearchChoice(u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(c(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function _(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}var n,r,i,s,o,u,a,f;n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},f=e(document),o=function(){var e=1;return function(){return e++}}(),f.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}}),r=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results",u;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=g(function(){return n.element.closest("body")}),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(A(n.containerCss)),this.container.addClass(A(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabIndex"),this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(A(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=r=this.container.find(s),this.search=i=this.container.find("input.select2-input"),i.attr("tabIndex",this.elementTabIndex),this.resultsPage=0,this.context=null,this.initContainer(),v(this.results),this.dropdown.delegate(s,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent)),y(80,this.results),this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop(),o;i>0&&s-i<=0?(r.scrollTop(0),w(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),w(e))}),d(i),i.bind("keyup-change input paste",this.bind(this.updateResults)),i.bind("focus",function(){i.addClass("select2-focused")}),i.bind("blur",function(){i.removeClass("select2-focused")}),this.dropdown.delegate(s,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show())},prepareOpts:function(n){var r,i,s,o;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,s){var o,u,a,f,l=this.opts.id,c=this;o=function(r,i,u){var a,f,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(a=0,f=r.length;a<f;a+=1)h=r[a],d=h.disabled===!0,p=!d&&l(h)!==t,v=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+u),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(c.opts.formatResultCssClass(h)),g=e(document.createElement("div")),g.addClass("select2-result-label"),b=n.formatResult(h,g,s,c.opts.escapeMarkup),b!==t&&g.html(b),m.append(g),v&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),o(h.children,y,u+1),m.append(y)),m.data("select2-data",h),i.append(m)},o(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(s=n.id,n.id=function(e){return e[s]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.attr("data-select2-tags")}i?(n.query=this.bind(function(n){var i={results:[],more:!1},s=n.term,o,u,a;a=function(e,t){var r;e.is("option")?n.matcher(s,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:c(e.attr("disabled"),"disabled")}):e.is("optgroup")&&(r={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){a(t,r.children)}),r.children.length>0&&t.push(r))},o=r.children(),this.getPlaceholder()!==t&&o.length>0&&(u=o[0],e(u).text()===""&&(o=o.not(u))),o.each2(function(e,t){a(t,i.results)}),n.callback(i)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(o=n.element.data("ajax-url"),o&&o.length>0&&(n.ajax.url=o),n.query=N.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=k(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(h(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){if(c(this.id,t))return r=this.text,!1}),i.push({id:t,text:r})}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var e,t,n=this;e=this.opts.element.attr("disabled")!=="disabled",t=this.opts.element.attr("readonly")==="readonly",e=e&&!t,this.enabled!==e&&(e?this.enable():this.disable()),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),e.bind("propertychange.select2 DOMAttrModified.select2",t),typeof WebKitMutationObserver!="undefined"&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)}),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=this.dropdown.outerHeight(!1),s=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),u=t.top+n,a=t.left,f=u+i<=o,l=t.top-i>=this.body().scrollTop(),c=this.dropdown.outerWidth(!1),h=a+c<=s,p=this.dropdown.hasClass("select2-drop-above"),d,v,m;this.body().css("position")!=="static"&&(d=this.body().offset(),u-=d.top,a-=d.left),p?(v=!0,!l&&f&&(v=!1)):(v=!1,!f&&l&&(v=!0)),h||(a=t.left+r-c),v?(u=t.top-i,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),m=e.extend({top:u,left:a,width:r},A(this.opts.dropdownCss)),this.dropdown.css(m)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.clearDropdownAlignmentPreference(),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.updateResults(!0),s=e("#select2-drop-mask"),s.length==0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body()),s.bind("mousedown touchstart",function(t){var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),s.show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible();var o=this;this.container.parents().add(window).each(function(){e(this).bind(r+" "+n+" "+i,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),o.positionDropdown()})}),this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(n).unbind(r).unbind(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices(),i=e(n[r]),s=i.offset().top+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!0),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=i.offset().top-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return l(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),r=e(n[t]),r.addClass("select2-highlighted"),this.ensureHighlightVisible(),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"highlight",val:this.id(i),choice:i})},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=-1,i=this.resultsPage+1,s=this,o=this.search.val(),u=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:u,matcher:this.opts.matcher,callback:this.bind(function(n){if(!s.opened())return;s.opts.populateResults.call(this,e,n.results,{term:o,page:i,context:u}),n.more===!0?(t.detach().appendTo(e).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):t.remove(),s.positionDropdown(),s.resultsPage=i,s.context=n.context})}))},tokenize:function(){},updateResults:function(n){function f(){i.scrollTop(0),r.removeClass("select2-active"),u.positionDropdown()}function l(e){i.html(e),f()}var r=this.search,i=this.results,s=this.opts,o,u=this,a;if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;r.addClass("select2-active");var h=this.getMaximumSelectionSize();if(h>=1){o=this.data();if(e.isArray(o)&&o.length>=h&&L(s.formatSelectionTooBig,"formatSelectionTooBig")){l("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(h)+"</li>");return}}if(r.val().length<s.minimumInputLength){L(s.formatInputTooShort,"formatInputTooShort")?l("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>"):l("");return}s.formatSearching()&&n===!0&&l("<li class='select2-searching'>"+s.formatSearching()+"</li>");if(s.maximumInputLength&&r.val().length>s.maximumInputLength){L(s.formatInputTooLong,"formatInputTooLong")?l("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>"):l("");return}a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(null,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return c(u.id(this),u.id(a))}).length===0&&o.results.unshift(a));if(o.results.length===0&&L(s.formatNoMatches,"formatNoMatches")){l("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&L(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),f()})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){b(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r&&(this.highlight(t),this.onSelect(r,e))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,r,i,s,o;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s+=1){i=r[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(i!==null&&i.length>=1)return i[1]}}return this.opts.width==="resolve"?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);r!==null&&this.container.css("width",r)}}),i=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments),this.focusser.attr("disabled","disabled"),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),b(this.focusser)},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var e,t=this.container,r=this.dropdown,i=!1;this.showSearch(this.opts.minimumResultsForSearch>=0),this.selection=e=t.find(".select2-choice"),this.focusser=t.find(".select2-focusser"),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.TAB:case n.ENTER:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}})),this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC)return;if(this.opts.openOnEnter===!1&&e.which===n.ENTER){w(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){this.open(),w(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){this.opts.allowClear&&this.clear(),w(e);return}})),d(this.focusser),this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open(),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.focusser.val(""),w(e)})),e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear(),E(e),this.close(),this.selection.focus()})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?this.close():this.enabled&&this.open(),w(e),i=!1})),r.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(e){w(e)})),this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active")})),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),this.opts.element.trigger({type:"removed",val:this.id(e),choice:e}),this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()==="")this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(t,n){var r=t.find(":selected");e.isFunction(n)&&n({id:r.attr("value"),text:r.text(),element:r})}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val();t.query({matcher:function(e,n,r){return c(i,t.id(r))},callback:e.isFunction(r)?function(e){r(e.results.length?e.results[0]:null)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.select.find("option").first().text()!==""?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,t){var n=0,r=this,i=!0;this.findHighlightableChoices().each2(function(e,t){if(c(r.id(t.data("select2-data")),r.opts.element.val()))return n=e,!1}),this.highlight(n);if(t===!0){var s=this.opts.minimumResultsForSearch;i=s<0?!1:O(e.results)>=s,this.showSearch(i)}},showSearch:function(t){this.showSearchInput=t,this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var n=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.close(),(!t||!t.noFocus)&&this.selection.focus(),c(n,this.id(e))||this.triggerChange()},updateSelection:function(e){var n=this.selection.find("span"),r;this.selection.data("select2-data",e),n.empty(),r=this.opts.formatSelection(e,n),r!==t&&n.append(this.opts.escapeMarkup(r)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=!1,r=null,i=this;if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1]);if(this.select)this.select.val(e).find(":selected").each2(function(e,t){return r={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e&&e!==0){this.clear(),n&&this.triggerChange();return}this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange()})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;!e||e===""?this.clear():(this.opts.element.val(e?this.id(e):""),this.updateSelection(e))}}),s=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var n=[];e.find(":selected").each2(function(e,t){n.push({id:t.attr("value"),text:t.text(),element:t[0]})}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=h(n.val(),t.separator);t.query({matcher:function(n,r,s){return e.grep(i,function(e){return c(e,t.id(s))}).length},callback:e.isFunction(r)?function(e){r(e.results)}:e.noop})}),t},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(t),this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;this.opened()||this.open()})),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.BACKSPACE&&this.search.val()===""){this.close();var t,i=r.find(".select2-search-choice-focus");if(i.length>0){this.unselect(i.first()),this.search.width(10),w(e);return}t=r.find(".select2-search-choice:not(.select2-locked)"),t.length>0&&t.last().addClass("select2-search-choice-focus")}else r.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.ENTER:case n.TAB:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC)return;if(e.which===n.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN)&&w(e)})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.opened()||this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()})),this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0)},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus(),this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){l(i.id(this),n)<0&&(n.push(i.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){i.addSelectedChoice(this)}),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a=this.getVal(),f;f=this.opts.formatSelection(n,o.find("div")),f!=t&&o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(f)+"</div>"),r&&o.find(".select2-search-choice-close").bind("mousedown",w).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),w(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),a.push(u),this.setVal(a)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";n=e.data("select2-data");if(!n)return;r=l(this.id(n).toString(),t),r>=0&&(t.splice(r,1),this.setVal(t),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(n),choice:n}),this.triggerChange({removed:n})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),n=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,n){var i=r.id(n.data("select2-data"));l(i,e)>=0&&(n.addClass("select2-selected"),n.find(".select2-result-selectable").addClass("select2-selected"))}),n.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&r.highlight(0)},resizeSearch:function(){var e,t,n,r,i,s=p(this.search);e=S(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(i)},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),h(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){l(this,n)<0&&n.push(this)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator)))},val:function(){var n,r=!1,i=[],s=this;if(arguments.length===0)return this.getVal();n=arguments[0],arguments.length>1&&(r=arguments[1]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange();return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n=this,r;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();t||(t=[]),r=e.map(t,function(e){return n.opts.id(e)}),this.setVal(r),this.updateSelection(t),this.clearSearch()}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?a=r.element.attr("multiple"):(a=r.multiple||!1,"tags"in r&&(r.multiple=a=!0)),o=a?new s:new i,o.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(l(n[0],f)<0)throw"Unknown method: "+n[0];u=t,o=e(this).data("select2");if(o===t)return;n[0]==="container"?u=o.container:u=o[n[0]].apply(o,n.slice(1));if(u!==t)return!1}}),u===t?this:u},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return T(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n){return e?e.text:t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please enter "+n+" less character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}}}(e)}),timely.define("libs/select2_multiselect_helper",["jquery_timely","external_libs/select2"],function(e){var t=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""&&(s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> '),s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},n=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""?s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> ':s+='<span class="ai1ec-color-swatch-empty"></span> ',s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},r=function(r){typeof r=="undefined"&&(r=e(document)),e(".ai1ec-select2-multiselect-selector",r).select2({allowClear:!0,formatResult:n,formatSelection:t,escapeMarkup:function(e){return e}})},i=function(t){e(".ai1ec-select2-multiselect-selector.select2-container",t).each(function(){e(this).data("select2").resizeSearch()})};return{init:r,refresh:i}});var Twig=function(e){return e.VERSION="0.7.2",e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}function n(t,n){var r,i,s="/",o=[],u;if(t.url)typeof t.base!="undefined"?r=t.base+(t.base.charAt(t.base.length-1)==="/"?"":"/"):r=t.url;else{if(!t.path)throw new e.Error("Cannot extend an inline template.");var a=require("path"),f=a.sep||s,l=new RegExp("^\\.{1,2}"+f.replace("\\","\\\\"));n=n.replace(/\//g,f),t.base!==undefined&&n.match(l)==null?(n=n.replace(t.base,""),r=t.base+f):r=t.path,r=r.replace(f+f,f),s=f}i=r.split(s),i.pop(),i=i.concat(n.split(s));while(i.length>0)u=i.shift(),u!="."&&(u==".."&&o.length>0&&o[o.length-1]!=".."?o.pop():o.push(u));return o.join(s)}return e.trace=!1,e.debug=!1,e.cache=!0,e.placeholders={parent:"{{|PARENT|}}"},e.indexOf=function(e,t){if(Array.prototype.hasOwnProperty("indexOf"))return e.indexOf(t);if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(r===0)return-1;var i=0;arguments.length>0&&(i=Number(arguments[1]),i!==i?i=0:i!==0&&i!==Infinity&&i!==-Infinity&&(i=(i>0||-1)*Math.floor(Math.abs(i))));if(i>=r)return-1;var s=i>=0?i:Math.max(r-Math.abs(i),0);for(;s<r;s++)if(s in n&&n[s]===t)return s;return e==t?0:-1},e.forEach=function(e,t,n){if(Array.prototype.forEach)return e.forEach(t,n);var r,i;if(e==null)throw new TypeError(" this is null or not defined");var s=Object(e),o=s.length>>>0;if({}.toString.call(t)!="[object Function]")throw new TypeError(t+" is not a function");n&&(r=n),i=0;while(i<o){var u;i in s&&(u=s[i],t.call(r,u,i,s)),i++}},e.Error=function(e){this.message=e,this.name="TwigException",this.type="TwigException"},e.Error.prototype.toString=function(){var e=this.name+": "+this.message;return e},e.log={trace:function(){e.trace&&console&&console.log(Array.prototype.slice.call(arguments))},debug:function(){e.debug&&console&&console.log(Array.prototype.slice.call(arguments))}},typeof console!="undefined"&&typeof console.log!="undefined"?e.log.error=function(){console.log.apply(console,arguments)}:e.log.error=function(){},e.token={},e.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw"},e.token.definitions=[{type:e.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:e.token.type.output,open:"{{",close:"}}"},{type:e.token.type.logic,open:"{%",close:"%}"},{type:e.token.type.comment,open:"{#",close:"#}"}],e.token.strings=['"',"'"],e.token.findStart=function(t){var n={position:null,def:null},r,i,s;for(r=0;r<e.token.definitions.length;r++)i=e.token.definitions[r],s=t.indexOf(i.open),e.log.trace("Twig.token.findStart: ","Searching for ",i.open," found at ",s),s>=0&&(n.position===null||s<n.position)&&(n.position=s,n.def=i);return n},e.token.findEnd=function(t,n,r){var i=null,s=!1,o=0,u=null,a=null,f=null,l=null,c=null,h=null,p,d;while(!s){u=null,a=null,f=t.indexOf(n.close,o);if(!(f>=0))throw new e.Error("Unable to find closing bracket '"+n.close+"'"+" opened near template position "+r);i=f,s=!0;if(n.type===e.token.type.comment)break;d=e.token.strings.length;for(p=0;p<d;p+=1)c=t.indexOf(e.token.strings[p],o),c>0&&c<f&&(u===null||c<u)&&(u=c,a=e.token.strings[p]);if(u!==null){l=u+1,i=null,s=!1;for(;;){h=t.indexOf(a,l);if(h<0)throw"Unclosed string in template";if(t.substr(h-1,1)!=="\\"){o=h+1;break}l=h+1}}}return i},e.tokenize=function(t){var n=[],r=0,i=null,s=null;while(t.length>0)i=e.token.findStart(t),e.log.trace("Twig.tokenize: ","Found token: ",i),i.position!==null?(i.position>0&&n.push({type:e.token.type.raw,value:t.substring(0,i.position)}),t=t.substr(i.position+i.def.open.length),r+=i.position+i.def.open.length,s=e.token.findEnd(t,i.def,r),e.log.trace("Twig.tokenize: ","Token ends at ",s),n.push({type:i.def.type,value:t.substring(0,s).trim()}),i.def.type==="logic"&&t.substr(s+i.def.close.length,1)==="\n"&&(s+=1),t=t.substr(s+i.def.close.length),r+=s+i.def.close.length):(n.push({type:e.token.type.raw,value:t}),t="");return n},e.compile=function(t){try{var n=[],r=[],i=[],s=null,o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null;while(t.length>0){s=t.shift(),e.log.trace("Compiling token ",s);switch(s.type){case e.token.type.raw:r.length>0?i.push(s):n.push(s);break;case e.token.type.logic:o=e.logic.compile.apply(this,[s]),c=o.type,h=e.logic.handler[c].open,p=e.logic.handler[c].next,e.log.trace("Twig.compile: ","Compiled logic token to ",o," next is: ",p," open is : ",h);if(h!==undefined&&!h){a=r.pop(),f=e.logic.handler[a.type];if(e.indexOf(f.next,c)<0)throw new Error(c+" not expected after a "+a.type);a.output=a.output||[],a.output=a.output.concat(i),i=[],l={type:e.token.type.logic,token:a},r.length>0?i.push(l):n.push(l)}p!==undefined&&p.length>0?(e.log.trace("Twig.compile: ","Pushing ",o," to logic stack."),r.length>0&&(a=r.pop(),a.output=a.output||[],a.output=a.output.concat(i),r.push(a),i=[]),r.push(o)):h!==undefined&&h&&(l={type:e.token.type.logic,token:o},r.length>0?i.push(l):n.push(l));break;case e.token.type.comment:break;case e.token.type.output:e.expression.compile.apply(this,[s]),r.length>0?i.push(s):n.push(s)}e.log.trace("Twig.compile: "," Output: ",n," Logic Stack: ",r," Pending Output: ",i)}if(r.length>0)throw u=r.pop(),new Error("Unable to find an end tag for "+u.type+", expecting one of "+u.next);return n}catch(d){e.log.error("Error compiling twig template "+this.id+": "),d.stack?e.log.error(d.stack):e.log.error(d.toString());if(this.options.rethrow)throw d}},e.parse=function(t,n){try{var r=[],i=!0,s=this;return n=n||{},e.forEach(t,function(o){e.log.debug("Twig.parse: ","Parsing token: ",o);switch(o.type){case e.token.type.raw:r.push(o.value);break;case e.token.type.logic:var u=o.token,a=e.logic.parse.apply(s,[u,n,i]);a.chain!==undefined&&(i=a.chain),a.context!==undefined&&(n=a.context),a.output!==undefined&&r.push(a.output);break;case e.token.type.comment:break;case e.token.type.output:e.log.debug("Twig.parse: ","Output token: ",o.stack),r.push(e.expression.parse.apply(s,[o.stack,n]))}}),r.join("")}catch(o){e.log.error("Error parsing twig template "+this.id+": "),o.stack?e.log.error(o.stack):e.log.error(o.toString());if(this.options.rethrow)throw o;if(e.debug)return o.toString()}},e.prepare=function(t){var n,r;return e.log.debug("Twig.prepare: ","Tokenizing ",t),r=e.tokenize.apply(this,[t]),e.log.debug("Twig.prepare: ","Compiling ",r),n=e.compile.apply(this,[r]),e.log.debug("Twig.prepare: ","Compiled ",n),n},e.Templates={registry:{}},e.validateId=function(t){if(t==="prototype")throw new e.Error(t+" is not a valid twig identifier");if(e.Templates.registry.hasOwnProperty(t))throw new e.Error("There is already a template with the ID "+t);return!0},e.Templates.save=function(t){if(t.id===undefined)throw new e.Error("Unable to save template with no id");e.Templates.registry[t.id]=t},e.Templates.load=function(t){return e.Templates.registry.hasOwnProperty(t)?e.Templates.registry[t]:null},e.Templates.loadRemote=function(t,n,r,i){var s=n.id,o=n.method,u=n.async,a=n.precompiled,f=null;u===undefined&&(u=!0),s===undefined&&(s=t),n.id=s;if(e.cache&&e.Templates.registry.hasOwnProperty(s))return r&&r(e.Templates.registry[s]),e.Templates.registry[s];if(o=="ajax"){if(typeof XMLHttpRequest=="undefined")throw new e.Error("Unsupported platform: Unable to do remote requests because there is no XMLHTTPRequest implementation");var l=new XMLHttpRequest;l.onreadystatechange=function(){var s=null;l.readyState==4&&(l.status==200?(e.log.debug("Got template ",l.responseText),a===!0?s=JSON.parse(l.responseText):s=l.responseText,n.url=t,n.data=s,f=new e.Template(n),r&&r(f)):i&&i(l))},l.open("GET",t,u),l.send()}else(function(){var s=require("fs"),o=require("path"),l=null,c=function(s,o){if(s){i&&i(s);return}a===!0&&(o=JSON.parse(o)),n.data=o,n.path=t,f=new e.Template(n),r&&r(f)};if(u===!0)s.stat(t,function(n,r){if(n||!r.isFile())throw new e.Error("Unable to find template file "+t);s.readFile(t,"utf8",c)});else{if(!s.statSync(t).isFile())throw new e.Error("Unable to find template file "+t);l=s.readFileSync(t,"utf8"),c(undefined,l)}})();return u===!1?f:!0},e.Template=function(n){var r=n.data,i=n.id,s=n.blocks,o=n.macros||{},u=n.base,a=n.path,f=n.url,l=n.options;this.id=i,this.base=u,this.path=a,this.url=f,this.macros=o,this.options=l,this.reset(s),t("String",r)?this.tokens=e.prepare.apply(this,[r]):this.tokens=r,i!==undefined&&e.Templates.save(this)},e.Template.prototype.reset=function(t){e.log.debug("Twig.Template.reset","Reseting template "+this.id),this.blocks={},this.child={blocks:t||{}},this.extend=null},e.Template.prototype.render=function(t,r){r=r||{};var i,s;this.context=t||{},this.reset(),r.blocks&&(this.blocks=r.blocks),r.macros&&(this.macros=r.macros),i=e.parse.apply(this,[this.tokens,this.context]);if(this.extend){var o;return this.options.allowInlineIncludes&&(o=e.Templates.load(this.extend),o&&(o.options=this.options)),o||(s=n(this,this.extend),o=e.Templates.loadRemote(s,{method:this.url?"ajax":"fs",base:this.base,async:!1,id:s,options:this.options})),this.parent=o,this.parent.render(this.context,{blocks:this.blocks})}return r.output=="blocks"?this.blocks:r.output=="macros"?this.macros:i},e.Template.prototype.importFile=function(t){var r,i;if(!this.url&&!this.path&&this.options.allowInlineIncludes){i=e.Templates.load(t),i.options=this.options;if(i)return i;throw new e.Error("Didn't find the inline template by id")}return r=n(this,t),i=e.Templates.loadRemote(r,{method:this.url?"ajax":"fs",base:this.base,async:!1,options:this.options,id:r}),i},e.Template.prototype.importBlocks=function(t,n){var r=this.importFile(t),i=this.context,s=this,o;n=n||!1,r.render(i),e.forEach(Object.keys(r.blocks),function(e){if(n||s.blocks[e]===undefined)s.blocks[e]=r.blocks[e]})},e.Template.prototype.importMacros=function(t){var r=n(this,t),i=e.Templates.loadRemote(r,{method:this.url?"ajax":"fs",async:!1,id:r});return i},e.Template.prototype.compile=function(t){return e.compiler.compile(this,t)},e}(Twig||{});(function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t})})();var Twig=function(e){e.lib={};var t=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function n(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};return r.format=function(r,i){var s=1,o=r.length,u="",a,f=[],l,c,h,p,d,v;for(l=0;l<o;l++){u=e(r[l]);if(u==="string")f.push(r[l]);else if(u==="array"){h=r[l];if(h[2]){a=i[s];for(c=0;c<h[2].length;c++){if(!a.hasOwnProperty(h[2][c]))throw t('[sprintf] property "%s" does not exist',h[2][c]);a=a[h[2][c]]}}else h[1]?a=i[h[1]]:a=i[s++];if(/[^s]/.test(h[8])&&e(a)!="number")throw t("[sprintf] expecting number but found %s",e(a));switch(h[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=h[7]?a.toExponential(h[7]):a.toExponential();break;case"f":a=h[7]?parseFloat(a).toFixed(h[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&h[7]?a.substring(0,h[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(h[8])&&h[3]&&a>=0?"+"+a:a,d=h[4]?h[4]=="0"?"0":h[4].charAt(1):" ",v=h[6]-String(a).length,p=h[6]?n(d,v):"",f.push(h[5]?a+p:p+a)}}return f.join("")},r.cache={},r.parse=function(e){var t=e,n=[],r=[],i=0;while(t){if((n=/^[^\x25]+/.exec(t))!==null)r.push(n[0]);else if((n=/^\x25{2}/.exec(t))!==null)r.push("%");else{if((n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))===null)throw"[sprintf] huh?";if(n[2]){i|=1;var s=[],o=n[2],u=[];if((u=/^([a-z_][a-z_\d]*)/i.exec(o))===null)throw"[sprintf] huh?";s.push(u[1]);while((o=o.substring(u[0].length))!=="")if((u=/^\.([a-z_][a-z_\d]*)/i.exec(o))!==null)s.push(u[1]);else{if((u=/^\[(\d+)\]/.exec(o))===null)throw"[sprintf] huh?";s.push(u[1])}n[2]=s}else i|=2;if(i===3)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},r}(),n=function(e,n){return n.unshift(e),t.apply(null,n)};return e.lib.sprintf=t,e.lib.vsprintf=n,function(){function s(e){return(e=Math.abs(e)%100)%10==1&&e!=11?"st":e%10==2&&e!=12?"nd":e%10==3&&e!=13?"rd":"th"}function o(e){var t=new Date(e.getFullYear()+1,0,4);return(t-e)/864e5<7&&(e.getDay()+6)%7<(t.getDay()+6)%7?t.getFullYear():e.getMonth()>0||e.getDate()>=4?e.getFullYear():e.getFullYear()-((e.getDay()+6)%7-e.getDate()>2?1:0)}function u(e){var t=new Date(o(e),0,4);return t.setDate(t.getDate()-(t.getDay()+6)%7),parseInt((e-t)/6048e5)+1}var t="Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),n="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),r="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),i="January,February,March,April,May,June,July,August,September,October,November,December".split(",");e.lib.formatDate=function(e,a){if(typeof a!="string"||/^\s*$/.test(a))return e+"";var f=new Date(e.getFullYear(),0,1),l=e;return a.replace(/[dDjlNSwzWFmMntLoYyaABgGhHisuU]/g,function(e){switch(e){case"d":return("0"+l.getDate()).replace(/^.+(..)$/,"$1");case"D":return t[l.getDay()];case"j":return l.getDate();case"l":return n[l.getDay()];case"N":return(l.getDay()+6)%7+1;case"S":return s(l.getDate());case"w":return l.getDay();case"z":return Math.ceil((f-l)/864e5);case"W":return("0"+u(l)).replace(/^.(..)$/,"$1");case"F":return i[l.getMonth()];case"m":return("0"+(l.getMonth()+1)).replace(/^.+(..)$/,"$1");case"M":return r[l.getMonth()];case"n":return l.getMonth()+1;case"t":return(new Date(l.getFullYear(),l.getMonth()+1,-1)).getDate();case"L":return(new Date(l.getFullYear(),1,29)).getDate()==29?1:0;case"o":return o(l);case"Y":return l.getFullYear();case"y":return(l.getFullYear()+"").replace(/^.+(..)$/,"$1");case"a":return l.getHours()<12?"am":"pm";case"A":return l.getHours()<12?"AM":"PM";case"B":return Math.floor(((l.getUTCHours()+1)%24+l.getUTCMinutes()/60+l.getUTCSeconds()/3600)*1e3/24);case"g":return l.getHours()%12!=0?l.getHours()%12:12;case"G":return l.getHours();case"h":return("0"+(l.getHours()%12!=0?l.getHours()%12:12)).replace(/^.+(..)$/,"$1");case"H":return("0"+l.getHours()).replace(/^.+(..)$/,"$1");case"i":return("0"+l.getMinutes()).replace(/^.+(..)$/,"$1");case"s":return("0"+l.getSeconds()).replace(/^.+(..)$/,"$1");case"u":return l.getMilliseconds();case"U":return l.getTime()/1e3}})}}(),e.lib.strip_tags=function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})},e.lib.parseISO8601Date=function(e){var t=/(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d+)?(Z|([+-])(\d\d):(\d\d))/,n=[];n=e.match(t);if(!n)throw"Couldn't parse ISO 8601 date string '"+e+"'";var r=[1,2,3,4,5,6,10,11];for(var i in r)n[r[i]]=parseInt(n[r[i]],10);n[7]=parseFloat(n[7]);var s=Date.UTC(n[1],n[2]-1,n[3],n[4],n[5],n[6]);n[7]>0&&(s+=Math.round(n[7]*1e3));if(n[8]!="Z"&&n[10]){var o=n[10]*60*60*1e3;n[11]&&(o+=n[11]*60*1e3),n[9]=="-"?s-=o:s+=o}return new Date(s)},e.lib.strtotime=function(t,n){var r,i,s,o,u="";t=t.replace(/\s{2,}|^\s|\s$/g," "),t=t.replace(/[\t\r\n]/g,"");if(t==="now")return n===null||isNaN(n)?(new Date).getTime()/1e3|0:n|0;if(!isNaN(u=Date.parse(t)))return u/1e3|0;n?n=new Date(n*1e3):n=new Date;var a=t;t=t.toLowerCase();var f={day:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},mon:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]},l=function(e){var t=e[2]&&e[2]==="ago",r=(r=e[0]==="last"?-1:1)*(t?-1:1);switch(e[0]){case"last":case"next":switch(e[1].substring(0,3)){case"yea":n.setFullYear(n.getFullYear()+r);break;case"wee":n.setDate(n.getDate()+r*7);break;case"day":n.setDate(n.getDate()+r);break;case"hou":n.setHours(n.getHours()+r);break;case"min":n.setMinutes(n.getMinutes()+r);break;case"sec":n.setSeconds(n.getSeconds()+r);break;case"mon":if(e[1]==="month"){n.setMonth(n.getMonth()+r);break};default:var i=f.day[e[1].substring(0,3)];if(typeof i!="undefined"){var s=i-n.getDay();s===0?s=7*r:s>0?e[0]==="last"&&(s-=7):e[0]==="next"&&(s+=7),n.setDate(n.getDate()+s),n.setHours(0,0,0,0)}}break;default:if(!/\d+/.test(e[0]))return!1;r*=parseInt(e[0],10);switch(e[1].substring(0,3)){case"yea":n.setFullYear(n.getFullYear()+r);break;case"mon":n.setMonth(n.getMonth()+r);break;case"wee":n.setDate(n.getDate()+r*7);break;case"day":n.setDate(n.getDate()+r);break;case"hou":n.setHours(n.getHours()+r);break;case"min":n.setMinutes(n.getMinutes()+r);break;case"sec":n.setSeconds(n.getSeconds()+r)}}return!0};s=t.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/);if(s!==null)return s[2]?s[3]||(s[2]+=":00"):s[2]="00:00:00",o=s[1].split(/-/g),o[1]=f.mon[o[1]-1]||o[1],o[0]=+o[0],o[0]=o[0]>=0&&o[0]<=69?"20"+(o[0]<10?"0"+o[0]:o[0]+""):o[0]>=70&&o[0]<=99?"19"+o[0]:o[0]+"",parseInt(this.strtotime(o[2]+" "+o[1]+" "+o[0]+" "+s[2])+(s[4]?s[4]/1e3:""),10);var c="([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?";s=t.match(new RegExp(c,"gi"));if(s===null){try{num=e.lib.parseISO8601Date(a);if(num)return num/1e3|0}catch(h){return!1}return!1}for(r=0,i=s.length;r<i;r++)if(!l(s[r].split(" ")))return!1;return n.getTime()/1e3|0},e.lib.is=function(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e},e.lib.copy=function(e){var t={},n;for(n in e)t[n]=e[n];return t},e.lib.replaceAll=function(e,t,n){return e.split(t).join(n)},e.lib.chunkArray=function(t,n){var r=[],i=0,s=t.length;if(n<1||!e.lib.is("Array",t))return[];while(i<s)r.push(t.slice(i,i+=n));return r},e.lib.round=function(t,n,r){var i,s,o,u;n|=0,i=Math.pow(10,n),t*=i,u=t>0|-(t<0),o=t%1===.5*u,s=Math.floor(t);if(o)switch(r){case"PHP_ROUND_HALF_DOWN":t=s+(u<0);break;case"PHP_ROUND_HALF_EVEN":t=s+s%2*u;break;case"PHP_ROUND_HALF_ODD":t=s+!(s%2);break;default:t=s+(u>0)}return(o?t:Math.round(t))/i},e}(Twig||{}),Twig=function(e){e.logic={},e.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from"},e.logic.definitions=[{type:e.logic.type.if_,regex:/^if\s+([^\s].+)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!0,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i="",s=e.expression.parse.apply(this,[t.stack,n]);return r=!0,s&&(r=!1,i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!1,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i="";return r&&e.expression.parse.apply(this,[t.stack,n])===!0&&(r=!1,i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.else_,regex:/^else$/,next:[e.logic.type.endif,e.logic.type.endfor],open:!1,parse:function(t,n,r){var i="";return r&&(i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:e.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].*?)(?:\s+if\s+([^\s].*))?$/,next:[e.logic.type.else_,e.logic.type.endfor],open:!0,compile:function(t){var n=t.match[1],r=t.match[2],i=t.match[3],s=null;t.key_var=null,t.value_var=null;if(n.indexOf(",")>=0){s=n.split(",");if(s.length!==2)throw new e.Error("Invalid expression in for loop: "+n);t.key_var=s[0].trim(),t.value_var=s[1].trim()}else t.value_var=n;return t.expression=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,i&&(t.conditional=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i}]).stack),delete t.match,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.expression,n]),s=[],o,u=0,a,f=this,l=t.conditional,c=function(e,t){var r=l!==undefined;return{index:e+1,index0:e,revindex:r?undefined:t-e,revindex0:r?undefined:t-e-1,first:e===0,last:r?undefined:e===t-1,length:r?undefined:t,parent:n}},h=function(r,i){var a=e.lib.copy(n);a[t.value_var]=i,t.key_var&&(a[t.key_var]=r),a.loop=c(u,o);if(l===undefined||e.expression.parse.apply(f,[l,a]))s.push(e.parse.apply(f,[t.output,a])),u+=1};return i instanceof Array?(o=i.length,e.forEach(i,function(e){var t=u;h(t,e)})):i instanceof Object&&(i._keys!==undefined?a=i._keys:a=Object.keys(i),o=a.length,e.forEach(a,function(e){if(e==="_keys")return;h(e,i[e])})),r=s.length===0,{chain:r,output:s.join("")}}},{type:e.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:e.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2],i=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack;return t.key=n,t.expression=i,delete t.match,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.expression,n]),s=t.key;return this.context[s]=i,n[s]=i,{chain:r,context:n}}},{type:e.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[e.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=t.key;return this.context[s]=i,n[s]=i,{chain:r,context:n}}},{type:e.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:e.logic.type.filter,regex:/^filter\s+(.+)$/,next:[e.logic.type.endfilter],open:!0,compile:function(t){var n="|"+t.match[1].trim();return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=[{type:e.expression.type.string,value:i}].concat(t.stack),o=e.expression.parse.apply(this,[s,n]);return{chain:r,output:o}}},{type:e.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:e.logic.type.block,regex:/^block\s+([a-zA-Z0-9_]+)$/,next:[e.logic.type.endblock],open:!0,compile:function(e){return e.block=e.match[1].trim(),delete e.match,e},parse:function(t,n,r){var i="",s="",o=this.blocks[t.block]&&this.blocks[t.block].indexOf(e.placeholders.parent)>-1;if(this.blocks[t.block]===undefined||o||n.loop)i=e.expression.parse.apply(this,[{type:e.expression.type.string,value:e.parse.apply(this,[t.output,n])},n]),o?this.blocks[t.block]=this.blocks[t.block].replace(e.placeholders.parent,i):this.blocks[t.block]=i;return this.child.blocks[t.block]?s=this.child.blocks[t.block]:s=this.blocks[t.block],{chain:r,output:s}}},{type:e.logic.type.endblock,regex:/^endblock(?:\s+([a-zA-Z0-9_]+))?$/,next:[],open:!1},{type:e.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.stack,n]);return this.extend=i,{chain:r,output:""}}},{type:e.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.stack,n]);return this.importBlocks(i),{chain:r,output:""}}},{type:e.logic.type.include,regex:/^include\s+(ignore missing\s+)?(.+?)\s*(?:with\s+(.+?))?\s*(only)?$/,next:[],open:!0,compile:function(t){var n=t.match,r=n[1]!==undefined,i=n[2].trim(),s=n[3],o=n[4]!==undefined&&n[4].length;return delete t.match,t.only=o,t.includeMissing=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i}]).stack,s!==undefined&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:s.trim()}]).stack),t},parse:function(t,n,r){var i={},s,o,u;if(!t.only)for(o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);if(t.withStack!==undefined){s=e.expression.parse.apply(this,[t.withStack,n]);for(o in s)s.hasOwnProperty(o)&&(i[o]=s[o])}var a=e.expression.parse.apply(this,[t.stack,i]);return u=this.importFile(a),{chain:r,output:u.render(i)}}},{type:e.logic.type.spaceless,regex:/^spaceless$/,next:[e.logic.type.endspaceless],open:!0,parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=/>\s+</g,o=i.replace(s,"><").trim();return{chain:r,output:o}}},{type:e.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:e.logic.type.macro,regex:/^macro\s+([a-zA-Z0-9_]+)\s?\((([a-zA-Z0-9_]+(,\s?)?)*)\)$/,next:[e.logic.type.endmacro],open:!0,compile:function(t){var n=t.match[1],r=t.match[2].split(/[ ,]+/);for(var i=0;i<r.length;i++)for(var s=0;s<r.length;s++)if(r[i]===r[s]&&i!==s)throw new e.Error("Duplicate arguments for parameter: "+r[i]);return t.macroName=n,t.parameters=r,delete t.match,t},parse:function(t,n,r){var i=this;return this.macros[t.macroName]=function(){var n={_self:i.macros};for(var r=0;r<t.parameters.length;r++){var s=t.parameters[r];typeof arguments[r]!="undefined"?n[s]=arguments[r]:n[s]=undefined}return e.parse.apply(i,[t.output,n])},{chain:r,output:""}}},{type:e.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:e.logic.type.import_,regex:/^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim();return delete t.match,t.expression=n,t.contextName=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){if(t.expression!=="_self"){var i=e.expression.parse.apply(this,[t.stack,n]),s=this.importMacros(i||t.expression);n[t.contextName]=s.render({},{output:"macros"})}else n[t.contextName]=this.macros;return{chain:r,output:""}}},{type:e.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim().split(/[ ,]+/),i={};for(var s=0;s<r.length;s++){var o=r[s],u=o.match(/^([a-zA-Z0-9_]+)\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/);u?i[u[1].trim()]=u[2].trim():o.match(/^([a-zA-Z0-9_]+)$/)&&(i[o]=o)}return delete t.match,t.expression=n,t.macroNames=i,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i;if(t.expression!=="_self"){var s=e.expression.parse.apply(this,[t.stack,n]),o=this.importMacros(s||t.expression);i=o.render({},{output:"macros"})}else i=this.macros;for(var u in t.macroNames)i.hasOwnProperty(u)&&(n[t.macroNames[u]]=i[u]);return{chain:r,output:""}}}],e.logic.handler={},e.logic.extendType=function(t,n){n=n||"Twig.logic.type"+t,e.logic.type[t]=n},e.logic.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);if(e.logic.type[t.type])throw new e.Error("Unable to extend logic definitions. Type "+t.type+" is already defined.");e.logic.extendType(t.type),e.logic.handler[t.type]=t};while(e.logic.definitions.length>0)e.logic.extend(e.logic.definitions.shift());return e.logic.compile=function(t){var n=t.value.trim(),r=e.logic.tokenize.apply(this,[n]),i=e.logic.handler[r.type];return i.compile&&(r=i.compile.apply(this,[r]),e.log.trace("Twig.logic.compile: ","Compiled logic token to ",r)),r},e.logic.tokenize=function(t){var n={},r=null,i=null,s=null,o=null,u=null,a=null;t=t.trim();for(r in e.logic.handler)if(e.logic.handler.hasOwnProperty(r)){i=e.logic.handler[r].type,s=e.logic.handler[r].regex,o=[],s instanceof Array?o=s:o.push(s);while(o.length>0){u=o.shift(),a=u.exec(t.trim());if(a!==null)return n.type=i,n.match=a,e.log.trace("Twig.logic.tokenize: ","Matched a ",i," regular expression of ",a),n}}throw new e.Error("Unable to parse '"+t.trim()+"'")},e.logic.parse=function(t,n,r){var i="",s;return n=n||{},e.log.debug("Twig.logic.parse: ","Parsing logic token ",t),s=e.logic.handler[t.type],s.parse&&(i=s.parse.apply(this,[t,n,r])),i},e}(Twig||{}),Twig=function(e){e.expression={},e.expression.reservedWords=["true","false","null","_context"],e.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},e.expression.set={operations:[e.expression.type.filter,e.expression.type.operator.unary,e.expression.type.operator.binary,e.expression.type.array.end,e.expression.type.object.end,e.expression.type.parameter.end,e.expression.type.comma,e.expression.type.test],expressions:[e.expression.type._function,e.expression.type.bool,e.expression.type.string,e.expression.type.variable,e.expression.type.number,e.expression.type._null,e.expression.type.context,e.expression.type.parameter.start,e.expression.type.array.start,e.expression.type.object.start]},e.expression.set.operations_extended=e.expression.set.operations.concat([e.expression.type.key.period,e.expression.type.key.brackets]),e.expression.fn={compile:{push:function(e,t,n){n.push(e)},push_both:function(e,t,n){n.push(e),t.push(e)}},parse:{push:function(e,t,n){t.push(e)},push_value:function(e,t,n){t.push(e.value)}}},e.expression.definitions=[{type:e.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*)/,next:e.expression.set.operations.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=n.pop(),s=t.params&&e.expression.parse.apply(this,[t.params,r]),o=e.test(t.filter,i,s);t.modifier=="not"?n.push(!o):n.push(o)}},{type:e.expression.type.comma,regex:/^,/,next:e.expression.set.expressions.concat([e.expression.type.array.end,e.expression.type.object.end]),compile:function(t,n,r){var i=n.length-1,s;delete t.match,delete t.value;for(;i>=0;i--){s=n.pop();if(s.type===e.expression.type.object.start||s.type===e.expression.type.parameter.start||s.type===e.expression.type.array.start){n.push(s);break}r.push(s)}r.push(t)}},{type:e.expression.type.operator.binary,regex:/(^[\+\-~%\?\:]|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^and\s+|^or\s+|^in\s+|^not in\s+|^\.\.)/,next:e.expression.set.expressions.concat([e.expression.type.operator.unary]),compile:function(t,n,r){delete t.match,t.value=t.value.trim();var i=t.value,s=e.expression.operator.lookup(i,t);e.log.trace("Twig.expression.compile: ","Operator: ",s," from ",i);while(n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(s.associativity===e.expression.operator.leftToRight&&s.precidence>=n[n.length-1].precidence||s.associativity===e.expression.operator.rightToLeft&&s.precidence>n[n.length-1].precidence)){var o=n.pop();r.push(o)}if(i===":"){if(!n[n.length-1]||n[n.length-1].value!=="?"){var u=r.pop();if(u.type!==e.expression.type.string&&u.type!==e.expression.type.variable&&u.type!==e.expression.type.number)throw new e.Error("Unexpected value before ':' of "+u.type+" = "+u.value);t.key=u.value,r.push(t);return}}else n.push(s)},parse:function(t,n,r){t.key?n.push(t):e.expression.operator.parse(t.value,n)}},{type:e.expression.type.operator.unary,regex:/(^not\s+)/,next:e.expression.set.expressions,compile:function(t,n,r){delete t.match,t.value=t.value.trim();var i=t.value,s=e.expression.operator.lookup(i,t);e.log.trace("Twig.expression.compile: ","Operator: ",s," from ",i);while(n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(s.associativity===e.expression.operator.leftToRight&&s.precidence>=n[n.length-1].precidence||s.associativity===e.expression.operator.rightToLeft&&s.precidence>n[n.length-1].precidence)){var o=n.pop();r.push(o)}n.push(s)},parse:function(t,n,r){e.expression.operator.parse(t.value,n)}},{type:e.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2.)*?\1/,next:e.expression.set.operations,compile:function(t,n,r){var i=t.value;delete t.match,i.substring(0,1)==='"'?i=i.replace('\\"','"'):i=i.replace("\\'","'"),t.value=i.substring(1,i.length-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),e.log.trace("Twig.expression.compile: ","String value: ",t.value),r.push(t)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.parameter.start,regex:/^\(/,next:e.expression.set.expressions.concat([e.expression.type.parameter.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.parameter.end,regex:/^\)/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i,s=t;i=n.pop();while(n.length>0&&i.type!=e.expression.type.parameter.start)r.push(i),i=n.pop();var o=[];while(t.type!==e.expression.type.parameter.start)o.unshift(t),t=r.pop();o.unshift(t);var u=!1;t=r[r.length-1],t===undefined||t.type!==e.expression.type._function&&t.type!==e.expression.type.filter&&t.type!==e.expression.type.test&&t.type!==e.expression.type.key.brackets&&t.type!==e.expression.type.key.period?(s.expression=!0,o.pop(),o.shift(),s.params=o,r.push(s)):(s.expression=!1,t.params=o)},parse:function(t,n,r){var i=[],s=!1,o=null;if(t.expression)o=e.expression.parse.apply(this,[t.params,r]),n.push(o);else{while(n.length>0){o=n.pop();if(o&&o.type&&o.type==e.expression.type.parameter.start){s=!0;break}i.unshift(o)}if(!s)throw new e.Error("Expected end of parameter set.");n.push(i)}}},{type:e.expression.type.array.start,regex:/^\[/,next:e.expression.set.expressions.concat([e.expression.type.array.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.array.end,regex:/^\]/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i=n.length-1,s;for(;i>=0;i--){s=n.pop();if(s.type===e.expression.type.array.start)break;r.push(s)}r.push(t)},parse:function(t,n,r){var i=[],s=!1,o=null;while(n.length>0){o=n.pop();if(o.type&&o.type==e.expression.type.array.start){s=!0;break}i.unshift(o)}if(!s)throw new e.Error("Expected end of array.");n.push(i)}},{type:e.expression.type.object.start,regex:/^\{/,next:e.expression.set.expressions.concat([e.expression.type.object.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.object.end,regex:/^\}/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i=n.length-1,s;for(;i>=0;i--){s=n.pop();if(s&&s.type===e.expression.type.object.start)break;r.push(s)}r.push(t)},parse:function(t,n,r){var i={},s=!1,o=null,u=null,a=!1,f=null;while(n.length>0){o=n.pop();if(o&&o.type&&o.type===e.expression.type.object.start){s=!0;break}if(o&&o.type&&(o.type===e.expression.type.operator.binary||o.type===e.expression.type.operator.unary)&&o.key){if(!a)throw new e.Error("Missing value for key '"+o.key+"' in object definition.");i[o.key]=f,i._keys===undefined&&(i._keys=[]),i._keys.unshift(o.key),f=null,a=!1}else a=!0,f=o}if(!s)throw new e.Error("Unexpected end of object.");n.push(i)}},{type:e.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.value=e.match[1],n.push(e)},parse:function(t,n,r){var i=n.pop(),s=t.params&&e.expression.parse.apply(this,[t.params,r]);n.push(e.filter.apply(this,[t.value,i,s]))}},{type:e.expression.type._function,regex:/^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,next:e.expression.type.parameter.start,transform:function(e,t){return"("},compile:function(e,t,n){var r=e.match[1];e.fn=r,delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=t.fn,o;if(e.functions[s])o=e.functions[s].apply(this,i);else{if(typeof r[s]!="function")throw new e.Error(s+" function does not exist and is not defined in the context");o=r[s].apply(r,i)}n.push(o)}},{type:e.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,validate:function(t,n){return e.indexOf(e.expression.reservedWords,t[0])<0},parse:function(t,n,r){var i=e.expression.resolve(r[t.value],r);n.push(i)}},{type:e.expression.type.key.period,regex:/^\.([a-zA-Z0-9_]+)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.key=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=t.key,o=n.pop(),u;if(o===null||o===undefined){if(this.options.strict_variables)throw new e.Error("Can't access a key "+s+" on an null or undefined object.");return null}var a=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)};typeof o=="object"&&s in o?u=o[s]:o["get"+a(s)]!==undefined?u=o["get"+a(s)]:o["is"+a(s)]!==undefined?u=o["is"+a(s)]:u=null,n.push(e.expression.resolve(u,o,i))}},{type:e.expression.type.key.brackets,regex:/^\[([^\]]*)\]/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(t,n,r){var i=t.match[1];delete t.value,delete t.match,t.stack=e.expression.compile({value:i}).stack,r.push(t)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=e.expression.parse.apply(this,[t.stack,r]),o=n.pop(),u;if(o===null||o===undefined){if(this.options.strict_variables)throw new e.Error("Can't access a key "+s+" on an null or undefined object.");return null}typeof o=="object"&&s in o?u=o[s]:u=null,n.push(e.expression.resolve(u,o,i))}},{type:e.expression.type._null,regex:/^null/,next:e.expression.set.operations,compile:function(e,t,n){delete e.match,e.value=null,n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.context,regex:/^_context/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,parse:function(e,t,n){t.push(n)}},{type:e.expression.type.number,regex:/^\-?\d+(\.\d+)?/,next:e.expression.set.operations,compile:function(e,t,n){e.value=Number(e.value),n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.bool,regex:/^(true|false)/,next:e.expression.set.operations,compile:function(e,t,n){e.value=e.match[0]=="true",delete e.match,n.push(e)},parse:e.expression.fn.parse.push_value}],e.expression.resolve=function(e,t,n){return typeof e=="function"?e.apply(t,n||[]):e},e.expression.handler={},e.expression.extendType=function(t){e.expression.type[t]="Twig.expression.type."+t},e.expression.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.expression.handler[t.type]=t};while(e.expression.definitions.length>0)e.expression.extend(e.expression.definitions.shift());return e.expression.tokenize=function(t){var n=[],r=0,i=null,s,o,u,a,f,l=[],c;c=function(){var t=Array.prototype.slice.apply(arguments),o=t.pop(),u=t.pop();return e.log.trace("Twig.expression.tokenize","Matched a ",s," regular expression of ",t),i&&e.indexOf(i,s)<0?(l.push(s+" cannot follow a "+n[n.length-1].type+" at template:"+r+" near '"+t[0].substring(0,20)+"...'"),t[0]):e.expression.handler[s].validate&&!e.expression.handler[s].validate(t,n)?t[0]:(l=[],n.push({type:s,value:t[0],match:t}),f=!0,i=a,r+=t[0].length,e.expression.handler[s].transform?e.expression.handler[s].transform(t,n):"")},e.log.debug("Twig.expression.tokenize","Tokenizing expression ",t);while(t.length>0){t=t.trim();for(s in e.expression.handler)if(e.expression.handler.hasOwnProperty(s)){a=e.expression.handler[s].next,o=e.expression.handler[s].regex,o instanceof Array?u=o:u=[o],f=!1;while(u.length>0)o=u.pop(),t=t.replace(o,c);if(f)break}if(!f)throw l.length>0?new e.Error(l.join(" OR ")):new e.Error("Unable to parse '"+t+"' at template position"+r)}return e.log.trace("Twig.expression.tokenize","Tokenized to ",n),n},e.expression.compile=function(t){var n=t.value,r=e.expression.tokenize(n),i=null,s=[],o=[],u=null;e.log.trace("Twig.expression.compile: ","Compiling ",n);while(r.length>0)i=r.shift(),u=e.expression.handler[i.type],e.log.trace("Twig.expression.compile: ","Compiling ",i),u.compile&&u.compile(i,o,s),e.log.trace("Twig.expression.compile: ","Stack is",o),e.log.trace("Twig.expression.compile: ","Output is",s);while(o.length>0)s.push(o.pop());return e.log.trace("Twig.expression.compile: ","Final output is",s),t.stack=s,delete t.value,t},e.expression.parse=function(t,n){var r=this;t instanceof Array||(t=[t]);var i=[],s=null;return e.forEach(t,function(t){s=e.expression.handler[t.type],s.parse&&s.parse.apply(r,[t,i,n])}),i.pop()},e}(Twig||{}),Twig=function(e){e.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};var t=function(e,t){if(t.indexOf!==undefined)return e===t||e!==""&&t.indexOf(e)>-1;var n;for(n in t)if(t.hasOwnProperty(n)&&t[n]===e)return!0;return!1};return e.expression.operator.lookup=function(t,n){switch(t){case"..":case"not in":case"in":n.precidence=20,n.associativity=e.expression.operator.leftToRight;break;case",":n.precidence=18,n.associativity=e.expression.operator.leftToRight;break;case"?":case":":n.precidence=16,n.associativity=e.expression.operator.rightToLeft;break;case"or":n.precidence=14,n.associativity=e.expression.operator.leftToRight;break;case"and":n.precidence=13,n.associativity=e.expression.operator.leftToRight;break;case"==":case"!=":n.precidence=9,n.associativity=e.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":n.precidence=8,n.associativity=e.expression.operator.leftToRight;break;case"~":case"+":case"-":n.precidence=6,n.associativity=e.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":n.precidence=5,n.associativity=e.expression.operator.leftToRight;break;case"not":n.precidence=3,n.associativity=e.expression.operator.rightToLeft;break;default:throw new e.Error(t+" is an unknown operator.")}return n.operator=t,n},e.expression.operator.parse=function(n,r){e.log.trace("Twig.expression.operator.parse: ","Handling ",n);var i,s,o;switch(n){case":":break;case"?":o=r.pop(),s=r.pop(),i=r.pop(),i?r.push(s):r.push(o);break;case"+":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i+s);break;case"-":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i-s);break;case"*":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i*s);break;case"/":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i/s);break;case"//":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(parseInt(i/s));break;case"%":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i%s);break;case"~":s=r.pop(),i=r.pop(),r.push((i!==undefined?i.toString():"")+(s!==undefined?s.toString():""));break;case"not":case"!":r.push(!r.pop());break;case"<":s=r.pop(),i=r.pop(),r.push(i<s);break;case"<=":s=r.pop(),i=r.pop(),r.push(i<=s);break;case">":s=r.pop(),i=r.pop(),r.push(i>s);break;case">=":s=r.pop(),i=r.pop(),r.push(i>=s);break;case"===":s=r.pop(),i=r.pop(),r.push(i===s);break;case"==":s=r.pop(),i=r.pop(),r.push(i==s);break;case"!==":s=r.pop(),i=r.pop(),r.push(i!==s);break;case"!=":s=r.pop(),i=r.pop(),r.push(i!=s);break;case"or":s=r.pop(),i=r.pop(),r.push(i||s);break;case"and":s=r.pop(),i=r.pop(),r.push(i&&s);break;case"**":s=r.pop(),i=r.pop(),r.push(Math.pow(i,s));break;case"not in":s=r.pop(),i=r.pop(),r.push(!t(i,s));break;case"in":s=r.pop(),i=r.pop(),r.push(t(i,s));break;case"..":s=r.pop(),i=r.pop(),r.push(e.functions.range(i,s));break;default:throw new e.Error(n+" is an unknown operator.")}},e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}return e.filters={upper:function(e){return typeof e!="string"?e:e.toUpperCase()},lower:function(e){return typeof e!="string"?e:e.toLowerCase()},capitalize:function(e){return typeof e!="string"?e:e.substr(0,1).toUpperCase()+e.toLowerCase().substr(1)},title:function(e){return typeof e!="string"?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})},length:function(t){return e.lib.is("Array",t)||typeof t=="string"?t.length:e.lib.is("Object",t)?t._keys===undefined?Object.keys(t).length:t._keys.length:0},reverse:function(e){if(t("Array",e))return e.reverse();if(t("String",e))return e.split("").reverse().join("");if(e instanceof Object){var n=e._keys||Object.keys(e).reverse();return e._keys=n,e}},sort:function(e){if(t("Array",e))return e.sort();if(e instanceof Object){delete e._keys;var n=Object.keys(e),r=n.sort(function(t,n){return e[t]>e[n]});return e._keys=r,e}},keys:function(t){if(t===undefined||t===null)return;var n=t._keys||Object.keys(t),r=[];return e.forEach(n,function(e){if(e==="_keys")return;t.hasOwnProperty(e)&&r.push(e)}),r},url_encode:function(e){if(e===undefined||e===null)return;return encodeURIComponent(e)},join:function(t,n){if(t===undefined||t===null)return;var r="",i=[],s=null;return n&&n[0]&&(r=n[0]),t instanceof Array?i=t:(s=t._keys||Object.keys(t),e.forEach(s,function(e){if(e==="_keys")return;t.hasOwnProperty(e)&&i.push(t[e])})),i.join(r)},"default":function(t,n){if(n===undefined||n.length!==1)throw new e.Error("default filter expects one argument");return t===undefined||t===null||t===""?n[0]:t},json_encode:function(e){return e&&e.hasOwnProperty("_keys")&&delete e._keys,e===undefined||e===null?"null":JSON.stringify(e)},merge:function(t,n){var r=[],i=0,s=[];t instanceof Array?e.forEach(n,function(e){e instanceof Array||(r={})}):r={},r instanceof Array||(r._keys=[]),t instanceof Array?e.forEach(t,function(e){r._keys&&r._keys.push(i),r[i]=e,i++}):(s=t._keys||Object.keys(t),e.forEach(s,function(e){r[e]=t[e],r._keys.push(e);var n=parseInt(e,10);!isNaN(n)&&n>=i&&(i=n+1)})),e.forEach(n,function(t){t instanceof Array?e.forEach(t,function(e){r._keys&&r._keys.push(i),r[i]=e,i++}):(s=t._keys||Object.keys(t),e.forEach(s,function(e){r[e]||r._keys.push(e),r[e]=t[e];var n=parseInt(e,10);!isNaN(n)&&n>=i&&(i=n+1)}))});if(n.length===0)throw new e.Error("Filter merge expects at least one parameter");return r},date:function(t,n){if(t===undefined||t===null)return;var r=e.functions.date(t);return e.lib.formatDate(r,n[0])},date_modify:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length!==1)throw new e.Error("date_modify filter expects 1 argument");var r=n[0],i;return e.lib.is("Date",t)&&(i=e.lib.strtotime(r,t.getTime()/1e3)),e.lib.is("String",t)&&(i=e.lib.strtotime(r,e.lib.strtotime(t))),e.lib.is("Number",t)&&(i=e.lib.strtotime(r,t)),new Date(i*1e3)},replace:function(t,n){if(t===undefined||t===null)return;var r=n[0],i;for(i in r)r.hasOwnProperty(i)&&i!=="_keys"&&(t=e.lib.replaceAll(t,i,r[i]));return t},format:function(t,n){if(t===undefined||t===null)return;return e.lib.vsprintf(t,n)},striptags:function(t){if(t===undefined||t===null)return;return e.lib.strip_tags(t)},escape:function(e){if(e===undefined||e===null)return;return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},e:function(t){return e.filters.escape(t)},nl2br:function(t){if(t===undefined||t===null)return;var n="BACKSLASH_n_replace",r="<br />"+n;return t=e.filters.escape(t).replace(/\r\n/g,r).replace(/\r/g,r).replace(/\n/g,r),e.lib.replaceAll(t,n,"\n")},number_format:function(e,t){var n=e,r=t&&t[0]?t[0]:undefined,i=t&&t[1]!==undefined?t[1]:".",s=t&&t[2]!==undefined?t[2]:",";n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+n)?+n:0,u=isFinite(+r)?Math.abs(r):0,a="",f=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return a=(u?f(o,u):""+Math.round(o)).split("."),a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(a[1]||"").length<u&&(a[1]=a[1]||"",a[1]+=(new Array(u-a[1].length+1)).join("0")),a.join(i)},trim:function(t,n){if(t===undefined||t===null)return;var r=e.filters.escape(""+t),i;n&&n[0]?i=""+n[0]:i=" \n\r	\f\u2028\u2029";for(var s=0;s<r.length;s++)if(i.indexOf(r.charAt(s))===-1){r=r.substring(s);break}for(s=r.length-1;s>=0;s--)if(i.indexOf(r.charAt(s))===-1){r=r.substring(0,s+1);break}return i.indexOf(r.charAt(0))===-1?r:""},slice:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length<1)throw new e.Error("slice filter expects at least 1 argument");var r=n[0]||0,i=n.length>1?n[1]:t.length,s=r>=0?r:Math.max(t.length+r,0);if(e.lib.is("Array",t)){var o=[];for(var u=s;u<s+i&&u<t.length;u++)o.push(t[u]);return o}if(e.lib.is("String",t))return t.substr(s,i);throw new e.Error("slice filter expects value to be an array or string")},abs:function(e){if(e===undefined||e===null)return;return Math.abs(e)},first:function(e){if(e instanceof Array)return e[0];if(e instanceof Object){if("_keys"in e)return e[e._keys[0]]}else if(typeof e=="string")return e.substr(0,1);return},split:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length<1||n.length>2)throw new e.Error("split filter expects 1 or 2 argument");if(e.lib.is("String",t)){var r=n[0],i=n[1],s=t.split(r);if(i===undefined)return s;if(i<0)return t.split(r,s.length+i);var o=[];if(r=="")while(s.length>0){var u="";for(var a=0;a<i&&s.length>0;a++)u+=s.shift();o.push(u)}else{for(var a=0;a<i-1&&s.length>0;a++)o.push(s.shift());s.length>0&&o.push(s.join(r))}return o}throw new e.Error("split filter expects value to be a string")},last:function(t){if(e.lib.is("Object",t)){var n;return t._keys===undefined?n=Object.keys(t):n=t._keys,t[n[n.length-1]]}return t[t.length-1]},raw:function(e){return e},batch:function(t,n){var r=n.shift(),i=n.shift(),s,o,u;if(!e.lib.is("Array",t))throw new e.Error("batch filter expects items to be an array");if(!e.lib.is("Number",r))throw new e.Error("batch filter expects size to be a number");r=Math.ceil(r),s=e.lib.chunkArray(t,r);if(i&&t.length%r!=0){o=s.pop(),u=r-o.length;while(u--)o.push(i);s.push(o)}return s},round:function(t,n){n=n||[];var r=n.length>0?n[0]:0,i=n.length>1?n[1]:"common";t=parseFloat(t);if(r&&!e.lib.is("Number",r))throw new e.Error("round filter expects precision to be a number");if(i==="common")return e.lib.round(t,r);if(!e.lib.is("Function",Math[i]))throw new e.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[i](t*Math.pow(10,r))/Math.pow(10,r)}},e.filter=function(t,n,r){if(!e.filters[t])throw"Unable to find filter "+t;return e.filters[t].apply(this,[n,r])},e.filter.extend=function(t,n){e.filters[t]=n},e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}return e.functions={range:function(e,t,n){var r=[],i,s,o,u=n||1,a=!1;!isNaN(e)&&!isNaN(t)?(i=parseInt(e,10),s=parseInt(t,10)):isNaN(e)&&isNaN(t)?(a=!0,i=e.charCodeAt(0),s=t.charCodeAt(0)):(i=isNaN(e)?0:e,s=isNaN(t)?0:t),o=i>s?!1:!0;if(o)while(i<=s)r.push(a?String.fromCharCode(i):i),i+=u;else while(i>=s)r.push(a?String.fromCharCode(i):i),i-=u;return r},cycle:function(e,t){var n=t%e.length;return e[n]},dump:function(){var t="\n",n="  ",r=0,i="",s=Array.prototype.slice.call(arguments),o=function(e){var t="";while(e>0)e--,t+=n;return t},u=function(e){i+=o(r),typeof e=="object"?a(e):typeof e=="function"?i+="function()"+t:typeof e=="string"?i+="string("+e.length+') "'+e+'"'+t:typeof e=="number"?i+="number("+e+")"+t:typeof e=="boolean"&&(i+="bool("+e+")"+t)},a=function(e){var n;if(e===null)i+="NULL"+t;else if(e===undefined)i+="undefined"+t;else if(typeof e=="object"){i+=o(r)+typeof e,r++,i+="("+function(e){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(e)+") {"+t;for(n in e)i+=o(r)+"["+n+"]=> "+t,u(e[n]);r--,i+=o(r)+"}"+t}else u(e)};return s.length==0&&s.push(this.context),e.forEach(s,function(e){a(e)}),i},date:function(t,n){var r;if(t===undefined)r=new Date;else if(e.lib.is("Date",t))r=t;else if(e.lib.is("String",t))r=new Date(e.lib.strtotime(t)*1e3);else{if(!e.lib.is("Number",t))throw new e.Error("Unable to parse date "+t);r=new Date(t*1e3)}return r},block:function(e){return this.blocks[e]},parent:function(){return e.placeholders.parent},attribute:function(e,t,n){return e instanceof Object&&e.hasOwnProperty(t)?typeof e[t]=="function"?e[t].apply(undefined,n):e[t]:e[t]||undefined}},e._function=function(t,n,r){if(!e.functions[t])throw"Unable to find function "+t;return e.functions[t](n,r)},e._function.extend=function(t,n){e.functions[t]=n},e}(Twig||{}),Twig=function(e){return e.tests={empty:function(e){if(e===null||e===undefined)return!0;if(typeof e=="number")return!1;if(e.length&&e.length>0)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},odd:function(e){return e%2===1},even:function(e){return e%2===0},divisibleby:function(e,t){return e%t[0]===0},defined:function(e){return e!==undefined},none:function(e){return e===null},"null":function(e){return this.none(e)},sameas:function(e,t){return e===t[0]}},e.test=function(t,n,r){if(!e.tests[t])throw"Test "+t+" is not defined.";return e.tests[t](n,r)},e.test.extend=function(t,n){e.tests[t]=n},e}(Twig||{}),Twig=function(e){return e.exports={VERSION:e.VERSION},e.exports.twig=function(n){var r=n.id,i={strict_variables:n.strict_variables||!1,allowInlineIncludes:n.allowInlineIncludes||!1,rethrow:n.rethrow||!1};r&&e.validateId(r),n.debug!==undefined&&(e.debug=n.debug),n.trace!==undefined&&(e.trace=n.trace);if(n.data!==undefined)return new e.Template({data:n.data,module:n.module,id:r,options:i});if(n.ref!==undefined){if(n.id!==undefined)throw new e.Error("Both ref and id cannot be set on a twig.js template.");return e.Templates.load(n.ref)}if(n.href!==undefined)return e.Templates.loadRemote(n.href,{id:r,method:"ajax",base:n.base,module:n.module,precompiled:n.precompiled,async:n.async,options:i},n.load,n.error);if(n.path!==undefined)return e.Templates.loadRemote(n.path,{id:r,method:"fs",base:n.base,module:n.module,precompiled:n.precompiled,async:n.async,options:i},n.load,n.error)},e.exports.extendFilter=function(t,n){e.filter.extend(t,n)},e.exports.extendFunction=function(t,n){e._function.extend(t,n)},e.exports.extendTest=function(t,n){e.test.extend(t,n)},e.exports.extendTag=function(t){e.logic.extend(t)},e.exports.extend=function(t){t(e)},e.exports.compile=function(t,n){var r=n.filename,i=n.filename,s;return s=new e.Template({data:t,path:i,id:r,options:n.settings["twig options"]}),function(e){return s.render(e)}},e.exports.renderFile=function(t,n,r){"function"==typeof n&&(r=n,n={}),n=n||{};var i={path:t,base:n.settings.views,load:function(e){r(null,e.render(n))}},s=n.settings["twig options"];if(s)for(var o in s)s.hasOwnProperty(o)&&(i[o]=s[o]);e.exports.twig(i)},e.exports.__express=e.exports.renderFile,e.exports.cache=function(t){e.cache=t},e}(Twig||{}),Twig=function(e){return e.compiler={module:{}},e.compiler.compile=function(t,n){var r=JSON.stringify(t.tokens),i=t.id,s;if(n.module){if(e.compiler.module[n.module]===undefined)throw new e.Error("Unable to find module type "+n.module);s=e.compiler.module[n.module](i,r,n.twig)}else s=e.compiler.wrap(i,r);return s},e.compiler.module={amd:function(t,n,r){return'define(["'+r+'"], function (Twig) {\n	var twig, templates;\ntwig = Twig.twig;\ntemplates = '+e.compiler.wrap(t,n)+"\n	return templates;\n});"},node:function(t,n){return'var twig = require("twig").twig;\nexports.template = '+e.compiler.wrap(t,n)},cjs2:function(t,n,r){return'module.declare([{ twig: "'+r+'" }], function (require, exports, module) {\n'+'	var twig = require("twig").twig;\n'+"	exports.template = "+e.compiler.wrap(t,n)+"\n});"}},e.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},e}(Twig||{});typeof module!="undefined"&&module.declare?module.declare([],function(e,t,n){for(key in Twig.exports)Twig.exports.hasOwnProperty(key)&&(t[key]=Twig.exports[key])}):typeof define=="function"&&define.amd||1?timely.define("external_libs/twig",[],function(){return Twig.exports}):typeof module!="undefined"&&module.exports?module.exports=Twig.exports:(window.twig=Twig.exports.twig,window.Twig=Twig.exports),timely.define("libs/twig",["external_libs/twig"],function(e){return e.extendFunction("ai1ec_disable_content_output",function(){}),e}),timely.define("agenda",["libs/twig","agenda"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/agenda.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<div class="ai1ec-agenda-view'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:'">\n	'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"dates",match:["dates"]},{type:"Twig.expression.type.test",filter:"empty"}],output:[{type:"raw",value:'		<p class="ai1ec-no-results">\n			'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_upcoming_events",match:["text_upcoming_events"]}]},{type:"raw",value:"\n		</p>\n	"}]}},{type:"logic",token:{type:"Twig.logic.type.else",match:["else"],output:[{type:"raw",value:"		"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"date",value_var:"date_info",expression:[{type:"Twig.expression.type.variable",value:"dates",match:["dates"]}],output:[{type:"raw",value:'			<div class="ai1ec-date\n				'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n				<a class="ai1ec-date-title ai1ec-load-view"\n					href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"href"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n					'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'>\n					<div class="ai1ec-month">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"month"}]},{type:"raw",value:'</div>\n					<div class="ai1ec-day">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"day"}]},{type:"raw",value:'</div>\n					<div class="ai1ec-weekday">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"weekday"}]},{type:"raw",value:"</div>\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_year_in_agenda_dates",match:["show_year_in_agenda_dates"]}],output:[{type:"raw",value:'						<div class="ai1ec-year">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"year"}]},{type:"raw",value:"</div>\n					"}]}},{type:"raw",value:'				</a>\n				<div class="ai1ec-date-events">\n					'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"category",expression:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"events"}],output:[{type:"raw",value:"						"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"category",match:["category"]}],output:[{type:"raw",value:'							<div class="ai1ec-event\n								ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n								ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"}],output:[{type:"raw",value:"ai1ec-allday"}]}},{type:"raw",value:"								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"expanded",match:["expanded"]}],output:[{type:"raw",value:"ai1ec-expanded"}]}},{type:"raw",value:'"\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'									data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								'}]}},{type:"raw",value:'								data-end="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end"}]},{type:"raw",value:'">\n\n								<div class="ai1ec-event-header">\n									<div class="ai1ec-event-toggle">\n										<i class="ai1ec-fa ai1ec-fa-minus-circle ai1ec-fa-lg"></i>\n										<i class="ai1ec-fa ai1ec-fa-plus-circle ai1ec-fa-lg"></i>\n									</div>\n									<span class="ai1ec-event-title">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<span class="ai1ec-event-location"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n										"}]}},{type:"raw",value:"									</span>\n									"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"edit_post_link",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"edit_post_link",match:["edit_post_link"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'										<a class="post-edit-link" href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"edit_post_link",match:["edit_post_link"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n											<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n										</a>\n									"}]}},{type:"raw",value:'\n									<div class="ai1ec-event-time">\n										 '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"timespan_short"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									</div>\n								</div>\n\n								"},{type:"raw",value:'\n								<div class="ai1ec-event-summary '},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"expanded",match:["expanded"]}],output:[{type:"raw",value:"ai1ec-expanded"}]}},{type:"raw",value:'">\n\n									<div class="ai1ec-event-description">\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"content_img_url"},{type:"Twig.expression.type.test",filter:"empty"},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<a class="ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</a>\n										"}]}},{type:"raw",value:"										"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_content"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n									</div>\n\n									<div class="ai1ec-event-summary-footer">\n										<div class="ai1ec-btn-group ai1ec-actions">\n											'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"is_ticket_button_enabled",match:["is_ticket_button_enabled"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'												<a class="ai1ec-pull-right ai1ec-btn ai1ec-btn-primary\n														ai1ec-btn-xs ai1ec-buy-tickets"\n													target="_blank"\n													href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n													>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url_label"}]},{type:"raw",value:"</a>\n											"}]}},{type:"raw",value:'											<a class="ai1ec-read-more ai1ec-btn ai1ec-btn-default\n												ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_read_more",match:["text_read_more"]}]},{type:"raw",value:' <i class="ai1ec-fa ai1ec-fa-arrow-right"></i>\n											</a>\n										</div>\n										'},{type:"logic",token:{type:"Twig.logic.type.set",key:"categories",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"categories_html"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"tags",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"tags_html"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"categories",match:["categories"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'											<span class="ai1ec-categories">\n												<span class="ai1ec-field-label">\n													<i class="ai1ec-fa ai1ec-fa-folder-open"></i>\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_categories",match:["text_categories"]}]},{type:"raw",value:"\n												</span>\n												"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"categories",match:["categories"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n										"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"tags",match:["tags"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'											<span class="ai1ec-tags">\n												<span class="ai1ec-field-label">\n													<i class="ai1ec-fa ai1ec-fa-tags"></i>\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_tags",match:["text_tags"]}]},{type:"raw",value:"\n												</span>\n												"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"tags",match:["tags"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n										"}]}},{type:"raw",value:"									</div>\n								</div>\n\n							</div>\n						"}]}},{type:"raw",value:" "},{type:"raw",value:"\n					"}]}},{type:"raw",value:" "},{type:"raw",value:"\n				</div>\n			</div>\n		"}]}},{type:"raw",value:" "},{type:"raw",value:"\n	"}]}},{type:"raw",value:" "},{type:"raw",value:'\n</div>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n}),timely.define("oneday",["libs/twig","oneday"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/oneday.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<table class="ai1ec-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view-original"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:'">\n	<thead>\n		<tr>\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"date",value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:'				<th class="ai1ec-weekday\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n					'},{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_reveal_button",match:["show_reveal_button"]},{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"last"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'						<div class="ai1ec-reveal-full-day">\n							<button class="ai1ec-btn ai1ec-btn-info ai1ec-btn-xs\n									ai1ec-tooltip-trigger"\n								data-placement="left"\n								title="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_full_day",match:["text_full_day"]},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n								<i class="ai1ec-fa ai1ec-fa-expand"></i>\n							</button>\n						</div>\n					'}]}},{type:"raw",value:'					<a class="ai1ec-load-view" href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"href"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n						'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'>\n						<span class="ai1ec-weekday-date">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"day"}]},{type:"raw",value:'</span>\n						<span class="ai1ec-weekday-day">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"weekday"}]},{type:"raw",value:"</span>\n					</a>\n				</th>\n			"}]}},{type:"raw",value:"		</tr>\n		<tr>\n			"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:'				<td class="ai1ec-allday-events\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"first"}],output:[{type:"raw",value:'						<div class="ai1ec-allday-label">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_all_day",match:["text_all_day"]}]},{type:"raw",value:"</div>\n					"}]}},{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"allday"}],output:[{type:"raw",value:'						<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n							data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n							class="ai1ec-event-container ai1ec-load-event ai1ec-popup-trigger\n								ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n								ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n								ai1ec-allday\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n							>\n							<div class="ai1ec-event"\n								 style="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								 '},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'									data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								 '}]}},{type:"raw",value:'>\n								<span class="ai1ec-event-title">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<span class="ai1ec-event-location"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n									"}]}},{type:"raw",value:'								</span>\n							</div>\n						</a>\n\n						<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n									ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"										ai1ec-has-tickets-button\n									"}]}},{type:"raw",value:'">\n							'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'								<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n							"}]}},{type:"raw",value:'							<span class="ai1ec-popup-title">\n								<a class="ai1ec-load-event"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n									>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'									<span class="ai1ec-event-location"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n								"}]}},{type:"raw",value:"							</span>\n\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'								<a class="post-edit-link"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n									<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n								</a>\n							"}]}},{type:"raw",value:'\n							<div class="ai1ec-event-time">\n								'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n							</div>\n\n							<a class="ai1ec-load-event"\n								href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n								'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n							</a>\n							"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'								<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n							"}]}},{type:"raw",value:"						</div>\n\n					"}]}},{type:"raw",value:" "},{type:"raw",value:"\n\n				</td>\n			"}]}},{type:"raw",value:" "},{type:"raw",value:'\n		</tr>\n\n	</thead>\n	<tbody>\n		<tr class="ai1ec-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:'">\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:"				<td "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"}],output:[{type:"raw",value:'class="ai1ec-today"'}]}},{type:"raw",value:">\n\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"first"}],output:[{type:"raw",value:'						<div class="ai1ec-grid-container">\n							'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"h",value_var:"hour",expression:[{type:"Twig.expression.type.variable",value:"hours",match:["hours"]}],output:[{type:"raw",value:'								<div class="ai1ec-hour-marker\n									'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:8,match:["8",null]},{type:"Twig.expression.type.operator.binary",value:">=",precidence:8,associativity:"leftToRight",operator:">="},{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:18,match:["18",null]},{type:"Twig.expression.type.operator.binary",value:"<",precidence:8,associativity:"leftToRight",operator:"<"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:"ai1ec-business-hour"}]}},{type:"raw",value:'"\n									style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:60,match:["60",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"}]},{type:"raw",value:'px;">\n									<div>\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"hour",match:["hour"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									</div>\n								</div>\n								"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"quarter",expression:[{type:"Twig.expression.type.number",value:1,match:["1",null]},{type:"Twig.expression.type.number",value:3,match:["3",null]},{type:"Twig.expression.type.operator.binary",value:"..",precidence:20,associativity:"leftToRight",operator:".."}],output:[{type:"raw",value:'									<div class="ai1ec-quarter-marker"\n										style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:60,match:["60",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.variable",value:"quarter",match:["quarter"]},{type:"Twig.expression.type.number",value:15,match:["15",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.operator.binary",value:"+",precidence:6,associativity:"leftToRight",operator:"+"}]},{type:"raw",value:'px;"></div>\n								'}]}},{type:"raw",value:"							"}]}},{type:"raw",value:"							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.variable",value:"show_now",match:["show_now"]},{type:"Twig.expression.type.operator.binary",value:"or",precidence:14,associativity:"leftToRight",operator:"or"}],output:[{type:"raw",value:'								<div class="ai1ec-now-marker" style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"now_top",match:["now_top"]}]},{type:"raw",value:'px;">\n									<div>\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_now_label",match:["text_now_label"]}]},{type:"raw",value:" "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"now_text",match:["now_text"]}]},{type:"raw",value:"\n									</div>\n								</div>\n							"}]}},{type:"raw",value:"						</div>\n					"}]}},{type:"raw",value:'\n					<div class="ai1ec-day">\n\n						'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day_array",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"notallday"}],output:[{type:"raw",value:"							"},{type:"logic",token:{type:"Twig.logic.type.set",key:"event",expression:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"event"}]}},{type:"raw",value:'							<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n								class="ai1ec-event-container ai1ec-load-event ai1ec-popup-trigger\n									ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"}],output:[{type:"raw",value:"ai1ec-start-truncated"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"}],output:[{type:"raw",value:"ai1ec-end-truncated"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n								style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"top"}]},{type:"raw",value:"px;\n									height: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"height"}]},{type:"raw",value:"px;\n									left: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"indent"},{type:"Twig.expression.type.variable",value:"indent_multiplier",match:["indent_multiplier"]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.variable",value:"indent_offset",match:["indent_offset"]},{type:"Twig.expression.type.operator.binary",value:"+",precidence:6,associativity:"leftToRight",operator:"+"}]},{type:"raw",value:"px;\n									"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"faded_color",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"faded_color"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba_color",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"rgba_color"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"faded_color",match:["faded_color"]}],output:[{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba1",expression:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.05"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba3",expression:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.3"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]}},{type:"raw",value:"										border: 1px solid "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"faded_color",match:["faded_color"]}]},{type:"raw",value:";\n										border-color: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.5"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:";\n										background-image: -webkit-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -moz-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -ms-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -o-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n									"}]}},{type:"raw",value:'									">\n\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"}],output:[{type:"raw",value:'									<div class="ai1ec-start-truncator"></div>\n								'}]}},{type:"raw",value:"								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"}],output:[{type:"raw",value:'									<div class="ai1ec-end-truncator"></div>\n								'}]}},{type:"raw",value:'\n								<div class="ai1ec-event"\n									'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'										data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n									'}]}},{type:"raw",value:'>\n									<span class="ai1ec-event-time">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"short_start_time"}]},{type:"raw",value:'\n									</span>\n									<span class="ai1ec-event-title">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<span class="ai1ec-event-location"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n										"}]}},{type:"raw",value:'									</span>\n								</div>\n\n							</a>\n\n							<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n										ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n										ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"											ai1ec-has-tickets-button\n										"}]}},{type:"raw",value:'">\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'									<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n								"}]}},{type:"raw",value:'								<span class="ai1ec-popup-title">\n									<a class="ai1ec-load-event"\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<span class="ai1ec-event-location"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n									"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"is_ticket_button_enabled",match:["is_ticket_button_enabled"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<a class="ai1ec-pull-right ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs\n											ai1ec-buy-tickets" target="_blank"\n											href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url_label"}]},{type:"raw",value:"</a>\n									"}]}},{type:"raw",value:"								</span>\n\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'									<a class="post-edit-link"\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n										<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n									</a>\n								"}]}},{type:"raw",value:'\n								<div class="ai1ec-event-time">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n								</div>\n\n								<a class="ai1ec-load-event"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n								</a>\n								"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'									<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n								"}]}},{type:"raw",value:"							</div>\n\n						"}]}},{type:"raw",value:" "},{type:"raw",value:"\n					</div>\n\n				</td>\n			"}]}},{type:"raw",value:" "},{type:"raw",value:'\n		</tr>\n	</tbody>\n\n</table>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n}),timely.define("month",["libs/twig","month"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/month.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<table class="ai1ec-month-view ai1ec-popover-boundary\n	'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:"	"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"month_word_wrap",match:["month_word_wrap"]}],output:[{type:"raw",value:"ai1ec-word-wrap"}]}},{type:"raw",value:'">\n	<thead>\n		<tr>\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"weekday",expression:[{type:"Twig.expression.type.variable",value:"weekdays",match:["weekdays"]}],output:[{type:"raw",value:'				<th scope="col" class="ai1ec-weekday">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"weekday",match:["weekday"]}]},{type:"raw",value:"</th>\n			"}]}},{type:"raw",value:"		</tr>\n	</thead>\n	<tbody>\n		"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"week",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:"			"},{type:"logic",token:{type:"Twig.logic.type.set",key:"added_stretcher",expression:[{type:"Twig.expression.type.bool",value:!1}]}},{type:"raw",value:'			<tr class="ai1ec-week">\n				'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"week",match:["week"]}],output:[{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date"}],output:[{type:"raw",value:"						<td "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"}],output:[{type:"raw",value:'class="ai1ec-today"'}]}},{type:"raw",value:">\n							"},{type:"raw",value:"\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"added_stretcher",match:["added_stretcher"]},{type:"Twig.expression.type.operator.unary",value:"not",precidence:3,associativity:"rightToLeft",operator:"not"}],output:[{type:"raw",value:'								<div class="ai1ec-day-stretcher"></div>\n								'},{type:"logic",token:{type:"Twig.logic.type.set",key:"added_stretcher",expression:[{type:"Twig.expression.type.bool",value:!0}]}},{type:"raw",value:"							"}]}},{type:"raw",value:'\n							<div class="ai1ec-day">\n								<div class="ai1ec-date">\n									<a class="ai1ec-load-view"\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date_link"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"date"}]},{type:"raw",value:"</a>\n								</div>\n\n								"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"events"}],output:[{type:"raw",value:'									<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:'											data-start-day="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_day"}]},{type:"raw",value:'"\n											data-end-day="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"multiday_end_day"}]},{type:"raw",value:'"\n											data-start-truncated="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"},{type:"Twig.expression.type.string",value:"true"},{type:"Twig.expression.type.string",value:"false"},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:'"\n											data-end-truncated="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"},{type:"Twig.expression.type.string",value:"true"},{type:"Twig.expression.type.string",value:"false"},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:'"\n										'}]}},{type:"raw",value:'										data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n										class="ai1ec-event-container ai1ec-load-event\n											ai1ec-popup-trigger\n											ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n											ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"}],output:[{type:"raw",value:"ai1ec-allday"}]}},{type:"raw",value:"											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n										>\n\n										<div class="ai1ec-event"\n											 style="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'												data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											'}]}},{type:"raw",value:'>\n											<span class="ai1ec-event-title">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"},{type:"Twig.expression.type.operator.unary",value:"not",precidence:3,associativity:"rightToLeft",operator:"not"}],output:[{type:"raw",value:'												<span class="ai1ec-event-time">\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"short_start_time"}]},{type:"raw",value:"\n												</span>\n											"}]}},{type:"raw",value:'										</div>\n									</a>\n\n									<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n									            ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									            ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									            "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"									                ai1ec-has-tickets-button\n									            "}]}},{type:"raw",value:'>\n									            ">\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'											<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n										"}]}},{type:"raw",value:'										<span class="ai1ec-popup-title">\n											<a class="ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n											"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'												<span class="ai1ec-event-location"\n													>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n											"}]}},{type:"raw",value:"										</span>\n\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'											<a class="post-edit-link"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n												<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n											</a>\n										"}]}},{type:"raw",value:'\n										<div class="ai1ec-event-time">\n											'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n										</div>\n\n										<a class="ai1ec-load-event"\n											href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n											'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										</a>\n										"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'											<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n										"}]}},{type:"raw",value:"									</div>\n								"}]}},{type:"raw",value:"							</div>\n						</td>\n					"}]}},{type:"logic",token:{type:"Twig.logic.type.else",match:["else"],output:[{type:"raw",value:" "},{type:"raw",value:'\n						<td class="ai1ec-empty"></td>\n					'}]}},{type:"raw",value:" "},{type:"raw",value:"\n\n				"}]}},{type:"raw",value:" "},{type:"raw",value:"\n			</tr>\n		"}]}},{type:"raw",value:" "},{type:"raw",value:'\n	</tbody>\n</table>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n}),timely.define("external_libs/jquery_history",["jquery_timely"],function(e){try{(function(t,n){var r=t.History=t.History||{};if(typeof r.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");r.Adapter={bind:function(t,n,r){e(t).bind(n,r)},trigger:function(t,n,r){e(t).trigger(n,r)},extractEventData:function(e,t,r){var i=t&&t.originalEvent&&t.originalEvent[e]||r&&r[e]||n;return i},onDomLoad:function(t){e(t)}},typeof r.init!="undefined"&&r.init()})(window),function(e,t){var n=e.document,r=e.setTimeout||r,i=e.clearTimeout||i,s=e.setInterval||s,o=e.History=e.History||{};if(typeof o.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){if(typeof o.initHtml4.initialized!="undefined")return!1;o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t=o.getHashByIndex(),n;return n=e===t,n},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return typeof e=="undefined"?t=o.savedHashes[o.savedHashes.length-1]:e<0?t=o.savedHashes[o.savedHashes.length+e]:t=o.savedHashes[e],t},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r=o.getHashByState(e),i;return i={discardedState:e,backState:n,forwardState:t},o.discardedStates[r]=i,!0},o.discardHash=function(e,t,n){var r={discardedHash:e,backState:n,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t=o.getHashByState(e),n;return n=o.discardedStates[t]||!1,n},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var t="",r,i,u,a;return o.isInternetExplorer()?(r="historyjs-iframe",i=n.createElement("iframe"),i.setAttribute("id",r),i.style.display="none",n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),u="",a=!1,o.checkerFunction=function(){if(a)return!1;a=!0;var n=o.getHash()||"",r=o.unescapeHash(i.contentWindow.document.location.hash)||"";return n!==t?(t=n,r!==n&&(u=r=n,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(n)),o.Adapter.trigger(e,"hashchange")):r!==u&&(u=r,o.setHash(r,!1)),a=!1,!0}):o.checkerFunction=function(){var n=o.getHash();return n!==t&&(t=n,o.Adapter.trigger(e,"hashchange")),!0},o.intervalList.push(s(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var r=t&&t.newURL||n.location.href,i=o.getHashByUrl(r),s=null,u=null,a=null,f;return o.isLastHash(i)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(i),i&&o.isTraditionalAnchor(i)?(o.Adapter.trigger(e,"anchorchange"),o.busy(!1),!1):(s=o.extractState(o.getFullUrl(i||n.location.href,!1),!0),o.isLastSavedState(s)?(o.busy(!1),!1):(u=o.getHashByState(s),f=o.discardedState(s),f?(o.getHashByIndex(-2)===o.getHashByState(f.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(s.data,s.title,s.url,!1),!0))))},o.Adapter.bind(e,"hashchange",o.onHashChange),o.pushState=function(t,r,i,s){if(o.getHashByUrl(i))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(s!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:s}),!1;o.busy(!0);var u=o.createStateObject(t,r,i),a=o.getHashByState(u),f=o.getState(!1),l=o.getHashByState(f),c=o.getHash();return o.storeState(u),o.expectedStateId=u.id,o.recycleState(u),o.setTitle(u),a===l?(o.busy(!1),!1):a!==c&&a!==o.getShortUrl(n.location.href)?(o.setHash(a,!1),!1):(o.saveState(u),o.Adapter.trigger(e,"statechange"),o.busy(!1),!0)},o.replaceState=function(e,t,n,r){if(o.getHashByUrl(n))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(r!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:r}),!1;o.busy(!0);var i=o.createStateObject(e,t,n),s=o.getState(!1),u=o.getStateByIndex(-2);return o.discardState(s,i,u),o.pushState(i.data,i.title,i.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,"hashchange")})},typeof o.init!="undefined"&&o.init()}(window),function(e,t){var n=e.console||t,r=e.document,i=e.navigator,s=e.sessionStorage||!1,o=e.setTimeout,u=e.clearTimeout,a=e.setInterval,f=e.clearInterval,l=e.JSON,c=e.alert,h=e.History=e.History||{},p=e.history;l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode;if(typeof h.init!="undefined")throw new Error("History.js Core has already been loaded...");h.init=function(){return typeof h.Adapter=="undefined"?!1:(typeof h.initCore!="undefined"&&h.initCore(),typeof h.initHtml4!="undefined"&&h.initHtml4(),!0)},h.initCore=function(){if(typeof h.initCore.initialized!="undefined")return!1;h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||r.title,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(typeof t!="undefined"&&t!==null){for(e=0;e<t.length;e++)f(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e=typeof n!="undefined"&&typeof n.log!="undefined"&&typeof n.log.apply!="undefined",t=r.getElementById("log"),i,s,o,u,a;e?(u=Array.prototype.slice.call(arguments),i=u.shift(),typeof n.debug!="undefined"?n.debug.apply(n,[i,u]):n.log.apply(n,[i,u])):i="\n"+arguments[0]+"\n";for(s=1,o=arguments.length;s<o;++s){a=arguments[s];if(typeof a=="object"&&typeof l!="undefined")try{a=l.stringify(a)}catch(f){}i+="\n"+a+"\n"}return t?(t.value+=i+"\n-----\n",t.scrollTop=t.scrollHeight-t.clientHeight):e||c(i),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached=typeof h.getInternetExplorerMajorVersion.cached!="undefined"?h.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement("div"),n=t.getElementsByTagName("i");while((t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n[0]);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached=typeof h.isInternetExplorer.cached!="undefined"?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=l.stringify(e),n=l.parse(t)):n={},n},h.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);if(r.location.port||!1)e+=":"+r.location.port;return e+="/",e},h.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,n="";return e.length===1&&(t=e[0],n=t.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e=h.getState(!1,!1),t=(e||{}).url||r.location.href,n;return n=t.replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+"/"}),n},h.getBasePageUrl=function(){var e=r.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},h.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t=typeof t=="undefined"?!0:t,/[a-z]+\:\/\//.test(e)||(r==="/"?n=h.getRootUrl()+e.replace(/^\/+/,""):r==="#"?n=h.getPageUrl().replace(/#.*/,"")+e:r==="?"?n=h.getPageUrl().replace(/[\?#].*/,"")+e:t?n=h.getBaseUrl()+e.replace(/^(\.\/)+/,""):n=h.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),r=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,"")),t=t.replace(r,"/"),h.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),t},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){typeof e=="undefined"&&(e=!0),typeof t=="undefined"&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t=h.extractId(e.url),n;if(!t){n=h.getStateString(e);if(typeof h.stateToId[n]!="undefined")t=h.stateToId[n];else if(typeof h.store.stateToId[n]!="undefined")t=h.store.stateToId[n];else{for(;;){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof h.idToState[t]=="undefined"&&typeof h.store.idToState[t]=="undefined")break}h.stateToId[n]=t,h.idToState[t]=e}}return t},h.normalizeState=function(e){var t,n;if(!e||typeof e!="object")e={};if(typeof e.normalized!="undefined")return e;if(!e.data||typeof e.data!="object")e.data={};t={},t.normalized=!0,t.title=e.title||"",t.url=h.getFullUrl(h.unescapeString(e.url||r.location.href)),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data);if(t.title||n)t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id;return t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t},h.createStateObject=function(e,t,n){var r={data:e,title:t,url:n};return r=h.normalizeState(r),r},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,r;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},r=l.stringify(n),r},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id,n},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash,n},h.extractId=function(e){var t,n,r;return n=/(.*)\&_suid=([0-9]+)$/.exec(e),r=n?n[1]||e:e,t=n?String(n[2]||""):"",t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n=null,r,i;return t=t||!1,r=h.extractId(e),r&&(n=h.getStateById(r)),n||(i=h.getFullUrl(e),r=h.getIdByUrl(i)||!1,r&&(n=h.getStateById(r)),!n&&t&&!h.isTraditionalAnchor(e)&&(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t=!1,n;return n=h.extractState(e.url),t=n&&n.id!==e.id,t},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1,n,r,i;return h.savedStates.length&&(n=e.id,r=h.getLastSavedState(),i=r.id,t=n===i),t},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return typeof e=="undefined"?t=h.savedStates[h.savedStates.length-1]:e<0?t=h.savedStates[h.savedStates.length+e]:t=h.savedStates[e],t},h.getHash=function(){var e=h.unescapeHash(r.location.hash);return e},h.unescapeString=function(t){var n=t,r;for(;;){r=e.unescape(n);if(r===n)break;n=r}return n},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=h.unescapeString(t),t},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},h.setHash=function(e,t){var n,i,s;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(n=h.escapeHash(e),h.busy(!0),i=h.extractState(e,!0),i&&!h.emulated.pushState?h.pushState(i.data,i.title,i.url,!1):r.location.hash!==n&&(h.bugs.setHash?(s=h.getPageUrl(),h.pushState(null,null,s+"#"+n,!1)):r.location.hash=n),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.escape(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=h.unescapeHash(t),t},h.setTitle=function(e){var t=e.title,n;t||(n=h.getStateByIndex(0),n&&n.url===e.url&&(t=n.title||h.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=t.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(i){}return r.title=t,h},h.queues=[],h.busy=function(e){typeof e!="undefined"?h.busy.flag=e:typeof h.busy.flag=="undefined"&&(h.busy.flag=!1);if(!h.busy.flag){u(h.busy.timeout);var t=function(){var e,n,r;if(h.busy.flag)return;for(e=h.queues.length-1;e>=0;--e){n=h.queues[e];if(n.length===0)continue;r=n.shift(),h.fireQueueItem(r),h.busy.timeout=o(t,h.options.busyDelay)}};h.busy.timeout=o(t,h.options.busyDelay)}return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return typeof e=="function"&&(e={callback:e}),typeof t!="undefined"&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(u(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=o(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t=h.extractState(r.location.href),n;if(!h.isLastSavedState(t))return n=t,n||(n=h.createStateObject()),h.Adapter.trigger(e,"popstate"),h;return},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;n<=e;++n)h.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=e;--n)h.back(t)}return h};if(h.emulated.pushState){var d=function(){};h.pushState=h.pushState||d,h.replaceState=h.replaceState||d}else h.onPopState=function(t,n){var i=!1,s=!1,o,u;return h.doubleCheckComplete(),o=h.getHash(),o?(u=h.extractState(o||r.location.href,!0),u?h.replaceState(u.data,u.title,u.url,!1):(h.Adapter.trigger(e,"anchorchange"),h.busy(!1)),h.expectedStateId=!1,!1):(i=h.Adapter.extractEventData("state",t,n)||!1,i?s=h.getStateById(i):h.expectedStateId?s=h.getStateById(h.expectedStateId):s=h.extractState(r.location.href),s||(s=h.createStateObject(null,null,r.location.href)),h.expectedStateId=!1,h.isLastSavedState(s)?(h.busy(!1),!1):(h.storeState(s),h.saveState(s),h.setTitle(s),h.Adapter.trigger(e,"statechange"),h.busy(!1),!0))},h.Adapter.bind(e,"popstate",h.onPopState),h.pushState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.pushState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0},h.replaceState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.replaceState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0};if(s){try{h.store=l.parse(s.getItem("History.store"))||{}}catch(v){h.store={}}h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,"beforeunload",h.clearAllIntervals),h.Adapter.bind(e,"unload",h.clearAllIntervals),h.saveState(h.storeState(h.extractState(r.location.href,!0))),s&&(h.onUnload=function(){var e,t;try{e=l.parse(s.getItem("History.store"))||{}}catch(n){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState){if(!h.idToState.hasOwnProperty(t))continue;e.idToState[t]=h.idToState[t]}for(t in h.urlToId){if(!h.urlToId.hasOwnProperty(t))continue;e.urlToId[t]=h.urlToId[t]}for(t in h.stateToId){if(!h.stateToId.hasOwnProperty(t))continue;e.stateToId[t]=h.stateToId[t]}h.store=e,h.normalizeStore(),s.setItem("History.store",l.stringify(e))},h.intervalList.push(a(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,"beforeunload",h.onUnload),h.Adapter.bind(e,"unload",h.onUnload));if(!h.emulated.pushState){h.bugs.safariPoll&&h.intervalList.push(a(h.safariStatePoll,h.options.safariPollInterval));if(i.vendor==="Apple Computer, Inc."||(i.appCodeName||"")==="Mozilla")h.Adapter.bind(e,"hashchange",function(){h.Adapter.trigger(e,"popstate")}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,"hashchange")})}},h.init()}(window)}catch(t){}}),timely.define("external_libs/jquery.tablescroller",["jquery_timely"],function(e){function n(){if(t)return t;var n=e('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>');e("body").append(n);var r=e("div",n).innerWidth();n.css("overflow-y","auto");var i=e("div",n).innerWidth();return e(n).remove(),t=r-i,t}var t=0;e.fn.tableScroll=function(t){if(t=="undo"){var r=e(this).parent().parent();r.hasClass("tablescroll_wrapper")&&(r.find(".tablescroll_head thead").prependTo(this),r.find(".tablescroll_foot tfoot").appendTo(this),r.before(this),r.empty());return}var i=e.extend({},e.fn.tableScroll.defaults,t);return i.scrollbarWidth=n(),this.each(function(){var t=i.flush,n=e(this).addClass("tablescroll_body"),r=e('<div class="tablescroll_wrapper ai1ec-popover-boundary"></div>').insertBefore(n).append(n);r.parent("div").hasClass(i.containerClass)||e("<div></div>").addClass(i.containerClass).insertBefore(r).append(r);var s=i.width?i.width:n.outerWidth(),o=i.scroll?"auto":"hidden";r.css({width:s+"px",height:i.height+"px",overflow:o}),n.css("width",s+"px");var u=r.outerWidth(),a=u-s;r.css({width:s-a-2+"px"}),n.css("width",s-a-i.scrollbarWidth+"px"),n.outerHeight()<=i.height&&(r.css({height:"auto",width:s-a+"px"}),t=!1);var f=e("thead",n).length?!0:!1,l=e("tfoot",n).length?!0:!1,c=e("thead tr:first",n),h=e("tbody tr:first",n),p=e("tfoot tr:first",n),d=0;e("th, td",c).each(function(t){d=e(this).width(),e("th:eq("+t+"), td:eq("+t+")",c).css("width",d+"px"),e("th:eq("+t+"), td:eq("+t+")",h).css("width",d+"px"),l&&e("th:eq("+t+"), td:eq("+t+")",p).css("width",d+"px")});if(f)var v=e('<table class="tablescroll_head" cellspacing="0"></table>').insertBefore(r).prepend(e("thead",n));if(l)var m=e('<table class="tablescroll_foot" cellspacing="0"></table>').insertAfter(r).prepend(e("tfoot",n));v!=undefined&&(v.css("width",s+"px"),t&&(e("tr:first th:last, tr:first td:last",v).css("width",d+i.scrollbarWidth+"px"),v.css("width",r.outerWidth()+"px"))),m!=undefined&&(m.css("width",s+"px"),t&&(e("tr:first th:last, tr:first td:last",m).css("width",d+i.scrollbarWidth+"px"),m.css("width",r.outerWidth()+"px")))}),this},e.fn.tableScroll.defaults={flush:!0,width:null,height:100,containerClass:"tablescroll",scroll:!0}}),timely.define("external_libs/jquery.scrollTo",["jquery_timely"],function(e){function n(e){return typeof e=="object"?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,r){e(window).scrollTo(t,n,r)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})},e.fn.scrollTo=function(r,i,s){return typeof i=="object"&&(s=i,i=0),typeof s=="function"&&(s={onAfter:s}),r=="max"&&(r=9e9),s=e.extend({},t.defaults,s),i=i||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(i/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function h(e){u.animate(l,i,s.easing,e&&function(){e.call(this,r,s)})}if(r==null)return;var o=this,u=e(o),a=r,f,l={},c=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)f=(a=e(a)).offset()}e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),p="scroll"+r,d=o[p],v=t.max(o,n);if(f)l[p]=f[i]+(c?0:d-u.offset()[i]),s.margin&&(l[p]-=parseInt(a.css("margin"+r))||0,l[p]-=parseInt(a.css("border"+r+"Width"))||0),l[p]+=s.offset[i]||0,s.over[i]&&(l[p]+=a[n=="x"?"width":"height"]()*s.over[i]);else{var m=a[i];l[p]=m.slice&&m.slice(-1)=="%"?parseFloat(m)/100*v:m}s.limit&&/^\d+$/.test(l[p])&&(l[p]=l[p]<=0?0:Math.min(l[p],v)),!e&&s.queue&&(d!=l[p]&&h(s.onAfterFirst),delete l[p])}),h(s.onAfter)}).end()},t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])}}),timely.define("external_libs/locales/bootstrap-datepicker.bg",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.bg={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.br",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.br={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.cs",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.cs={days:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota","Nedle"],daysShort:["Ned","Pon","te","St","tv","Pt","Sob","Ned"],daysMin:["Ne","Po","t","St","t","P","So","Ne"],months:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],monthsShort:["Led","no","Be","Dub","Kv","er","nc","Srp","Z","j","Lis","Pro"],today:"Dnes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.da",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.da={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",clear:"Nulstil"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.de",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Lschen",weekStart:1,format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.es",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado","Domingo"],daysShort:["Dom","Lun","Mar","Mi","Jue","Vie","Sb","Dom"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fi",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fi={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai","sunnuntai"],daysShort:["sun","maa","tii","kes","tor","per","lau","sun"],daysMin:["su","ma","ti","ke","to","pe","la","su"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tnn",weekStart:1,format:"d.m.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.fr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],daysMin:["D","L","Ma","Me","J","V","S","D"],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],monthsShort:["Jan","Fv","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Dc"],today:"Aujourd'hui",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.id",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.id={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab","Mgu"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa","Mg"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.is",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.is={days:["Sunnudagur","Mnudagur","rijudagur","Mivikudagur","Fimmtudagur","Fstudagur","Laugardagur","Sunnudagur"],daysShort:["Sun","Mn","ri","Mi","Fim","Fs","Lau","Sun"],daysMin:["Su","M","r","Mi","Fi","F","La","Su"],months:["Janar","Febrar","Mars","Aprl","Ma","Jn","Jl","gst","September","Oktber","Nvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Ma","Jn","Jl","g","Sep","Okt","Nv","Des"],today:" Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.it",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.it={days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato","Domenica"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab","Dom"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa","Do"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ja",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ja={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],today:"",format:"yyyy/mm/dd"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.kr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.kr={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lt={days:["Sekmadienis","Pirmadienis","Antradienis","Treiadienis","Ketvirtadienis","Penktadienis","etadienis","Sekmadienis"],daysShort:["S","Pr","A","T","K","Pn","","S"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","t","Sk"],months:["Sausis","Vasaris","Kovas","Balandis","Gegu","Birelis","Liepa","Rugpjtis","Rugsjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"iandien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.lv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lv={days:["Svtdiena","Pirmdiena","Otrdiena","Trediena","Ceturtdiena","Piektdiena","Sestdiena","Svtdiena"],daysShort:["Sv","P","O","T","C","Pk","S","Sv"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se","Sv"],months:["Janvris","Februris","Marts","Aprlis","Maijs","Jnijs","Jlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],today:"odien",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ms",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ms={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu","Ahad"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab","Aha"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa","Ah"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nb",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nb={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.nl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nl={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pl={days:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota","Niedziela"],daysShort:["Nie","Pn","Wt","r","Czw","Pt","So","Nie"],daysMin:["N","Pn","Wt","r","Cz","Pt","So","N"],months:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],monthsShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],today:"Dzisiaj",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt-BR",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["pt-BR"]={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.pt",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pt={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.ru",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ru={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sl",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sl={days:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota","Nedelja"],daysShort:["Ned","Pon","Tor","Sre","et","Pet","Sob","Ned"],daysMin:["Ne","Po","To","Sr","e","Pe","So","Ne"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.sv",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sv={days:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Mn","Tis","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","M","Ti","On","To","Fr","L","S"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",format:"yyyy-mm-dd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.th",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.th={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["..","..","..","..","..","..","..","..","..","..","..",".."],today:""}}}}),timely.define("external_libs/locales/bootstrap-datepicker.tr",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.tr={days:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],daysShort:["Pz","Pzt","Sal","r","Pr","Cu","Cts","Pz"],daysMin:["Pz","Pzt","Sa","r","Pr","Cu","Ct","Pz"],months:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],monthsShort:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],today:"Bugn",format:"dd.mm.yyyy"}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-CN",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-CN"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/locales/bootstrap-datepicker.zh-TW",["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-TW"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}}),timely.define("external_libs/bootstrap_datepicker",["jquery_timely","ai1ec_config","external_libs/locales/bootstrap-datepicker.bg","external_libs/locales/bootstrap-datepicker.br","external_libs/locales/bootstrap-datepicker.cs","external_libs/locales/bootstrap-datepicker.da","external_libs/locales/bootstrap-datepicker.de","external_libs/locales/bootstrap-datepicker.es","external_libs/locales/bootstrap-datepicker.fi","external_libs/locales/bootstrap-datepicker.fr","external_libs/locales/bootstrap-datepicker.id","external_libs/locales/bootstrap-datepicker.is","external_libs/locales/bootstrap-datepicker.it","external_libs/locales/bootstrap-datepicker.ja","external_libs/locales/bootstrap-datepicker.kr","external_libs/locales/bootstrap-datepicker.lt","external_libs/locales/bootstrap-datepicker.lv","external_libs/locales/bootstrap-datepicker.ms","external_libs/locales/bootstrap-datepicker.nb","external_libs/locales/bootstrap-datepicker.nl","external_libs/locales/bootstrap-datepicker.pl","external_libs/locales/bootstrap-datepicker.pt-BR","external_libs/locales/bootstrap-datepicker.pt","external_libs/locales/bootstrap-datepicker.ru","external_libs/locales/bootstrap-datepicker.sl","external_libs/locales/bootstrap-datepicker.sv","external_libs/locales/bootstrap-datepicker.th","external_libs/locales/bootstrap-datepicker.tr","external_libs/locales/bootstrap-datepicker.zh-CN","external_libs/locales/bootstrap-datepicker.zh-TW"],function(e,t){function r(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return r(e.getFullYear(),e.getMonth(),e.getDate())}function s(e){return function(){return this[e].apply(this,arguments)}}function f(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r)n.test(u)&&(s=u.replace(o,function(e,t){return t.toLowerCase()}),i[s]=r[u]);return i}function l(t){var n={};if(!d[t]){t=t.split("-")[0];if(!d[t])return}var r=d[t];return e.each(p,function(e,t){t in r&&(n[t]=r[t])}),n}var n=e(window),o=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){var t=e&&e.valueOf();for(var n=0,r=this.length;n<r;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){if(!t)return;e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t)},clear:function(){this.splice(0)},copy:function(){var e=new o;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),u=function(t,n){this.dates=new o,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".ai1ec-date")?this.element.find(".ai1ec-input-group, .ai1ec-input-group-addon, .ai1ec-btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(v.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("ai1ec-datepicker-inline").appendTo(this.element):this.picker.addClass("ai1ec-datepicker-dropdown ai1ec-dropdown-menu"),this.o.rtl&&this.picker.addClass("ai1ec-datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.ai1ec-today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};u.prototype={constructor:u,_process_options:function(n){this._o=e.extend({},this._o,n);var r=this.o=e.extend({},this._o),i=r.language;d[i]||(i=i.split("-")[0],d[i]||(i=t.language,d[i]||(i=h.language))),r.language=i;switch(r.startView){case 2:case"decade":r.startView=2;break;case 1:case"year":r.startView=1;break;default:r.startView=0}switch(r.minViewMode){case 1:case"months":r.minViewMode=1;break;case 2:case"years":r.minViewMode=2;break;default:r.minViewMode=0}r.startView=Math.max(r.startView,r.minViewMode),r.multidate!==!0&&(r.multidate=Number(r.multidate)||!1,r.multidate!==!1?r.multidate=Math.max(0,r.multidate):r.multidate=1),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7;var s=v.parseFormat(r.format);r.startDate!==-Infinity&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=v.parseDate(r.startDate,s,r.language):r.startDate=-Infinity),r.endDate!==Infinity&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=v.parseDate(r.endDate,s,r.language):r.endDate=Infinity),r.daysOfWeekDisabled=r.daysOfWeekDisabled||[],e.isArray(r.daysOfWeekDisabled)||(r.daysOfWeekDisabled=r.daysOfWeekDisabled.split(/[,\s]*/)),r.daysOfWeekDisabled=e.map(r.daysOfWeekDisabled,function(e){return parseInt(e,10)});var o=String(r.orientation).toLowerCase().split(/\s+/g),u=r.orientation.toLowerCase();o=e.grep(o,function(e){return/^auto|left|right|top|bottom$/.test(e)}),r.orientation={x:"auto",y:"auto"};if(!!u&&u!=="auto")if(o.length===1)switch(o[0]){case"top":case"bottom":r.orientation.y=o[0];break;case"left":case"right":r.orientation.x=o[0]}else u=e.grep(o,function(e){return/^left|right$/.test(e)}),r.orientation.x=u[0]||"auto",u=e.grep(o,function(e){return/^top|bottom$/.test(e)}),r.orientation.y=u[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(r=undefined,i=e[t][1]):e[t].length==3&&(r=e[t][1],i=e[t][2]),n.on(i,r)},_unapplyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(i=undefined,r=e[t][1]):e[t].length==3&&(i=e[t][1],r=e[t][2]),n.off(r,i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.dates.get(-1),i=this._utc_to_local(r);this.element.trigger({type:t,date:i,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){arguments.length===0?(e=this.dates.length-1,t=this.o.format):typeof e=="string"&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return v.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide")},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+e.getTimezoneOffset()*6e4)},_local_to_utc:function(e){return e&&new Date(e.getTime()-e.getTimezoneOffset()*6e4)},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){this.update.apply(this,arguments),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){this.update.apply(this,e.map(arguments,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(t){t===undefined&&(t=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return v.formatDate(e,t,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=this.picker.outerWidth(),r=this.picker.outerHeight(),i=10,s=n.width(),o=n.height(),u=n.scrollTop(),a=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,f=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=f.left,p=f.top;this.picker.removeClass("ai1ec-datepicker-orient-top ai1ec-datepicker-orient-bottom ai1ec-datepicker-orient-right ai1ec-datepicker-orient-left"),this.o.orientation.x!=="auto"?(this.picker.addClass("ai1ec-datepicker-orient-"+this.o.orientation.x),this.o.orientation.x==="right"&&(h-=t-c)):(this.picker.addClass("ai1ec-datepicker-orient-left"),f.left<0?h-=f.left-i:f.left+t>s&&(h=s-t-i));var d=this.o.orientation.y,v,m;d==="auto"&&(v=-u+f.top-r,m=u+o-(f.top+l+r),Math.max(v,m)===m?d="top":d="bottom"),this.picker.addClass("ai1ec-datepicker-orient-"+d),d==="top"?p+=l:p-=r+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:h,zIndex:a})},_allow_update:!0,update:function(){if(!this._allow_update)return;var t=this.dates.copy(),n=[],r=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),r=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n&&this.o.multidate?n=n.split(this.o.multidateSeparator):n=[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return v.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),r?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="ai1ec-cw">&nbsp;</th>';t+=n,this.picker.find(".ai1ec-datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7)t+='<th class="ai1ec-dow">'+d[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".ai1ec-datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="ai1ec-month">'+d[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".ai1ec-datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i?n.push("ai1ec-old"):(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i)&&n.push("ai1ec-new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("ai1ec-focused"),this.o.todayHighlight&&t.getUTCFullYear()==s.getFullYear()&&t.getUTCMonth()==s.getMonth()&&t.getUTCDate()==s.getDate()&&n.push("ai1ec-today"),this.dates.contains(t)!==-1&&n.push("ai1ec-active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("ai1ec-disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("ai1ec-range"),e.inArray(t.valueOf(),this.range)!=-1&&n.push("ai1ec-selected")),n},fill:function(){var t=new Date(this.viewDate),n=t.getUTCFullYear(),i=t.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f,l;this.picker.find(".ai1ec-datepicker-days thead th.ai1ec-datepicker-switch").text(d[this.o.language].months[i]+" "+n),this.picker.find("tfoot th.ai1ec-today").text(d[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.ai1ec-clear").text(d[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var c=r(n,i-1,28),h=v.getDaysInMonth(c.getUTCFullYear(),c.getUTCMonth());c.setUTCDate(h),c.setUTCDate(h-(c.getUTCDay()-this.o.weekStart+7)%7);var p=new Date(c);p.setUTCDate(p.getUTCDate()+42),p=p.valueOf();var m=[],g;while(c.valueOf()<p){if(c.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+c+(this.o.weekStart-c.getUTCDay()-7)%7*864e5),b=new Date(+y+(11-y.getUTCDay())%7*864e5),w=new Date(+(w=r(b.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="ai1ec-cw">'+E+"</td>")}}g=this.getClassNames(c),g.push("ai1ec-day");if(this.o.beforeShowDay!==e.noop){var S=this.o.beforeShowDay(this._utc_to_local(c));S===undefined?S={}:typeof S=="boolean"?S={enabled:S}:typeof S=="string"&&(S={classes:S}),S.enabled===!1&&g.push("ai1ec-disabled"),S.classes&&(g=g.concat(S.classes.split(/\s+/))),S.tooltip&&(f=S.tooltip)}g=e.unique(g),m.push('<td class="'+g.join(" ")+'"'+(f?' title="'+f+'"':"")+">"+c.getUTCDate()+"</td>"),c.getUTCDay()==this.o.weekEnd&&m.push("</tr>"),c.setUTCDate(c.getUTCDate()+1)}this.picker.find(".ai1ec-datepicker-days tbody").empty().append(m.join(""));var x=this.picker.find(".ai1ec-datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("ai1ec-active");e.each(this.dates,function(e,t){t.getUTCFullYear()==n&&x.eq(t.getUTCMonth()).addClass("ai1ec-active")}),(n<s||n>u)&&x.addClass("ai1ec-disabled"),n==s&&x.slice(0,o).addClass("ai1ec-disabled"),n==u&&x.slice(a+1).addClass("ai1ec-disabled"),m="",n=parseInt(n/10,10)*10;var T=this.picker.find(".ai1ec-datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;var N=e.map(this.dates,function(e){return e.getUTCFullYear()}),C;for(var k=-1;k<11;k++)C=["ai1ec-year"],k===-1?C.push("ai1ec-old"):k===10&&C.push("ai1ec-new"),e.inArray(n,N)!==-1&&C.push("ai1ec-active"),(n<s||n>u)&&C.push("ai1ec-disabled"),m+='<span class="'+C.join(" ")+'">'+n+"</span>",n+=1;T.html(m)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"})}},click:function(t){t.preventDefault();var n=e(t.target).closest("span, td, th"),i,s,o;if(n.length==1)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"ai1ec-datepicker-switch":this.showMode(1);break;case"ai1ec-prev":case"ai1ec-next":var u=v.modes[this.viewMode].navStep*(n[0].className=="ai1ec-prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,u),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,u),this.viewMode===1&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"ai1ec-today":var a=new Date;a=r(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var f=this.o.todayBtn=="linked"?null:"view";this._setDate(a,f);break;case"ai1ec-clear":var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input")),l&&l.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":n.is(".ai1ec-disabled")||(this.viewDate.setUTCDate(1),n.is(".ai1ec-month")?(o=1,s=n.parent().find("span").index(n),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1&&this._setDate(r(i,s,o))):(o=1,s=0,i=parseInt(n.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(r(i,s,o))),this.showMode(-1),this.fill());break;case"td":n.is(".ai1ec-day")&&!n.is(".ai1ec-disabled")&&(o=parseInt(n.text(),10)||1,i=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),n.is(".ai1ec-old")?s===0?(s=11,i-=1):s-=1:n.is(".ai1ec-new")&&(s==11?(s=0,i+=1):s+=1),this._setDate(r(i,s,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);e?t!==-1?this.dates.remove(t):this.dates.push(e):this.dates.clear();if(typeof this.o.multidate=="number")while(this.dates.length>this.o.multidate)this.dates.remove(0)},_setDate:function(e,t){(!t||t=="date")&&this._toggle_multidate(e&&new Date(e));if(!t||t=="view")this.viewDate=e&&new Date(e);this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),this.o.autoclose&&(!t||t=="date")&&this.hide()},moveMonth:function(e,t){if(!e)return undefined;if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,s,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n),s=new Date(o),s.setUTCDate(o.getUTCDate()+n)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n*7),s=new Date(o),s.setUTCDate(o.getUTCDate()+n*7)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:o=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(o),t=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(t){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".ai1ec-datepicker-"+v.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var a=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};a.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(this.updating)return;this.updating=!0;var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1)return;e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(r)});if(r<this.dates[i])while(i>=0&&r<this.dates[i])this.pickers[i--].setUTCDate(r);else if(r>this.dates[i])while(i<s&&r>this.dates[i])this.pickers[i++].setUTCDate(r);this.updateDates(),delete this.updating},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var c=e.fn.datepicker;e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof t=="object"&&t;if(!s){var c=f(this,"date"),p=e.extend({},h,c,o),d=l(p.language),v=e.extend({},h,d,c,o);if(i.is(".ai1ec-input-daterange")||v.inputs){var m={inputs:v.inputs||i.find("input").toArray()};i.data("datepicker",s=new a(this,e.extend(v,m)))}else i.data("datepicker",s=new u(this,v))}if(typeof t=="string"&&typeof s[t]=="function"){r=s[t].apply(s,n);if(r!==undefined)return!1}}),r!==undefined?r:this};var h=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=u;var d=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},v={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,v.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(t,n,i){if(!t)return undefined;if(t instanceof Date)return t;typeof n=="string"&&(n=v.parseFormat(n));if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){var s=/([\-+]\d+)([dmwy])/,o=t.match(/([\-+]\d+)([dmwy])/g),a,f;t=new Date;for(var l=0;l<o.length;l++){a=s.exec(o[l]),f=parseInt(a[1]);switch(a[2]){case"d":t.setUTCDate(t.getUTCDate()+f);break;case"m":t=u.prototype.moveMonth.call(u.prototype,t,f);break;case"w":t.setUTCDate(t.getUTCDate()+f*7);break;case"y":t=u.prototype.moveYear.call(u.prototype,t,f)}}return r(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}var o=t&&t.match(this.nonpunctuation)||[],t=new Date,c={},h=["yyyy","yy","M","MM","m","mm","d","dd"],p={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;p.M=p.MM=p.mm=p.m,p.dd=p.d,t=r(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var y=n.parts.slice();o.length!=y.length&&(y=e(y).filter(function(t,n){return e.inArray(n,h)!==-1}).toArray());if(o.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(o[l],10),a=y[l];if(isNaN(m))switch(a){case"MM":g=e(d[i].months).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].months)+1;break;case"M":g=e(d[i].monthsShort).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].monthsShort)+1}c[a]=m}for(var l=0,w,E;l<h.length;l++)E=h[l],E in c&&!isNaN(c[E])&&(w=new Date(t),p[E](w,c[E]),isNaN(w)||(t=w))}return t},formatDate:function(t,n,r){if(!t)return"";typeof n=="string"&&(n=v.parseFormat(n));var i={d:t.getUTCDate(),D:d[r].daysShort[t.getUTCDay()],DD:d[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:d[r].monthsShort[t.getUTCMonth()],MM:d[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="ai1ec-prev"><i class="ai1ec-fa ai1ec-fa-arrow-left"></i></th><th colspan="5" class="ai1ec-datepicker-switch"></th><th class="ai1ec-next"><i class="ai1ec-fa ai1ec-fa-arrow-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="ai1ec-today"></th></tr><tr><th colspan="7" class="ai1ec-clear"></th></tr></tfoot>'};v.template='<div class="timely ai1ec-datepicker"><div class="ai1ec-datepicker-days"><table class=" ai1ec-table-condensed">'+v.headTemplate+"<tbody></tbody>"+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-months">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-years">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=v,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=c,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),n.datepicker("show")}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()});for(var m=2,g=arguments.length;m<g;m++)arguments[m].localize()}),timely.define("external_libs/bootstrap/alert",["jquery_timely"],function(e){var t='[data-dismiss="ai1ec-alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed.bs.alert").remove()}var n=e(this),r=n.attr("data-target");r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var i=e(r);t&&t.preventDefault(),i.length||(i=n.hasClass("ai1ec-alert")?n:n.parent()),i.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;i.removeClass("ai1ec-in"),e.support.transition&&i.hasClass("ai1ec-fade")?i.one(e.support.transition.end,s).emulateTransitionEnd(150):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}),timely.define("external_libs/jquery_cookie",["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),timely.define("scripts/calendar/load_views",["jquery_timely","scripts/calendar/print","scripts/calendar/agenda_view","scripts/calendar/month_view","libs/frontend_utils","libs/utils","ai1ec_calendar","ai1ec_config","scripts/common_scripts/frontend/common_frontend","libs/select2_multiselect_helper","external_libs/twig","agenda","oneday","month","external_libs/jquery_history","external_libs/jquery.tablescroller","external_libs/jquery.scrollTo","external_libs/bootstrap_datepicker","external_libs/bootstrap/alert","external_libs/jquery_cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){e.cookie.json=!0;var d="ai1ec_saved_filter",v=!e("#save_filtered_views").hasClass("ai1ec-hide");timely.renderer_map||(timely.renderer_map={}),e.extend(timely.renderer_map,{agenda:c,oneday:h,week:h,month:p});var m=function(t){var n=t.find("#ai1ec-view-dropdown .ai1ec-dropdown-menu .ai1ec-active a"),i=u.week_view_ends_at-u.week_view_starts_at,s=i*60;t.find("table.ai1ec-week-view-original").tableScroll({height:s,containerClass:"ai1ec-week-view ai1ec-popover-boundary",scroll:!1}),t.find("table.ai1ec-oneday-view-original").tableScroll({height:s,containerClass:"ai1ec-oneday-view ai1ec-popover-boundary",scroll:!1});if(t.find(".ai1ec-week-view").length||t.find(".ai1ec-oneday-view").length)t.find(".ai1ec-oneday-view .tablescroll_wrapper, .ai1ec-week-view .tablescroll_wrapper").scrollTo(t.find(".ai1ec-hour-marker:eq("+u.week_view_starts_at+")")),t.find(".ai1ec-hour-marker:eq("+u.week_view_starts_at+")").addClass("ai1ec-first-visible");t.find(".ai1ec-month-view .ai1ec-multiday").length&&r.extend_multiday_events(t),t.find(".ai1ec-calendar-view-container").data("ai1ec-inited",!0).trigger("initialize_view.ai1ec"),t.find(".ai1ec-calendar-toolbar").trigger("ai1ec-affix.reinit"),e(".ai1ec-event[data-ticket-url], .ai1ec-has-tickets-button").each(function(){var t=e(this),n=t.data("ticket-url"),r=e.merge(e(".ai1ec-sas-action-tickets",t),e(".ai1ec-sas-action-tickets",t.parent("a").next(".ai1ec-popover"))).attr("href",n)})},g=function(t){t.find(".ai1ec-calendar-view-container").trigger("destroy_view.ai1ec");var n=t.find(".ai1ec-minical-trigger").data("datepicker");typeof n!="undefined"&&(n.picker.remove(),e(document).off("changeDate",".ai1ec-minical-trigger")),t.find(".ai1ec-tooltip.ai1ec-in, .ai1ec-popup").remove(),t.find(".ai1ec-calendar-toolbar .ai1ec-btn-toolbar").remove()},y=function(){var t=[],n=[],r=[],i;e(".ai1ec-category-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){t.push(e(this).data("term"))}),e(".ai1ec-tag-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){n.push(e(this).data("term"))}),e(".ai1ec-author-filter .ai1ec-dropdown-menu .ai1ec-active").each(function(){r.push(e(this).data("term"))});var s={};return s.cat_ids=t,s.tag_ids=n,s.auth_ids=r,i=e(".ai1ec-views-dropdown .ai1ec-dropdown-menu .ai1ec-active").data("action"),s.action=i,s},b=function(){var t=History.getState(),n=e.cookie(d);if(null===n||undefined===n)n={};var r=y();u.is_calendar_page?n.calendar_page=r:n[t.url]=r,e.cookie(d,n,{path:"/",expires:365}),e("#save_filtered_views").addClass("ai1ec-active").attr("data-original-title",u.clear_saved_filter_text);var i=s.make_alert(u.save_filter_text_ok,"success");e("#ai1ec-calendar").prepend(i)},w=function(t){t.stopImmediatePropagation();var n=e.cookie(d);if(u.is_calendar_page)delete n.calendar_page;else{var r=History.getState();delete n[r.url]}e.cookie(d,n,{path:"/",expires:365}),e("#save_filtered_views").removeClass("ai1ec-active").attr("data-original-title",u.reset_saved_filter_text),v||e("#save_filtered_views").addClass("ai1ec-hide");var i=s.make_alert(u.remove_filter_text_ok,"success");e("#ai1ec-calendar").prepend(i)},E=!1,S={},x=function(t,n,r){D(t,n),t.find(".ai1ec-calendar-view-loading").fadeIn("fast").end().find(".ai1ec-calendar-view").fadeTo("fast",.3,function(){var i={request_type:r,ai1ec_doing_ajax:!0};e("#ai1ec-container > .ai1ec-alert").remove(),E&&1===E.readyState&&E.abort("ai1ec_abort");var o="-"+i.request_type;S[n+o]?E=S[n+o]:(E=e.ajax({url:n,dataType:r,data:i,method:"GET"}),S[n+o]=E.promise()),E.done(function(i){e(document).trigger("calendar_view_loaded.ai1ec",t),g(t),typeof i.views_dropdown=="string"&&t.find(".ai1ec-views-dropdown").replaceWith(i.views_dropdown),typeof i.categories=="string"&&t.find(".ai1ec-category-filter").replaceWith(i.categories),typeof i.authors=="string"&&t.find(".ai1ec-author-filter").replaceWith(i.authors),typeof i.tags=="string"&&t.find(".ai1ec-tag-filter").replaceWith(i.tags);if(typeof i.custom_filters=="string"){var s=t.find("li.ai1ec-custom-filter").parent();t.find("li.ai1ec-custom-filter").remove(),s.append(i.custom_filters)}typeof i.subscribe_buttons=="string"&&t.find(".ai1ec-subscribe-container").empty().append(i.subscribe_buttons),typeof i.save_view_btngroup=="string"&&t.find("#save_filtered_views").closest(".ai1ec-btn-group").replaceWith(i.save_view_btngroup),v=i.are_filters_set;var o;if(i.is_json){var u=i.html.type;if(!timely.renderer_map[u]){x(t,n.replace(/\~json/,"~html"),r);return}o=timely.renderer_map[u]}t.find(".ai1ec-calendar-view").html(o?o.render(i.html):e(i.html).find(".ai1ec-calendar-view").length?e(i.html).find(".ai1ec-calendar-view").html():i.html),m(t);var a=t.offset().top-21;e(window).scrollTop()>a&&window.scrollTo(0,a)}),E.fail(function(n,r,i){if("ai1ec_abort"===r)return;var o=u.load_views_error;o=o.replace("%STATUS%",n.status),o=o.replace("%ERROR%",i),o=o+"<br/>"+s.make_popup_content_link(u.load_views_error_link_popup,u.load_views_error_popup_title,n.responseText);var a=s.make_alert(o,"error",!0);e("#ai1ec-container").prepend(a),g(t),m(t)}),E.always(function(){t.find(".ai1ec-calendar-view-loading").fadeOut("fast"),t.find(".ai1ec-calendar-view").fadeTo("fast",1)})})},T=!1,N=function(t){var n=History.getState(),r=e(".ai1ec-calendar:first");if(n.data.ai1ec!==undefined&&!0===n.data.ai1ec||!0===T)T=!0,x(r,n.url,"json")},C=function(e,t,n){if(t==="json"){var r={ai1ec:!0};null===n.match(/^http/)&&(n=location.protocol+n),History.pushState(r,document.title,decodeURI(n))}else x(e,n,"jsonp")},k=function(t){var n=e(this),r=n.closest(".ai1ec-calendar");t.preventDefault(),C(r,n.data("type"),n.attr("href"))},L=function(t){var n=e(this);t.preventDefault();if(typeof n.data("datepicker")=="undefined"){n.datepicker({todayBtn:"linked",todayHighlight:!0,language:n.data("lang")});var r=n.data("datepicker");if(n.closest(".ai1ec-pull-right").length>0){r.picker.addClass("ai1ec-right-aligned");var i=r.place;r.place=function(){i.call(this);var t=this.component?this.component:this.element,n=t.offset();this.picker.css({left:"auto",right:e(document).width()-n.left-t.outerWidth()})}}e(document).one("changeDate",".ai1ec-minical-trigger",A)}n.datepicker("show")},A=function(t){var n,r=e(this),i=r.closest(".ai1ec-calendar"),s;r.datepicker("hide"),n=r.data("href"),s=t.format(),s=s.replace(/\//g,"-"),n=n.replace("__DATE__",s),C(i,r.data("type"),n)},O=function(t){var n;typeof t.added!="undefined"?n=e(t.added.element).data("href"):n=e("option[value="+t.removed.id+"]",t.target).data("href");var r={ai1ec:!0};History.pushState(r,null,n)},M=function(){var t=e(this).closest(".ai1ec-calendar");return C(t,e(this).attr("data-type"),e(this).attr("data-href")),!1},_=u.ai1ec_permalinks_enabled?"/":"|",D=function(t,n){var r={},i=function(i,s){var o=e(".ai1ec-filters .ai1ec-load-view."+s.filter_class,t),u=e(s.filter_button,t),a=new RegExp(i+"~((,?[0-9]+)+)"),f=n.match(a),l=n.match(/action~(\w+)/),l=l&&l[1]?l[1]:null,f=f&&f[1]?e.map(f[1].split(","),function(e){return parseInt(e,10)}):[];r[i]=f.join(","),o.each(function(){var t=this.href,n=e(this).closest("[data-term]"),r=n.data("term"),s=e.extend(!0,[],f);-1<e.inArray(r,f)?(s=e.grep(s,function(e){return r!=e}),n.addClass("ai1ec-active")):(s.push(r),n.removeClass("ai1ec-active"));var o=s.length?i+"~"+s.join(","):"";t.match(a)?this.href=t.replace(a,o):s.length&&(this.href+=_+o),l&&(this.href=this.href.replace(/action~(\w+)/,"action~"+l)),this.href=P(this.href)}),e(s.filter_items,t).length?u.addClass("ai1ec-active"):u.removeClass("ai1ec-active"),e(".ai1ec-clear-filter",u).each(function(){e(this).attr("data-href",P(e(this).attr("data-href").replace(a,"").replace(/action~(\w+)/,"action~"+l)))})},s={};e("ul.ai1ec-filters > li",t).each(function(){var t=e(this),n=t.data("slug");s[n+"_ids"]={filter_class:"ai1ec-"+n,filter_button:"li.ai1ec-"+n+"-filter",filter_items:".ai1ec-"+n+"-filter .ai1ec-active"}});for(var o in s)i(o,s[o]);for(var o in r){var u=r[o],a=new RegExp(o+"~((,?[0-9]+)+)");e(".ai1ec-filters .ai1ec-load-view").each(function(){if(e(this).hasClass(s[o].filter_class))return;u?this.href.match(a)?this.href=this.href.replace(a,o+"~"+u):this.href=this.href+_+o+"~"+u:this.href=P(this.href.replace(a,""))}),e(".ai1ec-clear-filter",t).each(function(){var t=e(this),n=t.closest("[data-slug]").data("slug");n===o.substr(0,o.length-4)||!u?t.attr("data-href",P(t.attr("data-href").replace(a,""))):t.attr("data-href").match(a)?t.attr("data-href",P(t.attr("data-href").replace(a,o+"~"+u))):t.attr("data-href",P(t.attr("data-href")+_+o+"~"+u))})}},P=function(e){return"/"===_?e.replace(/\/\//g,"/").replace(/\/\//g,"/").replace(/:\//g,"://"):e.replace(/\|\|/g,"|").replace(/\|\|/g,"|")};return{initialize_view:m,handle_click_on_link_to_load_view:k,handle_minical_trigger:L,handle_minical_change_date:A,clear_filters:M,handle_state_change:N,load_view:x,save_current_filter:b,remove_current_filter:w,load_view_from_select2_filter:O,load_view_according_to_datatype:C}}),timely.define("scripts/calendar/calendar-affix",["jquery_timely","ai1ec_config"],function(e,t){var n=function(n){var r=n.find(".ai1ec-calendar-toolbar");r.length||(r=e("<div />",{"class":"timely ai1ec-calendar-toolbar ai1ec-empty-toolbar ai1ec-clearfix"}),n.prepend(r));var i=n.find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").css("clear","both"),s=r.find(".ai1ec-dropdown-toggle"),o=n.find("#ai1ec-calendar-view"),u=e("#wpadminbar"),a=r.offset().top,f=0,l=null,c=function(){return e("#ai1ec-bs-modes div:visible:first").text()},h=function(){var t=["xs","sm","md","lg"],n=e('<div id="ai1ec-bs-modes"></div>');for(var r in t)e('<div class="ai1ec-device-'+t[r]+" ai1ec-visible-"+t[r]+'">'+t[r]+"</div>").appendTo(n);n.appendTo("body")},p=function(){return parseInt(t["affix_vertical_offset_"+c()]||0)},d=function(){s.each(function(){e(this).contents().eq(-3).wrap('<div class="ai1ec-hidden" />')})},v=function(){s.find(".ai1ec-hidden").contents().unwrap()},m=function(){var e=0;"fixed"===u.css("position")&&(e=u.height()),r.css("top",e+p()+"px")},g=function(){return f},y=function(){f=a-("fixed"===u.css("position")?u.height():0)-p()},b=function(){r.height()>r.data("original_height")?(d(),r.height()>r.data("original_height")&&v()):v()},w=function(){n.find(".ai1ec-affix .ai1ec-views-dropdown").closest("div.ai1ec-clearfix").remove(),i=n.find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix"),s=r.find(".ai1ec-dropdown-toggle"),r.trigger("ai1ec-affix-top.bs.affix").find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").hide().end().end().data({original_height:r.height()}).find(".ai1ec-views-dropdown").closest("div.ai1ec-clearfix").show().end().end().filter(".ai1ec-affix").trigger("ai1ec-affix.bs.affix")},E=function(){r.hasClass("ai1ec-affix")&&r.addClass("ai1ec-was-affixed"),y(),r.removeClass("ai1ec-affix").css("width",n.width()).find(".ai1ec-btn-toolbar").hide().end().data({original_height:r.height()}),m(),a=r.offset().top,r.filter(".ai1ec-was-affixed").addClass("ai1ec-affix").removeClass("ai1ec-was-affixed").find(".ai1ec-btn-toolbar").show(),l=null};return h(),y(),r.data({original_height:r.height()}).css("width",n.width()).affix({offset:{top:g,bottom:0}}).on("ai1ec-affix.bs.affix",function(){var t=o.offset().top;i.hide().appendTo(r).show().css("opacity",0).animate({opacity:1},400),b(),m(),o.css("margin-top",r.outerHeight(!0)+parseInt(r.css("margin-bottom"))+"px"),e("body").addClass("ai1ec-has-affixed-toolbar")}).on("ai1ec-affix-top.bs.affix",function(){i.hide(),o.prepend(i),i.show().css("opacity",0).animate({opacity:1},400),v(),m(),o.css("margin-top",0),r.data("original_height",r.height()),e("body").removeClass("ai1ec-has-affixed-toolbar")}).on("ai1ec-affix.reinit",w).filter(".ai1ec-affix").trigger("ai1ec-affix.bs.affix"),e(window).on("resize.affix",function(){clearTimeout(l),l=setTimeout(E,100)}),n};return{initialize_affixed_toolbar:n}}),timely.define("external_libs/bootstrap/transition",["jquery_timely"],function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})}),timely.define("external_libs/bootstrap/modal",["jquery_timely"],function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r);if(this.isShown||r.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="ai1ec-modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("ai1ec-fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("ai1ec-in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".ai1ec-modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)})},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("ai1ec-in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("ai1ec-fade")?"ai1ec-fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="ai1ec-modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("ai1ec-in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("ai1ec-in"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="ai1ec-modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".ai1ec-modal",function(){e(document.body).addClass("ai1ec-modal-open")}).on("hidden.bs.modal",".ai1ec-modal",function(){e(document.body).removeClass("ai1ec-modal-open")})}),timely.define("scripts/calendar",["jquery_timely","domReady","scripts/calendar/load_views","scripts/calendar/print","scripts/calendar/agenda_view","scripts/calendar/month_view","scripts/calendar/calendar-affix","ai1ec_calendar","ai1ec_config","scripts/common_scripts/frontend/common_frontend","libs/utils","libs/select2_multiselect_helper","external_libs/bootstrap/transition","external_libs/bootstrap/modal","external_libs/jquery.scrollTo","external_libs/jquery_cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=function(){if(u.selector!==undefined&&u.selector!==""&&e(u.selector).length===1){var t=e(":header:contains("+u.title+"):first");t.length||(t=e('<h1 class="page-title"></h1>'),t.text(u.title));var n=e(".ai1ec-main-container:first").detach().before(t);e(u.selector).empty().append(n).hide().css("visibility","visible").fadeIn("fast")}},p=function(){var t=e(this).data("instanceId"),n=e(this).closest(".ai1ec-calendar");n.find(".ai1ec-event-instance-id-"+t).addClass("ai1ec-hover")},d=function(){var t=e(this).data("instanceId"),n=e(this).closest(".ai1ec-calendar");n.find(".ai1ec-event-instance-id-"+t).removeClass("ai1ec-hover")},v=function(){var t=e(this),n=t.closest(".ai1ec-calendar"),r=t.data("instanceId");t.delay(500).queue(function(){n.find(".ai1ec-event-instance-id-"+r).addClass("ai1ec-raised")})},m=function(t){var n=e(this),r=n.closest(".ai1ec-calendar"),i=n.data("instanceId"),s=e(t.toElement||t.relatedTarget),o=r.find(".ai1ec-event-instance-id-"+i);if(s.is(o)||s.parent().is(o))return;r.find(".ai1ec-event-instance-id-"+i).clearQueue().removeClass("ai1ec-raised")},g=function(){h()},y=function(){e(document).on({mouseenter:p,mouseleave:d},".ai1ec-event-container.ai1ec-multiday"),e(document).on({mouseenter:v,mouseleave:m},".ai1ec-oneday-view .ai1ec-oneday .ai1ec-event-container, .ai1ec-week-view .ai1ec-week .ai1ec-event-container"),e(document).on("click",".ai1ec-agenda-view .ai1ec-event-header",i.toggle_event),e(document).on("click","#ai1ec-agenda-expand-all",i.expand_all),e(document).on("click","#ai1ec-agenda-collapse-all",i.collapse_all),e(document).on("click","a.ai1ec-load-view",n.handle_click_on_link_to_load_view),e(document).on("click",".ai1ec-minical-trigger",n.handle_minical_trigger),e(document).on("click",".ai1ec-clear-filter",n.clear_filters),e(document).on("click","#ai1ec-print-button",r.handle_click_on_print_button),e(document).on("click",".ai1ec-reveal-full-day button",function(){var t=e(this).closest(".ai1ec-calendar");e(this).fadeOut();var n=t.find(".ai1ec-oneday-view-original, .ai1ec-week-view-original"),r=t.find(".tablescroll_wrapper").offset().top-n.offset().top;e(window).scrollTo("+="+r+"px",400);var i=1442;t.find(".tablescroll_wrapper").scrollTo("-="+r+"px",400).animate({height:i+"px"})}),History.Adapter.bind(window,"statechange",n.handle_state_change),e(document).on("click","#ai1ec-calendar-view .ai1ec-load-event",function(t){e.cookie.raw=!1,e.cookie("ai1ec_calendar_url",document.URL,{path:a.cookie_path})})},b=function(){c.init(e(".ai1ec-select2-filters")),e(document).on("change",".ai1ec-select2-multiselect-selector",n.load_view_from_select2_filter)};t(function(){var t=e(".ai1ec-calendar"),r=e(".ai1ec-calendar:visible").first();g(),a.use_select2&&b(),y(),t.each(function(){n.initialize_view(e(this))}),a.affix_filter_menu&&1===r.length&&o.initialize_affixed_toolbar(r)});var w=function(){};return{start:w,initialize_view:n.initialize_view}}),timely.require(["scripts/calendar"],function(e){e.start()}),timely.define("pages/calendar",function(){});

==================================================
FILE PATH: ./public/js/oneday.js
==================================================
timely.define(["libs/twig","oneday"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/oneday.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<table class="ai1ec-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view-original"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:'">\n	<thead>\n		<tr>\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"date",value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:'				<th class="ai1ec-weekday\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n					'},{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_reveal_button",match:["show_reveal_button"]},{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"last"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'						<div class="ai1ec-reveal-full-day">\n							<button class="ai1ec-btn ai1ec-btn-info ai1ec-btn-xs\n									ai1ec-tooltip-trigger"\n								data-placement="left"\n								title="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_full_day",match:["text_full_day"]},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n								<i class="ai1ec-fa ai1ec-fa-expand"></i>\n							</button>\n						</div>\n					'}]}},{type:"raw",value:'					<a class="ai1ec-load-view" href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"href"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n						'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'>\n						<span class="ai1ec-weekday-date">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"day"}]},{type:"raw",value:'</span>\n						<span class="ai1ec-weekday-day">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"weekday"}]},{type:"raw",value:"</span>\n					</a>\n				</th>\n			"}]}},{type:"raw",value:"		</tr>\n		<tr>\n			"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:'				<td class="ai1ec-allday-events\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n\n					'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"first"}],output:[{type:"raw",value:'						<div class="ai1ec-allday-label">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_all_day",match:["text_all_day"]}]},{type:"raw",value:"</div>\n					"}]}},{type:"raw",value:"\n					"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"allday"}],output:[{type:"raw",value:'						<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n							data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n							class="ai1ec-event-container ai1ec-load-event ai1ec-popup-trigger\n								ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n								ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n								ai1ec-allday\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n							>\n							<div class="ai1ec-event"\n								 style="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								 '},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'									data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								 '}]}},{type:"raw",value:'>\n								<span class="ai1ec-event-title">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<span class="ai1ec-event-location"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n									"}]}},{type:"raw",value:'								</span>\n							</div>\n						</a>\n\n						<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n									ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"										ai1ec-has-tickets-button\n									"}]}},{type:"raw",value:'">\n							'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'								<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n							"}]}},{type:"raw",value:'							<span class="ai1ec-popup-title">\n								<a class="ai1ec-load-event"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n									>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'									<span class="ai1ec-event-location"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n								"}]}},{type:"raw",value:"							</span>\n\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'								<a class="post-edit-link"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n									<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n								</a>\n							"}]}},{type:"raw",value:'\n							<div class="ai1ec-event-time">\n								'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n							</div>\n\n							<a class="ai1ec-load-event"\n								href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n								'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n							</a>\n							"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'								<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n							"}]}},{type:"raw",value:"						</div>\n\n					"}]}},{type:"raw",value:" "},{type:"raw",value:"\n\n				</td>\n			"}]}},{type:"raw",value:" "},{type:"raw",value:'\n		</tr>\n\n	</thead>\n	<tbody>\n		<tr class="ai1ec-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:'">\n			'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day",expression:[{type:"Twig.expression.type.variable",value:"cell_array",match:["cell_array"]}],output:[{type:"raw",value:"				<td "},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"}],output:[{type:"raw",value:'class="ai1ec-today"'}]}},{type:"raw",value:">\n\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"loop",match:["loop"]},{type:"Twig.expression.type.key.period",key:"first"}],output:[{type:"raw",value:'						<div class="ai1ec-grid-container">\n							'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"h",value_var:"hour",expression:[{type:"Twig.expression.type.variable",value:"hours",match:["hours"]}],output:[{type:"raw",value:'								<div class="ai1ec-hour-marker\n									'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:8,match:["8",null]},{type:"Twig.expression.type.operator.binary",value:">=",precidence:8,associativity:"leftToRight",operator:">="},{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:18,match:["18",null]},{type:"Twig.expression.type.operator.binary",value:"<",precidence:8,associativity:"leftToRight",operator:"<"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:"ai1ec-business-hour"}]}},{type:"raw",value:'"\n									style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:60,match:["60",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"}]},{type:"raw",value:'px;">\n									<div>\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"hour",match:["hour"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									</div>\n								</div>\n								"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"quarter",expression:[{type:"Twig.expression.type.number",value:1,match:["1",null]},{type:"Twig.expression.type.number",value:3,match:["3",null]},{type:"Twig.expression.type.operator.binary",value:"..",precidence:20,associativity:"leftToRight",operator:".."}],output:[{type:"raw",value:'									<div class="ai1ec-quarter-marker"\n										style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"h",match:["h"]},{type:"Twig.expression.type.number",value:60,match:["60",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.variable",value:"quarter",match:["quarter"]},{type:"Twig.expression.type.number",value:15,match:["15",null]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.operator.binary",value:"+",precidence:6,associativity:"leftToRight",operator:"+"}]},{type:"raw",value:'px;"></div>\n								'}]}},{type:"raw",value:"							"}]}},{type:"raw",value:"							"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.variable",value:"show_now",match:["show_now"]},{type:"Twig.expression.type.operator.binary",value:"or",precidence:14,associativity:"leftToRight",operator:"or"}],output:[{type:"raw",value:'								<div class="ai1ec-now-marker" style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"now_top",match:["now_top"]}]},{type:"raw",value:'px;">\n									<div>\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_now_label",match:["text_now_label"]}]},{type:"raw",value:" "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"now_text",match:["now_text"]}]},{type:"raw",value:"\n									</div>\n								</div>\n							"}]}},{type:"raw",value:"						</div>\n					"}]}},{type:"raw",value:'\n					<div class="ai1ec-day">\n\n						'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"day_array",expression:[{type:"Twig.expression.type.variable",value:"day",match:["day"]},{type:"Twig.expression.type.key.period",key:"notallday"}],output:[{type:"raw",value:"							"},{type:"logic",token:{type:"Twig.logic.type.set",key:"event",expression:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"event"}]}},{type:"raw",value:'							<a href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								data-instance-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:'"\n								class="ai1ec-event-container ai1ec-load-event ai1ec-popup-trigger\n									ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n									ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"}],output:[{type:"raw",value:"ai1ec-start-truncated"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"}],output:[{type:"raw",value:"ai1ec-end-truncated"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_multiday"}],output:[{type:"raw",value:"ai1ec-multiday"}]}},{type:"raw",value:'"\n								style="top: '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"top"}]},{type:"raw",value:"px;\n									height: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"height"}]},{type:"raw",value:"px;\n									left: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"day_array",match:["day_array"]},{type:"Twig.expression.type.key.period",key:"indent"},{type:"Twig.expression.type.variable",value:"indent_multiplier",match:["indent_multiplier"]},{type:"Twig.expression.type.operator.binary",value:"*",precidence:5,associativity:"leftToRight",operator:"*"},{type:"Twig.expression.type.variable",value:"indent_offset",match:["indent_offset"]},{type:"Twig.expression.type.operator.binary",value:"+",precidence:6,associativity:"leftToRight",operator:"+"}]},{type:"raw",value:"px;\n									"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"color_style"}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"faded_color",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"faded_color"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba_color",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"rgba_color"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"faded_color",match:["faded_color"]}],output:[{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba1",expression:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.05"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"rgba3",expression:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.3"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]}},{type:"raw",value:"										border: 1px solid "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"faded_color",match:["faded_color"]}]},{type:"raw",value:";\n										border-color: "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba_color",match:["rgba_color"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"0.5"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:";\n										background-image: -webkit-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -moz-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -ms-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: -o-linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n										background-image: linear-gradient( top, "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba1",match:["rgba1"]}]},{type:"raw",value:", "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"rgba3",match:["rgba3"]}]},{type:"raw",value:" 50px );\n									"}]}},{type:"raw",value:'									">\n\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"start_truncated"}],output:[{type:"raw",value:'									<div class="ai1ec-start-truncator"></div>\n								'}]}},{type:"raw",value:"								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end_truncated"}],output:[{type:"raw",value:'									<div class="ai1ec-end-truncator"></div>\n								'}]}},{type:"raw",value:'\n								<div class="ai1ec-event"\n									'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'										data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n									'}]}},{type:"raw",value:'>\n									<span class="ai1ec-event-time">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"short_start_time"}]},{type:"raw",value:'\n									</span>\n									<span class="ai1ec-event-title">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<span class="ai1ec-event-location"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n										"}]}},{type:"raw",value:'									</span>\n								</div>\n\n							</a>\n\n							<div class="ai1ec-popover ai1ec-popup ai1ec-popup-in-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"type",match:["type"]}]},{type:"raw",value:"-view\n										ai1ec-event-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n										ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"											ai1ec-has-tickets-button\n										"}]}},{type:"raw",value:'">\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"}],output:[{type:"raw",value:'									<div class="ai1ec-color-swatches">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"category_colors"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n								"}]}},{type:"raw",value:'								<span class="ai1ec-popup-title">\n									<a class="ai1ec-load-event"\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n										>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</a>\n									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<span class="ai1ec-event-location"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n									"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"is_ticket_button_enabled",match:["is_ticket_button_enabled"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'										<a class="ai1ec-pull-right ai1ec-btn ai1ec-btn-primary ai1ec-btn-xs\n											ai1ec-buy-tickets" target="_blank"\n											href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n											>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url_label"}]},{type:"raw",value:"</a>\n									"}]}},{type:"raw",value:"								</span>\n\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}],output:[{type:"raw",value:'									<a class="post-edit-link"\n										href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n										<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n									</a>\n								"}]}},{type:"raw",value:'\n								<div class="ai1ec-event-time">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"popup_timespan"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n								</div>\n\n								<a class="ai1ec-load-event"\n									href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n									'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n								</a>\n								"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"}],output:[{type:"raw",value:'									<div class="ai1ec-popup-excerpt">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_excerpt"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n								"}]}},{type:"raw",value:"							</div>\n\n						"}]}},{type:"raw",value:" "},{type:"raw",value:"\n					</div>\n\n				</td>\n			"}]}},{type:"raw",value:" "},{type:"raw",value:'\n		</tr>\n	</tbody>\n\n</table>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n});

==================================================
FILE PATH: ./public/js/jquery_timely19.js
==================================================
/*!
	 * jQuery JavaScript Library v1.9.1
	 * http://jquery.com/
	 *
	 * Includes Sizzle.js
	 * http://sizzlejs.com/
	 *
	 * Copyright 2005, 2012 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2013-2-4
	 */

/*!
	 * Sizzle CSS Selector Engine
	 * Copyright 2012 jQuery Foundation and other contributors
	 * Released under the MIT license
	 * http://sizzlejs.com/
	 */

timely.define("jquery_timely",[],function(){return function(e,t){function P(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||n!=="function"&&(t===0||typeof t=="number"&&t>0&&t-1 in e)}function B(e){var t=H[e]={};return b.each(e.match(E)||[],function(e,n){t[n]=!0}),t}function I(e,n,r,i){if(!b.acceptData(e))return;var s,o,u=b.expando,a=typeof n=="string",f=e.nodeType,c=f?b.cache:e,h=f?e[u]:e[u]&&u;if((!h||!c[h]||!i&&!c[h].data)&&a&&r===t)return;h||(f?e[u]=h=l.pop()||b.guid++:h=u),c[h]||(c[h]={},f||(c[h].toJSON=b.noop));if(typeof n=="object"||typeof n=="function")i?c[h]=b.extend(c[h],n):c[h].data=b.extend(c[h].data,n);return s=c[h],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[b.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[b.camelCase(n)])):o=s,o}function q(e,t,n){if(!b.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?b.cache:e,a=o?e[b.expando]:b.expando;if(!u[a])return;if(t){s=n?u[a]:u[a].data;if(s){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in s?t=[t]:(t=b.camelCase(t),t in s?t=[t]:t=t.split(" "));for(r=0,i=t.length;r<i;r++)delete s[t[r]];if(!(n?U:b.isEmptyObject)(s))return}}if(!n){delete u[a].data;if(!U(u[a]))return}o?b.cleanData([e],!0):b.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null}function R(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(F,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:j.test(r)?b.parseJSON(r):r}catch(s){}b.data(e,n,r)}else r=t}return r}function U(e){var t;for(t in e){if(t==="data"&&b.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function it(){return!0}function st(){return!1}function ct(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ht(e,t,n){t=t||0;if(b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if(typeof t=="string"){var r=b.grep(e,function(e){return e.nodeType===1});if(at.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function pt(e){var t=dt.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Mt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function _t(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function Dt(e){var t=Ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pt(e,t){var n,r=0;for(;(n=e[r])!=null;r++)b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}function Ht(e,t){if(t.nodeType!==1||!b.hasData(e))return;var n,r,i,s=b._data(e),o=b._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)b.event.add(t,n,u[n][r])}o.data&&(o.data=b.extend({},o.data))}function Bt(e,t){var n,r,i;if(t.nodeType!==1)return;n=t.nodeName.toLowerCase();if(!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}if(n==="script"&&t.text!==e.text)_t(t).text=e.text,Dt(t);else if(n==="object")t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML);else if(n==="input"&&xt.test(e.type))t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value);else if(n==="option")t.defaultSelected=t.selected=e.defaultSelected;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function jt(e,n){var r,s,o=0,u=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!u)for(u=[],r=e.childNodes||e;(s=r[o])!=null;o++)!n||b.nodeName(s,n)?u.push(s):b.merge(u,jt(s,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],u):u}function Ft(e){xt.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--){t=en[i]+n;if(t in e)return t}return r}function nn(e,t){return e=t||e,b.css(e,"display")==="none"||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=b._data(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&nn(r)&&(s[o]=b._data(r,"olddisplay",an(r.nodeName)))):s[o]||(i=nn(r),(n&&n!=="none"||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function sn(e,t,n){var r=$t.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function on(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=b.css(e,n+Zt[s],!0,i)),r?(n==="content"&&(o-=b.css(e,"padding"+Zt[s],!0,i)),n!=="margin"&&(o-=b.css(e,"border"+Zt[s]+"Width",!0,i))):(o+=b.css(e,"padding"+Zt[s],!0,i),n!=="padding"&&(o+=b.css(e,"border"+Zt[s]+"Width",!0,i)));return o}function un(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=qt(e),o=b.support.boxSizing&&b.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=Rt(e,t,s);if(i<0||i==null)i=e.style[t];if(Jt.test(i))return i;r=o&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+on(e,t,n||(o?"border":"content"),r,s)+"px"}function an(e){var t=s,n=Qt[e];if(!n){n=fn(e,t);if(n==="none"||!n)It=(It||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=fn(e,t),It.detach();Qt[e]=n}return n}function fn(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}function vn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||cn.test(e)?r(e,i):vn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&b.type(t)==="object")for(i in t)vn(e+"["+i+"]",t[i],n,r);else r(e,t)}function _n(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(E)||[];if(b.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Dn(e,t,n,r){function o(u){var a;return i[u]=!0,b.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===An;return o(t.dataTypes[0])||!i["*"]&&o("*")}function Pn(e,n){var r,i,s=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}function Hn(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(u in l)u in r&&(n[l[u]]=r[u]);while(f[0]==="*")f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}if(o)return o!==f[0]&&f.unshift(o),r[o]}function Bn(e,t){var n,r,i,s,o={},u=0,a=e.dataTypes.slice(),f=a[0];e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(a[1])for(i in e.converters)o[i.toLowerCase()]=e.converters[i];for(;r=a[++u];)if(r!=="*"){if(f!=="*"&&f!==r){i=o[f+" "+r]||o["* "+r];if(!i)for(n in o){s=n.split(" ");if(s[1]===r){i=o[f+" "+s[0]]||o["* "+s[0]];if(i){i===!0?i=o[n]:o[n]!==!0&&(r=s[0],a.splice(u--,0,r));break}}}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(l){return{state:"parsererror",error:i?l:"No conversion from "+f+" to "+r}}}f=r}return{state:"success",data:t}}function zn(){try{return new e.XMLHttpRequest}catch(t){}}function Wn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Yn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Gn[t]||[]).concat(Gn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,s=0,o=Qn.length,u=b.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Xn||Yn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Yn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;tr(l,f.opts.specialEasing);for(;s<o;s++){r=Qn[s].call(f,e,l,f.opts);if(r)return r}return Zn(f,l),b.isFunction(f.opts.start)&&f.opts.start.call(e,f),b.fx.timer(b.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function tr(e,t){var n,r,i,s,o;for(i in e){r=b.camelCase(i),s=t[r],n=e[i],b.isArray(n)&&(s=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),o=b.cssHooks[r];if(o&&"expand"in o){n=o.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=s)}else t[r]=s}}function nr(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},v=[],m=e.nodeType&&nn(e);n.queue||(l=b._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,b.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],b.css(e,"display")==="inline"&&b.css(e,"float")==="none"&&(!b.support.inlineBlockNeedsLayout||an(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",b.support.shrinkWrapBlocks||h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in t){o=t[i];if($n.exec(o)){delete t[i],a=a||o==="toggle";if(o===(m?"hide":"show"))continue;v.push(i)}}s=v.length;if(s){u=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden"in u&&(m=u.hidden),a&&(u.hidden=!m),m?b(e).show():h.done(function(){b(e).hide()}),h.done(function(){var t;b._removeData(e,"fxshow");for(t in d)b.style(e,t,d[t])});for(i=0;i<s;i++)r=v[i],f=h.createTween(r,m?u[r]:0),d[r]=u[r]||b.style(e,r),r in u||(u[r]=f.start,m&&(f.end=f.start,f.start=r==="width"||r==="height"?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function sr(e){return b.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=typeof t,s=e.document,o=e.location,u=e.jQuery,a=e.$,f={},l=[],c="1.9.1-ai1ec",h=l.concat,p=l.push,d=l.slice,v=l.indexOf,m=f.toString,g=f.hasOwnProperty,y=c.trim,b=function(e,t){return new b.fn.init(e,t,r)},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,E=/\S+/g,S=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,x=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,T=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,N=/^[\],:{}\s]*$/,C=/(?:^|:|,)(?:\s*\[)+/g,k=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,L=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,A=/^-ms-/,O=/-([\da-z])/gi,M=function(e,t){return t.toUpperCase()},_=function(e){if(s.addEventListener||e.type==="load"||s.readyState==="complete")D(),b.ready()},D=function(){s.addEventListener?(s.removeEventListener("DOMContentLoaded",_,!1),e.removeEventListener("load",_,!1)):(s.detachEvent("onreadystatechange",_),e.detachEvent("onload",_))};b.fn=b.prototype={jquery:c,constructor:b,init:function(e,n,r){var i,o;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?i=[null,e,null]:i=x.exec(e);if(i&&(i[1]||!n)){if(i[1]){n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:s,!0));if(T.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}o=s.getElementById(i[2]);if(o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=s,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return d.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:p,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!b.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((s=arguments[a])!=null)for(i in s){e=u[i],r=s[i];if(u===r)continue;l&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,o=e&&b.isArray(e)?e:[]):o=e&&b.isPlainObject(e)?e:{},u[i]=b.extend(l,o,r)):r!==t&&(u[i]=r)}return u},b.extend({noConflict:function(t){return e.$===b&&(e.$=a),t&&e.jQuery===b&&(e.jQuery=u),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?--b.readyWait:b.isReady)return;if(!s.body)return setTimeout(b.ready);b.isReady=!0;if(e!==!0&&--b.readyWait>0)return;n.resolveWith(s,[b]),b.fn.trigger&&b(s).trigger("ready").off("ready")},isFunction:function(e){return b.type(e)==="function"},isArray:Array.isArray||function(e){return b.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?f[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||b.type(e)!=="object"||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!g.call(e,"constructor")&&!g.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||g.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||s;var r=T.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(t===null)return t;if(typeof t=="string"){t=b.trim(t);if(t&&N.test(t.replace(k,"@").replace(L,"]").replace(C,"")))return(new Function("return "+t))()}b.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(A,"ms-").replace(O,M)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=P(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:y&&!y.call("")?function(e){return e==null?"":y.call(e)}:function(e){return e==null?"":(e+"").replace(S,"")},makeArray:function(e,t){var n=t||[];return e!=null&&(P(Object(e))?b.merge(n,typeof e=="string"?[e]:e):p.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(v)return v.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=P(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),r!=null&&(u[u.length]=r);return h.apply([],u)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(s=e[n],n=e,e=s),b.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(n||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=r==null;if(b.type(r)==="object"){s=!0;for(a in r)b.access(e,n,a,r[a],!0,o,u)}else if(i!==t){s=!0,b.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(b(e),n)}));if(n)for(;a<f;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)))}return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n){n=b.Deferred();if(s.readyState==="complete")setTimeout(b.ready);else if(s.addEventListener)s.addEventListener("DOMContentLoaded",_,!1),e.addEventListener("load",_,!1);else{s.attachEvent("onreadystatechange",_),e.attachEvent("onload",_);var r=!1;try{r=e.frameElement==null&&s.documentElement}catch(i){}r&&r.doScroll&&function o(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(o,50)}D(),b.ready()}}()}}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){f["[object "+t+"]"]=t.toLowerCase()}),r=b(s);var H={};b.Callbacks=function(e){e=typeof e=="string"?H[e]||B(e):b.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){r=e.memory&&t,i=!0,o=u||0,u=0,s=a.length,n=!0;for(;a&&o<s;o++)if(a[o].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,a&&(f?f.length&&l(f.shift()):r?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);r==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&r!=="string"&&i(n)})})(arguments),n?s=a.length:r&&(u=t,l(r))}return this},remove:function(){return a&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,a,r))>-1)a.splice(r,1),n&&(r<=s&&s--,r<=o&&o--)}),this},has:function(e){return e?b.inArray(e,a)>-1:!!a&&!!a.length},empty:function(){return a=[],this},disable:function(){return a=f=r=t,this},disabled:function(){return!a},lock:function(){return f=t,r||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!i||f)&&(n?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,s){var o=s[0],u=b.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=r!==1||e&&b.isFunction(e.promise)?r:0,s=i===1?e:b.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),b.support=function(){var t,n,r,o,u,a,f,l,c,h,p=s.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};u=s.createElement("select"),f=u.appendChild(s.createElement("option")),o=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:p.className!=="t",leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!o.value,optSelected:f.selected,enctype:!!s.createElement("form").enctype,html5Clone:s.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:s.compatMode==="CSS1Compat",deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,u.disabled=!0,t.optDisabled=!f.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}o=s.createElement("input"),o.setAttribute("value",""),t.input=o.getAttribute("value")==="",o.value="t",o.setAttribute("type","radio"),t.radioValue=o.value==="t",o.setAttribute("checked","t"),o.setAttribute("name","t"),a=s.createDocumentFragment(),a.appendChild(o),t.appendChecked=o.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||p.attributes[l].expando===!1;return p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle=p.style.backgroundClip==="content-box",b(function(){var n,r,o,u="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=s.getElementsByTagName("body")[0];if(!a)return;n=s.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=p.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",c=o[0].offsetHeight===0,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=c&&o[0].offsetHeight===0,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=p.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(p,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(p,null)||{width:"4px"}).width==="4px",r=p.appendChild(s.createElement("div")),r.style.cssText=p.style.cssText=u,r.style.marginRight=r.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof p.style.zoom!==i&&(p.innerHTML="",p.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=p.offsetWidth===3,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=p.offsetWidth!==3,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=p=o=r=null}),n=u=a=f=r=o=null,t}();var j=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,F=/([A-Z])/g;b.extend({cache:{},expando:"jQuery"+(c+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!U(e)},data:function(e,t,n){return I(e,t,n)},removeData:function(e,t){return q(e,t)},_data:function(e,t,n){return I(e,t,n,!0)},_removeData:function(e,t){return q(e,t,!0)},acceptData:function(e){if(e.nodeType&&e.nodeType!==1&&e.nodeType!==9)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,s=this[0],o=0,u=null;if(e===t){if(this.length){u=b.data(s);if(s.nodeType===1&&!b._data(s,"parsedAttrs")){r=s.attributes;for(;o<r.length;o++)i=r[o].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),R(s,i,u[i]));b._data(s,"parsedAttrs",!0)}}return u}return typeof e=="object"?this.each(function(){b.data(this,e)}):b.access(this,function(n){if(n===t)return s?R(s,e,b.data(s,e)):null;this.each(function(){b.data(this,e,n)})},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}}),b.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=b._data(e,t),n&&(!r||b.isArray(n)?r=b._data(e,t,b.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),s=b._queueHooks(e,t),o=function(){b.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),s.cur=i,i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=b.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=b._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var z,W,X=/[\t\r\n]/g,V=/\r/g,$=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,K=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Q=/^(?:checked|selected)$/i,G=b.support.getSetAttribute,Y=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=typeof e=="string"&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(a){t=(e||"").match(E)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(X," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=b.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=arguments.length===0||typeof e=="string"&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(a){t=(e||"").match(E)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(X," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?b.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var s,o=0,u=b(this),a=t,f=e.match(E)||[];while(s=f[o++])a=r?a:!u.hasClass(s),u[a?"addClass":"removeClass"](s)}else if(n===i||n==="boolean")this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return r=b.valHooks[s.type]||b.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,typeof n=="string"?n.replace(V,""):n==null?"":n);return}return i=b.isFunction(e),this.each(function(n){var s,o=b(this);if(this.nodeType!==1)return;i?s=e.call(this,n,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":b.isArray(s)&&(s=b.map(s,function(e){return e==null?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()];if(!r||!("set"in r)||r.set(this,s,"value")===t)this.value=s})}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(b.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!b.nodeName(n.parentNode,"optgroup"))){t=b(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(typeof e.getAttribute===i)return b.prop(e,n,r);o=a!==1||!b.isXMLDoc(e),o&&(n=n.toLowerCase(),s=b.attrHooks[n]||(K.test(n)?W:z));if(r===t)return s&&o&&"get"in s&&(u=s.get(e,n))!==null?u:(typeof e.getAttribute!==i&&(u=e.getAttribute(n)),u==null?t:u);if(r!==null)return s&&o&&"set"in s&&(u=s.set(e,r,n))!==t?u:(e.setAttribute(n,r+""),r);b.removeAttr(e,n)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(E);if(s&&e.nodeType===1)while(n=s[i++])r=b.propFix[n]||n,K.test(n)?!G&&Q.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(G?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&t==="radio"&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!b.isXMLDoc(e),o&&(n=b.propFix[n]||n,s=b.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):$.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:t}}}}),W={get:function(e,n){var r=b.prop(e,n),i=typeof r=="boolean"&&e.getAttribute(n),s=typeof r=="boolean"?Y&&G?i!=null:Q.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return s&&s.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):Y&&G||!Q.test(n)?e.setAttribute(!G&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}};if(!Y||!G)b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,t,n){if(!b.nodeName(e,"input"))return z&&z.set(e,t,n);e.defaultValue=t}};G||(z=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&(n==="id"||n==="name"||n==="coords"?r.value!=="":r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="",r==="value"||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:z.get,set:function(e,t,n){z.set(e,t===""?!1:t,n)}},b.each(["width","height"],function(e,t){b.attrHooks[t]=b.extend(b.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r==null?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,t){if(b.isArray(t))return e.checked=b.inArray(b(e).val(),t)>=0}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;b.event={global:{},add:function(e,n,r,s,o){var u,a,f,l,c,h,p,d,v,m,g,y=b._data(e);if(!y)return;r.handler&&(l=r,r=l.handler,o=l.selector),r.guid||(r.guid=b.guid++),(a=y.events)||(a=y.events={}),(h=y.handle)||(h=y.handle=function(e){return typeof b===i||!!e&&b.event.triggered===e.type?t:b.event.dispatch.apply(h.elem,arguments)},h.elem=e),n=(n||"").match(E)||[""],f=n.length;while(f--){u=rt.exec(n[f])||[],v=g=u[1],m=(u[2]||"").split(".").sort(),c=b.event.special[v]||{},v=(o?c.delegateType:c.bindType)||v,c=b.event.special[v]||{},p=b.extend({type:v,origType:g,data:s,handler:r,guid:r.guid,selector:o,needsContext:o&&b.expr.match.needsContext.test(o),namespace:m.join(".")},l);if(!(d=a[v])){d=a[v]=[],d.delegateCount=0;if(!c.setup||c.setup.call(e,s,m,h)===!1)e.addEventListener?e.addEventListener(v,h,!1):e.attachEvent&&e.attachEvent("on"+v,h)}c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),b.event.global[v]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=b.hasData(e)&&b._data(e);if(!m||!(l=m.events))return;t=(t||"").match(E)||[""],f=t.length;while(f--){u=rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in l)b.event.remove(e,p+t[f],n,r,!0);continue}c=b.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],(i||v===o.origType)&&(!n||n.guid===o.guid)&&(!u||u.test(o.namespace))&&(!r||r===o.selector||r==="**"&&o.selector)&&(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&b.removeEvent(e,p,m.handle),delete l[p])}b.isEmptyObject(l)&&(delete m.handle,b._removeData(e,"events"))},trigger:function(n,r,i,o){var u,a,f,l,c,h,p,d=[i||s],v=g.call(n,"type")?n.type:n,m=g.call(n,"namespace")?n.namespace.split("."):[];f=h=i=i||s;if(i.nodeType===3||i.nodeType===8)return;if(nt.test(v+b.event.triggered))return;v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),a=v.indexOf(":")<0&&"on"+v,n=n[b.expando]?n:new b.Event(v,typeof n=="object"&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=r==null?[n]:b.makeArray(r,[n]),c=b.event.special[v]||{};if(!o&&c.trigger&&c.trigger.apply(i,r)===!1)return;if(!o&&!c.noBubble&&!b.isWindow(i)){l=c.delegateType||v,nt.test(l+v)||(f=f.parentNode);for(;f;f=f.parentNode)d.push(f),h=f;h===(i.ownerDocument||s)&&d.push(h.defaultView||h.parentWindow||e)}p=0;while((f=d[p++])&&!n.isPropagationStopped())n.type=p>1?l:c.bindType||v,u=(b._data(f,"events")||{})[n.type]&&b._data(f,"handle"),u&&u.apply(f,r),u=a&&f[a],u&&b.acceptData(f)&&u.apply&&u.apply(f,r)===!1&&n.preventDefault();n.type=v;if(!o&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(i.ownerDocument,r)===!1)&&(v!=="click"||!b.nodeName(i,"a"))&&b.acceptData(i)&&a&&i[v]&&!b.isWindow(i)){h=i[a],h&&(i[a]=null),b.event.triggered=v;try{i[v]()}catch(y){}b.event.triggered=t,h&&(i[a]=h)}return n.result},dispatch:function(e){e=b.event.fix(e);var n,r,i,s,o,u=[],a=d.call(arguments),f=(b._data(this,"events")||{})[e.type]||[],l=b.event.special[e.type]||{};a[0]=e,e.delegateTarget=this;if(l.preDispatch&&l.preDispatch.call(this,e)===!1)return;u=b.event.handlers.call(this,e,f),n=0;while((s=u[n++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(i.namespace))e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return l.postDispatch&&l.postDispatch.call(this,e),e.result},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||e.type!=="click"))for(;f!=this;f=f.parentNode||this)if(f.nodeType===1&&(f.disabled!==!0||e.type!=="click")){s=[];for(o=0;o<a;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?b(r,this).index(f)>=0:b.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return a<n.length&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,o=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new b.Event(o),t=r.length;while(t--)n=r[t],e[n]=o[n];return e.target||(e.target=o.srcElement||s),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,u.filter?u.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(i=e.target.ownerDocument||s,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){if(b.nodeName(this,"input")&&this.type==="checkbox"&&this.click)return this.click(),!1}},focus:{trigger:function(){if(this!==s.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===s.activeElement&&this.blur)return this.blur(),!1},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=s.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,t){if(!(this instanceof b.Event))return new b.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:st):this.type=e,t&&b.extend(this,t),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0},b.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!b.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){if(b.nodeName(this,"form"))return!1;b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(b.nodeName(this,"form"))return!1;b.event.remove(this,"._submit")}}),b.support.changeBubbles||(b.event.special.change={setup:function(){if(Z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")b.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)});return!1}b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){n++===0&&s.addEventListener(e,r,!0)},teardown:function(){--n===0&&s.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=st;else if(!i)return this;return s===1&&(u=i,i=function(e){return b().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=st),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return b.event.trigger(e,t,n,!0)}}),function(e,t){function rt(e){return J.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function st(e){return e[w]=!0,e}function ot(e){var t=c.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function ut(e,t,n,r){var i,s,o,u,a,f,h,v,m,y;(t?t.ownerDocument||t:E)!==c&&l(t),t=t||c,n=n||[];if(!e||typeof e!="string")return n;if((u=t.nodeType)!==1&&u!==9)return[];if(!p&&!r){if(i=K.exec(e))if(o=i[1]){if(u===9){s=t.getElementById(o);if(!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&g(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return _.apply(n,D.call(t.getElementsByTagName(e),0)),n;if((o=i[3])&&S.getByClassName&&t.getElementsByClassName)return _.apply(n,D.call(t.getElementsByClassName(o),0)),n}if(S.qsa&&!d.test(e)){h=!0,v=w,m=t,y=u===9&&e;if(u===1&&t.nodeName.toLowerCase()!=="object"){f=ht(e),(h=t.getAttribute("id"))?v=h.replace(Y,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",a=f.length;while(a--)f[a]=v+pt(f[a]);m=$.test(e)&&t.parentNode||t,y=f.join(",")}if(y)try{return _.apply(n,D.call(m.querySelectorAll(y),0)),n}catch(b){}finally{h||t.removeAttribute("id")}}}return Et(e.replace(R,"$1"),t,n,r)}function at(e,t){var n=t&&e,r=n&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function ct(e){return st(function(t){return t=+t,st(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ht(e,t){var n,r,s,o,u,a,f,l=C[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=U.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=z.exec(u))n=r.shift(),s.push({value:n,type:r[0].replace(R," ")}),u=u.slice(n.length);for(o in i.filter)(r=V[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(n=r.shift(),s.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ut.error(e):C(e,a).slice(0)}function pt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function dt(e,t,n){var i=t.dir,s=n&&i==="parentNode",o=T++;return t.first?function(t,n,r){while(t=t[i])if(t.nodeType===1||s)return e(t,n,r)}:function(t,n,u){var a,f,l,c=x+" "+o;if(u){while(t=t[i])if(t.nodeType===1||s)if(e(t,n,u))return!0}else while(t=t[i])if(t.nodeType===1||s){l=t[w]||(t[w]={});if((f=l[i])&&f[0]===c){if((a=f[1])===!0||a===r)return a===!0}else{f=l[i]=[c],f[1]=e(t,n,u)||r;if(f[1]===!0)return!0}}}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function gt(e,t,n,r,i,s){return r&&!r[w]&&(r=gt(r)),i&&!i[w]&&(i=gt(i,s)),st(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||wt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?mt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=mt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?P.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=mt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):_.apply(o,g)})}function yt(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,l=dt(function(e){return e===t},u,!0),c=dt(function(e){return P.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[dt(vt(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[w]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return gt(a>1&&vt(h),a>1&&pt(e.slice(0,a-1)).replace(R,"$1"),n,a<r&&yt(e.slice(a,r)),r<s&&yt(e=e.slice(r)),r<s&&pt(e))}h.push(n)}return vt(h)}function bt(e,t){var n=0,s=t.length>0,o=e.length>0,u=function(u,a,l,h,p){var d,v,m,g=[],y=0,b="0",w=u&&[],E=p!=null,S=f,T=u||o&&i.find.TAG("*",p&&a.parentNode||a),N=x+=S==null?1:Math.random()||.1;E&&(f=a!==c&&a,r=n);for(;(d=T[b])!=null;b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){h.push(d);break}E&&(x=N,r=++n)}s&&((d=!m&&d)&&y--,u&&w.push(d))}y+=b;if(s&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)!w[b]&&!g[b]&&(g[b]=M.call(h));g=mt(g)}_.apply(h,g),E&&!u&&g.length>0&&y+t.length>1&&ut.uniqueSort(h)}return E&&(x=N,f=S),w};return s?st(u):u}function wt(e,t,n){var r=0,i=t.length;for(;r<i;r++)ut(e,t[r],n);return n}function Et(e,t,n,r){var s,o,a,f,l,c=ht(e);if(!r&&c.length===1){o=c[0]=c[0].slice(0);if(o.length>2&&(a=o[0]).type==="ID"&&t.nodeType===9&&!p&&i.relative[o[1].type]){t=i.find.ID(a.matches[0].replace(et,tt),t)[0];if(!t)return n;e=e.slice(o.shift().value.length)}s=V.needsContext.test(e)?0:o.length;while(s--){a=o[s];if(i.relative[f=a.type])break;if(l=i.find[f])if(r=l(a.matches[0].replace(et,tt),$.test(o[0].type)&&t.parentNode||t)){o.splice(s,1),e=r.length&&pt(o);if(!e)return _.apply(n,D.call(r,0)),n;break}}}return u(e,c)(r,t,p,n,$.test(e)),n}function St(){}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,w="sizzle"+ -(new Date),E=e.document,S={},x=0,T=0,N=it(),C=it(),k=it(),L=typeof t,A=1<<31,O=[],M=O.pop,_=O.push,D=O.slice,P=O.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},H="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",j=B.replace("w","w#"),F="([*^$|!~]?=)",I="\\["+H+"*("+B+")"+H+"*(?:"+F+H+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+j+")|)|)"+H+"*\\]",q=":("+B+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+I.replace(3,8)+")*)|.*)\\)|)",R=new RegExp("^"+H+"+|((?:^|[^\\\\])(?:\\\\.)*)"+H+"+$","g"),U=new RegExp("^"+H+"*,"+H+"*"),z=new RegExp("^"+H+"*([\\x20\\t\\r\\n\\f>+~])"+H+"*"),W=new RegExp(q),X=new RegExp("^"+j+"$"),V={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),NAME:new RegExp("^\\[name=['\"]?("+B+")['\"]?\\]"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+H+"*(even|odd|(([+-]|)(\\d*)n|)"+H+"*(?:([+-]|)"+H+"*(\\d+)|))"+H+"*\\)|)","i"),needsContext:new RegExp("^"+H+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+H+"*((?:-\\d)?\\d*)"+H+"*\\)|)(?=[^-]|$)","i")},$=/[\x20\t\r\n\f]*[+~]/,J=/^[^{]+\{\s*\[native code/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)};try{D.call(E.documentElement.childNodes,0)[0].nodeType}catch(nt){D=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}o=ut.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},l=ut.setDocument=function(e){var n=e?e.ownerDocument||e:E;if(n===c||n.nodeType!==9||!n.documentElement)return c;c=n,h=n.documentElement,p=o(n),S.tagNameNoComments=ot(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),S.attributes=ot(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),S.getByClassName=ot(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),S.getByName=ot(function(e){e.id=w+0,e.innerHTML="<a name='"+w+"'></a><div name='"+w+"'></div>",h.insertBefore(e,h.firstChild);var t=n.getElementsByName&&n.getElementsByName(w).length===2+n.getElementsByName(w+0).length;return S.getIdNotName=!n.getElementById(w),h.removeChild(e),t}),i.attrHandle=ot(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==L&&e.firstChild.getAttribute("href")==="#"})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},S.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==L&&!p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==L&&!p){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==L&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=S.tagNameNoComments?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},i.find.NAME=S.getByName&&function(e,t){if(typeof t.getElementsByName!==L)return t.getElementsByName(name)},i.find.CLASS=S.getByClassName&&function(e,t){if(typeof t.getElementsByClassName!==L&&!p)return t.getElementsByClassName(e)},v=[],d=[":focus"];if(S.qsa=rt(n.querySelectorAll))ot(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+H+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||d.push(":checked")}),ot(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&d.push("[*^$]="+H+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")});return(S.matchesSelector=rt(m=h.matchesSelector||h.mozMatchesSelector||h.webkitMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ot(function(e){S.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",q)}),d=new RegExp(d.join("|")),v=new RegExp(v.join("|")),g=rt(h.contains)||h.compareDocumentPosition?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},y=h.compareDocumentPosition?function(e,t){var r;if(e===t)return a=!0,0;if(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))return r&1||e.parentNode&&e.parentNode.nodeType===11?e===n||g(E,e)?-1:t===n||g(E,t)?1:0:r&4?-1:1;return e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],f=[t];if(e===t)return a=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:0;if(s===o)return at(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)f.unshift(r);while(u[i]===f[i])i++;return i?at(u[i],f[i]):u[i]===E?-1:f[i]===E?1:0},a=!1,[0,0].sort(y),S.detectDuplicates=a,c},ut.matches=function(e,t){return ut(e,null,null,t)},ut.matchesSelector=function(e,t){(e.ownerDocument||e)!==c&&l(e),t=t.replace(Z,"='$1']");if(S.matchesSelector&&!p&&(!v||!v.test(t))&&!d.test(t))try{var n=m.call(e,t);if(n||S.disconnectedMatch||e.document&&e.document.nodeType!==11)return n}catch(r){}return ut(t,c,null,[e]).length>0},ut.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},ut.attr=function(e,t){var n;return(e.ownerDocument||e)!==c&&l(e),p||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):p||S.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},ut.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ut.uniqueSort=function(e){var t,n=[],r=1,i=0;a=!S.detectDuplicates,e.sort(y);if(a){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},s=ut.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r];r++)n+=s(t);else if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue;return n},i=ut.selectors={cacheLength:50,createPseudo:st,match:V,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||ut.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&ut.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return V.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&W.test(n)&&(t=ht(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=N[e+" "];return t||(t=new RegExp("(^|"+H+")"+e+"("+H+"|$)"))&&N(e,function(e){return t.test(e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ut.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===x&&f[1],h=f[0]===x&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[x,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===x)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[w]||(c[w]={}))[e]=[x,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ut.error("unsupported pseudo: "+e);return r[w]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?st(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=P.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:st(function(e){var t=[],n=[],r=u(e.replace(R,"$1"));return r[w]?st(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:st(function(e){return function(t){return ut(e,t).length>0}}),contains:st(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:st(function(e){return X.test(e||"")||ut.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=p?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:ct(function(){return[0]}),last:ct(function(e,t){return[t-1]}),eq:ct(function(e,t,n){return[n<0?n+t:n]}),even:ct(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:ct(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:ct(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ct(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=ft(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=lt(n);u=ut.compile=function(e,t){var n,r=[],i=[],s=k[e+" "];if(!s){t||(t=ht(e)),n=t.length;while(n--)s=yt(t[n]),s[w]?r.push(s):i.push(s);s=k(e,bt(i,r))}return s},i.pseudos.nth=i.pseudos.eq,i.filters=St.prototype=i.pseudos,i.setFilters=new St,l(),ut.attr=b.attr,b.find=ut,b.expr=ut.selectors,b.expr[":"]=b.expr.pseudos,b.unique=ut.uniqueSort,b.text=ut.getText,b.isXMLDoc=ut.isXML,b.contains=ut.contains}(e);var ot=/Until$/,ut=/^(?:parents|prev(?:Until|All))/,at=/^.[^:#\[\.,]*$/,ft=b.expr.match.needsContext,lt={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if(typeof e!="string")return r=this,this.pushStack(b(e).filter(function(){for(t=0;t<i;t++)if(b.contains(r[t],this))return!0}));n=[];for(t=0;t<i;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ht(this,e,!1))},filter:function(e){return this.pushStack(ht(this,e,!0))},is:function(e){return!!e&&(typeof e=="string"?ft.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=ft.test(e)||typeof e!="string"?b(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:b.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return this.pushStack(s.length>1?b.unique(s):s)},index:function(e){return e?typeof e=="string"?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack,b.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return ot.test(e)||(r=n),r&&typeof r=="string"&&(i=b.filter(r,i)),i=this.length>1&&!lt[e]?b.unique(i):i,this.length>1&&ut.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!b(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",vt=/ jQuery\d+="(?:null|\d+)"/g,mt=new RegExp("<(?:"+dt+")[\\s/>]","i"),gt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,Et=/<|&#?\w+;/,St=/<(?:script|style|link)/i,xt=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^$|\/(?:java|ecma)script/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Lt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},At=pt(s),Ot=At.appendChild(s.createElement("div"));Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||b.filter(e,[n]).length>0)!t&&n.nodeType===1&&b.cleanData(jt(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Pt(jt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&b.cleanData(jt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(vt,""):t;if(typeof e=="string"&&!St.test(e)&&(b.support.htmlSerialize||!mt.test(e))&&(b.support.leadingWhitespace||!gt.test(e))&&!Lt[(bt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(yt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(b.cleanData(jt(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return!t&&typeof e!="string"&&(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=h.apply([],e);var i,s,o,u,a,f,l=0,c=this.length,p=this,d=c-1,v=e[0],m=b.isFunction(v);if(m||!(c<=1||typeof v!="string"||b.support.checkClone||!Tt.test(v)))return this.each(function(i){var s=p.eq(i);m&&(e[0]=v.call(this,i,n?s.html():t)),s.domManip(e,n,r)});if(c){f=b.buildFragment(e,this[0].ownerDocument,!1,this),i=f.firstChild,f.childNodes.length===1&&(f=i);if(i){n=n&&b.nodeName(i,"tr"),u=b.map(jt(f,"script"),_t),o=u.length;for(;l<c;l++)s=f,l!==d&&(s=b.clone(s,!0,!0),o&&b.merge(u,jt(s,"script"))),r.call(n&&b.nodeName(this[l],"table")?Mt(this[l],"tbody"):this[l],s,l);if(o){a=u[u.length-1].ownerDocument,b.map(u,Dt);for(l=0;l<o;l++)s=u[l],Nt.test(s.type||"")&&!b._data(s,"globalEval")&&b.contains(a,s)&&(s.src?b.ajax({url:s.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((s.text||s.textContent||s.innerHTML||"").replace(kt,"")))}f=i=null}}return this}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],s=b(e),o=s.length-1;for(;r<=o;r++)n=r===o?this:this.clone(!0),b(s[r])[t](n),p.apply(i,n.get());return this.pushStack(i)}}),b.extend({clone:function(e,t,n){var r,i,s,o,u,a=b.contains(e.ownerDocument,e);b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Ot.innerHTML=e.outerHTML,Ot.removeChild(s=Ot.firstChild));if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!b.isXMLDoc(e)){r=jt(s),u=jt(e);for(o=0;(i=u[o])!=null;++o)r[o]&&Bt(i,r[o])}if(t)if(n){u=u||jt(e),r=r||jt(s);for(o=0;(i=u[o])!=null;o++)Ht(i,r[o])}else Ht(e,s);return r=jt(s,"script"),r.length>0&&Pt(r,!a&&jt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,c=e.length,h=pt(t),p=[],d=0;for(;d<c;d++){s=e[d];if(s||s===0)if(b.type(s)==="object")b.merge(p,s.nodeType?[s]:s);else if(!Et.test(s))p.push(t.createTextNode(s));else{u=u||h.appendChild(t.createElement("div")),a=(bt.exec(s)||["",""])[1].toLowerCase(),l=Lt[a]||Lt._default,u.innerHTML=l[1]+s.replace(yt,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;!b.support.leadingWhitespace&&gt.test(s)&&p.push(t.createTextNode(gt.exec(s)[0]));if(!b.support.tbody){s=a==="table"&&!wt.test(s)?u.firstChild:l[1]==="<table>"&&!wt.test(s)?u:0,i=s&&s.childNodes.length;while(i--)b.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}b.merge(p,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=h.lastChild}}u&&h.removeChild(u),b.support.appendChecked||b.grep(jt(p,"input"),Ft),d=0;while(s=p[d++]){if(r&&b.inArray(s,r)!==-1)continue;o=b.contains(s.ownerDocument,s),u=jt(h.appendChild(s),"script"),o&&Pt(u);if(n){i=0;while(s=u[i++])Nt.test(s.type||"")&&n.push(s)}}return u=null,h},cleanData:function(e,t){var n,r,s,o,u=0,a=b.expando,f=b.cache,c=b.support.deleteExpando,h=b.event.special;for(;(n=e[u])!=null;u++)if(t||b.acceptData(n)){s=n[a],o=s&&f[s];if(o){if(o.events)for(r in o.events)h[r]?b.event.remove(n,r):b.removeEvent(n,r,o.handle);f[s]&&(delete f[s],c?delete n[a]:typeof n.removeAttribute!==i?n.removeAttribute(a):n[a]=null,l.push(s))}}}});var It,qt,Rt,Ut=/alpha\([^)]*\)/i,zt=/opacity\s*=\s*([^)]*)/,Wt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,$t=new RegExp("^("+w+")(.*)$","i"),Jt=new RegExp("^("+w+")(?!px)[a-z%]+$","i"),Kt=new RegExp("^([+-])=("+w+")","i"),Qt={BODY:"block"},Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,s,o={},u=0;if(b.isArray(n)){s=qt(e),i=n.length;for(;u<i;u++)o[n[u]]=b.css(e,n[u],!1,s);return o}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t=typeof e=="boolean";return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Rt(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=b.camelCase(n),f=e.style;n=b.cssProps[a]||(b.cssProps[a]=tn(f,a)),u=b.cssHooks[n]||b.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=Kt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(b.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!b.cssNumber[a]&&(r+="px"),!b.support.clearCloneStyle&&r===""&&n.indexOf("background")===0&&(f[n]="inherit");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=b.camelCase(n);return n=b.cssProps[a]||(b.cssProps[a]=tn(e.style,a)),u=b.cssHooks[n]||b.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=Rt(e,n,i)),o==="normal"&&n in Yt&&(o=Yt[n]),r===""||r?(s=parseFloat(o),r===!0||b.isNumeric(s)?s||0:o):o},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),e.getComputedStyle?(qt=function(t){return e.getComputedStyle(t,null)},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(a===""&&!b.contains(e.ownerDocument,e)&&(a=b.style(e,n)),Jt.test(a)&&Vt.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):s.documentElement.currentStyle&&(qt=function(e){return e.currentStyle},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u[n]:t,f=e.style;return a==null&&f&&f[n]&&(a=f[n]),Jt.test(a)&&!Wt.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left=n==="fontSize"?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),a===""?"auto":a}),b.each(["height","width"],function(e,t){b.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&Xt.test(b.css(e,"display"))?b.swap(e,Gt,function(){return un(e,t,r)}):un(e,t,r)},set:function(e,n,r){var i=r&&qt(e);return sn(e,n,r?on(e,t,r,b.support.boxSizing&&b.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return zt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if((t>=1||t==="")&&b.trim(s.replace(Ut,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(t===""||r&&!r.filter)return}n.filter=Ut.test(s)?s.replace(Ut,i):s+" "+i}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,t){if(t)return b.swap(e,{display:"inline-block"},Rt,[e,"marginRight"])}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,t){b.cssHooks[t]={get:function(e,n){if(n)return n=Rt(e,t),Jt.test(n)?b(e).position()[t]+"px":n}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!b.support.reliableHiddenOffsets&&(e.style&&e.style.display||b.css(e,"display"))==="none"},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+Zt[r]+t]=s[r]||s[r-2]||s[0];return i}},Vt.test(e)||(b.cssHooks[e+t].set=sn)});var ln=/%20/g,cn=/\[\]$/,hn=/\r?\n/g,pn=/^(?:submit|button|image|reset|file)$/i,dn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&dn.test(this.nodeName)&&!pn.test(e)&&(this.checked||!xt.test(e))}).map(function(e,t){var n=b(this).val();return n==null?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(hn,"\r\n")}}):{name:t.name,value:n.replace(hn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],s=function(e,t){t=b.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional);if(b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){s(this.name,this.value)});else for(r in e)vn(r,e[r],n,s);return i.join("&").replace(ln,"+")},b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,gn,yn=b.now(),bn=/\?/,wn=/#.*$/,En=/([?&])_=[^&]*/,Sn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,xn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tn=/^(?:GET|HEAD)$/,Nn=/^\/\//,Cn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kn=b.fn.load,Ln={},An={},On="*/".concat("*");try{gn=o.href}catch(Mn){gn=s.createElement("a"),gn.href="",gn=gn.href}mn=Cn.exec(gn.toLowerCase())||[],b.fn.load=function(e,n,r){if(typeof e!="string"&&kn)return kn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),b.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(o="POST"),u.length>0&&b.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,s){return b.isFunction(r)&&(s=s||i,i=r,r=t),b.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gn,type:"GET",isLocal:xn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":On,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Pn(Pn(e,b.ajaxSettings),t):Pn(b.ajaxSettings,e)},ajaxPrefilter:_n(Ln),ajaxTransport:_n(An),ajax:function(e,n){function N(e,n,r,i){var l,g,y,E,S,T=n;if(w===2)return;w=2,u&&clearTimeout(u),f=t,o=i||"",x.readyState=e>0?4:0,r&&(E=Hn(c,x,r));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(b.lastModified[s]=S),S=x.getResponseHeader("etag"),S&&(b.etag[s]=S)),e===204?(l=!0,T="nocontent"):e===304?(l=!0,T="notmodified"):(l=Bn(c,E),T=l.state,g=l.data,y=l.error,l=!y);else{y=T;if(e||!T)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[g,T,x]):d.rejectWith(h,[x,T,y]),x.statusCode(m),m=t,a&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,c,l?g:y]),v.fireWith(h,[x,T]),a&&(p.trigger("ajaxComplete",[x,c]),--b.active||b.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=b.ajaxSetup({},n),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?b(h):b.event,d=b.Deferred(),v=b.Callbacks("once memory"),m=c.statusCode||{},g={},y={},w=0,S="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(w===2){if(!l){l={};while(t=Sn.exec(o))l[t[1].toLowerCase()]=t[2]}t=l[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return w===2?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return w||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||S;return f&&f.abort(t),N(0,t),this}};d.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,c.url=((e||c.url||gn)+"").replace(wn,"").replace(Nn,mn[1]+"//"),c.type=n.method||n.type||c.method||c.type,c.dataTypes=b.trim(c.dataType||"*").toLowerCase().match(E)||[""],c.crossDomain==null&&(r=Cn.exec(c.url.toLowerCase()),c.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||(r[1]==="http:"?80:443))==(mn[3]||(mn[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=b.param(c.data,c.traditional)),Dn(Ln,c,n,x);if(w===2)return x;a=c.global,a&&b.active++===0&&b.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Tn.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(bn.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=En.test(s)?s.replace(En,"$1_="+yn++):s+(bn.test(s)?"&":"?")+"_="+yn++)),c.ifModified&&(b.lastModified[s]&&x.setRequestHeader("If-Modified-Since",b.lastModified[s]),b.etag[s]&&x.setRequestHeader("If-None-Match",b.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+On+"; q=0.01":""):c.accepts["*"]);for(i in c.headers)x.setRequestHeader(i,c.headers[i]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&w!==2){S="abort";for(i in{success:1,error:1,complete:1})x[i](c[i]);f=Dn(An,c,n,x);if(!f)N(-1,"No Transport");else{x.readyState=1,a&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{w=1,f.send(g,N)}catch(T){if(!(w<2))throw T;N(-1,T)}}return x}return x.abort()},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}}),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=s.head||b("head")[0]||s.documentElement;return{send:function(t,i){n=s.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){if(t||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var jn=[],Fn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||b.expando+"_"+yn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Fn.test(n.url)?"url":typeof n.data=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(n.data)&&"data");if(a||n.dataTypes[0]==="jsonp")return s=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Fn,"$1"+s):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||b.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,jn.push(s)),u&&b.isFunction(o)&&o(u[0]),u=o=t}),"script"});var In,qn,Rn=0,Un=e.ActiveXObject&&function(){var e;for(e in In)In[e](t,!0)};b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&zn()||Wn()}:zn,qn=b.ajaxSettings.xhr(),b.support.cors=!!qn&&"withCredentials"in qn,qn=b.support.ajax=!!qn,qn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=b.noop,Un&&delete In[o]);if(i)a.readyState!==4&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),typeof a.responseText=="string"&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?a.readyState===4?setTimeout(r):(o=++Rn,Un&&(In||(In={},b(e).unload(Un)),In[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Vn,$n=/^(?:toggle|show|hide)$/,Jn=new RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Kn=/queueHooks$/,Qn=[nr],Gn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=Jn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(b.cssNumber[e]?"":"px");if(r!=="px"&&u){u=b.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,b.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Gn[n]=Gn[n]||[],Gn[n].unshift(t)},prefilter:function(e,t){t?Qn.unshift(e):Qn.push(e)}}),b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.options.duration?this.pos=t=b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=b.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(e.elem.style[b.cssProps[e.prop]]!=null||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),s=b.speed(t,n,r),o=function(){var t=er(this,b.extend({},e),s);o.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=b.timers,o=b._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Kn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=b.timers,o=r?r.length:0;n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&typeof e=="object"?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};r.duration=b.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;Xn=b.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Vn||(Vn=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Vn),Vn=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,s={top:0,left:0},o=this[0],u=o&&o.ownerDocument;if(!u)return;return n=u.documentElement,b.contains(n,o)?(typeof o.getBoundingClientRect!==i&&(s=o.getBoundingClientRect()),r=sr(u),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");r==="static"&&(e.style.position="relative");var i=b(e),s=i.offset(),o=b.css(e,"top"),u=b.css(e,"left"),a=(r==="absolute"||r==="fixed")&&b.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),b.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},b.fn.extend({position:function(){if(!this[0])return;var e,t,n={top:0,left:0},r=this[0];return b.css(r,"position")==="fixed"?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s.documentElement;while(e&&!b.nodeName(e,"html")&&b.css(e,"position")==="static")e=e.offsetParent;return e||s.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,s){var o=sr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?b(o).scrollLeft():s,r?s:b(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return b.access(this,function(n,r,i){var s;return b.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?b.css(n,r,u):b.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=b}(window),jQuery.noConflict(!0)});

==================================================
FILE PATH: ./public/js/external_libs/select2.js
==================================================
/*
Copyright 2012 Igor Vaynberg

Version: 3.3.1 Timestamp: Wed Feb 20 09:57:22 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

timely.define(["jquery_timely"],function(e){(function(e){typeof e.fn.each2=="undefined"&&e.fn.extend({each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})})(e),function(e,t){function l(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(c(e,t[n]))return n;return-1}function c(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e===n+"":n.constructor===String?n===e+"":!1}function h(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r}function p(e){return e.outerWidth(!1)-e.width()}function d(n){var r="keyup-change-value";n.bind("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.bind("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function v(n){n.bind("mousemove",function(n){var r=a;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function m(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function g(e){var t=!1,n;return function(){return t===!1&&(n=e(),t=!0),n}}function y(e,t){var n=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){l(e.target,t.get())>=0&&n(e)})}function b(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus(),t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",n),r.select())},0)}function w(e){e.preventDefault(),e.stopPropagation()}function E(e){e.preventDefault(),e.stopImmediatePropagation()}function S(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),u.attr("class","select2-sizer"),e("body").append(u)}return u.text(t.val()),u.width()}function x(t,n,r){var i,s=[],o;i=t.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")===0&&s.push(this)}),i=n.attr("class"),typeof i=="string"&&e(i.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),typeof o=="string"&&o.length>0&&s.push(this))}),t.attr("class",s.join(" "))}function T(e,t,n,r){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function N(t){var n,r=0,i=null,s=t.quietMillis||100,o=t.url,u=this;return function(a){window.clearTimeout(n),n=window.setTimeout(function(){r+=1;var n=r,s=t.data,f=o,l=t.transport||e.ajax,c=t.type||"GET",h={};s=s?s.call(u,a.term,a.page,a.context):null,f=typeof f=="function"?f.call(u,a.term,a.page,a.context):f,null!==i&&i.abort(),t.params&&(e.isFunction(t.params)?e.extend(h,t.params.call(u)):e.extend(h,t.params)),e.extend(h,{url:f,dataType:t.dataType,data:s,type:c,cache:!1,success:function(e){if(n<r)return;var i=t.results(e,a.page);a.callback(i)}}),i=l.call(u,h)},s)}}function C(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=n.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function k(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o)}}function L(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function A(t){return e.isFunction(t)?t():t}function O(t){var n=0;return e.each(t,function(e,t){t.children?n+=O(t.children):n++}),n}function M(e,n,r,i){var s=e,o=!1,u,a,f,l,h;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){h=i.tokenSeparators[f],a=e.indexOf(h);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+h.length);if(u.length>0){u=i.createSearchChoice(u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(c(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function _(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}var n,r,i,s,o,u,a,f;n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},f=e(document),o=function(){var e=1;return function(){return e++}}(),f.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}}),r=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results",u;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=g(function(){return n.element.closest("body")}),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(A(n.containerCss)),this.container.addClass(A(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabIndex"),this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(A(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=r=this.container.find(s),this.search=i=this.container.find("input.select2-input"),i.attr("tabIndex",this.elementTabIndex),this.resultsPage=0,this.context=null,this.initContainer(),v(this.results),this.dropdown.delegate(s,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent)),y(80,this.results),this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop(),o;i>0&&s-i<=0?(r.scrollTop(0),w(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),w(e))}),d(i),i.bind("keyup-change input paste",this.bind(this.updateResults)),i.bind("focus",function(){i.addClass("select2-focused")}),i.bind("blur",function(){i.removeClass("select2-focused")}),this.dropdown.delegate(s,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show())},prepareOpts:function(n){var r,i,s,o;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,s){var o,u,a,f,l=this.opts.id,c=this;o=function(r,i,u){var a,f,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(a=0,f=r.length;a<f;a+=1)h=r[a],d=h.disabled===!0,p=!d&&l(h)!==t,v=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+u),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(c.opts.formatResultCssClass(h)),g=e(document.createElement("div")),g.addClass("select2-result-label"),b=n.formatResult(h,g,s,c.opts.escapeMarkup),b!==t&&g.html(b),m.append(g),v&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),o(h.children,y,u+1),m.append(y)),m.data("select2-data",h),i.append(m)},o(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(s=n.id,n.id=function(e){return e[s]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.attr("data-select2-tags")}i?(n.query=this.bind(function(n){var i={results:[],more:!1},s=n.term,o,u,a;a=function(e,t){var r;e.is("option")?n.matcher(s,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:c(e.attr("disabled"),"disabled")}):e.is("optgroup")&&(r={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){a(t,r.children)}),r.children.length>0&&t.push(r))},o=r.children(),this.getPlaceholder()!==t&&o.length>0&&(u=o[0],e(u).text()===""&&(o=o.not(u))),o.each2(function(e,t){a(t,i.results)}),n.callback(i)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(o=n.element.data("ajax-url"),o&&o.length>0&&(n.ajax.url=o),n.query=N.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=k(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(h(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){if(c(this.id,t))return r=this.text,!1}),i.push({id:t,text:r})}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var e,t,n=this;e=this.opts.element.attr("disabled")!=="disabled",t=this.opts.element.attr("readonly")==="readonly",e=e&&!t,this.enabled!==e&&(e?this.enable():this.disable()),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),e.bind("propertychange.select2 DOMAttrModified.select2",t),typeof WebKitMutationObserver!="undefined"&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)}),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=this.dropdown.outerHeight(!1),s=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),u=t.top+n,a=t.left,f=u+i<=o,l=t.top-i>=this.body().scrollTop(),c=this.dropdown.outerWidth(!1),h=a+c<=s,p=this.dropdown.hasClass("select2-drop-above"),d,v,m;this.body().css("position")!=="static"&&(d=this.body().offset(),u-=d.top,a-=d.left),p?(v=!0,!l&&f&&(v=!1)):(v=!1,!f&&l&&(v=!0)),h||(a=t.left+r-c),v?(u=t.top-i,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),m=e.extend({top:u,left:a,width:r},A(this.opts.dropdownCss)),this.dropdown.css(m)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.clearDropdownAlignmentPreference(),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.updateResults(!0),s=e("#select2-drop-mask"),s.length==0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body()),s.bind("mousedown touchstart",function(t){var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),s.show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible();var o=this;this.container.parents().add(window).each(function(){e(this).bind(r+" "+n+" "+i,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight}),o.positionDropdown()})}),this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(n).unbind(r).unbind(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices(),i=e(n[r]),s=i.offset().top+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!0),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=i.offset().top-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return l(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),r=e(n[t]),r.addClass("select2-highlighted"),this.ensureHighlightVisible(),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"highlight",val:this.id(i),choice:i})},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=-1,i=this.resultsPage+1,s=this,o=this.search.val(),u=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:u,matcher:this.opts.matcher,callback:this.bind(function(n){if(!s.opened())return;s.opts.populateResults.call(this,e,n.results,{term:o,page:i,context:u}),n.more===!0?(t.detach().appendTo(e).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):t.remove(),s.positionDropdown(),s.resultsPage=i,s.context=n.context})}))},tokenize:function(){},updateResults:function(n){function f(){i.scrollTop(0),r.removeClass("select2-active"),u.positionDropdown()}function l(e){i.html(e),f()}var r=this.search,i=this.results,s=this.opts,o,u=this,a;if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;r.addClass("select2-active");var h=this.getMaximumSelectionSize();if(h>=1){o=this.data();if(e.isArray(o)&&o.length>=h&&L(s.formatSelectionTooBig,"formatSelectionTooBig")){l("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(h)+"</li>");return}}if(r.val().length<s.minimumInputLength){L(s.formatInputTooShort,"formatInputTooShort")?l("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>"):l("");return}s.formatSearching()&&n===!0&&l("<li class='select2-searching'>"+s.formatSearching()+"</li>");if(s.maximumInputLength&&r.val().length>s.maximumInputLength){L(s.formatInputTooLong,"formatInputTooLong")?l("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>"):l("");return}a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(null,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return c(u.id(this),u.id(a))}).length===0&&o.results.unshift(a));if(o.results.length===0&&L(s.formatNoMatches,"formatNoMatches")){l("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&L(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),f()})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){b(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r&&(this.highlight(t),this.onSelect(r,e))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,r,i,s,o;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s+=1){i=r[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(i!==null&&i.length>=1)return i[1]}}return this.opts.width==="resolve"?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);r!==null&&this.container.css("width",r)}}),i=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments),this.focusser.attr("disabled","disabled"),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),b(this.focusser)},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var e,t=this.container,r=this.dropdown,i=!1;this.showSearch(this.opts.minimumResultsForSearch>=0),this.selection=e=t.find(".select2-choice"),this.focusser=t.find(".select2-focusser"),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.TAB:case n.ENTER:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}})),this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC)return;if(this.opts.openOnEnter===!1&&e.which===n.ENTER){w(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){this.open(),w(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){this.opts.allowClear&&this.clear(),w(e);return}})),d(this.focusser),this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open(),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.focusser.val(""),w(e)})),e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear(),E(e),this.close(),this.selection.focus()})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?this.close():this.enabled&&this.open(),w(e),i=!1})),r.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(e){w(e)})),this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active")})),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),this.opts.element.trigger({type:"removed",val:this.id(e),choice:e}),this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()==="")this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(t,n){var r=t.find(":selected");e.isFunction(n)&&n({id:r.attr("value"),text:r.text(),element:r})}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val();t.query({matcher:function(e,n,r){return c(i,t.id(r))},callback:e.isFunction(r)?function(e){r(e.results.length?e.results[0]:null)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.select.find("option").first().text()!==""?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,t){var n=0,r=this,i=!0;this.findHighlightableChoices().each2(function(e,t){if(c(r.id(t.data("select2-data")),r.opts.element.val()))return n=e,!1}),this.highlight(n);if(t===!0){var s=this.opts.minimumResultsForSearch;i=s<0?!1:O(e.results)>=s,this.showSearch(i)}},showSearch:function(t){this.showSearchInput=t,this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var n=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.close(),(!t||!t.noFocus)&&this.selection.focus(),c(n,this.id(e))||this.triggerChange()},updateSelection:function(e){var n=this.selection.find("span"),r;this.selection.data("select2-data",e),n.empty(),r=this.opts.formatSelection(e,n),r!==t&&n.append(this.opts.escapeMarkup(r)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=!1,r=null,i=this;if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1]);if(this.select)this.select.val(e).find(":selected").each2(function(e,t){return r={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e&&e!==0){this.clear(),n&&this.triggerChange();return}this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange()})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;!e||e===""?this.clear():(this.opts.element.val(e?this.id(e):""),this.updateSelection(e))}}),s=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var n=[];e.find(":selected").each2(function(e,t){n.push({id:t.attr("value"),text:t.text(),element:t[0]})}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=h(n.val(),t.separator);t.query({matcher:function(n,r,s){return e.grep(i,function(e){return c(e,t.id(s))}).length},callback:e.isFunction(r)?function(e){r(e.results)}:e.noop})}),t},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(t),this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;this.opened()||this.open()})),this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.BACKSPACE&&this.search.val()===""){this.close();var t,i=r.find(".select2-search-choice-focus");if(i.length>0){this.unselect(i.first()),this.search.width(10),w(e);return}t=r.find(".select2-search-choice:not(.select2-locked)"),t.length>0&&t.last().addClass("select2-search-choice-focus")}else r.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),w(e);return;case n.ENTER:case n.TAB:this.selectHighlighted(),w(e);return;case n.ESC:this.cancel(e),w(e);return}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC)return;if(e.which===n.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN)&&w(e)})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.opened()||this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()})),this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0)},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus(),this.opts.element.triggerHandler("focus")},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){l(i.id(this),n)<0&&(n.push(i.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){i.addSelectedChoice(this)}),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a=this.getVal(),f;f=this.opts.formatSelection(n,o.find("div")),f!=t&&o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(f)+"</div>"),r&&o.find(".select2-search-choice-close").bind("mousedown",w).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),w(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),a.push(u),this.setVal(a)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";n=e.data("select2-data");if(!n)return;r=l(this.id(n).toString(),t),r>=0&&(t.splice(r,1),this.setVal(t),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(n),choice:n}),this.triggerChange({removed:n})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),n=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,n){var i=r.id(n.data("select2-data"));l(i,e)>=0&&(n.addClass("select2-selected"),n.find(".select2-result-selectable").addClass("select2-selected"))}),n.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&r.highlight(0)},resizeSearch:function(){var e,t,n,r,i,s=p(this.search);e=S(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(i)},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),h(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){l(this,n)<0&&n.push(this)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator)))},val:function(){var n,r=!1,i=[],s=this;if(arguments.length===0)return this.getVal();n=arguments[0],arguments.length>1&&(r=arguments[1]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange();return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n=this,r;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();t||(t=[]),r=e.map(t,function(e){return n.opts.id(e)}),this.setVal(r),this.updateSelection(t),this.clearSearch()}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?a=r.element.attr("multiple"):(a=r.multiple||!1,"tags"in r&&(r.multiple=a=!0)),o=a?new s:new i,o.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(l(n[0],f)<0)throw"Unknown method: "+n[0];u=t,o=e(this).data("select2");if(o===t)return;n[0]==="container"?u=o.container:u=o[n[0]].apply(o,n.slice(1));if(u!==t)return!1}}),u===t?this:u},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return T(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n){return e?e.text:t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please enter "+n+" less character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}}}(e)});

==================================================
FILE PATH: ./public/js/external_libs/jquery_cookie.js
==================================================
timely.define(["jquery_timely"],function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap_datepicker.js
==================================================
/* =========================================================
 * bootstrap-datepicker.js
 * Repo: https://github.com/eternicode/bootstrap-datepicker/
 * Demo: http://eternicode.github.io/bootstrap-datepicker/
 * Docs: http://bootstrap-datepicker.readthedocs.org/
 * Forked from http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Started by Stefan Petre; improvements by Andrew Rowls + contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

timely.define(["jquery_timely","ai1ec_config","external_libs/locales/bootstrap-datepicker.bg","external_libs/locales/bootstrap-datepicker.br","external_libs/locales/bootstrap-datepicker.cs","external_libs/locales/bootstrap-datepicker.da","external_libs/locales/bootstrap-datepicker.de","external_libs/locales/bootstrap-datepicker.es","external_libs/locales/bootstrap-datepicker.fi","external_libs/locales/bootstrap-datepicker.fr","external_libs/locales/bootstrap-datepicker.id","external_libs/locales/bootstrap-datepicker.is","external_libs/locales/bootstrap-datepicker.it","external_libs/locales/bootstrap-datepicker.ja","external_libs/locales/bootstrap-datepicker.kr","external_libs/locales/bootstrap-datepicker.lt","external_libs/locales/bootstrap-datepicker.lv","external_libs/locales/bootstrap-datepicker.ms","external_libs/locales/bootstrap-datepicker.nb","external_libs/locales/bootstrap-datepicker.nl","external_libs/locales/bootstrap-datepicker.pl","external_libs/locales/bootstrap-datepicker.pt-BR","external_libs/locales/bootstrap-datepicker.pt","external_libs/locales/bootstrap-datepicker.ru","external_libs/locales/bootstrap-datepicker.sl","external_libs/locales/bootstrap-datepicker.sv","external_libs/locales/bootstrap-datepicker.th","external_libs/locales/bootstrap-datepicker.tr","external_libs/locales/bootstrap-datepicker.zh-CN","external_libs/locales/bootstrap-datepicker.zh-TW"],function(e,t){function r(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return r(e.getFullYear(),e.getMonth(),e.getDate())}function s(e){return function(){return this[e].apply(this,arguments)}}function f(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r)n.test(u)&&(s=u.replace(o,function(e,t){return t.toLowerCase()}),i[s]=r[u]);return i}function l(t){var n={};if(!d[t]){t=t.split("-")[0];if(!d[t])return}var r=d[t];return e.each(p,function(e,t){t in r&&(n[t]=r[t])}),n}var n=e(window),o=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){var t=e&&e.valueOf();for(var n=0,r=this.length;n<r;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){if(!t)return;e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t)},clear:function(){this.splice(0)},copy:function(){var e=new o;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),u=function(t,n){this.dates=new o,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".ai1ec-date")?this.element.find(".ai1ec-input-group, .ai1ec-input-group-addon, .ai1ec-btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(v.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("ai1ec-datepicker-inline").appendTo(this.element):this.picker.addClass("ai1ec-datepicker-dropdown ai1ec-dropdown-menu"),this.o.rtl&&this.picker.addClass("ai1ec-datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.ai1ec-today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};u.prototype={constructor:u,_process_options:function(n){this._o=e.extend({},this._o,n);var r=this.o=e.extend({},this._o),i=r.language;d[i]||(i=i.split("-")[0],d[i]||(i=t.language,d[i]||(i=h.language))),r.language=i;switch(r.startView){case 2:case"decade":r.startView=2;break;case 1:case"year":r.startView=1;break;default:r.startView=0}switch(r.minViewMode){case 1:case"months":r.minViewMode=1;break;case 2:case"years":r.minViewMode=2;break;default:r.minViewMode=0}r.startView=Math.max(r.startView,r.minViewMode),r.multidate!==!0&&(r.multidate=Number(r.multidate)||!1,r.multidate!==!1?r.multidate=Math.max(0,r.multidate):r.multidate=1),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7;var s=v.parseFormat(r.format);r.startDate!==-Infinity&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=v.parseDate(r.startDate,s,r.language):r.startDate=-Infinity),r.endDate!==Infinity&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=v.parseDate(r.endDate,s,r.language):r.endDate=Infinity),r.daysOfWeekDisabled=r.daysOfWeekDisabled||[],e.isArray(r.daysOfWeekDisabled)||(r.daysOfWeekDisabled=r.daysOfWeekDisabled.split(/[,\s]*/)),r.daysOfWeekDisabled=e.map(r.daysOfWeekDisabled,function(e){return parseInt(e,10)});var o=String(r.orientation).toLowerCase().split(/\s+/g),u=r.orientation.toLowerCase();o=e.grep(o,function(e){return/^auto|left|right|top|bottom$/.test(e)}),r.orientation={x:"auto",y:"auto"};if(!!u&&u!=="auto")if(o.length===1)switch(o[0]){case"top":case"bottom":r.orientation.y=o[0];break;case"left":case"right":r.orientation.x=o[0]}else u=e.grep(o,function(e){return/^left|right$/.test(e)}),r.orientation.x=u[0]||"auto",u=e.grep(o,function(e){return/^top|bottom$/.test(e)}),r.orientation.y=u[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(r=undefined,i=e[t][1]):e[t].length==3&&(r=e[t][1],i=e[t][2]),n.on(i,r)},_unapplyEvents:function(e){for(var t=0,n,r,i;t<e.length;t++)n=e[t][0],e[t].length==2?(i=undefined,r=e[t][1]):e[t].length==3&&(i=e[t][1],r=e[t][2]),n.off(r,i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.dates.get(-1),i=this._utc_to_local(r);this.element.trigger({type:t,date:i,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){arguments.length===0?(e=this.dates.length-1,t=this.o.format):typeof e=="string"&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return v.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide")},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+e.getTimezoneOffset()*6e4)},_local_to_utc:function(e){return e&&new Date(e.getTime()-e.getTimezoneOffset()*6e4)},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){this.update.apply(this,arguments),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){this.update.apply(this,e.map(arguments,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(t){t===undefined&&(t=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return v.formatDate(e,t,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=this.picker.outerWidth(),r=this.picker.outerHeight(),i=10,s=n.width(),o=n.height(),u=n.scrollTop(),a=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,f=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=f.left,p=f.top;this.picker.removeClass("ai1ec-datepicker-orient-top ai1ec-datepicker-orient-bottom ai1ec-datepicker-orient-right ai1ec-datepicker-orient-left"),this.o.orientation.x!=="auto"?(this.picker.addClass("ai1ec-datepicker-orient-"+this.o.orientation.x),this.o.orientation.x==="right"&&(h-=t-c)):(this.picker.addClass("ai1ec-datepicker-orient-left"),f.left<0?h-=f.left-i:f.left+t>s&&(h=s-t-i));var d=this.o.orientation.y,v,m;d==="auto"&&(v=-u+f.top-r,m=u+o-(f.top+l+r),Math.max(v,m)===m?d="top":d="bottom"),this.picker.addClass("ai1ec-datepicker-orient-"+d),d==="top"?p+=l:p-=r+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:h,zIndex:a})},_allow_update:!0,update:function(){if(!this._allow_update)return;var t=this.dates.copy(),n=[],r=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),r=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n&&this.o.multidate?n=n.split(this.o.multidateSeparator):n=[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return v.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),r?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="ai1ec-cw">&nbsp;</th>';t+=n,this.picker.find(".ai1ec-datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7)t+='<th class="ai1ec-dow">'+d[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".ai1ec-datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="ai1ec-month">'+d[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".ai1ec-datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i?n.push("ai1ec-old"):(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i)&&n.push("ai1ec-new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("ai1ec-focused"),this.o.todayHighlight&&t.getUTCFullYear()==s.getFullYear()&&t.getUTCMonth()==s.getMonth()&&t.getUTCDate()==s.getDate()&&n.push("ai1ec-today"),this.dates.contains(t)!==-1&&n.push("ai1ec-active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("ai1ec-disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("ai1ec-range"),e.inArray(t.valueOf(),this.range)!=-1&&n.push("ai1ec-selected")),n},fill:function(){var t=new Date(this.viewDate),n=t.getUTCFullYear(),i=t.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f,l;this.picker.find(".ai1ec-datepicker-days thead th.ai1ec-datepicker-switch").text(d[this.o.language].months[i]+" "+n),this.picker.find("tfoot th.ai1ec-today").text(d[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.ai1ec-clear").text(d[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var c=r(n,i-1,28),h=v.getDaysInMonth(c.getUTCFullYear(),c.getUTCMonth());c.setUTCDate(h),c.setUTCDate(h-(c.getUTCDay()-this.o.weekStart+7)%7);var p=new Date(c);p.setUTCDate(p.getUTCDate()+42),p=p.valueOf();var m=[],g;while(c.valueOf()<p){if(c.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+c+(this.o.weekStart-c.getUTCDay()-7)%7*864e5),b=new Date(+y+(11-y.getUTCDay())%7*864e5),w=new Date(+(w=r(b.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="ai1ec-cw">'+E+"</td>")}}g=this.getClassNames(c),g.push("ai1ec-day");if(this.o.beforeShowDay!==e.noop){var S=this.o.beforeShowDay(this._utc_to_local(c));S===undefined?S={}:typeof S=="boolean"?S={enabled:S}:typeof S=="string"&&(S={classes:S}),S.enabled===!1&&g.push("ai1ec-disabled"),S.classes&&(g=g.concat(S.classes.split(/\s+/))),S.tooltip&&(f=S.tooltip)}g=e.unique(g),m.push('<td class="'+g.join(" ")+'"'+(f?' title="'+f+'"':"")+">"+c.getUTCDate()+"</td>"),c.getUTCDay()==this.o.weekEnd&&m.push("</tr>"),c.setUTCDate(c.getUTCDate()+1)}this.picker.find(".ai1ec-datepicker-days tbody").empty().append(m.join(""));var x=this.picker.find(".ai1ec-datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("ai1ec-active");e.each(this.dates,function(e,t){t.getUTCFullYear()==n&&x.eq(t.getUTCMonth()).addClass("ai1ec-active")}),(n<s||n>u)&&x.addClass("ai1ec-disabled"),n==s&&x.slice(0,o).addClass("ai1ec-disabled"),n==u&&x.slice(a+1).addClass("ai1ec-disabled"),m="",n=parseInt(n/10,10)*10;var T=this.picker.find(".ai1ec-datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;var N=e.map(this.dates,function(e){return e.getUTCFullYear()}),C;for(var k=-1;k<11;k++)C=["ai1ec-year"],k===-1?C.push("ai1ec-old"):k===10&&C.push("ai1ec-new"),e.inArray(n,N)!==-1&&C.push("ai1ec-active"),(n<s||n>u)&&C.push("ai1ec-disabled"),m+='<span class="'+C.join(" ")+'">'+n+"</span>",n+=1;T.html(m)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".ai1ec-prev").css({visibility:"hidden"}):this.picker.find(".ai1ec-prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".ai1ec-next").css({visibility:"hidden"}):this.picker.find(".ai1ec-next").css({visibility:"visible"})}},click:function(t){t.preventDefault();var n=e(t.target).closest("span, td, th"),i,s,o;if(n.length==1)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"ai1ec-datepicker-switch":this.showMode(1);break;case"ai1ec-prev":case"ai1ec-next":var u=v.modes[this.viewMode].navStep*(n[0].className=="ai1ec-prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,u),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,u),this.viewMode===1&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"ai1ec-today":var a=new Date;a=r(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var f=this.o.todayBtn=="linked"?null:"view";this._setDate(a,f);break;case"ai1ec-clear":var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input")),l&&l.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":n.is(".ai1ec-disabled")||(this.viewDate.setUTCDate(1),n.is(".ai1ec-month")?(o=1,s=n.parent().find("span").index(n),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1&&this._setDate(r(i,s,o))):(o=1,s=0,i=parseInt(n.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(r(i,s,o))),this.showMode(-1),this.fill());break;case"td":n.is(".ai1ec-day")&&!n.is(".ai1ec-disabled")&&(o=parseInt(n.text(),10)||1,i=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),n.is(".ai1ec-old")?s===0?(s=11,i-=1):s-=1:n.is(".ai1ec-new")&&(s==11?(s=0,i+=1):s+=1),this._setDate(r(i,s,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);e?t!==-1?this.dates.remove(t):this.dates.push(e):this.dates.clear();if(typeof this.o.multidate=="number")while(this.dates.length>this.o.multidate)this.dates.remove(0)},_setDate:function(e,t){(!t||t=="date")&&this._toggle_multidate(e&&new Date(e));if(!t||t=="view")this.viewDate=e&&new Date(e);this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),this.o.autoclose&&(!t||t=="date")&&this.hide()},moveMonth:function(e,t){if(!e)return undefined;if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,s,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n),s=new Date(o),s.setUTCDate(o.getUTCDate()+n)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(r=this.moveYear(this.dates.get(-1)||i(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(r=this.moveMonth(this.dates.get(-1)||i(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(r=new Date(this.dates.get(-1)||i()),r.setUTCDate(r.getUTCDate()+n*7),s=new Date(o),s.setUTCDate(o.getUTCDate()+n*7)),this.dateWithinRange(r)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:o=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(o),t=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(t){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".ai1ec-datepicker-"+v.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var a=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};a.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(this.updating)return;this.updating=!0;var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1)return;e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(r)});if(r<this.dates[i])while(i>=0&&r<this.dates[i])this.pickers[i--].setUTCDate(r);else if(r>this.dates[i])while(i<s&&r>this.dates[i])this.pickers[i++].setUTCDate(r);this.updateDates(),delete this.updating},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var c=e.fn.datepicker;e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof t=="object"&&t;if(!s){var c=f(this,"date"),p=e.extend({},h,c,o),d=l(p.language),v=e.extend({},h,d,c,o);if(i.is(".ai1ec-input-daterange")||v.inputs){var m={inputs:v.inputs||i.find("input").toArray()};i.data("datepicker",s=new a(this,e.extend(v,m)))}else i.data("datepicker",s=new u(this,v))}if(typeof t=="string"&&typeof s[t]=="function"){r=s[t].apply(s,n);if(r!==undefined)return!1}}),r!==undefined?r:this};var h=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=u;var d=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},v={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,v.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(t,n,i){if(!t)return undefined;if(t instanceof Date)return t;typeof n=="string"&&(n=v.parseFormat(n));if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){var s=/([\-+]\d+)([dmwy])/,o=t.match(/([\-+]\d+)([dmwy])/g),a,f;t=new Date;for(var l=0;l<o.length;l++){a=s.exec(o[l]),f=parseInt(a[1]);switch(a[2]){case"d":t.setUTCDate(t.getUTCDate()+f);break;case"m":t=u.prototype.moveMonth.call(u.prototype,t,f);break;case"w":t.setUTCDate(t.getUTCDate()+f*7);break;case"y":t=u.prototype.moveYear.call(u.prototype,t,f)}}return r(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}var o=t&&t.match(this.nonpunctuation)||[],t=new Date,c={},h=["yyyy","yy","M","MM","m","mm","d","dd"],p={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;p.M=p.MM=p.mm=p.m,p.dd=p.d,t=r(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var y=n.parts.slice();o.length!=y.length&&(y=e(y).filter(function(t,n){return e.inArray(n,h)!==-1}).toArray());if(o.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(o[l],10),a=y[l];if(isNaN(m))switch(a){case"MM":g=e(d[i].months).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].months)+1;break;case"M":g=e(d[i].monthsShort).filter(function(){var e=this.slice(0,o[l].length),t=o[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],d[i].monthsShort)+1}c[a]=m}for(var l=0,w,E;l<h.length;l++)E=h[l],E in c&&!isNaN(c[E])&&(w=new Date(t),p[E](w,c[E]),isNaN(w)||(t=w))}return t},formatDate:function(t,n,r){if(!t)return"";typeof n=="string"&&(n=v.parseFormat(n));var i={d:t.getUTCDate(),D:d[r].daysShort[t.getUTCDay()],DD:d[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:d[r].monthsShort[t.getUTCMonth()],MM:d[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="ai1ec-prev"><i class="ai1ec-fa ai1ec-fa-arrow-left"></i></th><th colspan="5" class="ai1ec-datepicker-switch"></th><th class="ai1ec-next"><i class="ai1ec-fa ai1ec-fa-arrow-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="ai1ec-today"></th></tr><tr><th colspan="7" class="ai1ec-clear"></th></tr></tfoot>'};v.template='<div class="timely ai1ec-datepicker"><div class="ai1ec-datepicker-days"><table class=" ai1ec-table-condensed">'+v.headTemplate+"<tbody></tbody>"+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-months">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+'<div class="ai1ec-datepicker-years">'+'<table class="ai1ec-table-condensed">'+v.headTemplate+v.contTemplate+v.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=v,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=c,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),n.datepicker("show")}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()});for(var m=2,g=arguments.length;m<g;m++)arguments[m].localize()});

==================================================
FILE PATH: ./public/js/external_libs/constrained_popover.js
==================================================
timely.define(["jquery_timely","external_libs/bootstrap/popover"],function(e){var t=function(e,t){this.init("constrained_popover",e,t)};t.DEFAULTS=e.extend({},e.fn.popover.Constructor.DEFAULTS,{container:"",content:this.options}),t.prototype=e.extend({},e.fn.popover.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.applyPlacement=function(t,n){e.fn.popover.Constructor.prototype.applyPlacement.call(this,t,n);var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=this.getPosition(),u={};switch(n){case"left":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left-i:u.left=newPos.left-i,r.offset(u);break;case"right":newPos=this.defineBounds(o),typeof newPos.top=="undefined"?u.top=o.top+o.height/2-s/2:u.top=newPos.top-s/2,typeof newPos.left=="undefined"?u.left=o.left+o.width:u.left=newPos.left+o.width,r.offset(u)}},t.prototype.defineBounds=function(t){var n,r,i,s,o,u={},a=e("body"===this.options.container?document:this.options.container);return a.length?(n=a.offset()||{top:0,left:0},r=n.top,i=n.left,s=r+a.height(),o=i+a.width(),t.top+t.height/2<r&&(u.top=r),t.top+t.height/2>s&&(u.top=s),t.left-t.width/2<i&&(u.left=i),t.left-t.width/2>o&&(u.left=o),u):!1};var n=e.fn.popover;e.fn.constrained_popover=function(n){return this.each(function(){var r=e(this),i=r.data("ai1ec.constrained_popover"),s=typeof n=="object"&&n;i||r.data("ai1ec.constrained_popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.constrained_popover.Constructor=t,e.fn.constrained_popover.noConflict=function(){return e.fn.constrained_popover=n,this}});

==================================================
FILE PATH: ./public/js/external_libs/geo_autocomplete.js
==================================================
timely.define(["jquery_timely","external_libs/jquery.autocomplete_geomod"],function(e){e.fn.extend({geo_autocomplete:function(t,n){return options=e.extend({},e.Autocompleter.defaults,{geocoder:t,mapwidth:100,mapheight:100,maptype:"terrain",mapkey:"ABQIAAAAbnvDoAoYOSW2iqoXiGTpYBT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQNumU68AwGqjbSNF9YO8NokKst8w",mapsensor:!1,parse:function(t,n,r){var i=[];return t&&n&&n=="OK"&&e.each(t,function(t,n){if(n.geometry&&n.geometry.viewport){var s=n.formatted_address.split(","),o=s[0];e.each(s,function(t,n){if(n.toLowerCase().indexOf(r.toLowerCase())!=-1)return o=e.trim(n),!1}),i.push({data:n,value:o,result:o})}}),i},formatItem:function(e,t,n,r){var i="https://maps.google.com/maps/api/staticmap?visible="+e.geometry.viewport.getSouthWest().toUrlValue()+"|"+e.geometry.viewport.getNorthEast().toUrlValue()+"&size="+options.mapwidth+"x"+options.mapheight+"&maptype="+options.maptype+"&key="+options.mapkey+"&sensor="+(options.mapsensor?"true":"false"),s=e.formatted_address.replace(/,/gi,",<br/>");return'<img src="'+i+'" width="'+options.mapwidth+'" height="'+options.mapheight+'" /> '+s+'<br clear="both"/>'}},n),options.highlight=options.highlight||function(e){return e},options.formatMatch=options.formatMatch||options.formatItem,options.resultsClass="ai1ec-geo-ac-results-not-ready",this.each(function(){e(this).one("focus",function(){var t=setInterval(function(){var n=e(".ai1ec-geo-ac-results-not-ready");n.length&&(n.removeClass("ai1ec-geo-ac-results-not-ready").addClass("ai1ec-geo-ac-results").children("ul").addClass("ai1ec-dropdown-menu"),clearInterval(t))},500)}),new e.Autocompleter(this,options)})}})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap_colorpicker.js
==================================================
timely.define(["jquery_timely"],function(e){var t=function(e){this.value={h:1,s:1,b:1,a:1},this.setColor(e)};t.prototype={constructor:t,setColor:function(t){t=t.toLowerCase();var n=this;e.each(r.stringParsers,function(e,i){var s=i.re.exec(t),o=s&&i.parse(s),u=i.space||"rgba";if(o)return u=="hsla"?n.value=r.RGBtoHSB.apply(null,r.HSLtoRGB.apply(null,o)):n.value=r.RGBtoHSB.apply(null,o),!1})},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt((1-e)*100,10)/100},toRGB:function(e,t,n,r){e||(e=this.value.h,t=this.value.s,n=this.value.b),e*=360;var i,s,o,u,a;return e=e%360/60,a=n*t,u=a*(1-Math.abs(e%2-1)),i=s=o=n-a,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],{r:Math.round(i*255),g:Math.round(s*255),b:Math.round(o*255),a:r||this.value.a}},toHex:function(e,t,n,r){var i=this.toRGB(e,t,n,r);return"#"+(1<<24|parseInt(i.r)<<16|parseInt(i.g)<<8|parseInt(i.b)).toString(16).substr(1)},toHSL:function(e,t,n,r){e||(e=this.value.h,t=this.value.s,n=this.value.b);var i=e,s=(2-t)*n,o=t*n;return s>0&&s<=1?o/=s:o/=2-s,s/=2,o>1&&(o=1),{h:i,s:o,l:s,a:r||this.value.a}}};var n=function(t,n){this.element=e(t);var i=n.format||this.element.data("color-format")||"hex";this.format=r.translateFormats[i],this.isInput=this.element.is("input"),this.component=this.element.is(".color")?this.element.find(".ai1ec-input-group-addon"):!1,this.picker=e(r.template).appendTo("body").on("mousedown",e.proxy(this.mousedown,this)),this.isInput?this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on({click:e.proxy(this.show,this)}):this.element.on({click:e.proxy(this.show,this)});if(i=="rgba"||i=="hsla")this.picker.addClass("alpha"),this.alpha=this.picker.find(".colorpicker-alpha")[0].style;this.component?(this.picker.find(".colorpicker-color").hide(),this.preview=this.element.find("i")[0].style):this.preview=this.picker.find("div:last")[0].style,this.base=this.picker.find("div:first")[0].style,this.update()};n.prototype={constructor:n,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),this.isInput||t&&(t.stopPropagation(),t.preventDefault()),e(document).on({mousedown:e.proxy(this.hide,this)}),this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new t(this.isInput?this.element.prop("value"):this.element.data("color")),this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a)),this.previewColor()},hide:function(){this.picker.hide(),e(window).off("resize",this.place),this.isInput?this.element.prop("value",this.format.call(this)):(e(document).off({mousedown:this.hide}),this.component&&this.element.find("input").prop("value",this.format.call(this)),this.element.data("color",this.format.call(this))),this.element.trigger({type:"hide",color:this.color})},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},previewColor:function(){this.preview.backgroundColor=this.format.call(this),this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1),this.alpha&&(this.alpha.backgroundColor=this.color.toHex())},pointer:null,slider:null,mousedown:function(t){t.stopPropagation(),t.preventDefault();var n=e(t.target),i=n.closest("div");if(!i.is(".colorpicker")){i.is(".colorpicker-saturation")?this.slider=e.extend({},r.sliders.saturation):i.is(".colorpicker-hue")?this.slider=e.extend({},r.sliders.hue):i.is(".colorpicker-alpha")&&(this.slider=e.extend({},r.sliders.alpha));var s=i.offset();this.slider.knob=i.find("i")[0].style,this.slider.left=t.pageX-s.left,this.slider.top=t.pageY-s.top,this.pointer={left:t.pageX,top:t.pageY},e(document).on({mousemove:e.proxy(this.mousemove,this),mouseup:e.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((e.pageX||this.pointer.left)-this.pointer.left))),n=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((e.pageY||this.pointer.top)-this.pointer.top)));return this.slider.knob.left=t+"px",this.slider.knob.top=n+"px",this.slider.callLeft&&this.color[this.slider.callLeft].call(this.color,t/100),this.slider.callTop&&this.color[this.slider.callTop].call(this.color,n/100),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),e(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),!1}},e.fn.colorpicker=function(t){return this.each(function(){var r=e(this),i=r.data("colorpicker"),s=typeof t=="object"&&t;i||r.data("colorpicker",i=new n(this,e.extend({},e.fn.colorpicker.defaults,s))),typeof t=="string"&&i[t]()})},e.fn.colorpicker.defaults={},e.fn.colorpicker.Constructor=n;var r={translateFormats:{rgb:function(){var e=this.color.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.color.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hsl:function(){var e=this.color.toHSL();return"hsl("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%)"},hsla:function(){var e=this.color.toHSL();return"hsla("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%,"+e.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},RGBtoHSB:function(e,t,n,r){e/=255,t/=255,n/=255;var i,s,o,u;return o=Math.max(e,t,n),u=o-Math.min(e,t,n),i=u==0?null:o==e?(t-n)/u:o==t?(n-e)/u+2:(e-t)/u+4,i=(i+360)%6*60/360,s=u==0?0:u/o,{h:i||1,s:s,b:o,a:r||1}},HueToRGB:function(e,t,n){return n<0?n+=1:n>1&&(n-=1),n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e},HSLtoRGB:function(e,t,n,i){t<0&&(t=0);if(n<=.5)var s=n*(1+t);else var s=n+t-n*t;var o=2*n-s,u=e+1/3,a=e,f=e-1/3,l=Math.round(r.HueToRGB(o,s,u)*255),c=Math.round(r.HueToRGB(o,s,a)*255),h=Math.round(r.HueToRGB(o,s,f)*255);return[l,c,h,i||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}}],template:'<div class="colorpicker ai1ec-dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}});

==================================================
FILE PATH: ./public/js/external_libs/twig.js
==================================================
/**
 * Twig.js 0.7.2
 *
 * @copyright 2011-2013 John Roepke
 * @license   Available under the BSD 2-Clause License
 * @link      https://github.com/justjohn/twig.js
 */

//     Twig.js
//     Copyright (c) 2011-2013 John Roepke
//     Available under the BSD 2-Clause License
//     https://github.com/justjohn/twig.js

// The following methods are from MDN and are available under a
// [MIT License](http://www.opensource.org/licenses/mit-license.php) or are
// [Public Domain](https://developer.mozilla.org/Project:Copyrights).
//
// See:
// * [Object.keys - MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)

// ## twig.lib.js
//
// This file contains 3rd party libraries used within twig.
//
// Copies of the licenses for the code included here can be found in the
// LICENSES.md file.
//

/**
     * jPaq - A fully customizable JavaScript/JScript library
     * http://jpaq.org/
     *
     * Copyright (c) 2011 Christopher West
     * Licensed under the MIT license.
     * http://jpaq.org/license/
     *
     * Version: 1.0.6.0000W
     * Revised: April 6, 2011
     */

//     Twig.js
//     Copyright (c) 2011-2013 John Roepke
//                   2012 Hadrien Lanneau
//     Available under the BSD 2-Clause License
//     https://github.com/justjohn/twig.js

var Twig=function(e){return e.VERSION="0.7.2",e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}function n(t,n){var r,i,s="/",o=[],u;if(t.url)typeof t.base!="undefined"?r=t.base+(t.base.charAt(t.base.length-1)==="/"?"":"/"):r=t.url;else{if(!t.path)throw new e.Error("Cannot extend an inline template.");var a=require("path"),f=a.sep||s,l=new RegExp("^\\.{1,2}"+f.replace("\\","\\\\"));n=n.replace(/\//g,f),t.base!==undefined&&n.match(l)==null?(n=n.replace(t.base,""),r=t.base+f):r=t.path,r=r.replace(f+f,f),s=f}i=r.split(s),i.pop(),i=i.concat(n.split(s));while(i.length>0)u=i.shift(),u!="."&&(u==".."&&o.length>0&&o[o.length-1]!=".."?o.pop():o.push(u));return o.join(s)}return e.trace=!1,e.debug=!1,e.cache=!0,e.placeholders={parent:"{{|PARENT|}}"},e.indexOf=function(e,t){if(Array.prototype.hasOwnProperty("indexOf"))return e.indexOf(t);if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(r===0)return-1;var i=0;arguments.length>0&&(i=Number(arguments[1]),i!==i?i=0:i!==0&&i!==Infinity&&i!==-Infinity&&(i=(i>0||-1)*Math.floor(Math.abs(i))));if(i>=r)return-1;var s=i>=0?i:Math.max(r-Math.abs(i),0);for(;s<r;s++)if(s in n&&n[s]===t)return s;return e==t?0:-1},e.forEach=function(e,t,n){if(Array.prototype.forEach)return e.forEach(t,n);var r,i;if(e==null)throw new TypeError(" this is null or not defined");var s=Object(e),o=s.length>>>0;if({}.toString.call(t)!="[object Function]")throw new TypeError(t+" is not a function");n&&(r=n),i=0;while(i<o){var u;i in s&&(u=s[i],t.call(r,u,i,s)),i++}},e.Error=function(e){this.message=e,this.name="TwigException",this.type="TwigException"},e.Error.prototype.toString=function(){var e=this.name+": "+this.message;return e},e.log={trace:function(){e.trace&&console&&console.log(Array.prototype.slice.call(arguments))},debug:function(){e.debug&&console&&console.log(Array.prototype.slice.call(arguments))}},typeof console!="undefined"&&typeof console.log!="undefined"?e.log.error=function(){console.log.apply(console,arguments)}:e.log.error=function(){},e.token={},e.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw"},e.token.definitions=[{type:e.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:e.token.type.output,open:"{{",close:"}}"},{type:e.token.type.logic,open:"{%",close:"%}"},{type:e.token.type.comment,open:"{#",close:"#}"}],e.token.strings=['"',"'"],e.token.findStart=function(t){var n={position:null,def:null},r,i,s;for(r=0;r<e.token.definitions.length;r++)i=e.token.definitions[r],s=t.indexOf(i.open),e.log.trace("Twig.token.findStart: ","Searching for ",i.open," found at ",s),s>=0&&(n.position===null||s<n.position)&&(n.position=s,n.def=i);return n},e.token.findEnd=function(t,n,r){var i=null,s=!1,o=0,u=null,a=null,f=null,l=null,c=null,h=null,p,d;while(!s){u=null,a=null,f=t.indexOf(n.close,o);if(!(f>=0))throw new e.Error("Unable to find closing bracket '"+n.close+"'"+" opened near template position "+r);i=f,s=!0;if(n.type===e.token.type.comment)break;d=e.token.strings.length;for(p=0;p<d;p+=1)c=t.indexOf(e.token.strings[p],o),c>0&&c<f&&(u===null||c<u)&&(u=c,a=e.token.strings[p]);if(u!==null){l=u+1,i=null,s=!1;for(;;){h=t.indexOf(a,l);if(h<0)throw"Unclosed string in template";if(t.substr(h-1,1)!=="\\"){o=h+1;break}l=h+1}}}return i},e.tokenize=function(t){var n=[],r=0,i=null,s=null;while(t.length>0)i=e.token.findStart(t),e.log.trace("Twig.tokenize: ","Found token: ",i),i.position!==null?(i.position>0&&n.push({type:e.token.type.raw,value:t.substring(0,i.position)}),t=t.substr(i.position+i.def.open.length),r+=i.position+i.def.open.length,s=e.token.findEnd(t,i.def,r),e.log.trace("Twig.tokenize: ","Token ends at ",s),n.push({type:i.def.type,value:t.substring(0,s).trim()}),i.def.type==="logic"&&t.substr(s+i.def.close.length,1)==="\n"&&(s+=1),t=t.substr(s+i.def.close.length),r+=s+i.def.close.length):(n.push({type:e.token.type.raw,value:t}),t="");return n},e.compile=function(t){try{var n=[],r=[],i=[],s=null,o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null;while(t.length>0){s=t.shift(),e.log.trace("Compiling token ",s);switch(s.type){case e.token.type.raw:r.length>0?i.push(s):n.push(s);break;case e.token.type.logic:o=e.logic.compile.apply(this,[s]),c=o.type,h=e.logic.handler[c].open,p=e.logic.handler[c].next,e.log.trace("Twig.compile: ","Compiled logic token to ",o," next is: ",p," open is : ",h);if(h!==undefined&&!h){a=r.pop(),f=e.logic.handler[a.type];if(e.indexOf(f.next,c)<0)throw new Error(c+" not expected after a "+a.type);a.output=a.output||[],a.output=a.output.concat(i),i=[],l={type:e.token.type.logic,token:a},r.length>0?i.push(l):n.push(l)}p!==undefined&&p.length>0?(e.log.trace("Twig.compile: ","Pushing ",o," to logic stack."),r.length>0&&(a=r.pop(),a.output=a.output||[],a.output=a.output.concat(i),r.push(a),i=[]),r.push(o)):h!==undefined&&h&&(l={type:e.token.type.logic,token:o},r.length>0?i.push(l):n.push(l));break;case e.token.type.comment:break;case e.token.type.output:e.expression.compile.apply(this,[s]),r.length>0?i.push(s):n.push(s)}e.log.trace("Twig.compile: "," Output: ",n," Logic Stack: ",r," Pending Output: ",i)}if(r.length>0)throw u=r.pop(),new Error("Unable to find an end tag for "+u.type+", expecting one of "+u.next);return n}catch(d){e.log.error("Error compiling twig template "+this.id+": "),d.stack?e.log.error(d.stack):e.log.error(d.toString());if(this.options.rethrow)throw d}},e.parse=function(t,n){try{var r=[],i=!0,s=this;return n=n||{},e.forEach(t,function(o){e.log.debug("Twig.parse: ","Parsing token: ",o);switch(o.type){case e.token.type.raw:r.push(o.value);break;case e.token.type.logic:var u=o.token,a=e.logic.parse.apply(s,[u,n,i]);a.chain!==undefined&&(i=a.chain),a.context!==undefined&&(n=a.context),a.output!==undefined&&r.push(a.output);break;case e.token.type.comment:break;case e.token.type.output:e.log.debug("Twig.parse: ","Output token: ",o.stack),r.push(e.expression.parse.apply(s,[o.stack,n]))}}),r.join("")}catch(o){e.log.error("Error parsing twig template "+this.id+": "),o.stack?e.log.error(o.stack):e.log.error(o.toString());if(this.options.rethrow)throw o;if(e.debug)return o.toString()}},e.prepare=function(t){var n,r;return e.log.debug("Twig.prepare: ","Tokenizing ",t),r=e.tokenize.apply(this,[t]),e.log.debug("Twig.prepare: ","Compiling ",r),n=e.compile.apply(this,[r]),e.log.debug("Twig.prepare: ","Compiled ",n),n},e.Templates={registry:{}},e.validateId=function(t){if(t==="prototype")throw new e.Error(t+" is not a valid twig identifier");if(e.Templates.registry.hasOwnProperty(t))throw new e.Error("There is already a template with the ID "+t);return!0},e.Templates.save=function(t){if(t.id===undefined)throw new e.Error("Unable to save template with no id");e.Templates.registry[t.id]=t},e.Templates.load=function(t){return e.Templates.registry.hasOwnProperty(t)?e.Templates.registry[t]:null},e.Templates.loadRemote=function(t,n,r,i){var s=n.id,o=n.method,u=n.async,a=n.precompiled,f=null;u===undefined&&(u=!0),s===undefined&&(s=t),n.id=s;if(e.cache&&e.Templates.registry.hasOwnProperty(s))return r&&r(e.Templates.registry[s]),e.Templates.registry[s];if(o=="ajax"){if(typeof XMLHttpRequest=="undefined")throw new e.Error("Unsupported platform: Unable to do remote requests because there is no XMLHTTPRequest implementation");var l=new XMLHttpRequest;l.onreadystatechange=function(){var s=null;l.readyState==4&&(l.status==200?(e.log.debug("Got template ",l.responseText),a===!0?s=JSON.parse(l.responseText):s=l.responseText,n.url=t,n.data=s,f=new e.Template(n),r&&r(f)):i&&i(l))},l.open("GET",t,u),l.send()}else(function(){var s=require("fs"),o=require("path"),l=null,c=function(s,o){if(s){i&&i(s);return}a===!0&&(o=JSON.parse(o)),n.data=o,n.path=t,f=new e.Template(n),r&&r(f)};if(u===!0)s.stat(t,function(n,r){if(n||!r.isFile())throw new e.Error("Unable to find template file "+t);s.readFile(t,"utf8",c)});else{if(!s.statSync(t).isFile())throw new e.Error("Unable to find template file "+t);l=s.readFileSync(t,"utf8"),c(undefined,l)}})();return u===!1?f:!0},e.Template=function(n){var r=n.data,i=n.id,s=n.blocks,o=n.macros||{},u=n.base,a=n.path,f=n.url,l=n.options;this.id=i,this.base=u,this.path=a,this.url=f,this.macros=o,this.options=l,this.reset(s),t("String",r)?this.tokens=e.prepare.apply(this,[r]):this.tokens=r,i!==undefined&&e.Templates.save(this)},e.Template.prototype.reset=function(t){e.log.debug("Twig.Template.reset","Reseting template "+this.id),this.blocks={},this.child={blocks:t||{}},this.extend=null},e.Template.prototype.render=function(t,r){r=r||{};var i,s;this.context=t||{},this.reset(),r.blocks&&(this.blocks=r.blocks),r.macros&&(this.macros=r.macros),i=e.parse.apply(this,[this.tokens,this.context]);if(this.extend){var o;return this.options.allowInlineIncludes&&(o=e.Templates.load(this.extend),o&&(o.options=this.options)),o||(s=n(this,this.extend),o=e.Templates.loadRemote(s,{method:this.url?"ajax":"fs",base:this.base,async:!1,id:s,options:this.options})),this.parent=o,this.parent.render(this.context,{blocks:this.blocks})}return r.output=="blocks"?this.blocks:r.output=="macros"?this.macros:i},e.Template.prototype.importFile=function(t){var r,i;if(!this.url&&!this.path&&this.options.allowInlineIncludes){i=e.Templates.load(t),i.options=this.options;if(i)return i;throw new e.Error("Didn't find the inline template by id")}return r=n(this,t),i=e.Templates.loadRemote(r,{method:this.url?"ajax":"fs",base:this.base,async:!1,options:this.options,id:r}),i},e.Template.prototype.importBlocks=function(t,n){var r=this.importFile(t),i=this.context,s=this,o;n=n||!1,r.render(i),e.forEach(Object.keys(r.blocks),function(e){if(n||s.blocks[e]===undefined)s.blocks[e]=r.blocks[e]})},e.Template.prototype.importMacros=function(t){var r=n(this,t),i=e.Templates.loadRemote(r,{method:this.url?"ajax":"fs",async:!1,id:r});return i},e.Template.prototype.compile=function(t){return e.compiler.compile(this,t)},e}(Twig||{});(function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t})})();var Twig=function(e){e.lib={};var t=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function n(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};return r.format=function(r,i){var s=1,o=r.length,u="",a,f=[],l,c,h,p,d,v;for(l=0;l<o;l++){u=e(r[l]);if(u==="string")f.push(r[l]);else if(u==="array"){h=r[l];if(h[2]){a=i[s];for(c=0;c<h[2].length;c++){if(!a.hasOwnProperty(h[2][c]))throw t('[sprintf] property "%s" does not exist',h[2][c]);a=a[h[2][c]]}}else h[1]?a=i[h[1]]:a=i[s++];if(/[^s]/.test(h[8])&&e(a)!="number")throw t("[sprintf] expecting number but found %s",e(a));switch(h[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=h[7]?a.toExponential(h[7]):a.toExponential();break;case"f":a=h[7]?parseFloat(a).toFixed(h[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&h[7]?a.substring(0,h[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(h[8])&&h[3]&&a>=0?"+"+a:a,d=h[4]?h[4]=="0"?"0":h[4].charAt(1):" ",v=h[6]-String(a).length,p=h[6]?n(d,v):"",f.push(h[5]?a+p:p+a)}}return f.join("")},r.cache={},r.parse=function(e){var t=e,n=[],r=[],i=0;while(t){if((n=/^[^\x25]+/.exec(t))!==null)r.push(n[0]);else if((n=/^\x25{2}/.exec(t))!==null)r.push("%");else{if((n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))===null)throw"[sprintf] huh?";if(n[2]){i|=1;var s=[],o=n[2],u=[];if((u=/^([a-z_][a-z_\d]*)/i.exec(o))===null)throw"[sprintf] huh?";s.push(u[1]);while((o=o.substring(u[0].length))!=="")if((u=/^\.([a-z_][a-z_\d]*)/i.exec(o))!==null)s.push(u[1]);else{if((u=/^\[(\d+)\]/.exec(o))===null)throw"[sprintf] huh?";s.push(u[1])}n[2]=s}else i|=2;if(i===3)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},r}(),n=function(e,n){return n.unshift(e),t.apply(null,n)};return e.lib.sprintf=t,e.lib.vsprintf=n,function(){function s(e){return(e=Math.abs(e)%100)%10==1&&e!=11?"st":e%10==2&&e!=12?"nd":e%10==3&&e!=13?"rd":"th"}function o(e){var t=new Date(e.getFullYear()+1,0,4);return(t-e)/864e5<7&&(e.getDay()+6)%7<(t.getDay()+6)%7?t.getFullYear():e.getMonth()>0||e.getDate()>=4?e.getFullYear():e.getFullYear()-((e.getDay()+6)%7-e.getDate()>2?1:0)}function u(e){var t=new Date(o(e),0,4);return t.setDate(t.getDate()-(t.getDay()+6)%7),parseInt((e-t)/6048e5)+1}var t="Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),n="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),r="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),i="January,February,March,April,May,June,July,August,September,October,November,December".split(",");e.lib.formatDate=function(e,a){if(typeof a!="string"||/^\s*$/.test(a))return e+"";var f=new Date(e.getFullYear(),0,1),l=e;return a.replace(/[dDjlNSwzWFmMntLoYyaABgGhHisuU]/g,function(e){switch(e){case"d":return("0"+l.getDate()).replace(/^.+(..)$/,"$1");case"D":return t[l.getDay()];case"j":return l.getDate();case"l":return n[l.getDay()];case"N":return(l.getDay()+6)%7+1;case"S":return s(l.getDate());case"w":return l.getDay();case"z":return Math.ceil((f-l)/864e5);case"W":return("0"+u(l)).replace(/^.(..)$/,"$1");case"F":return i[l.getMonth()];case"m":return("0"+(l.getMonth()+1)).replace(/^.+(..)$/,"$1");case"M":return r[l.getMonth()];case"n":return l.getMonth()+1;case"t":return(new Date(l.getFullYear(),l.getMonth()+1,-1)).getDate();case"L":return(new Date(l.getFullYear(),1,29)).getDate()==29?1:0;case"o":return o(l);case"Y":return l.getFullYear();case"y":return(l.getFullYear()+"").replace(/^.+(..)$/,"$1");case"a":return l.getHours()<12?"am":"pm";case"A":return l.getHours()<12?"AM":"PM";case"B":return Math.floor(((l.getUTCHours()+1)%24+l.getUTCMinutes()/60+l.getUTCSeconds()/3600)*1e3/24);case"g":return l.getHours()%12!=0?l.getHours()%12:12;case"G":return l.getHours();case"h":return("0"+(l.getHours()%12!=0?l.getHours()%12:12)).replace(/^.+(..)$/,"$1");case"H":return("0"+l.getHours()).replace(/^.+(..)$/,"$1");case"i":return("0"+l.getMinutes()).replace(/^.+(..)$/,"$1");case"s":return("0"+l.getSeconds()).replace(/^.+(..)$/,"$1");case"u":return l.getMilliseconds();case"U":return l.getTime()/1e3}})}}(),e.lib.strip_tags=function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})},e.lib.parseISO8601Date=function(e){var t=/(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d+)?(Z|([+-])(\d\d):(\d\d))/,n=[];n=e.match(t);if(!n)throw"Couldn't parse ISO 8601 date string '"+e+"'";var r=[1,2,3,4,5,6,10,11];for(var i in r)n[r[i]]=parseInt(n[r[i]],10);n[7]=parseFloat(n[7]);var s=Date.UTC(n[1],n[2]-1,n[3],n[4],n[5],n[6]);n[7]>0&&(s+=Math.round(n[7]*1e3));if(n[8]!="Z"&&n[10]){var o=n[10]*60*60*1e3;n[11]&&(o+=n[11]*60*1e3),n[9]=="-"?s-=o:s+=o}return new Date(s)},e.lib.strtotime=function(t,n){var r,i,s,o,u="";t=t.replace(/\s{2,}|^\s|\s$/g," "),t=t.replace(/[\t\r\n]/g,"");if(t==="now")return n===null||isNaN(n)?(new Date).getTime()/1e3|0:n|0;if(!isNaN(u=Date.parse(t)))return u/1e3|0;n?n=new Date(n*1e3):n=new Date;var a=t;t=t.toLowerCase();var f={day:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},mon:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]},l=function(e){var t=e[2]&&e[2]==="ago",r=(r=e[0]==="last"?-1:1)*(t?-1:1);switch(e[0]){case"last":case"next":switch(e[1].substring(0,3)){case"yea":n.setFullYear(n.getFullYear()+r);break;case"wee":n.setDate(n.getDate()+r*7);break;case"day":n.setDate(n.getDate()+r);break;case"hou":n.setHours(n.getHours()+r);break;case"min":n.setMinutes(n.getMinutes()+r);break;case"sec":n.setSeconds(n.getSeconds()+r);break;case"mon":if(e[1]==="month"){n.setMonth(n.getMonth()+r);break};default:var i=f.day[e[1].substring(0,3)];if(typeof i!="undefined"){var s=i-n.getDay();s===0?s=7*r:s>0?e[0]==="last"&&(s-=7):e[0]==="next"&&(s+=7),n.setDate(n.getDate()+s),n.setHours(0,0,0,0)}}break;default:if(!/\d+/.test(e[0]))return!1;r*=parseInt(e[0],10);switch(e[1].substring(0,3)){case"yea":n.setFullYear(n.getFullYear()+r);break;case"mon":n.setMonth(n.getMonth()+r);break;case"wee":n.setDate(n.getDate()+r*7);break;case"day":n.setDate(n.getDate()+r);break;case"hou":n.setHours(n.getHours()+r);break;case"min":n.setMinutes(n.getMinutes()+r);break;case"sec":n.setSeconds(n.getSeconds()+r)}}return!0};s=t.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/);if(s!==null)return s[2]?s[3]||(s[2]+=":00"):s[2]="00:00:00",o=s[1].split(/-/g),o[1]=f.mon[o[1]-1]||o[1],o[0]=+o[0],o[0]=o[0]>=0&&o[0]<=69?"20"+(o[0]<10?"0"+o[0]:o[0]+""):o[0]>=70&&o[0]<=99?"19"+o[0]:o[0]+"",parseInt(this.strtotime(o[2]+" "+o[1]+" "+o[0]+" "+s[2])+(s[4]?s[4]/1e3:""),10);var c="([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?";s=t.match(new RegExp(c,"gi"));if(s===null){try{num=e.lib.parseISO8601Date(a);if(num)return num/1e3|0}catch(h){return!1}return!1}for(r=0,i=s.length;r<i;r++)if(!l(s[r].split(" ")))return!1;return n.getTime()/1e3|0},e.lib.is=function(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e},e.lib.copy=function(e){var t={},n;for(n in e)t[n]=e[n];return t},e.lib.replaceAll=function(e,t,n){return e.split(t).join(n)},e.lib.chunkArray=function(t,n){var r=[],i=0,s=t.length;if(n<1||!e.lib.is("Array",t))return[];while(i<s)r.push(t.slice(i,i+=n));return r},e.lib.round=function(t,n,r){var i,s,o,u;n|=0,i=Math.pow(10,n),t*=i,u=t>0|-(t<0),o=t%1===.5*u,s=Math.floor(t);if(o)switch(r){case"PHP_ROUND_HALF_DOWN":t=s+(u<0);break;case"PHP_ROUND_HALF_EVEN":t=s+s%2*u;break;case"PHP_ROUND_HALF_ODD":t=s+!(s%2);break;default:t=s+(u>0)}return(o?t:Math.round(t))/i},e}(Twig||{}),Twig=function(e){e.logic={},e.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from"},e.logic.definitions=[{type:e.logic.type.if_,regex:/^if\s+([^\s].+)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!0,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i="",s=e.expression.parse.apply(this,[t.stack,n]);return r=!0,s&&(r=!1,i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!1,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i="";return r&&e.expression.parse.apply(this,[t.stack,n])===!0&&(r=!1,i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.else_,regex:/^else$/,next:[e.logic.type.endif,e.logic.type.endfor],open:!1,parse:function(t,n,r){var i="";return r&&(i=e.parse.apply(this,[t.output,n])),{chain:r,output:i}}},{type:e.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:e.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].*?)(?:\s+if\s+([^\s].*))?$/,next:[e.logic.type.else_,e.logic.type.endfor],open:!0,compile:function(t){var n=t.match[1],r=t.match[2],i=t.match[3],s=null;t.key_var=null,t.value_var=null;if(n.indexOf(",")>=0){s=n.split(",");if(s.length!==2)throw new e.Error("Invalid expression in for loop: "+n);t.key_var=s[0].trim(),t.value_var=s[1].trim()}else t.value_var=n;return t.expression=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,i&&(t.conditional=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i}]).stack),delete t.match,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.expression,n]),s=[],o,u=0,a,f=this,l=t.conditional,c=function(e,t){var r=l!==undefined;return{index:e+1,index0:e,revindex:r?undefined:t-e,revindex0:r?undefined:t-e-1,first:e===0,last:r?undefined:e===t-1,length:r?undefined:t,parent:n}},h=function(r,i){var a=e.lib.copy(n);a[t.value_var]=i,t.key_var&&(a[t.key_var]=r),a.loop=c(u,o);if(l===undefined||e.expression.parse.apply(f,[l,a]))s.push(e.parse.apply(f,[t.output,a])),u+=1};return i instanceof Array?(o=i.length,e.forEach(i,function(e){var t=u;h(t,e)})):i instanceof Object&&(i._keys!==undefined?a=i._keys:a=Object.keys(i),o=a.length,e.forEach(a,function(e){if(e==="_keys")return;h(e,i[e])})),r=s.length===0,{chain:r,output:s.join("")}}},{type:e.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:e.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2],i=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack;return t.key=n,t.expression=i,delete t.match,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.expression,n]),s=t.key;return this.context[s]=i,n[s]=i,{chain:r,context:n}}},{type:e.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[e.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=t.key;return this.context[s]=i,n[s]=i,{chain:r,context:n}}},{type:e.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:e.logic.type.filter,regex:/^filter\s+(.+)$/,next:[e.logic.type.endfilter],open:!0,compile:function(t){var n="|"+t.match[1].trim();return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=[{type:e.expression.type.string,value:i}].concat(t.stack),o=e.expression.parse.apply(this,[s,n]);return{chain:r,output:o}}},{type:e.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:e.logic.type.block,regex:/^block\s+([a-zA-Z0-9_]+)$/,next:[e.logic.type.endblock],open:!0,compile:function(e){return e.block=e.match[1].trim(),delete e.match,e},parse:function(t,n,r){var i="",s="",o=this.blocks[t.block]&&this.blocks[t.block].indexOf(e.placeholders.parent)>-1;if(this.blocks[t.block]===undefined||o||n.loop)i=e.expression.parse.apply(this,[{type:e.expression.type.string,value:e.parse.apply(this,[t.output,n])},n]),o?this.blocks[t.block]=this.blocks[t.block].replace(e.placeholders.parent,i):this.blocks[t.block]=i;return this.child.blocks[t.block]?s=this.child.blocks[t.block]:s=this.blocks[t.block],{chain:r,output:s}}},{type:e.logic.type.endblock,regex:/^endblock(?:\s+([a-zA-Z0-9_]+))?$/,next:[],open:!1},{type:e.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.stack,n]);return this.extend=i,{chain:r,output:""}}},{type:e.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i=e.expression.parse.apply(this,[t.stack,n]);return this.importBlocks(i),{chain:r,output:""}}},{type:e.logic.type.include,regex:/^include\s+(ignore missing\s+)?(.+?)\s*(?:with\s+(.+?))?\s*(only)?$/,next:[],open:!0,compile:function(t){var n=t.match,r=n[1]!==undefined,i=n[2].trim(),s=n[3],o=n[4]!==undefined&&n[4].length;return delete t.match,t.only=o,t.includeMissing=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i}]).stack,s!==undefined&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:s.trim()}]).stack),t},parse:function(t,n,r){var i={},s,o,u;if(!t.only)for(o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);if(t.withStack!==undefined){s=e.expression.parse.apply(this,[t.withStack,n]);for(o in s)s.hasOwnProperty(o)&&(i[o]=s[o])}var a=e.expression.parse.apply(this,[t.stack,i]);return u=this.importFile(a),{chain:r,output:u.render(i)}}},{type:e.logic.type.spaceless,regex:/^spaceless$/,next:[e.logic.type.endspaceless],open:!0,parse:function(t,n,r){var i=e.parse.apply(this,[t.output,n]),s=/>\s+</g,o=i.replace(s,"><").trim();return{chain:r,output:o}}},{type:e.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:e.logic.type.macro,regex:/^macro\s+([a-zA-Z0-9_]+)\s?\((([a-zA-Z0-9_]+(,\s?)?)*)\)$/,next:[e.logic.type.endmacro],open:!0,compile:function(t){var n=t.match[1],r=t.match[2].split(/[ ,]+/);for(var i=0;i<r.length;i++)for(var s=0;s<r.length;s++)if(r[i]===r[s]&&i!==s)throw new e.Error("Duplicate arguments for parameter: "+r[i]);return t.macroName=n,t.parameters=r,delete t.match,t},parse:function(t,n,r){var i=this;return this.macros[t.macroName]=function(){var n={_self:i.macros};for(var r=0;r<t.parameters.length;r++){var s=t.parameters[r];typeof arguments[r]!="undefined"?n[s]=arguments[r]:n[s]=undefined}return e.parse.apply(i,[t.output,n])},{chain:r,output:""}}},{type:e.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:e.logic.type.import_,regex:/^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim();return delete t.match,t.expression=n,t.contextName=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){if(t.expression!=="_self"){var i=e.expression.parse.apply(this,[t.stack,n]),s=this.importMacros(i||t.expression);n[t.contextName]=s.render({},{output:"macros"})}else n[t.contextName]=this.macros;return{chain:r,output:""}}},{type:e.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim().split(/[ ,]+/),i={};for(var s=0;s<r.length;s++){var o=r[s],u=o.match(/^([a-zA-Z0-9_]+)\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/);u?i[u[1].trim()]=u[2].trim():o.match(/^([a-zA-Z0-9_]+)$/)&&(i[o]=o)}return delete t.match,t.expression=n,t.macroNames=i,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var i;if(t.expression!=="_self"){var s=e.expression.parse.apply(this,[t.stack,n]),o=this.importMacros(s||t.expression);i=o.render({},{output:"macros"})}else i=this.macros;for(var u in t.macroNames)i.hasOwnProperty(u)&&(n[t.macroNames[u]]=i[u]);return{chain:r,output:""}}}],e.logic.handler={},e.logic.extendType=function(t,n){n=n||"Twig.logic.type"+t,e.logic.type[t]=n},e.logic.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);if(e.logic.type[t.type])throw new e.Error("Unable to extend logic definitions. Type "+t.type+" is already defined.");e.logic.extendType(t.type),e.logic.handler[t.type]=t};while(e.logic.definitions.length>0)e.logic.extend(e.logic.definitions.shift());return e.logic.compile=function(t){var n=t.value.trim(),r=e.logic.tokenize.apply(this,[n]),i=e.logic.handler[r.type];return i.compile&&(r=i.compile.apply(this,[r]),e.log.trace("Twig.logic.compile: ","Compiled logic token to ",r)),r},e.logic.tokenize=function(t){var n={},r=null,i=null,s=null,o=null,u=null,a=null;t=t.trim();for(r in e.logic.handler)if(e.logic.handler.hasOwnProperty(r)){i=e.logic.handler[r].type,s=e.logic.handler[r].regex,o=[],s instanceof Array?o=s:o.push(s);while(o.length>0){u=o.shift(),a=u.exec(t.trim());if(a!==null)return n.type=i,n.match=a,e.log.trace("Twig.logic.tokenize: ","Matched a ",i," regular expression of ",a),n}}throw new e.Error("Unable to parse '"+t.trim()+"'")},e.logic.parse=function(t,n,r){var i="",s;return n=n||{},e.log.debug("Twig.logic.parse: ","Parsing logic token ",t),s=e.logic.handler[t.type],s.parse&&(i=s.parse.apply(this,[t,n,r])),i},e}(Twig||{}),Twig=function(e){e.expression={},e.expression.reservedWords=["true","false","null","_context"],e.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},e.expression.set={operations:[e.expression.type.filter,e.expression.type.operator.unary,e.expression.type.operator.binary,e.expression.type.array.end,e.expression.type.object.end,e.expression.type.parameter.end,e.expression.type.comma,e.expression.type.test],expressions:[e.expression.type._function,e.expression.type.bool,e.expression.type.string,e.expression.type.variable,e.expression.type.number,e.expression.type._null,e.expression.type.context,e.expression.type.parameter.start,e.expression.type.array.start,e.expression.type.object.start]},e.expression.set.operations_extended=e.expression.set.operations.concat([e.expression.type.key.period,e.expression.type.key.brackets]),e.expression.fn={compile:{push:function(e,t,n){n.push(e)},push_both:function(e,t,n){n.push(e),t.push(e)}},parse:{push:function(e,t,n){t.push(e)},push_value:function(e,t,n){t.push(e.value)}}},e.expression.definitions=[{type:e.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*)/,next:e.expression.set.operations.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=n.pop(),s=t.params&&e.expression.parse.apply(this,[t.params,r]),o=e.test(t.filter,i,s);t.modifier=="not"?n.push(!o):n.push(o)}},{type:e.expression.type.comma,regex:/^,/,next:e.expression.set.expressions.concat([e.expression.type.array.end,e.expression.type.object.end]),compile:function(t,n,r){var i=n.length-1,s;delete t.match,delete t.value;for(;i>=0;i--){s=n.pop();if(s.type===e.expression.type.object.start||s.type===e.expression.type.parameter.start||s.type===e.expression.type.array.start){n.push(s);break}r.push(s)}r.push(t)}},{type:e.expression.type.operator.binary,regex:/(^[\+\-~%\?\:]|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^and\s+|^or\s+|^in\s+|^not in\s+|^\.\.)/,next:e.expression.set.expressions.concat([e.expression.type.operator.unary]),compile:function(t,n,r){delete t.match,t.value=t.value.trim();var i=t.value,s=e.expression.operator.lookup(i,t);e.log.trace("Twig.expression.compile: ","Operator: ",s," from ",i);while(n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(s.associativity===e.expression.operator.leftToRight&&s.precidence>=n[n.length-1].precidence||s.associativity===e.expression.operator.rightToLeft&&s.precidence>n[n.length-1].precidence)){var o=n.pop();r.push(o)}if(i===":"){if(!n[n.length-1]||n[n.length-1].value!=="?"){var u=r.pop();if(u.type!==e.expression.type.string&&u.type!==e.expression.type.variable&&u.type!==e.expression.type.number)throw new e.Error("Unexpected value before ':' of "+u.type+" = "+u.value);t.key=u.value,r.push(t);return}}else n.push(s)},parse:function(t,n,r){t.key?n.push(t):e.expression.operator.parse(t.value,n)}},{type:e.expression.type.operator.unary,regex:/(^not\s+)/,next:e.expression.set.expressions,compile:function(t,n,r){delete t.match,t.value=t.value.trim();var i=t.value,s=e.expression.operator.lookup(i,t);e.log.trace("Twig.expression.compile: ","Operator: ",s," from ",i);while(n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(s.associativity===e.expression.operator.leftToRight&&s.precidence>=n[n.length-1].precidence||s.associativity===e.expression.operator.rightToLeft&&s.precidence>n[n.length-1].precidence)){var o=n.pop();r.push(o)}n.push(s)},parse:function(t,n,r){e.expression.operator.parse(t.value,n)}},{type:e.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2.)*?\1/,next:e.expression.set.operations,compile:function(t,n,r){var i=t.value;delete t.match,i.substring(0,1)==='"'?i=i.replace('\\"','"'):i=i.replace("\\'","'"),t.value=i.substring(1,i.length-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),e.log.trace("Twig.expression.compile: ","String value: ",t.value),r.push(t)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.parameter.start,regex:/^\(/,next:e.expression.set.expressions.concat([e.expression.type.parameter.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.parameter.end,regex:/^\)/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i,s=t;i=n.pop();while(n.length>0&&i.type!=e.expression.type.parameter.start)r.push(i),i=n.pop();var o=[];while(t.type!==e.expression.type.parameter.start)o.unshift(t),t=r.pop();o.unshift(t);var u=!1;t=r[r.length-1],t===undefined||t.type!==e.expression.type._function&&t.type!==e.expression.type.filter&&t.type!==e.expression.type.test&&t.type!==e.expression.type.key.brackets&&t.type!==e.expression.type.key.period?(s.expression=!0,o.pop(),o.shift(),s.params=o,r.push(s)):(s.expression=!1,t.params=o)},parse:function(t,n,r){var i=[],s=!1,o=null;if(t.expression)o=e.expression.parse.apply(this,[t.params,r]),n.push(o);else{while(n.length>0){o=n.pop();if(o&&o.type&&o.type==e.expression.type.parameter.start){s=!0;break}i.unshift(o)}if(!s)throw new e.Error("Expected end of parameter set.");n.push(i)}}},{type:e.expression.type.array.start,regex:/^\[/,next:e.expression.set.expressions.concat([e.expression.type.array.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.array.end,regex:/^\]/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i=n.length-1,s;for(;i>=0;i--){s=n.pop();if(s.type===e.expression.type.array.start)break;r.push(s)}r.push(t)},parse:function(t,n,r){var i=[],s=!1,o=null;while(n.length>0){o=n.pop();if(o.type&&o.type==e.expression.type.array.start){s=!0;break}i.unshift(o)}if(!s)throw new e.Error("Expected end of array.");n.push(i)}},{type:e.expression.type.object.start,regex:/^\{/,next:e.expression.set.expressions.concat([e.expression.type.object.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.object.end,regex:/^\}/,next:e.expression.set.operations_extended,compile:function(t,n,r){var i=n.length-1,s;for(;i>=0;i--){s=n.pop();if(s&&s.type===e.expression.type.object.start)break;r.push(s)}r.push(t)},parse:function(t,n,r){var i={},s=!1,o=null,u=null,a=!1,f=null;while(n.length>0){o=n.pop();if(o&&o.type&&o.type===e.expression.type.object.start){s=!0;break}if(o&&o.type&&(o.type===e.expression.type.operator.binary||o.type===e.expression.type.operator.unary)&&o.key){if(!a)throw new e.Error("Missing value for key '"+o.key+"' in object definition.");i[o.key]=f,i._keys===undefined&&(i._keys=[]),i._keys.unshift(o.key),f=null,a=!1}else a=!0,f=o}if(!s)throw new e.Error("Unexpected end of object.");n.push(i)}},{type:e.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.value=e.match[1],n.push(e)},parse:function(t,n,r){var i=n.pop(),s=t.params&&e.expression.parse.apply(this,[t.params,r]);n.push(e.filter.apply(this,[t.value,i,s]))}},{type:e.expression.type._function,regex:/^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,next:e.expression.type.parameter.start,transform:function(e,t){return"("},compile:function(e,t,n){var r=e.match[1];e.fn=r,delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=t.fn,o;if(e.functions[s])o=e.functions[s].apply(this,i);else{if(typeof r[s]!="function")throw new e.Error(s+" function does not exist and is not defined in the context");o=r[s].apply(r,i)}n.push(o)}},{type:e.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,validate:function(t,n){return e.indexOf(e.expression.reservedWords,t[0])<0},parse:function(t,n,r){var i=e.expression.resolve(r[t.value],r);n.push(i)}},{type:e.expression.type.key.period,regex:/^\.([a-zA-Z0-9_]+)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.key=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=t.key,o=n.pop(),u;if(o===null||o===undefined){if(this.options.strict_variables)throw new e.Error("Can't access a key "+s+" on an null or undefined object.");return null}var a=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)};typeof o=="object"&&s in o?u=o[s]:o["get"+a(s)]!==undefined?u=o["get"+a(s)]:o["is"+a(s)]!==undefined?u=o["is"+a(s)]:u=null,n.push(e.expression.resolve(u,o,i))}},{type:e.expression.type.key.brackets,regex:/^\[([^\]]*)\]/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(t,n,r){var i=t.match[1];delete t.value,delete t.match,t.stack=e.expression.compile({value:i}).stack,r.push(t)},parse:function(t,n,r){var i=t.params&&e.expression.parse.apply(this,[t.params,r]),s=e.expression.parse.apply(this,[t.stack,r]),o=n.pop(),u;if(o===null||o===undefined){if(this.options.strict_variables)throw new e.Error("Can't access a key "+s+" on an null or undefined object.");return null}typeof o=="object"&&s in o?u=o[s]:u=null,n.push(e.expression.resolve(u,o,i))}},{type:e.expression.type._null,regex:/^null/,next:e.expression.set.operations,compile:function(e,t,n){delete e.match,e.value=null,n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.context,regex:/^_context/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,parse:function(e,t,n){t.push(n)}},{type:e.expression.type.number,regex:/^\-?\d+(\.\d+)?/,next:e.expression.set.operations,compile:function(e,t,n){e.value=Number(e.value),n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.bool,regex:/^(true|false)/,next:e.expression.set.operations,compile:function(e,t,n){e.value=e.match[0]=="true",delete e.match,n.push(e)},parse:e.expression.fn.parse.push_value}],e.expression.resolve=function(e,t,n){return typeof e=="function"?e.apply(t,n||[]):e},e.expression.handler={},e.expression.extendType=function(t){e.expression.type[t]="Twig.expression.type."+t},e.expression.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.expression.handler[t.type]=t};while(e.expression.definitions.length>0)e.expression.extend(e.expression.definitions.shift());return e.expression.tokenize=function(t){var n=[],r=0,i=null,s,o,u,a,f,l=[],c;c=function(){var t=Array.prototype.slice.apply(arguments),o=t.pop(),u=t.pop();return e.log.trace("Twig.expression.tokenize","Matched a ",s," regular expression of ",t),i&&e.indexOf(i,s)<0?(l.push(s+" cannot follow a "+n[n.length-1].type+" at template:"+r+" near '"+t[0].substring(0,20)+"...'"),t[0]):e.expression.handler[s].validate&&!e.expression.handler[s].validate(t,n)?t[0]:(l=[],n.push({type:s,value:t[0],match:t}),f=!0,i=a,r+=t[0].length,e.expression.handler[s].transform?e.expression.handler[s].transform(t,n):"")},e.log.debug("Twig.expression.tokenize","Tokenizing expression ",t);while(t.length>0){t=t.trim();for(s in e.expression.handler)if(e.expression.handler.hasOwnProperty(s)){a=e.expression.handler[s].next,o=e.expression.handler[s].regex,o instanceof Array?u=o:u=[o],f=!1;while(u.length>0)o=u.pop(),t=t.replace(o,c);if(f)break}if(!f)throw l.length>0?new e.Error(l.join(" OR ")):new e.Error("Unable to parse '"+t+"' at template position"+r)}return e.log.trace("Twig.expression.tokenize","Tokenized to ",n),n},e.expression.compile=function(t){var n=t.value,r=e.expression.tokenize(n),i=null,s=[],o=[],u=null;e.log.trace("Twig.expression.compile: ","Compiling ",n);while(r.length>0)i=r.shift(),u=e.expression.handler[i.type],e.log.trace("Twig.expression.compile: ","Compiling ",i),u.compile&&u.compile(i,o,s),e.log.trace("Twig.expression.compile: ","Stack is",o),e.log.trace("Twig.expression.compile: ","Output is",s);while(o.length>0)s.push(o.pop());return e.log.trace("Twig.expression.compile: ","Final output is",s),t.stack=s,delete t.value,t},e.expression.parse=function(t,n){var r=this;t instanceof Array||(t=[t]);var i=[],s=null;return e.forEach(t,function(t){s=e.expression.handler[t.type],s.parse&&s.parse.apply(r,[t,i,n])}),i.pop()},e}(Twig||{}),Twig=function(e){e.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};var t=function(e,t){if(t.indexOf!==undefined)return e===t||e!==""&&t.indexOf(e)>-1;var n;for(n in t)if(t.hasOwnProperty(n)&&t[n]===e)return!0;return!1};return e.expression.operator.lookup=function(t,n){switch(t){case"..":case"not in":case"in":n.precidence=20,n.associativity=e.expression.operator.leftToRight;break;case",":n.precidence=18,n.associativity=e.expression.operator.leftToRight;break;case"?":case":":n.precidence=16,n.associativity=e.expression.operator.rightToLeft;break;case"or":n.precidence=14,n.associativity=e.expression.operator.leftToRight;break;case"and":n.precidence=13,n.associativity=e.expression.operator.leftToRight;break;case"==":case"!=":n.precidence=9,n.associativity=e.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":n.precidence=8,n.associativity=e.expression.operator.leftToRight;break;case"~":case"+":case"-":n.precidence=6,n.associativity=e.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":n.precidence=5,n.associativity=e.expression.operator.leftToRight;break;case"not":n.precidence=3,n.associativity=e.expression.operator.rightToLeft;break;default:throw new e.Error(t+" is an unknown operator.")}return n.operator=t,n},e.expression.operator.parse=function(n,r){e.log.trace("Twig.expression.operator.parse: ","Handling ",n);var i,s,o;switch(n){case":":break;case"?":o=r.pop(),s=r.pop(),i=r.pop(),i?r.push(s):r.push(o);break;case"+":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i+s);break;case"-":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i-s);break;case"*":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i*s);break;case"/":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i/s);break;case"//":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(parseInt(i/s));break;case"%":s=parseFloat(r.pop()),i=parseFloat(r.pop()),r.push(i%s);break;case"~":s=r.pop(),i=r.pop(),r.push((i!==undefined?i.toString():"")+(s!==undefined?s.toString():""));break;case"not":case"!":r.push(!r.pop());break;case"<":s=r.pop(),i=r.pop(),r.push(i<s);break;case"<=":s=r.pop(),i=r.pop(),r.push(i<=s);break;case">":s=r.pop(),i=r.pop(),r.push(i>s);break;case">=":s=r.pop(),i=r.pop(),r.push(i>=s);break;case"===":s=r.pop(),i=r.pop(),r.push(i===s);break;case"==":s=r.pop(),i=r.pop(),r.push(i==s);break;case"!==":s=r.pop(),i=r.pop(),r.push(i!==s);break;case"!=":s=r.pop(),i=r.pop(),r.push(i!=s);break;case"or":s=r.pop(),i=r.pop(),r.push(i||s);break;case"and":s=r.pop(),i=r.pop(),r.push(i&&s);break;case"**":s=r.pop(),i=r.pop(),r.push(Math.pow(i,s));break;case"not in":s=r.pop(),i=r.pop(),r.push(!t(i,s));break;case"in":s=r.pop(),i=r.pop(),r.push(t(i,s));break;case"..":s=r.pop(),i=r.pop(),r.push(e.functions.range(i,s));break;default:throw new e.Error(n+" is an unknown operator.")}},e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}return e.filters={upper:function(e){return typeof e!="string"?e:e.toUpperCase()},lower:function(e){return typeof e!="string"?e:e.toLowerCase()},capitalize:function(e){return typeof e!="string"?e:e.substr(0,1).toUpperCase()+e.toLowerCase().substr(1)},title:function(e){return typeof e!="string"?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})},length:function(t){return e.lib.is("Array",t)||typeof t=="string"?t.length:e.lib.is("Object",t)?t._keys===undefined?Object.keys(t).length:t._keys.length:0},reverse:function(e){if(t("Array",e))return e.reverse();if(t("String",e))return e.split("").reverse().join("");if(e instanceof Object){var n=e._keys||Object.keys(e).reverse();return e._keys=n,e}},sort:function(e){if(t("Array",e))return e.sort();if(e instanceof Object){delete e._keys;var n=Object.keys(e),r=n.sort(function(t,n){return e[t]>e[n]});return e._keys=r,e}},keys:function(t){if(t===undefined||t===null)return;var n=t._keys||Object.keys(t),r=[];return e.forEach(n,function(e){if(e==="_keys")return;t.hasOwnProperty(e)&&r.push(e)}),r},url_encode:function(e){if(e===undefined||e===null)return;return encodeURIComponent(e)},join:function(t,n){if(t===undefined||t===null)return;var r="",i=[],s=null;return n&&n[0]&&(r=n[0]),t instanceof Array?i=t:(s=t._keys||Object.keys(t),e.forEach(s,function(e){if(e==="_keys")return;t.hasOwnProperty(e)&&i.push(t[e])})),i.join(r)},"default":function(t,n){if(n===undefined||n.length!==1)throw new e.Error("default filter expects one argument");return t===undefined||t===null||t===""?n[0]:t},json_encode:function(e){return e&&e.hasOwnProperty("_keys")&&delete e._keys,e===undefined||e===null?"null":JSON.stringify(e)},merge:function(t,n){var r=[],i=0,s=[];t instanceof Array?e.forEach(n,function(e){e instanceof Array||(r={})}):r={},r instanceof Array||(r._keys=[]),t instanceof Array?e.forEach(t,function(e){r._keys&&r._keys.push(i),r[i]=e,i++}):(s=t._keys||Object.keys(t),e.forEach(s,function(e){r[e]=t[e],r._keys.push(e);var n=parseInt(e,10);!isNaN(n)&&n>=i&&(i=n+1)})),e.forEach(n,function(t){t instanceof Array?e.forEach(t,function(e){r._keys&&r._keys.push(i),r[i]=e,i++}):(s=t._keys||Object.keys(t),e.forEach(s,function(e){r[e]||r._keys.push(e),r[e]=t[e];var n=parseInt(e,10);!isNaN(n)&&n>=i&&(i=n+1)}))});if(n.length===0)throw new e.Error("Filter merge expects at least one parameter");return r},date:function(t,n){if(t===undefined||t===null)return;var r=e.functions.date(t);return e.lib.formatDate(r,n[0])},date_modify:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length!==1)throw new e.Error("date_modify filter expects 1 argument");var r=n[0],i;return e.lib.is("Date",t)&&(i=e.lib.strtotime(r,t.getTime()/1e3)),e.lib.is("String",t)&&(i=e.lib.strtotime(r,e.lib.strtotime(t))),e.lib.is("Number",t)&&(i=e.lib.strtotime(r,t)),new Date(i*1e3)},replace:function(t,n){if(t===undefined||t===null)return;var r=n[0],i;for(i in r)r.hasOwnProperty(i)&&i!=="_keys"&&(t=e.lib.replaceAll(t,i,r[i]));return t},format:function(t,n){if(t===undefined||t===null)return;return e.lib.vsprintf(t,n)},striptags:function(t){if(t===undefined||t===null)return;return e.lib.strip_tags(t)},escape:function(e){if(e===undefined||e===null)return;return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},e:function(t){return e.filters.escape(t)},nl2br:function(t){if(t===undefined||t===null)return;var n="BACKSLASH_n_replace",r="<br />"+n;return t=e.filters.escape(t).replace(/\r\n/g,r).replace(/\r/g,r).replace(/\n/g,r),e.lib.replaceAll(t,n,"\n")},number_format:function(e,t){var n=e,r=t&&t[0]?t[0]:undefined,i=t&&t[1]!==undefined?t[1]:".",s=t&&t[2]!==undefined?t[2]:",";n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+n)?+n:0,u=isFinite(+r)?Math.abs(r):0,a="",f=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return a=(u?f(o,u):""+Math.round(o)).split("."),a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(a[1]||"").length<u&&(a[1]=a[1]||"",a[1]+=(new Array(u-a[1].length+1)).join("0")),a.join(i)},trim:function(t,n){if(t===undefined||t===null)return;var r=e.filters.escape(""+t),i;n&&n[0]?i=""+n[0]:i=" \n\r	\f\u2028\u2029";for(var s=0;s<r.length;s++)if(i.indexOf(r.charAt(s))===-1){r=r.substring(s);break}for(s=r.length-1;s>=0;s--)if(i.indexOf(r.charAt(s))===-1){r=r.substring(0,s+1);break}return i.indexOf(r.charAt(0))===-1?r:""},slice:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length<1)throw new e.Error("slice filter expects at least 1 argument");var r=n[0]||0,i=n.length>1?n[1]:t.length,s=r>=0?r:Math.max(t.length+r,0);if(e.lib.is("Array",t)){var o=[];for(var u=s;u<s+i&&u<t.length;u++)o.push(t[u]);return o}if(e.lib.is("String",t))return t.substr(s,i);throw new e.Error("slice filter expects value to be an array or string")},abs:function(e){if(e===undefined||e===null)return;return Math.abs(e)},first:function(e){if(e instanceof Array)return e[0];if(e instanceof Object){if("_keys"in e)return e[e._keys[0]]}else if(typeof e=="string")return e.substr(0,1);return},split:function(t,n){if(t===undefined||t===null)return;if(n===undefined||n.length<1||n.length>2)throw new e.Error("split filter expects 1 or 2 argument");if(e.lib.is("String",t)){var r=n[0],i=n[1],s=t.split(r);if(i===undefined)return s;if(i<0)return t.split(r,s.length+i);var o=[];if(r=="")while(s.length>0){var u="";for(var a=0;a<i&&s.length>0;a++)u+=s.shift();o.push(u)}else{for(var a=0;a<i-1&&s.length>0;a++)o.push(s.shift());s.length>0&&o.push(s.join(r))}return o}throw new e.Error("split filter expects value to be a string")},last:function(t){if(e.lib.is("Object",t)){var n;return t._keys===undefined?n=Object.keys(t):n=t._keys,t[n[n.length-1]]}return t[t.length-1]},raw:function(e){return e},batch:function(t,n){var r=n.shift(),i=n.shift(),s,o,u;if(!e.lib.is("Array",t))throw new e.Error("batch filter expects items to be an array");if(!e.lib.is("Number",r))throw new e.Error("batch filter expects size to be a number");r=Math.ceil(r),s=e.lib.chunkArray(t,r);if(i&&t.length%r!=0){o=s.pop(),u=r-o.length;while(u--)o.push(i);s.push(o)}return s},round:function(t,n){n=n||[];var r=n.length>0?n[0]:0,i=n.length>1?n[1]:"common";t=parseFloat(t);if(r&&!e.lib.is("Number",r))throw new e.Error("round filter expects precision to be a number");if(i==="common")return e.lib.round(t,r);if(!e.lib.is("Function",Math[i]))throw new e.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[i](t*Math.pow(10,r))/Math.pow(10,r)}},e.filter=function(t,n,r){if(!e.filters[t])throw"Unable to find filter "+t;return e.filters[t].apply(this,[n,r])},e.filter.extend=function(t,n){e.filters[t]=n},e}(Twig||{}),Twig=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&n===e}return e.functions={range:function(e,t,n){var r=[],i,s,o,u=n||1,a=!1;!isNaN(e)&&!isNaN(t)?(i=parseInt(e,10),s=parseInt(t,10)):isNaN(e)&&isNaN(t)?(a=!0,i=e.charCodeAt(0),s=t.charCodeAt(0)):(i=isNaN(e)?0:e,s=isNaN(t)?0:t),o=i>s?!1:!0;if(o)while(i<=s)r.push(a?String.fromCharCode(i):i),i+=u;else while(i>=s)r.push(a?String.fromCharCode(i):i),i-=u;return r},cycle:function(e,t){var n=t%e.length;return e[n]},dump:function(){var t="\n",n="  ",r=0,i="",s=Array.prototype.slice.call(arguments),o=function(e){var t="";while(e>0)e--,t+=n;return t},u=function(e){i+=o(r),typeof e=="object"?a(e):typeof e=="function"?i+="function()"+t:typeof e=="string"?i+="string("+e.length+') "'+e+'"'+t:typeof e=="number"?i+="number("+e+")"+t:typeof e=="boolean"&&(i+="bool("+e+")"+t)},a=function(e){var n;if(e===null)i+="NULL"+t;else if(e===undefined)i+="undefined"+t;else if(typeof e=="object"){i+=o(r)+typeof e,r++,i+="("+function(e){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(e)+") {"+t;for(n in e)i+=o(r)+"["+n+"]=> "+t,u(e[n]);r--,i+=o(r)+"}"+t}else u(e)};return s.length==0&&s.push(this.context),e.forEach(s,function(e){a(e)}),i},date:function(t,n){var r;if(t===undefined)r=new Date;else if(e.lib.is("Date",t))r=t;else if(e.lib.is("String",t))r=new Date(e.lib.strtotime(t)*1e3);else{if(!e.lib.is("Number",t))throw new e.Error("Unable to parse date "+t);r=new Date(t*1e3)}return r},block:function(e){return this.blocks[e]},parent:function(){return e.placeholders.parent},attribute:function(e,t,n){return e instanceof Object&&e.hasOwnProperty(t)?typeof e[t]=="function"?e[t].apply(undefined,n):e[t]:e[t]||undefined}},e._function=function(t,n,r){if(!e.functions[t])throw"Unable to find function "+t;return e.functions[t](n,r)},e._function.extend=function(t,n){e.functions[t]=n},e}(Twig||{}),Twig=function(e){return e.tests={empty:function(e){if(e===null||e===undefined)return!0;if(typeof e=="number")return!1;if(e.length&&e.length>0)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},odd:function(e){return e%2===1},even:function(e){return e%2===0},divisibleby:function(e,t){return e%t[0]===0},defined:function(e){return e!==undefined},none:function(e){return e===null},"null":function(e){return this.none(e)},sameas:function(e,t){return e===t[0]}},e.test=function(t,n,r){if(!e.tests[t])throw"Test "+t+" is not defined.";return e.tests[t](n,r)},e.test.extend=function(t,n){e.tests[t]=n},e}(Twig||{}),Twig=function(e){return e.exports={VERSION:e.VERSION},e.exports.twig=function(n){var r=n.id,i={strict_variables:n.strict_variables||!1,allowInlineIncludes:n.allowInlineIncludes||!1,rethrow:n.rethrow||!1};r&&e.validateId(r),n.debug!==undefined&&(e.debug=n.debug),n.trace!==undefined&&(e.trace=n.trace);if(n.data!==undefined)return new e.Template({data:n.data,module:n.module,id:r,options:i});if(n.ref!==undefined){if(n.id!==undefined)throw new e.Error("Both ref and id cannot be set on a twig.js template.");return e.Templates.load(n.ref)}if(n.href!==undefined)return e.Templates.loadRemote(n.href,{id:r,method:"ajax",base:n.base,module:n.module,precompiled:n.precompiled,async:n.async,options:i},n.load,n.error);if(n.path!==undefined)return e.Templates.loadRemote(n.path,{id:r,method:"fs",base:n.base,module:n.module,precompiled:n.precompiled,async:n.async,options:i},n.load,n.error)},e.exports.extendFilter=function(t,n){e.filter.extend(t,n)},e.exports.extendFunction=function(t,n){e._function.extend(t,n)},e.exports.extendTest=function(t,n){e.test.extend(t,n)},e.exports.extendTag=function(t){e.logic.extend(t)},e.exports.extend=function(t){t(e)},e.exports.compile=function(t,n){var r=n.filename,i=n.filename,s;return s=new e.Template({data:t,path:i,id:r,options:n.settings["twig options"]}),function(e){return s.render(e)}},e.exports.renderFile=function(t,n,r){"function"==typeof n&&(r=n,n={}),n=n||{};var i={path:t,base:n.settings.views,load:function(e){r(null,e.render(n))}},s=n.settings["twig options"];if(s)for(var o in s)s.hasOwnProperty(o)&&(i[o]=s[o]);e.exports.twig(i)},e.exports.__express=e.exports.renderFile,e.exports.cache=function(t){e.cache=t},e}(Twig||{}),Twig=function(e){return e.compiler={module:{}},e.compiler.compile=function(t,n){var r=JSON.stringify(t.tokens),i=t.id,s;if(n.module){if(e.compiler.module[n.module]===undefined)throw new e.Error("Unable to find module type "+n.module);s=e.compiler.module[n.module](i,r,n.twig)}else s=e.compiler.wrap(i,r);return s},e.compiler.module={amd:function(t,n,r){return'define(["'+r+'"], function (Twig) {\n	var twig, templates;\ntwig = Twig.twig;\ntemplates = '+e.compiler.wrap(t,n)+"\n	return templates;\n});"},node:function(t,n){return'var twig = require("twig").twig;\nexports.template = '+e.compiler.wrap(t,n)},cjs2:function(t,n,r){return'module.declare([{ twig: "'+r+'" }], function (require, exports, module) {\n'+'	var twig = require("twig").twig;\n'+"	exports.template = "+e.compiler.wrap(t,n)+"\n});"}},e.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},e}(Twig||{});typeof module!="undefined"&&module.declare?module.declare([],function(e,t,n){for(key in Twig.exports)Twig.exports.hasOwnProperty(key)&&(t[key]=Twig.exports[key])}):typeof define=="function"&&define.amd||1?timely.define("external_libs/twig",[],function(){return Twig.exports}):typeof module!="undefined"&&module.exports?module.exports=Twig.exports:(window.twig=Twig.exports.twig,window.Twig=Twig.exports);

==================================================
FILE PATH: ./public/js/external_libs/bootstrap_fileupload.js
==================================================
/* ===========================================================
 * bootstrap-fileupload.js j2
 * http://jasny.github.com/bootstrap/javascript.html#fileupload
 * ===========================================================
 * Copyright 2012 Jasny BV, Netherlands.
 *
 * Licensed under the Apache License, Version 2.0 (the "License")
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

timely.define(["jquery_timely"],function(e){var t=function(t,n){this.$element=e(t),this.type=this.$element.data("uploadtype")||(this.$element.find(".ai1ec-thumbnail").length>0?"image":"file"),this.$input=this.$element.find(":file");if(this.$input.length===0)return;this.name=this.$input.attr("name")||n.name,this.$hidden=this.$element.find(':hidden[name="'+this.name+'"]'),this.$hidden.length===0&&(this.$hidden=e('<input type="hidden" />'),this.$element.prepend(this.$hidden)),this.$preview=this.$element.find(".ai1ec-fileupload-preview");var r=this.$preview.css("height");this.$preview.css("display")!="inline"&&r!="0px"&&r!="none"&&this.$preview.css("line-height",r),this.$remove=this.$element.find('[data-dismiss="fileupload"]'),this.$element.find('[data-trigger="fileupload"]').on("click.fileupload",e.proxy(this.trigger,this)),this.listen()};t.prototype={listen:function(){this.$input.on("change.fileupload",e.proxy(this.change,this)),this.$remove&&this.$remove.on("click.fileupload",e.proxy(this.clear,this))},change:function(e,t){var n=e.target.files!==undefined?e.target.files[0]:e.target.value?{name:e.target.value.replace(/^.+\\/,"")}:null;if(t==="clear")return;if(!n){this.clear();return}this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name);if(this.type==="image"&&this.$preview.length>0&&(typeof n.type!="undefined"?n.type.match("image.*"):n.name.match("\\.(gif|png|jpe?g)$"))&&typeof FileReader!="undefined"){var r=new FileReader,i=this.$preview,s=this.$element;r.onload=function(e){i.html('<img src="'+e.target.result+'" '+(i.css("max-height")!="none"?'style="max-height: '+i.css("max-height")+';"':"")+" />"),s.addClass("ai1ec-fileupload-exists").removeClass("ai1ec-fileupload-new")},r.readAsDataURL(n)}else this.$preview.text(n.name),this.$element.addClass("ai1ec-fileupload-exists").removeClass("ai1ec-fileupload-new")},clear:function(e){this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),this.$input.val(""),this.$preview.html(""),this.$element.addClass("ai1ec-fileupload-new").removeClass("ai1ec-fileupload-exists"),e&&(this.$input.trigger("change",["clear"]),e.preventDefault())},trigger:function(e){this.$input.trigger("click"),e.preventDefault()}},e.fn.fileupload=function(n){return this.each(function(){var r=e(this),i=r.data("fileupload");i||r.data("fileupload",i=new t(this,n))})},e.fn.fileupload.Constructor=t,e(function(){e("body").on("click.fileupload.data-api",'[data-provides="fileupload"]',function(t){var n=e(this);if(n.data("fileupload"))return;n.fileupload(n.data());var r=e(t.target).parents("[data-dismiss=fileupload],[data-trigger=fileupload]").first();r.length>0&&(r.trigger("click.fileupload"),t.preventDefault())})})});

==================================================
FILE PATH: ./public/js/external_libs/moment.js
==================================================
//! moment.js
//! version : 2.9.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

timely.define([],function(){function tt(e,t,n){switch(arguments.length){case 2:return e!=null?e:t;case 3:return e!=null?e:t!=null?t:n;default:throw new Error("Implement me")}}function nt(e,t){return s.call(e,t)}function rt(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function it(t){e.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+t)}function st(e,t){var n=!0;return dt(function(){return n&&(it(e),n=!1),t.apply(this,arguments)},t)}function ot(e,t){Y[e]||(it(t),Y[e]=!0)}function ut(e,t){return function(n){return gt(e.call(this,n),t)}}function at(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function ft(e,t){var n=(t.year()-e.year())*12+(t.month()-e.month()),r=e.clone().add(n,"months"),i,s;return t-r<0?(i=e.clone().add(n-1,"months"),s=(t-r)/(r-i)):(i=e.clone().add(n+1,"months"),s=(t-r)/(i-r)),-(n+s)}function lt(e,t,n){var r;return n==null?t:e.meridiemHour!=null?e.meridiemHour(t,n):e.isPM!=null?(r=e.isPM(n),r&&t<12&&(t+=12),!r&&t===12&&(t=0),t):t}function ct(){}function ht(t,n){n!==!1&&Dt(t),vt(this,t),this._d=new Date(+t._d),et===!1&&(et=!0,e.updateOffset(this),et=!1)}function pt(t){var n=Ct(t),r=n.year||0,i=n.quarter||0,s=n.month||0,o=n.week||0,u=n.day||0,a=n.hour||0,f=n.minute||0,l=n.second||0,c=n.millisecond||0;this._milliseconds=+c+l*1e3+f*6e4+a*36e5,this._days=+u+o*7,this._months=+s+i*3+r*12,this._data={},this._locale=e.localeData(),this._bubble()}function dt(e,t){for(var n in t)nt(t,n)&&(e[n]=t[n]);return nt(t,"toString")&&(e.toString=t.toString),nt(t,"valueOf")&&(e.valueOf=t.valueOf),e}function vt(e,t){var n,r,i;typeof t._isAMomentObject!="undefined"&&(e._isAMomentObject=t._isAMomentObject),typeof t._i!="undefined"&&(e._i=t._i),typeof t._f!="undefined"&&(e._f=t._f),typeof t._l!="undefined"&&(e._l=t._l),typeof t._strict!="undefined"&&(e._strict=t._strict),typeof t._tzm!="undefined"&&(e._tzm=t._tzm),typeof t._isUTC!="undefined"&&(e._isUTC=t._isUTC),typeof t._offset!="undefined"&&(e._offset=t._offset),typeof t._pf!="undefined"&&(e._pf=t._pf),typeof t._locale!="undefined"&&(e._locale=t._locale);if(v.length>0)for(n in v)r=v[n],i=t[r],typeof i!="undefined"&&(e[r]=i);return e}function mt(e){return e<0?Math.ceil(e):Math.floor(e)}function gt(e,t,n){var r=""+Math.abs(e),i=e>=0;while(r.length<t)r="0"+r;return(i?n?"+":"":"-")+r}function yt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function bt(e,t){var n;return t=Ft(t,e),e.isBefore(t)?n=yt(e,t):(n=yt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function wt(t,n){return function(r,i){var s,o;return i!==null&&!isNaN(+i)&&(ot(n,"moment()."+n+"(period, number) is deprecated. Please use moment()."+n+"(number, period)."),o=r,r=i,i=o),r=typeof r=="string"?+r:r,s=e.duration(r,i),Et(this,s,t),this}}function Et(t,n,r,i){var s=n._milliseconds,o=n._days,u=n._months;i=i==null?!0:i,s&&t._d.setTime(+t._d+s*r),o&&mn(t,"Date",vn(t,"Date")+o*r),u&&dn(t,vn(t,"Month")+u*r),i&&e.updateOffset(t,o||u)}function St(e){return Object.prototype.toString.call(e)==="[object Array]"}function xt(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function Tt(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&Lt(e[o])!==Lt(t[o]))&&s++;return s+i}function Nt(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=X[e]||V[t]||t}return e}function Ct(e){var t={},n,r;for(r in e)nt(e,r)&&(n=Nt(r),n&&(t[n]=e[r]));return t}function kt(t){var n,r;if(t.indexOf("week")===0)n=7,r="day";else{if(t.indexOf("month")!==0)return;n=12,r="month"}e[t]=function(i,s){var o,u,a=e._locale[t],f=[];typeof i=="number"&&(s=i,i=undefined),u=function(t){var n=e().utc().set(r,t);return a.call(e._locale,n,i||"")};if(s!=null)return u(s);for(o=0;o<n;o++)f.push(u(o));return f}}function Lt(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(t>=0?n=Math.floor(t):n=Math.ceil(t)),n}function At(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function Ot(t,n,r){return ln(e([t,11,31+n-r]),n,r).week}function Mt(e){return _t(e)?366:365}function _t(e){return e%4===0&&e%100!==0||e%400===0}function Dt(e){var t;e._a&&e._pf.overflow===-2&&(t=e._a[a]<0||e._a[a]>11?a:e._a[f]<1||e._a[f]>At(e._a[u],e._a[a])?f:e._a[l]<0||e._a[l]>24||e._a[l]===24&&(e._a[c]!==0||e._a[h]!==0||e._a[p]!==0)?l:e._a[c]<0||e._a[c]>59?c:e._a[h]<0||e._a[h]>59?h:e._a[p]<0||e._a[p]>999?p:-1,e._pf._overflowDayOfYear&&(t<u||t>f)&&(t=f),e._pf.overflow=t)}function Pt(e){return e._isValid==null&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&e._pf.charsLeftOver===0&&e._pf.unusedTokens.length===0&&e._pf.bigHour===undefined)),e._isValid}function Ht(e){return e?e.toLowerCase().replace("_","-"):e}function Bt(e){var t=0,n,r,i,s;while(t<e.length){s=Ht(e[t]).split("-"),n=s.length,r=Ht(e[t+1]),r=r?r.split("-"):null;while(n>0){i=jt(s.slice(0,n).join("-"));if(i)return i;if(r&&r.length>=n&&Tt(s,r,!0)>=n-1)break;n--}t++}return null}function jt(t){var n=null;if(!d[t]&&m)try{n=e.locale(),require("./locale/"+t),e.locale(n)}catch(r){}return d[t]}function Ft(t,n){var r,i;return n._isUTC?(r=n.clone(),i=(e.isMoment(t)||xt(t)?+t:+e(t))- +r,r._d.setTime(+r._d+i),e.updateOffset(r,!1),r):e(t).local()}function It(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function qt(e){var t=e.match(w),n,r;for(n=0,r=t.length;n<r;n++)G[t[n]]?t[n]=G[t[n]]:t[n]=It(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function Rt(e,t){return e.isValid()?(t=Ut(t,e.localeData()),$[t]||($[t]=qt(t)),$[t](e)):e.localeData().invalidDate()}function Ut(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;E.lastIndex=0;while(n>=0&&E.test(e))e=e.replace(E,r),E.lastIndex=0,n-=1;return e}function zt(e,t){var n,r=t._strict;switch(e){case"Q":return _;case"DDDD":return P;case"YYYY":case"GGGG":case"gggg":return r?H:T;case"Y":case"G":case"g":return j;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?B:N;case"S":if(r)return _;case"SS":if(r)return D;case"SSS":if(r)return P;case"DDD":return x;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return k;case"a":case"A":return t._locale._meridiemParse;case"x":return O;case"X":return M;case"Z":case"ZZ":return L;case"T":return A;case"SSSS":return C;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?D:S;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return S;case"Do":return r?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return n=new RegExp(Yt(Gt(e.replace("\\","")),"i")),n}}function Wt(e){e=e||"";var t=e.match(L)||[],n=t[t.length-1]||[],r=(n+"").match(U)||["-",0,0],i=+(r[1]*60)+Lt(r[2]);return r[0]==="+"?i:-i}function Xt(t,n,r){var i,s=r._a;switch(t){case"Q":n!=null&&(s[a]=(Lt(n)-1)*3);break;case"M":case"MM":n!=null&&(s[a]=Lt(n)-1);break;case"MMM":case"MMMM":i=r._locale.monthsParse(n,t,r._strict),i!=null?s[a]=i:r._pf.invalidMonth=n;break;case"D":case"DD":n!=null&&(s[f]=Lt(n));break;case"Do":n!=null&&(s[f]=Lt(parseInt(n.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":n!=null&&(r._dayOfYear=Lt(n));break;case"YY":s[u]=e.parseTwoDigitYear(n);break;case"YYYY":case"YYYYY":case"YYYYYY":s[u]=Lt(n);break;case"a":case"A":r._meridiem=n;break;case"h":case"hh":r._pf.bigHour=!0;case"H":case"HH":s[l]=Lt(n);break;case"m":case"mm":s[c]=Lt(n);break;case"s":case"ss":s[h]=Lt(n);break;case"S":case"SS":case"SSS":case"SSSS":s[p]=Lt(("0."+n)*1e3);break;case"x":r._d=new Date(Lt(n));break;case"X":r._d=new Date(parseFloat(n)*1e3);break;case"Z":case"ZZ":r._useUTC=!0,r._tzm=Wt(n);break;case"dd":case"ddd":case"dddd":i=r._locale.weekdaysParse(n),i!=null?(r._w=r._w||{},r._w.d=i):r._pf.invalidWeekday=n;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":t=t.substr(0,1);case"gggg":case"GGGG":case"GGGGG":t=t.substr(0,2),n&&(r._w=r._w||{},r._w[t]=Lt(n));break;case"gg":case"GG":r._w=r._w||{},r._w[t]=e.parseTwoDigitYear(n)}}function Vt(t){var n,r,i,s,o,a,f;n=t._w,n.GG!=null||n.W!=null||n.E!=null?(o=1,a=4,r=tt(n.GG,t._a[u],ln(e(),1,4).year),i=tt(n.W,1),s=tt(n.E,1)):(o=t._locale._week.dow,a=t._locale._week.doy,r=tt(n.gg,t._a[u],ln(e(),o,a).year),i=tt(n.w,1),n.d!=null?(s=n.d,s<o&&++i):n.e!=null?s=n.e+o:s=o),f=cn(r,i,s,a,o),t._a[u]=f.year,t._dayOfYear=f.dayOfYear}function $t(e){var t,n,r=[],i,s;if(e._d)return;i=Kt(e),e._w&&e._a[f]==null&&e._a[a]==null&&Vt(e),e._dayOfYear&&(s=tt(e._a[u],i[u]),e._dayOfYear>Mt(s)&&(e._pf._overflowDayOfYear=!0),n=on(s,0,e._dayOfYear),e._a[a]=n.getUTCMonth(),e._a[f]=n.getUTCDate());for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[l]===24&&e._a[c]===0&&e._a[h]===0&&e._a[p]===0&&(e._nextDay=!0,e._a[l]=0),e._d=(e._useUTC?on:sn).apply(null,r),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[l]=24)}function Jt(e){var t;if(e._d)return;t=Ct(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],$t(e)}function Kt(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Qt(t){if(t._f===e.ISO_8601){en(t);return}t._a=[],t._pf.empty=!0;var n=""+t._i,r,i,s,o,u,a=n.length,f=0;s=Ut(t._f,t._locale).match(w)||[];for(r=0;r<s.length;r++)o=s[r],i=(n.match(zt(o,t))||[])[0],i&&(u=n.substr(0,n.indexOf(i)),u.length>0&&t._pf.unusedInput.push(u),n=n.slice(n.indexOf(i)+i.length),f+=i.length),G[o]?(i?t._pf.empty=!1:t._pf.unusedTokens.push(o),Xt(o,i,t)):t._strict&&!i&&t._pf.unusedTokens.push(o);t._pf.charsLeftOver=a-f,n.length>0&&t._pf.unusedInput.push(n),t._pf.bigHour===!0&&t._a[l]<=12&&(t._pf.bigHour=undefined),t._a[l]=lt(t._locale,t._a[l],t._meridiem),$t(t),Dt(t)}function Gt(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function Yt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Zt(e){var t,n,r,i,s;if(e._f.length===0){e._pf.invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=vt({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._pf=rt(),t._f=e._f[i],Qt(t);if(!Pt(t))continue;s+=t._pf.charsLeftOver,s+=t._pf.unusedTokens.length*10,t._pf.score=s;if(r==null||s<r)r=s,n=t}dt(e,n||t)}function en(e){var t,n,r=e._i,i=F.exec(r);if(i){e._pf.iso=!0;for(t=0,n=q.length;t<n;t++)if(q[t][1].exec(r)){e._f=q[t][0]+(i[6]||" ");break}for(t=0,n=R.length;t<n;t++)if(R[t][1].exec(r)){e._f+=R[t][0];break}r.match(L)&&(e._f+="Z"),Qt(e)}else e._isValid=!1}function tn(t){en(t),t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))}function nn(e,t){var n=[],r;for(r=0;r<e.length;++r)n.push(t(e[r],r));return n}function rn(t){var n=t._i,r;n===undefined?t._d=new Date:xt(n)?t._d=new Date(+n):(r=g.exec(n))!==null?t._d=new Date(+r[1]):typeof n=="string"?tn(t):St(n)?(t._a=nn(n.slice(0),function(e){return parseInt(e,10)}),$t(t)):typeof n=="object"?Jt(t):typeof n=="number"?t._d=new Date(n):e.createFromInputFallback(t)}function sn(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<1970&&u.setFullYear(e),u}function on(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function un(e,t){if(typeof e=="string")if(!isNaN(e))e=parseInt(e,10);else{e=t.weekdaysParse(e);if(typeof e!="number")return null}return e}function an(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function fn(t,n,r){var s=e.duration(t).abs(),o=i(s.as("s")),u=i(s.as("m")),a=i(s.as("h")),f=i(s.as("d")),l=i(s.as("M")),c=i(s.as("y")),h=o<J.s&&["s",o]||u===1&&["m"]||u<J.m&&["mm",u]||a===1&&["h"]||a<J.h&&["hh",a]||f===1&&["d"]||f<J.d&&["dd",f]||l===1&&["M"]||l<J.M&&["MM",l]||c===1&&["y"]||["yy",c];return h[2]=n,h[3]=+t>0,h[4]=r,an.apply({},h)}function ln(t,n,r){var i=r-n,s=r-t.day(),o;return s>i&&(s-=7),s<i-7&&(s+=7),o=e(t).add(s,"d"),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function cn(e,t,n,r,i){var s=on(e,0,1).getUTCDay(),o,u;return s=s===0?7:s,n=n!=null?n:i,o=i-s+(s>r?7:0)-(s<i?7:0),u=7*(t-1)+(n-i)+o+1,{year:u>0?e:e-1,dayOfYear:u>0?u:Mt(e-1)+u}}function hn(t){var n=t._i,r=t._f,i;return t._locale=t._locale||e.localeData(t._l),n===null||r===undefined&&n===""?e.invalid({nullInput:!0}):(typeof n=="string"&&(t._i=n=t._locale.preparse(n)),e.isMoment(n)?new ht(n,!0):(r?St(r)?Zt(t):Qt(t):rn(t),i=new ht(t),i._nextDay&&(i.add(1,"d"),i._nextDay=undefined),i))}function pn(t,n){var r,i;n.length===1&&St(n[0])&&(n=n[0]);if(!n.length)return e();r=n[0];for(i=1;i<n.length;++i)n[i][t](r)&&(r=n[i]);return r}function dn(e,t){var n;if(typeof t=="string"){t=e.localeData().monthsParse(t);if(typeof t!="number")return e}return n=Math.min(e.date(),At(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function vn(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function mn(e,t,n){return t==="Month"?dn(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function gn(t,n){return function(r){return r!=null?(mn(this,t,r),e.updateOffset(this,n),this):vn(this,t)}}function yn(e){return e*400/146097}function bn(e){return e*146097/400}function wn(t){e.duration.fn[t]=function(){return this._data[t]}}var e,t="2.9.0",n=typeof global=="undefined"||typeof window!="undefined"&&window!==global.window?this:global,r,i=Math.round,s=Object.prototype.hasOwnProperty,o,u=0,a=1,f=2,l=3,c=4,h=5,p=6,d={},v=[],m=typeof module!="undefined"&&module&&module.exports,g=/^\/?Date\((\-?\d+)/i,y=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,b=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,w=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,E=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,S=/\d\d?/,x=/\d{1,3}/,T=/\d{1,4}/,N=/[+\-]?\d{1,6}/,C=/\d+/,k=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,L=/Z|[\+\-]\d\d:?\d\d/gi,A=/T/i,O=/[\+\-]?\d+/,M=/[\+\-]?\d+(\.\d{1,3})?/,_=/\d/,D=/\d\d/,P=/\d{3}/,H=/\d{4}/,B=/[+-]?\d{6}/,j=/[+-]?\d+/,F=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,I="YYYY-MM-DDTHH:mm:ssZ",q=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],R=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],U=/([\+\-]|\d\d)/gi,z="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),W={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},X={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},V={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},$={},J={s:45,m:45,h:22,d:26,M:11},K="DDD w W M D d".split(" "),Q="M D H h m s w W".split(" "),G={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return gt(this.year()%100,2)},YYYY:function(){return gt(this.year(),4)},YYYYY:function(){return gt(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+gt(Math.abs(e),6)},gg:function(){return gt(this.weekYear()%100,2)},gggg:function(){return gt(this.weekYear(),4)},ggggg:function(){return gt(this.weekYear(),5)},GG:function(){return gt(this.isoWeekYear()%100,2)},GGGG:function(){return gt(this.isoWeekYear(),4)},GGGGG:function(){return gt(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return Lt(this.milliseconds()/100)},SS:function(){return gt(Lt(this.milliseconds()/10),2)},SSS:function(){return gt(this.milliseconds(),3)},SSSS:function(){return gt(this.milliseconds(),3)},Z:function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+gt(Lt(e/60),2)+":"+gt(Lt(e)%60,2)},ZZ:function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+gt(Lt(e/60),2)+gt(Lt(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Y={},Z=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],et=!1;while(K.length)o=K.pop(),G[o+"o"]=at(G[o],o);while(Q.length)o=Q.pop(),G[o+o]=ut(G[o],2);G.DDDD=ut(G.DDD,3),dt(ct.prototype,{set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(t,n,r){var i,s,o;this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(i=0;i<12;i++){s=e.utc([2e3,i]),r&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!r&&!this._monthsParse[i]&&(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i"));if(r&&n==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(r&&n==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!r&&this._monthsParse[i].test(t))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(t){var n,r,i;this._weekdaysParse||(this._weekdaysParse=[]);for(n=0;n<7;n++){this._weekdaysParse[n]||(r=e([2e3,1]).day(n),i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i"));if(this._weekdaysParse[n].test(t))return n}},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return(e+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,n){var r=this._calendar[e];return typeof r=="function"?r.apply(t,[n]):r},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return ln(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),e=function(e,t,n,r){var i;return typeof n=="boolean"&&(r=n,n=undefined),i={},i._isAMomentObject=!0,i._i=e,i._f=t,i._l=n,i._strict=r,i._isUTC=!1,i._pf=rt(),hn(i)},e.suppressDeprecationWarnings=!1,e.createFromInputFallback=st("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),e.min=function(){var e=[].slice.call(arguments,0);return pn("isBefore",e)},e.max=function(){var e=[].slice.call(arguments,0);return pn("isAfter",e)},e.utc=function(e,t,n,r){var i;return typeof n=="boolean"&&(r=n,n=undefined),i={},i._isAMomentObject=!0,i._useUTC=!0,i._isUTC=!0,i._l=n,i._i=e,i._f=t,i._strict=r,i._pf=rt(),hn(i).utc()},e.unix=function(t){return e(t*1e3)},e.duration=function(t,n){var r=t,i=null,s,o,u,a;return e.isDuration(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:typeof t=="number"?(r={},n?r[n]=t:r.milliseconds=t):(i=y.exec(t))?(s=i[1]==="-"?-1:1,r={y:0,d:Lt(i[f])*s,h:Lt(i[l])*s,m:Lt(i[c])*s,s:Lt(i[h])*s,ms:Lt(i[p])*s}):(i=b.exec(t))?(s=i[1]==="-"?-1:1,u=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*s},r={y:u(i[2]),M:u(i[3]),d:u(i[4]),h:u(i[5]),m:u(i[6]),s:u(i[7]),w:u(i[8])}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=bt(e(r.from),e(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),o=new pt(r),e.isDuration(t)&&nt(t,"_locale")&&(o._locale=t._locale),o},e.version=t,e.defaultFormat=I,e.ISO_8601=function(){},e.momentProperties=v,e.updateOffset=function(){},e.relativeTimeThreshold=function(e,t){return J[e]===undefined?!1:t===undefined?J[e]:(J[e]=t,!0)},e.lang=st("moment.lang is deprecated. Use moment.locale instead.",function(t,n){return e.locale(t,n)}),e.locale=function(t,n){var r;return t&&(typeof n!="undefined"?r=e.defineLocale(t,n):r=e.localeData(t),r&&(e.duration._locale=e._locale=r)),e._locale._abbr},e.defineLocale=function(t,n){return n!==null?(n.abbr=t,d[t]||(d[t]=new ct),d[t].set(n),e.locale(t),d[t]):(delete d[t],null)},e.langData=st("moment.langData is deprecated. Use moment.localeData instead.",function(t){return e.localeData(t)}),e.localeData=function(t){var n;t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr);if(!t)return e._locale;if(!St(t)){n=jt(t);if(n)return n;t=[t]}return Bt(t)},e.isMoment=function(e){return e instanceof ht||e!=null&&nt(e,"_isAMomentObject")},e.isDuration=function(e){return e instanceof pt};for(o=Z.length-1;o>=0;--o)kt(Z[o]);e.normalizeUnits=function(e){return Nt(e)},e.invalid=function(t){var n=e.utc(NaN);return t!=null?dt(n._pf,t):n._pf.userInvalidated=!0,n},e.parseZone=function(){return e.apply(null,arguments).parseZone()},e.parseTwoDigitYear=function(e){return Lt(e)+(Lt(e)>68?1900:2e3)},e.isDate=xt,dt(e.fn=ht.prototype,{clone:function(){return e(this)},valueOf:function(){return+this._d-(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var t=e(this).utc();return 0<t.year()&&t.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():Rt(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):Rt(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return Pt(this)},isDSTShifted:function(){return this._a?this.isValid()&&Tt(this._a,(this._isUTC?e.utc(this._a):e(this._a)).toArray())>0:!1},parsingFlags:function(){return dt({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.utcOffset(0,e)},local:function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(t){var n=Rt(this,t||e.defaultFormat);return this.localeData().postformat(n)},add:wt(1,"add"),subtract:wt(-1,"subtract"),diff:function(e,t,n){var r=Ft(e,this),i=(r.utcOffset()-this.utcOffset())*6e4,s,o,u,a;return t=Nt(t),t==="year"||t==="month"||t==="quarter"?(u=ft(this,r),t==="quarter"?u/=3:t==="year"&&(u/=12)):(o=this-r,u=t==="second"?o/1e3:t==="minute"?o/6e4:t==="hour"?o/36e5:t==="day"?(o-i)/864e5:t==="week"?(o-i)/6048e5:o),n?u:mt(u)},from:function(t,n){return e.duration({to:this,from:t}).locale(this.locale()).humanize(!n)},fromNow:function(t){return this.from(e(),t)},calendar:function(t){var n=t||e(),r=Ft(n,this).startOf("day"),i=this.diff(r,"days",!0),s=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(s,this,e(n)))},isLeapYear:function(){return _t(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=un(e,this.localeData()),this.add(e-t,"d")):t},month:gn("Month",!0),startOf:function(e){e=Nt(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"?this.weekday(0):e==="isoWeek"&&this.isoWeekday(1),e==="quarter"&&this.month(Math.floor(this.month()/3)*3),this},endOf:function(e){return e=Nt(e),e===undefined||e==="millisecond"?this:this.startOf(e).add(1,e==="isoWeek"?"week":e).subtract(1,"ms")},isAfter:function(t,n){var r;return n=Nt(typeof n!="undefined"?n:"millisecond"),n==="millisecond"?(t=e.isMoment(t)?t:e(t),+this>+t):(r=e.isMoment(t)?+t:+e(t),r<+this.clone().startOf(n))},isBefore:function(t,n){var r;return n=Nt(typeof n!="undefined"?n:"millisecond"),n==="millisecond"?(t=e.isMoment(t)?t:e(t),+this<+t):(r=e.isMoment(t)?+t:+e(t),+this.clone().endOf(n)<r)},isBetween:function(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)},isSame:function(t,n){var r;return n=Nt(n||"millisecond"),n==="millisecond"?(t=e.isMoment(t)?t:e(t),+this===+t):(r=+e(t),+this.clone().startOf(n)<=r&&r<=+this.clone().endOf(n))},min:st("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(t){return t=e.apply(null,arguments),t<this?this:t}),max:st("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(t){return t=e.apply(null,arguments),t>this?this:t}),zone:st("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),utcOffset:function(t,n){var r=this._offset||0,i;return t!=null?(typeof t=="string"&&(t=Wt(t)),Math.abs(t)<16&&(t*=60),!this._isUTC&&n&&(i=this._dateUtcOffset()),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!n||this._changeInProgress?Et(this,e.duration(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&this._offset===0},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):typeof this._i=="string"&&this.utcOffset(Wt(this._i)),this},hasAlignedHourOffset:function(t){return t?t=e(t).utcOffset():t=0,(this.utcOffset()-t)%60===0},daysInMonth:function(){return At(this.year(),this.month())},dayOfYear:function(t){var n=i((e(this).startOf("day")-e(this).startOf("year"))/864e5)+1;return t==null?n:this.add(t-n,"d")},quarter:function(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)},weekYear:function(e){var t=ln(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return e==null?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=ln(this,1,4).year;return e==null?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")},isoWeek:function(e){var t=ln(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return Ot(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return Ot(this.year(),e.dow,e.doy)},get:function(e){return e=Nt(e),this[e]()},set:function(e,t){var n;if(typeof e=="object")for(n in e)this.set(n,e[n]);else e=Nt(e),typeof this[e]=="function"&&this[e](t);return this},locale:function(t){var n;return t===undefined?this._locale._abbr:(n=e.localeData(t),n!=null&&(this._locale=n),this)},lang:st("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===undefined?this.localeData():this.locale(e)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return-Math.round(this._d.getTimezoneOffset()/15)*15}}),e.fn.millisecond=e.fn.milliseconds=gn("Milliseconds",!1),e.fn.second=e.fn.seconds=gn("Seconds",!1),e.fn.minute=e.fn.minutes=gn("Minutes",!1),e.fn.hour=e.fn.hours=gn("Hours",!0),e.fn.date=gn("Date",!0),e.fn.dates=st("dates accessor is deprecated. Use date instead.",gn("Date",!0)),e.fn.year=gn("FullYear",!0),e.fn.years=st("years accessor is deprecated. Use year instead.",gn("FullYear",!0)),e.fn.days=e.fn.day,e.fn.months=e.fn.month,e.fn.weeks=e.fn.week,e.fn.isoWeeks=e.fn.isoWeek,e.fn.quarters=e.fn.quarter,e.fn.toJSON=e.fn.toISOString,e.fn.isUTC=e.fn.isUtc,dt(e.duration.fn=pt.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u=0;r.milliseconds=e%1e3,i=mt(e/1e3),r.seconds=i%60,s=mt(i/60),r.minutes=s%60,o=mt(s/60),r.hours=o%24,t+=mt(o/24),u=mt(yn(t)),t-=mt(bn(u)),n+=mt(t/30),t%=30,u+=mt(n/12),n%=12,r.days=t,r.months=n,r.years=u},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return mt(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+Lt(this._months/12)*31536e6},humanize:function(e){var t=fn(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(t,n){var r=e.duration(t,n);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(t,n){var r=e.duration(t,n);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(e){return e=Nt(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;e=Nt(e);if(e==="month"||e==="year")return t=this._days+this._milliseconds/864e5,n=this._months+yn(t)*12,e==="month"?n:n/12;t=this._days+Math.round(bn(this._months/12));switch(e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return t*24+this._milliseconds/36e5;case"minute":return t*24*60+this._milliseconds/6e4;case"second":return t*24*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(t*24*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:e.fn.lang,locale:e.fn.locale,toIsoString:st("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||s?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),e.duration.fn.toString=e.duration.fn.toISOString;for(o in W)nt(W,o)&&wn(o.toLowerCase());return e.duration.fn.asMilliseconds=function(){return this.as("ms")},e.duration.fn.asSeconds=function(){return this.as("s")},e.duration.fn.asMinutes=function(){return this.as("m")},e.duration.fn.asHours=function(){return this.as("h")},e.duration.fn.asDays=function(){return this.as("d")},e.duration.fn.asWeeks=function(){return this.as("weeks")},e.duration.fn.asMonths=function(){return this.as("M")},e.duration.fn.asYears=function(){return this.as("y")},e.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=Lt(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),e});

==================================================
FILE PATH: ./public/js/external_libs/jquery.autocomplete_geomod.js
==================================================
timely.define(["jquery_timely"],function(e){e.fn.extend({autocomplete:function(t,n){var r=typeof t=="string";return n=e.extend({},e.Autocompleter.defaults,{url:r?t:null,data:r?null:t,delay:r?e.Autocompleter.defaults.delay:10,max:n&&!n.scroll?10:150},n),n.highlight=n.highlight||function(e){return e},n.formatMatch=n.formatMatch||n.formatItem,this.each(function(){new e.Autocompleter(this,n)})},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,n){function d(){var r=h.selected();if(!r)return!1;var s=r.result;o=s;if(n.multiple){var u=m(i.val());if(u.length>1){var a=n.multipleSeparator.length,f=e(t).selection().start,l,c=0;e.each(u,function(e,t){c+=t.length;if(f<=c)return l=e,!1;c+=a}),u[l]=s,s=u.join(n.multipleSeparator)}s+=n.multipleSeparator}return i.val(s),w(),i.trigger("result",[r.data,r.value]),!0}function v(e,t){if(f==r.DEL){h.hide();return}var s=i.val();if(!t&&s==o)return;o=s,s=g(s),s.length>=n.minChars?(i.addClass(n.loadingClass),n.matchCase||(s=s.toLowerCase()),S(s,E,w)):(T(),h.hide())}function m(t){return t?n.multiple?e.map(t.split(n.multipleSeparator),function(n){return e.trim(t).length?e.trim(n):null}):[e.trim(t)]:[""]}function g(r){if(!n.multiple)return r;var i=m(r);if(i.length==1)return i[0];var s=e(t).selection().start;return s==r.length?i=m(r):i=m(r.replace(r.substring(s),"")),i[i.length-1]}function y(s,u){n.autoFill&&g(i.val()).toLowerCase()==s.toLowerCase()&&f!=r.BACKSPACE&&(i.val(i.val()+u.substring(g(o).length)),e(t).selection(o.length,o.length+u.length))}function b(){clearTimeout(s),s=setTimeout(w,200)}function w(){var e=h.visible();h.hide(),clearTimeout(s),T(),n.mustMatch&&i.search(function(e){if(!e)if(n.multiple){var t=m(i.val()).slice(0,-1);i.val(t.join(n.multipleSeparator)+(t.length?n.multipleSeparator:""))}else i.val(""),i.trigger("result",null)})}function E(e,t){t&&t.length&&a?(T(),h.display(t,e),y(e,t[0].value),h.show()):w()}function S(r,i,s){n.matchCase||(r=r.toLowerCase());var o=u.load(r);if(o&&o.length)i(r,o);else if(n.geocoder){var a=g(r),f={address:a};n.region&&(f.region=n.region),n.geocoder.geocode(f,function(e,t){var s=n.parse(e,t,a);u.add(r,s),i(r,s)})}else if(typeof n.url=="string"&&n.url.length>0){var l={timestamp:+(new Date)};e.each(n.extraParams,function(e,t){l[e]=typeof t=="function"?t():t}),e.ajax({mode:"abort",port:"autocomplete"+t.name,dataType:n.dataType,url:n.url,data:e.extend({q:g(r),limit:n.max},l),success:function(e){var t=n.parse&&n.parse(e)||x(e);u.add(r,t),i(r,t)}})}else h.emptyList(),s(r)}function x(t){var r=[],i=t.split("\n");for(var s=0;s<i.length;s++){var o=e.trim(i[s]);o&&(o=o.split("|"),r[r.length]={data:o,value:o[0],result:n.formatResult&&n.formatResult(o,o[0])||o[0]})}return r}function T(){i.removeClass(n.loadingClass)}var r={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},i=e(t).attr("autocomplete","off").addClass(n.inputClass),s,o="",u=e.Autocompleter.Cache(n),a=0,f,l=navigator.userAgent.match(/opera/i),c={mouseDownOnSelect:!1},h=e.Autocompleter.Select(n,t,d,c),p;l&&e(t.form).bind("submit.autocomplete",function(){if(p)return p=!1,!1}),i.bind((l?"keypress":"keydown")+".autocomplete",function(t){a=1,f=t.keyCode;switch(t.keyCode){case r.UP:t.preventDefault(),h.visible()?h.prev():v(0,!0);break;case r.DOWN:t.preventDefault(),h.visible()?h.next():v(0,!0);break;case r.PAGEUP:t.preventDefault(),h.visible()?h.pageUp():v(0,!0);break;case r.PAGEDOWN:t.preventDefault(),h.visible()?h.pageDown():v(0,!0);break;case n.multiple&&e.trim(n.multipleSeparator)==","&&r.COMMA:case r.TAB:case r.RETURN:if(d())return t.preventDefault(),p=!0,!1;break;case r.ESC:h.hide();break;default:clearTimeout(s),s=setTimeout(v,n.delay)}}).focus(function(){a++}).blur(function(){a=0,c.mouseDownOnSelect||b()}).click(function(){a++>1&&!h.visible()&&v(0,!0)}).bind("search",function(){function n(e,n){var r;if(n&&n.length)for(var s=0;s<n.length;s++)if(n[s].result.toLowerCase()==e.toLowerCase()){r=n[s];break}typeof t=="function"?t(r):i.trigger("result",r&&[r.data,r.value])}var t=arguments.length>1?arguments[1]:null;e.each(m(i.val()),function(e,t){S(t,n,n)})}).bind("flushCache",function(){u.flush()}).bind("setOptions",function(){e.extend(n,arguments[1]),"data"in arguments[1]&&u.populate()}).bind("unautocomplete",function(){h.unbind(),i.unbind(),e(t.form).unbind(".autocomplete")})},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){function i(e,n){t.matchCase||(e=e.toLowerCase());var r=e.indexOf(n);return t.matchContains=="word"&&(r=e.toLowerCase().search("\\b"+n.toLowerCase())),r==-1?!1:r==0||t.matchContains}function s(e,i){r>t.cacheLength&&u(),n[e]||r++,n[e]=i}function o(){if(!t.data)return!1;var n={},r=0;t.url||(t.cacheLength=1),n[""]=[];for(var i=0,o=t.data.length;i<o;i++){var u=t.data[i];u=typeof u=="string"?[u]:u;var a=t.formatMatch(u,i+1,t.data.length);if(a===!1)continue;var f=a.charAt(0).toLowerCase();n[f]||(n[f]=[]);var l={value:a,data:u,result:t.formatResult&&t.formatResult(u)||a};n[f].push(l),r++<t.max&&n[""].push(l)}e.each(n,function(e,n){t.cacheLength++,s(e,n)})}function u(){n={},r=0}var n={},r=0;return setTimeout(o,25),{flush:u,add:s,populate:o,load:function(s){if(!t.cacheLength||!r)return null;if(!t.url&&t.matchContains){var o=[];for(var u in n)if(u.length>0){var a=n[u];e.each(a,function(e,t){i(t.value,s)&&o.push(t)})}return o}if(n[s])return n[s];if(t.matchSubset)for(var f=s.length-1;f>=t.minChars;f--){var a=n[s.substr(0,f)];if(a){var o=[];return e.each(a,function(e,t){i(t.value,s)&&(o[o.length]=t)}),o}}return null}}},e.Autocompleter.Select=function(t,n,r,i){function p(){if(!l)return;c=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),h=e("<ul/>").appendTo(c).mouseover(function(t){d(t).nodeName&&d(t).nodeName.toUpperCase()=="LI"&&(u=e("li",h).removeClass(s.ACTIVE).index(d(t)),e(d(t)).addClass(s.ACTIVE))}).click(function(t){return e(d(t)).addClass(s.ACTIVE),r(),n.focus(),!1}).mousedown(function(){i.mouseDownOnSelect=!0}).mouseup(function(){i.mouseDownOnSelect=!1}),t.width>0&&c.css("width",t.width),l=!1}function d(e){var t=e.target;while(t&&t.tagName!="LI")t=t.parentNode;return t?t:[]}function v(e){o.slice(u,u+1).removeClass(s.ACTIVE),m(e);var n=o.slice(u,u+1).addClass(s.ACTIVE);if(t.scroll){var r=0;o.slice(0,u).each(function(){r+=this.offsetHeight}),r+n[0].offsetHeight-h.scrollTop()>h[0].clientHeight?h.scrollTop(r+n[0].offsetHeight-h.innerHeight()):r<h.scrollTop()&&h.scrollTop(r)}}function m(e){u+=e,u<0?u=o.size()-1:u>=o.size()&&(u=0)}function g(e){return t.max&&t.max<e?t.max:e}function y(){h.empty();var n=g(a.length);for(var r=0;r<n;r++){if(!a[r])continue;var i=t.formatItem(a[r].data,r+1,n,a[r].value,f);if(i===!1)continue;var l=e("<li/>").html(t.highlight(i,f)).addClass(r%2==0?"ac_even":"ac_odd").appendTo(h)[0];e.data(l,"ac_data",a[r])}o=h.find("li"),t.selectFirst&&(o.slice(0,1).addClass(s.ACTIVE),u=0),e.fn.bgiframe&&h.bgiframe()}var s={ACTIVE:"ac_over"},o,u=-1,a,f="",l=!0,c,h;return{display:function(e,t){p(),a=e,f=t,y()},next:function(){v(1)},prev:function(){v(-1)},pageUp:function(){u!=0&&u-8<0?v(-u):v(-8)},pageDown:function(){u!=o.size()-1&&u+8>o.size()?v(o.size()-1-u):v(8)},hide:function(){c&&c.hide(),o&&o.removeClass(s.ACTIVE),u=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(o.filter("."+s.ACTIVE)[0]||t.selectFirst&&o[0])},show:function(){var r=e(n).offset();c.css({width:typeof t.width=="string"||t.width>0?t.width:e(n).width(),top:r.top+n.offsetHeight,left:r.left}).show();if(t.scroll){h.scrollTop(0),h.css({maxHeight:t.scrollHeight,overflow:"auto"});if(navigator.userAgent.match(/msie/i)&&typeof document.body.style.maxHeight=="undefined"){var i=0;o.each(function(){i+=this.offsetHeight});var s=i>t.scrollHeight;h.css("height",s?t.scrollHeight:i),s||o.width(h.width()-parseInt(o.css("padding-left"))-parseInt(o.css("padding-right")))}}},selected:function(){var t=o&&o.filter("."+s.ACTIVE).removeClass(s.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){h&&h.empty()},unbind:function(){c&&c.remove()}}},e.fn.selection=function(e,t){if(e!==undefined)return this.each(function(){if(this.createTextRange){var n=this.createTextRange();t===undefined||e==t?(n.move("character",e),n.select()):(n.collapse(!0),n.moveStart("character",e),n.moveEnd("character",t),n.select())}else this.setSelectionRange?this.setSelectionRange(e,t):this.selectionStart&&(this.selectionStart=e,this.selectionEnd=t)});var n=this[0];if(n.createTextRange){var r=document.selection.createRange(),i=n.value,s="<->",o=r.text.length;r.text=s;var u=n.value.indexOf(s);return n.value=i,this.selection(u,u+o),{start:u,end:u+o}}if(n.selectionStart!==undefined)return{start:n.selectionStart,end:n.selectionEnd}}});

==================================================
FILE PATH: ./public/js/external_libs/colorpicker.js
==================================================
timely.define(["jquery_timely"],function(e){var t=function(){var t={},n,r=65,i,s='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',o={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},u=function(t,n){var r=q(t);e(n).data("colorpicker").fields.eq(1).val(r.r).end().eq(2).val(r.g).end().eq(3).val(r.b).end()},a=function(t,n){e(n).data("colorpicker").fields.eq(4).val(t.h).end().eq(5).val(t.s).end().eq(6).val(t.b).end()},f=function(t,n){e(n).data("colorpicker").fields.eq(0).val(U(t)).end()},l=function(t,n){e(n).data("colorpicker").selector.css("backgroundColor","#"+U({h:t.h,s:100,b:100})),e(n).data("colorpicker").selectorIndic.css({left:parseInt(150*t.s/100,10),top:parseInt(150*(100-t.b)/100,10)})},c=function(t,n){e(n).data("colorpicker").hue.css("top",parseInt(150-150*t.h/360,10))},h=function(t,n){e(n).data("colorpicker").currentColor.css("backgroundColor","#"+U(t))},p=function(t,n){e(n).data("colorpicker").newColor.css("backgroundColor","#"+U(t))},d=function(t){var n=t.charCode||t.keyCode||-1;if(n>r&&n<=90||n==32)return!1;var i=e(this).parent().parent();i.data("colorpicker").livePreview===!0&&v.apply(this)},v=function(t){var n=e(this).parent().parent(),r;this.parentNode.className.indexOf("_hex")>0?n.data("colorpicker").color=r=F(B(this.value)):this.parentNode.className.indexOf("_hsb")>0?n.data("colorpicker").color=r=P({h:parseInt(n.data("colorpicker").fields.eq(4).val(),10),s:parseInt(n.data("colorpicker").fields.eq(5).val(),10),b:parseInt(n.data("colorpicker").fields.eq(6).val(),10)}):n.data("colorpicker").color=r=I(H({r:parseInt(n.data("colorpicker").fields.eq(1).val(),10),g:parseInt(n.data("colorpicker").fields.eq(2).val(),10),b:parseInt(n.data("colorpicker").fields.eq(3).val(),10)})),t&&(u(r,n.get(0)),f(r,n.get(0)),a(r,n.get(0))),l(r,n.get(0)),c(r,n.get(0)),p(r,n.get(0)),n.data("colorpicker").onChange.apply(n,[r,U(r),q(r)])},m=function(t){var n=e(this).parent().parent();n.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},g=function(){r=this.parentNode.className.indexOf("_hex")>0?70:65,e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),e(this).parent().addClass("colorpicker_focus")},y=function(t){var n=e(this).parent().find("input").focus(),r={el:e(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:n,val:parseInt(n.val(),10),preview:e(this).parent().parent().data("colorpicker").livePreview};e(document).bind("mouseup",r,w),e(document).bind("mousemove",r,b)},b=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&v.apply(e.data.field.get(0),[!0]),!1},w=function(t){return v.apply(t.data.field.get(0),[!0]),t.data.el.removeClass("colorpicker_slider").find("input").focus(),e(document).unbind("mouseup",w),e(document).unbind("mousemove",b),!1},E=function(t){var n={cal:e(this).parent(),y:e(this).offset().top};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,x),e(document).bind("mousemove",n,S)},S=function(e){return v.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},x=function(t){return u(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),f(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",x),e(document).unbind("mousemove",S),!1},T=function(t){var n={cal:e(this).parent(),pos:e(this).offset()};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,C),e(document).bind("mousemove",n,N)},N=function(e){return v.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},C=function(t){return u(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),f(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",C),e(document).unbind("mousemove",N),!1},k=function(t){e(this).addClass("colorpicker_focus")},L=function(t){e(this).removeClass("colorpicker_focus")},A=function(t){var n=e(this).parent(),r=n.data("colorpicker").color;n.data("colorpicker").origColor=r,h(r,n.get(0)),n.data("colorpicker").onSubmit(r,U(r),q(r),n.data("colorpicker").el)},O=function(t){var n=e("#"+e(this).data("colorpickerId"));n.data("colorpicker").onBeforeShow.apply(this,[n.get(0)]);var r=e(this).offset(),i=D(),s=e("#tag-color").offset(),o=s.top+e("#tag-color").height(),u=s.left+1;return n.css({left:u+"px",top:o+"px"}),n.data("colorpicker").onShow.apply(this,[n.get(0)])!=0&&n.show(),e(document).bind("mousedown",{cal:n},M),!1},M=function(t){_(t.data.cal.get(0),t.target,t.data.cal.get(0))||(t.data.cal.data("colorpicker").onHide.apply(this,[t.data.cal.get(0)])!=0&&t.data.cal.hide(),e(document).unbind("mousedown",M))},_=function(e,t,n){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(e.compareDocumentPosition(t)&16);var r=t.parentNode;while(r&&r!=n){if(r==e)return!0;r=r.parentNode}return!1},D=function(){var e=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},P=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},H=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},B=function(e){var t=6-e.length;if(t>0){var n=[];for(var r=0;r<t;r++)n.push("0");n.push(e),e=n.join("")}return e},j=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}},F=function(e){return I(j(e))},I=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-n;return t.b=r,r!=0,t.s=r!=0?255*i/r:0,t.s!=0?e.r==r?t.h=(e.g-e.b)/i:e.g==r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},q=function(e){var t={},n=Math.round(e.h),r=Math.round(e.s*255/100),i=Math.round(e.b*255/100);if(r==0)t.r=t.g=t.b=i;else{var s=i,o=(255-r)*i/255,u=(s-o)*(n%60)/60;n==360&&(n=0),n<60?(t.r=s,t.b=o,t.g=o+u):n<120?(t.g=s,t.b=o,t.r=s-u):n<180?(t.g=s,t.r=o,t.b=o+u):n<240?(t.b=s,t.r=o,t.g=s-u):n<300?(t.b=s,t.g=o,t.r=o+u):n<360?(t.r=s,t.g=o,t.b=s-u):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},R=function(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(n,function(e,t){t.length==1&&(n[e]="0"+t)}),n.join("")},U=function(e){return R(q(e))},z=function(){var t=e(this).parent(),n=t.data("colorpicker").origColor;t.data("colorpicker").color=n,u(n,t.get(0)),f(n,t.get(0)),a(n,t.get(0)),l(n,t.get(0)),c(n,t.get(0)),p(n,t.get(0))};return{init:function(t){t=e.extend({},o,t||{});if(typeof t.color=="string")t.color=F(t.color);else if(t.color.r!=undefined&&t.color.g!=undefined&&t.color.b!=undefined)t.color=I(t.color);else{if(t.color.h==undefined||t.color.s==undefined||t.color.b==undefined)return this;t.color=P(t.color)}return this.each(function(){if(!e(this).data("colorpickerId")){var n=e.extend({},t);n.origColor=t.color;var r="collorpicker_"+parseInt(Math.random()*1e3);e(this).data("colorpickerId",r);var i=e(s).attr("id",r);n.flat?i.appendTo(this).show():i.appendTo(document.body),n.fields=i.find("input").bind("keyup",d).bind("change",v).bind("blur",m).bind("focus",g),i.find("span").bind("mousedown",y).end().find(">div.colorpicker_current_color").bind("click",z),n.selector=i.find("div.colorpicker_color").bind("mousedown",T),n.selectorIndic=n.selector.find("div div"),n.el=this,n.hue=i.find("div.colorpicker_hue div"),i.find("div.colorpicker_hue").bind("mousedown",E),n.newColor=i.find("div.colorpicker_new_color"),n.currentColor=i.find("div.colorpicker_current_color"),i.data("colorpicker",n),i.find("div.colorpicker_submit").bind("mouseenter",k).bind("mouseleave",L).bind("click",A),u(n.color,i.get(0)),a(n.color,i.get(0)),f(n.color,i.get(0)),c(n.color,i.get(0)),l(n.color,i.get(0)),h(n.color,i.get(0)),p(n.color,i.get(0)),n.flat?i.css({position:"relative",display:"block"}):e(this).bind(n.eventName,O)}})},showPicker:function(){return this.each(function(){e(this).data("colorpickerId")&&O.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colorpickerId")&&e("#"+e(this).data("colorpickerId")).hide()})},setColor:function(t){if(typeof t=="string")t=F(t);else if(t.r!=undefined&&t.g!=undefined&&t.b!=undefined)t=I(t);else{if(t.h==undefined||t.s==undefined||t.b==undefined)return this;t=P(t)}return this.each(function(){if(e(this).data("colorpickerId")){var n=e("#"+e(this).data("colorpickerId"));n.data("colorpicker").color=t,n.data("colorpicker").origColor=t,u(t,n.get(0)),a(t,n.get(0)),f(t,n.get(0)),c(t,n.get(0)),l(t,n.get(0)),h(t,n.get(0)),p(t,n.get(0))}})}}}();e.fn.extend({ColorPicker:t.init,ColorPickerHide:t.hidePicker,ColorPickerShow:t.showPicker,ColorPickerSetColor:t.setColor})});

==================================================
FILE PATH: ./public/js/external_libs/jquery.tools.js
==================================================
timely.define(["jquery_timely"],function(e){function i(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function s(e,t){var n=parseInt(e.css(t),10);if(n)return n;var r=e[0].currentStyle;return r&&r.width&&parseInt(r.width,10)}function o(e){var t=e.data("events");return t&&t.onSlide}function u(t,n){function x(e,s,o,u){o===undefined?o=s/h*m:u&&(o-=n.min),g&&(o=Math.round(o/g)*g);if(s===undefined||g)s=o*h/m;if(isNaN(o))return r;s=Math.max(0,Math.min(s,h)),o=s/h*m;if(u||!f)o+=n.min;f&&(u?s=h-s:o=n.max-o),o=i(o,y);var a=e.type=="click";if(S&&l!==undefined&&!a){e.type="onSlide",E.trigger(e,[o,s]);if(e.isDefaultPrevented())return r}var c=a?n.speed:0,b=a?function(){e.type="change",E.trigger(e,[o])}:null;return f?(d.animate({top:s},c,b),n.progress&&v.animate({height:h-s+d.height()/2},c)):(d.animate({left:s},c,b),n.progress&&v.animate({width:s+d.width()/2},c)),l=o,p=s,t.val(o),r}function T(){f=n.vertical||s(a,"height")>s(a,"width"),f?(h=s(a,"height")-s(d,"height"),c=a.offset().top+h):(h=s(a,"width")-s(d,"width"),c=a.offset().left)}function N(){T(),r.setValue(n.value!==undefined?n.value:n.min)}var r=this,u=n.css,a=e("<div><div/><a href='#'/></div>").data("rangeinput",r),f,l,c,h,p;t.before(a);var d=a.addClass(u.slider).find("a").addClass(u.handle),v=a.find("div").addClass(u.progress);e.each("min,max,step,value".split(","),function(e,r){var i=t.attr(r);parseFloat(i)&&(n[r]=parseFloat(i,10))});var m=n.max-n.min,g=n.step=="any"?0:n.step,y=n.precision;y===undefined&&(y=g.toString().split("."),y=y.length===2?y[1].length:0);if(t.attr("type")=="range"){var b=t.clone().wrap("<div/>").parent().html(),w=e(b.replace(/type/i,"type=text data-orig-type"));w.val(n.value),t.replaceWith(w),t=w}t.addClass(u.input);var E=e(r).add(t),S=!0;e.extend(r,{getValue:function(){return l},setValue:function(t,n){return T(),x(n||e.Event("api"),undefined,t,!0)},getConf:function(){return n},getProgress:function(){return v},getHandle:function(){return d},getInput:function(){return t},step:function(t,i){i=i||e.Event();var s=n.step=="any"?1:n.step;r.setValue(l+s*(t||1),i)},stepUp:function(e){return r.step(e||1)},stepDown:function(e){return r.step(-e||-1)}}),e.each("onSlide,change".split(","),function(t,i){e.isFunction(n[i])&&e(r).on(i,n[i]),r[i]=function(t){return t&&e(r).on(i,t),r}}),d.drag({drag:!1}).on("dragStart",function(){T(),S=o(e(r))||o(t)}).on("drag",function(e,n,r){if(t.is(":disabled"))return!1;x(e,f?n:r)}).on("dragEnd",function(e){e.isDefaultPrevented()||(e.type="change",E.trigger(e,[l]))}).click(function(e){return e.preventDefault()}),a.click(function(e){if(t.is(":disabled")||e.target==d[0])return e.preventDefault();T();var n=f?d.height()/2:d.width()/2;x(e,f?h-c-n+e.pageY:e.pageX-c-n)}),n.keyboard&&t.keydown(function(n){if(t.attr("readonly"))return;var i=n.keyCode,s=e([75,76,38,33,39]).index(i)!=-1,o=e([74,72,40,34,37]).index(i)!=-1;if((s||o)&&!(n.shiftKey||n.altKey||n.ctrlKey))return s?r.step(i==33?10:1,n):o&&r.step(i==34?-10:-1,n),n.preventDefault()}),t.blur(function(t){var n=e(this).val();n!==l&&r.setValue(n,t)}),e.extend(t[0],{stepUp:r.stepUp,stepDown:r.stepDown}),N(),h||e(window).load(N)}e.tools=e.tools||{version:"1.2.7"};var t;t=e.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:undefined,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var n,r;e.fn.drag=function(t){return document.ondragstart=function(){return!1},t=e.extend({x:!0,y:!0,drag:!0},t),n=n||e(document).on("mousedown mouseup",function(i){var s=e(i.target);if(i.type=="mousedown"&&s.data("drag")){var o=s.position(),u=i.pageX-o.left,a=i.pageY-o.top,f=!0;n.on("mousemove.drag",function(e){var n=e.pageX-u,i=e.pageY-a,o={};t.x&&(o.left=n),t.y&&(o.top=i),f&&(s.trigger("dragStart"),f=!1),t.drag&&s.css(o),s.trigger("drag",[i,n]),r=s}),i.preventDefault()}else try{r&&r.trigger("dragEnd")}finally{n.off("mousemove.drag"),r=null}}),this.data("drag",!0)},e.expr[":"].range=function(t){var n=t.getAttribute("type");return n&&n=="range"||!!e(t).filter("input").data("rangeinput")},e.fn.rangeinput=function(n){if(this.data("rangeinput"))return this;n=e.extend(!0,{},t.conf,n);var r;return this.each(function(){var t=new u(e(this),e.extend(!0,{},n)),i=t.getInput().data("rangeinput",t);r=r?r.add(i):i}),r?r:this}});

==================================================
FILE PATH: ./public/js/external_libs/jquery.scrollTo.js
==================================================
/*!
 * jQuery.ScrollTo
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 12/14/2012
 *
 * @projectDescription Easy element scrolling using jQuery.
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @author Ariel Flesler
 * @version 1.4.5 BETA
 *
 * @id jQuery.scrollTo
 * @id jQuery.fn.scrollTo
 * @param {String, Number, DOMElement, jQuery, Object} target Where to scroll the matched elements.
 *	  The different options for target are:
 *		- A number position (will be applied to all axes).
 *		- A string position ('44', '100px', '+=90', etc ) will be applied to all axes
 *		- A jQuery/DOM element ( logically, child of the element to scroll )
 *		- A string selector, that will be relative to the element to scroll ( 'li:eq(2)', etc )
 *		- A hash { top:x, left:y }, x and y can be any kind of number/string like above.
 *		- A percentage of the container's dimension/s, for example: 50% to go to the middle.
 *		- The string 'max' for go-to-end.
 * @param {Number, Function} duration The OVERALL length of the animation, this argument can be the settings object instead.
 * @param {Object,Function} settings Optional set of settings or the onAfter callback.
 *	 @option {String} axis Which axis must be scrolled, use 'x', 'y', 'xy' or 'yx'.
 *	 @option {Number, Function} duration The OVERALL length of the animation.
 *	 @option {String} easing The easing method for the animation.
 *	 @option {Boolean} margin If true, the margin of the target element will be deducted from the final position.
 *	 @option {Object, Number} offset Add/deduct from the end position. One number for both axes or { top:x, left:y }.
 *	 @option {Object, Number} over Add/deduct the height/width multiplied by 'over', can be { top:x, left:y } when using both axes.
 *	 @option {Boolean} queue If true, and both axis are given, the 2nd axis will only be animated after the first one ends.
 *	 @option {Function} onAfter Function to be called after the scrolling ends.
 *	 @option {Function} onAfterFirst If queuing is activated, this function will be called after the first scrolling ends.
 * @return {jQuery} Returns the same jQuery object, for chaining.
 *
 * @desc Scroll to a fixed position
 * @example $('div').scrollTo( 340 );
 *
 * @desc Scroll relatively to the actual position
 * @example $('div').scrollTo( '+=340px', { axis:'y' } );
 *
 * @desc Scroll using a selector (relative to the scrolled element)
 * @example $('div').scrollTo( 'p.paragraph:eq(2)', 500, { easing:'swing', queue:true, axis:'xy' } );
 *
 * @desc Scroll to a DOM element (same for jQuery object)
 * @example var second_child = document.getElementById('container').firstChild.nextSibling;
 *			$('#container').scrollTo( second_child, { duration:500, axis:'x', onAfter:function(){
 *				alert('scrolled!!');
 *			}});
 *
 * @desc Scroll on both axes, to different values
 * @example $('div').scrollTo( { top: 300, left:'+=200' }, { axis:'xy', offset:-20 } );
 */

timely.define(["jquery_timely"],function(e){function n(e){return typeof e=="object"?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,r){e(window).scrollTo(t,n,r)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})},e.fn.scrollTo=function(r,i,s){return typeof i=="object"&&(s=i,i=0),typeof s=="function"&&(s={onAfter:s}),r=="max"&&(r=9e9),s=e.extend({},t.defaults,s),i=i||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(i/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function h(e){u.animate(l,i,s.easing,e&&function(){e.call(this,r,s)})}if(r==null)return;var o=this,u=e(o),a=r,f,l={},c=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)f=(a=e(a)).offset()}e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),p="scroll"+r,d=o[p],v=t.max(o,n);if(f)l[p]=f[i]+(c?0:d-u.offset()[i]),s.margin&&(l[p]-=parseInt(a.css("margin"+r))||0,l[p]-=parseInt(a.css("border"+r+"Width"))||0),l[p]+=s.offset[i]||0,s.over[i]&&(l[p]+=a[n=="x"?"width":"height"]()*s.over[i]);else{var m=a[i];l[p]=m.slice&&m.slice(-1)=="%"?parseFloat(m)/100*v:m}s.limit&&/^\d+$/.test(l[p])&&(l[p]=l[p]<=0?0:Math.min(l[p],v)),!e&&s.queue&&(d!=l[p]&&h(s.onAfterFirst),delete l[p])}),h(s.onAfter)}).end()},t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.rs-latin.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["rs-latin"]={days:["Nedelja","Ponedeljak","Utorak","Sreda","etvrtak","Petak","Subota","Nedelja"],daysShort:["Ned","Pon","Uto","Sre","et","Pet","Sub","Ned"],daysMin:["N","Po","U","Sr","","Pe","Su","N"],months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danas"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.sq.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sq={days:["E Diel","E Hn","E mart","E mrkur","E Enjte","E Premte","E Shtun","E Diel"],daysShort:["Die","Hn","Mar","Mr","Enj","Pre","Shtu","Die"],daysMin:["Di","H","Ma","M","En","Pr","Sht","Di"],months:["Janar","Shkurt","Mars","Prill","Maj","Qershor","Korrik","Gusht","Shtator","Tetor","Nntor","Dhjetor"],monthsShort:["Jan","Shk","Mar","Pri","Maj","Qer","Korr","Gu","Sht","Tet","Nn","Dhjet"],today:"Sot"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.hr.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.hr={days:["Nedjelja","Ponedjelja","Utorak","Srijeda","etrtak","Petak","Subota","Nedjelja"],daysShort:["Ned","Pon","Uto","Srr","et","Pet","Sub","Ned"],daysMin:["Ne","Po","Ut","Sr","e","Pe","Su","Ne"],months:["Sijeanj","Veljaa","Oujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],monthsShort:["Sije","Velj","Ou","Tra","Svi","Lip","Jul","Kol","Ruj","Lis","Stu","Pro"],today:"Danas"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ua.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ua={days:["","","","","","'","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["C","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.lt.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lt={days:["Sekmadienis","Pirmadienis","Antradienis","Treiadienis","Ketvirtadienis","Penktadienis","etadienis","Sekmadienis"],daysShort:["S","Pr","A","T","K","Pn","","S"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","t","Sk"],months:["Sausis","Vasaris","Kovas","Balandis","Gegu","Birelis","Liepa","Rugpjtis","Rugsjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"iandien",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ka.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ka={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",clear:"",weekStart:1,format:"dd.mm.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.hu.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.hu={days:["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","Szombat","Vasrnap"],daysShort:["Vas","Ht","Ked","Sze","Cs","Pn","Szo","Vas"],daysMin:["Va","H","Ke","Sz","Cs","P","Sz","Va"],months:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],monthsShort:["Jan","Feb","Mr","pr","Mj","Jn","Jl","Aug","Sze","Okt","Nov","Dec"],today:"Ma",weekStart:1,format:"yyyy.mm.dd"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.sk.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sk={days:["Nedea","Pondelok","Utorok","Streda","tvrtok","Piatok","Sobota","Nedea"],daysShort:["Ned","Pon","Uto","Str","tv","Pia","Sob","Ned"],daysMin:["Ne","Po","Ut","St","t","Pia","So","Ne"],months:["Janur","Februr","Marec","Aprl","Mj","Jn","Jl","August","September","Oktber","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Mj","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],today:"Dnes"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.pt-BR.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["pt-BR"]={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.sv.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sv={days:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Mn","Tis","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","M","Ti","On","To","Fr","L","S"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",format:"yyyy-mm-dd",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.cs.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.cs={days:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota","Nedle"],daysShort:["Ned","Pon","te","St","tv","Pt","Sob","Ned"],daysMin:["Ne","Po","t","St","t","P","So","Ne"],months:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],monthsShort:["Led","no","Be","Dub","Kv","er","nc","Srp","Z","j","Lis","Pro"],today:"Dnes"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.is.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.is={days:["Sunnudagur","Mnudagur","rijudagur","Mivikudagur","Fimmtudagur","Fstudagur","Laugardagur","Sunnudagur"],daysShort:["Sun","Mn","ri","Mi","Fim","Fs","Lau","Sun"],daysMin:["Su","M","r","Mi","Fi","F","La","Su"],months:["Janar","Febrar","Mars","Aprl","Ma","Jn","Jl","gst","September","Oktber","Nvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Ma","Jn","Jl","g","Sep","Okt","Nv","Des"],today:" Dag"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ro.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ro={days:["Duminic","Luni","Mari","Miercuri","Joi","Vineri","Smbt","Duminic"],daysShort:["Dum","Lun","Mar","Mie","Joi","Vin","Sm","Dum"],daysMin:["Du","Lu","Ma","Mi","Jo","Vi","S","Du"],months:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],monthsShort:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],today:"Astzi",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.bg.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.bg={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.sl.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sl={days:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota","Nedelja"],daysShort:["Ned","Pon","Tor","Sre","et","Pet","Sob","Ned"],daysMin:["Ne","Po","To","Sr","e","Pe","So","Ne"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.fr.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],daysMin:["D","L","Ma","Me","J","V","S","D"],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],monthsShort:["Jan","Fv","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Dc"],today:"Aujourd'hui",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.nl.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nl={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.fi.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fi={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai","sunnuntai"],daysShort:["sun","maa","tii","kes","tor","per","lau","sun"],daysMin:["su","ma","ti","ke","to","pe","la","su"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tnn",weekStart:1,format:"d.m.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.nb.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.nb={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ru.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ru={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.no.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.no={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr"],daysMin:["S","Ma","Ti","On","To","Fr","L"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I dag",clear:"Nullstill",weekStart:1,format:"dd.mm.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.cy.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.cy={days:["Sul","Llun","Mawrth","Mercher","Iau","Gwener","Sadwrn","Sul"],daysShort:["Sul","Llu","Maw","Mer","Iau","Gwe","Sad","Sul"],daysMin:["Su","Ll","Ma","Me","Ia","Gwe","Sa","Su"],months:["Ionawr","Chewfror","Mawrth","Ebrill","Mai","Mehefin","Gorfennaf","Awst","Medi","Hydref","Tachwedd","Rhagfyr"],monthsShort:["Ion","Chw","Maw","Ebr","Mai","Meh","Gor","Aws","Med","Hyd","Tach","Rha"],today:"Heddiw"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.mk.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.mk={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"dd.mm.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.el.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.el={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ms.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ms={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu","Ahad"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab","Aha"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa","Ah"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.de.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Lschen",weekStart:1,format:"dd.mm.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ar.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ar={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:" ",rtl:!0}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.id.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.id={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab","Mgu"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa","Mg"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.tr.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.tr={days:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],daysShort:["Pz","Pzt","Sal","r","Pr","Cu","Cts","Pz"],daysMin:["Pz","Pzt","Sa","r","Pr","Cu","Ct","Pz"],months:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],monthsShort:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],today:"Bugn",format:"dd.mm.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.nl-BE.js
==================================================
timely.define(["jquery_timely"],function(e){e.fn.datepicker.dates["nl-BE"]={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag",clear:"Leegmaken",weekStart:1,format:"dd/mm/yyyy"}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ja.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ja={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],today:"",format:"yyyy/mm/dd"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.fa.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.fa={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",clear:" ",weekStart:1,format:"yyyy/mm/dd"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.zh-CN.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-CN"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.es.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado","Domingo"],daysShort:["Dom","Lun","Mar","Mi","Jue","Vie","Sb","Dom"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.it.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.it={days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato","Domenica"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab","Dom"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa","Do"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.br.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.br={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.he.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.he={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",rtl:!0}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.th.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.th={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["..","..","..","..","..","..","..","..","..","..","..",".."],today:""}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.gl.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.gl={days:["Domingo","Luns","Martes","Mrcores","Xoves","Venres","Sbado","Domingo"],daysShort:["Dom","Lun","Mar","Mr","Xov","Ven","Sb","Dom"],daysMin:["Do","Lu","Ma","Me","Xo","Ve","Sa","Do"],months:["Xaneiro","Febreiro","Marzo","Abril","Maio","Xuo","Xullo","Agosto","Setembro","Outubro","Novembro","Decembro"],monthsShort:["Xan","Feb","Mar","Abr","Mai","Xun","Xul","Ago","Sep","Out","Nov","Dec"],today:"Hoxe",clear:"Limpar"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.et.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.et={days:["Phapev","Esmaspev","Teisipev","Kolmapev","Neljapev","Reede","Laupev","Phapev"],daysShort:["Phap","Esmasp","Teisip","Kolmap","Neljap","Reede","Laup","Phap"],daysMin:["P","E","T","K","N","R","L","P"],months:["Jaanuar","Veebruar","Mrts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],monthsShort:["Jaan","Veebr","Mrts","Apr","Mai","Juuni","Juuli","Aug","Sept","Okt","Nov","Dets"],today:"Tna",clear:"Thjenda",weekStart:1,format:"dd.mm.yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.pl.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pl={days:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota","Niedziela"],daysShort:["Nie","Pn","Wt","r","Czw","Pt","So","Nie"],daysMin:["N","Pn","Wt","r","Cz","Pt","So","N"],months:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],monthsShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],today:"Dzisiaj",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.sw.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.sw={days:["Jumapili","Jumatatu","Jumanne","Jumatano","Alhamisi","Ijumaa","Jumamosi","Jumapili"],daysShort:["J2","J3","J4","J5","Alh","Ij","J1","J2"],daysMin:["2","3","4","5","A","I","1","2"],months:["Januari","Februari","Machi","Aprili","Mei","Juni","Julai","Agosti","Septemba","Oktoba","Novemba","Desemba"],monthsShort:["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ago","Sep","Okt","Nov","Des"],today:"Leo"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.da.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.da={days:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag","Sndag"],daysShort:["Sn","Man","Tir","Ons","Tor","Fre","Lr","Sn"],daysMin:["S","Ma","Ti","On","To","Fr","L","S"],months:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",clear:"Nulstil"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.ca.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.ca={days:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte","Diumenge"],daysShort:["Diu","Dil","Dmt","Dmc","Dij","Div","Dis","Diu"],daysMin:["dg","dl","dt","dc","dj","dv","ds","dg"],months:["Gener","Febrer","Mar","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],monthsShort:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],today:"Avui"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.kk.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.kk={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.lv.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.lv={days:["Svtdiena","Pirmdiena","Otrdiena","Trediena","Ceturtdiena","Piektdiena","Sestdiena","Svtdiena"],daysShort:["Sv","P","O","T","C","Pk","S","Sv"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se","Sv"],months:["Janvris","Februris","Marts","Aprlis","Maijs","Jnijs","Jlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],today:"odien",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.zh-TW.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates["zh-TW"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",format:"yyyymmdd",weekStart:1}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.vi.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.vi={days:["Ch nht","Th hai","Th ba","Th t","Th nm","Th su","Th by","Ch nht"],daysShort:["CN","Th 2","Th 3","Th 4","Th 5","Th 6","Th 7","CN"],daysMin:["CN","T2","T3","T4","T5","T6","T7","CN"],months:["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"],monthsShort:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],today:"Hm nay",clear:"Xa",format:"dd/mm/yyyy"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.rs.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.rs={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:""}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.pt.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.pt={days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"}}}});

==================================================
FILE PATH: ./public/js/external_libs/locales/bootstrap-datepicker.kr.js
==================================================
timely.define(["jquery_timely"],function(e){return{localize:function(){e.fn.datepicker.dates.kr={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}});

==================================================
FILE PATH: ./public/js/external_libs/jquery.calendrical_timespan.js
==================================================
timely.define(["jquery_timely"],function(e){function l(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function c(e,t){return typeof e=="string"&&(e=new Date(e)),typeof t=="string"&&(t=new Date(t)),e.getUTCDate()===t.getUTCDate()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCFullYear()===t.getUTCFullYear()?!0:!1}function h(e,t){if(e instanceof Date)return h(e.getUTCFullYear(),e.getUTCMonth());if(t==1){var n=e%4==0&&(e%100!=0||e%400==0);return n?29:28}return t==3||t==5||t==8||t==10?30:31}function p(e){return new Date(e.getTime()+864e5)}function d(e){return new Date(e.getTime()-864e5)}function v(e,t){return t==11?new Date(e+1,0,1):new Date(e,t+1,1)}function m(t,n,r,i){var s=i.monthNames.split(","),o=e("<thead />"),u=e("<tr />").appendTo(o);e("<th />").addClass("monthCell").append(e('<a href="javascript:;">&laquo;</a>').addClass("prevMonth").mousedown(function(e){g(t,r==0?n-1:n,r==0?11:r-1,i),e.preventDefault()})).appendTo(u),e("<th />").addClass("monthCell").attr("colSpan",5).append(e('<a href="javascript:;">'+s[r]+" "+n+"</a>").addClass("monthName")).appendTo(u),e("<th />").addClass("monthCell").append(e('<a href="javascript:;">&raquo;</a>').addClass("nextMonth").mousedown(function(){g(t,r==11?n+1:n,r==11?0:r+1,i)})).appendTo(u);var a=i.dayNames.split(","),f=parseInt(i.weekStartDay),l=[];for(var c=0,h=a.length;c<h;c++)l[c]=a[(c+f)%h];var p=e("<tr />").appendTo(o);return e.each(l,function(t,n){e("<td />").addClass("dayName").append(n).appendTo(p)}),o}function g(t,n,r,i){i=i||{};var s=parseInt(i.weekStartDay),o=i.today?i.today:l();o.setHours(0),o.setMinutes(0);var u=new Date(n,r,1),a=v(n,r),f=Math.abs(o.getTimezoneOffset());f!=0&&(o.setHours(o.getHours()+f/60),o.setMinutes(o.getMinutes()+f%60),u.setHours(u.getHours()+f/60),u.setMinutes(u.getMinutes()+f%60),a.setHours(a.getHours()+f/60),a.setMinutes(a.getMinutes()+f%60));var h=a.getUTCDay()-s;h<0?h=Math.abs(h)-1:h=6-h;for(var g=0;g<h;g++)a=p(a);var y=e("<table />");m(t,n,r,i).appendTo(y);var b=e("<tbody />").appendTo(y),w=e("<tr />"),E=u.getUTCDay()-s;E<0&&(E=7+E);for(var g=0;g<E;g++)u=d(u);while(u<=a){var S=e("<td />").addClass("day").append(e('<a href="javascript:;">'+u.getUTCDate()+"</a>").click(function(){var e=u;return function(){i&&i.selectDate&&i.selectDate(e)}}())).appendTo(w),x=c(u,o),T=i.selected&&c(i.selected,u);x&&S.addClass("today"),T&&S.addClass("selected"),x&&T&&S.addClass("today_selected"),u.getUTCMonth()!=r&&S.addClass("nonMonth");var N=u.getUTCDay();(N+1)%7==s&&(b.append(w),w=e("<tr />")),u=p(u)}w.children().length?b.append(w):w.remove(),t.empty().append(y)}function y(t,n){var r=n.selection&&f(n.selection);r&&(r.minute=Math.floor(r.minute/15)*15);var i=n.startTime&&n.startTime.hour*60+n.startTime.minute,s,o=e("<ul />");for(var a=0;a<24;a++)for(var l=0;l<60;l+=15){if(i&&i>a*60+l)continue;(function(){var t=u(a,l,n.isoTime),f=t;if(i!=null){var c=a*60+l-i;c<60?f+=" ("+c+" min)":c==60?f+=" (1 hr)":f+=" ("+Math.floor(c/60)+" hr "+c%60+" min)"}var h=e("<li />").append(e('<a href="javascript:;">'+f+"</a>").click(function(){n&&n.selectTime&&n.selectTime(t)}).mousemove(function(){e("li.selected",o).removeClass("selected")})).appendTo(o);!s&&a==n.defaultHour&&(s=h),r&&r.hour==a&&r.minute==l&&(h.addClass("selected"),s=h)})()}s&&setTimeout(function(){t[0].scrollTop=s[0].offsetTop-s.height()*2},0),t.empty().append(o)}function b(e){e.addClass("error").fadeOut("normal",function(){e.val(e.data("timespan.stored")).removeClass("error").fadeIn("fast")})}function w(){e(this).data("timespan.stored",this.value)}function E(t,n,r,i,a,f,l,c,h,p){r.val(r.data("timespan.initial_value")),f.val(f.data("timespan.initial_value")),l.get(0).checked=l.data("timespan.initial_value");var d=s(r,p,0,15);n.val(u(d.getUTCHours(),d.getUTCMinutes(),c)),t.val(o(d,h));var v=s(f,d.getTime(),1,15);a.val(u(v.getUTCHours(),v.getUTCMinutes(),c)),l.get(0).checked&&v.setUTCDate(v.getUTCDate()-1),i.val(o(v,h)),t.each(w),n.each(w),i.each(w),a.each(w),l.trigger("change.timespan"),e("#ai1ec_instant_event").trigger("change.timespan")}var t={us:{pattern:/([\d]{1,2})\/([\d]{1,2})\/([\d]{4}|[\d]{2})/,format:"m/d/y",order:"middleEndian",zeroPad:!1},iso:{pattern:/([\d]{4}|[\d]{2})-([\d]{1,2})-([\d]{1,2})/,format:"y-m-d",order:"bigEndian",zeroPad:!0},dot:{pattern:/([\d]{1,2}).([\d]{1,2}).([\d]{4}|[\d]{2})/,format:"d.m.y",order:"littleEndian",zeroPad:!1},def:{pattern:/([\d]{1,2})\/([\d]{1,2})\/([\d]{4}|[\d]{2})/,format:"d/m/y",order:"littleEndian",zeroPad:!1}},n=function(e){return e<10?"0"+e:e},r=function(e,t){typeof t=="undefined"&&(t=!1);var r=e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate());return t&&(r+="T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":00"),r},i=function(e,t){var n=e.val(),r=null;if(n.length<4)r=new Date(t);else{r=new Date(n);var i=n.split("T"),s=i[0].split("-"),o=i[1].split(":");r.setUTCFullYear(s[0],s[1]-1,s[2]),r.setUTCHours(o[0],o[1],o[2],0)}return r},s=function(e,t,n,r){return t+=n*36e5,t-=t%(r*6e4),i(e,t)},o=function(e,n,r){var i,s,o;typeof t[n]=="undefined"&&(n="def"),typeof r=="undefined"&&(r=!1),!0===r?(i=e.getFullYear().toString(),s=(e.getMonth()+1).toString(),o=e.getDate().toString()):(i=e.getUTCFullYear().toString(),s=(e.getUTCMonth()+1).toString(),o=e.getUTCDate().toString()),t[n].zeroPad&&(s.length==1&&(s="0"+s),o.length==1&&(o="0"+o));var u=t[n].format;return u=u.replace("d",o),u=u.replace("m",s),u=u.replace("y",i),u},u=function(e,t,n){var r=t;t<10&&(r="0"+t);if(n){var i=e;return i<10&&(i="0"+e),i+":"+r}var i=e%12;i==0&&(i=12);var s=e<12?"am":"pm";return i+":"+r+s},a=function(e,n){typeof t[n]=="undefined"&&(n="def");var r=e.match(t[n].pattern);if(!r||r.length!=4)return Date("invalid");switch(t[n].order){case"bigEndian":var i=r[3],s=r[2],o=r[1];break;case"littleEndian":var i=r[1],s=r[2],o=r[3];break;case"middleEndian":var i=r[2],s=r[1],o=r[3];break;default:var i=r[1],s=r[2],o=r[3]}return o.length==2&&(o=(new Date).getUTCFullYear().toString().substr(0,2)+o),new Date(s+"/"+i+"/"+o+" GMT")},f=function(e){var t=t=/(\d+)\s*[:\-\.,]\s*(\d+)\s*(am|pm)?/i.exec(e);if(t&&t.length>=3){var n=Number(t[1]),r=Number(t[2]);return n==12&&t[3]&&(n-=12),t[3]&&t[3].toLowerCase()=="pm"&&(n+=12),{hour:n,minute:r}}return null};e.fn.calendricalDate=function(t){return t=t||{},t.padding=t.padding||4,t.monthNames=t.monthNames||"January,February,March,April,May,June,July,August,September,October,November,December",t.dayNames=t.dayNames||"S,M,T,W,T,F,S",t.weekStartDay=t.weekStartDay||0,this.each(function(){var n=e(this),r,i=!1;n.bind("focus",function(){if(r)return;var s=n.position(),u=n.css("padding-left");r=e("<div />").addClass("calendricalDatePopup").mouseenter(function(){i=!0}).mouseleave(function(){i=!1}).mousedown(function(e){e.preventDefault()}).css({position:"absolute",left:s.left,top:s.top+n.height()+t.padding*2}),n.after(r);var f=a(n.val(),t.dateFormat);f.getUTCFullYear()||(f=t.today?t.today:l()),g(r,f.getUTCFullYear(),f.getUTCMonth(),{today:t.today,selected:f,monthNames:t.monthNames,dayNames:t.dayNames,weekStartDay:t.weekStartDay,selectDate:function(e){i=!1,n.val(o(e,t.dateFormat)),r.remove(),r=null;if(t.endDate){var s=a(t.endDate.val(),t.dateFormat);s>=f&&t.endDate.val(o(new Date(e.getTime()+s.getTime()-f.getTime()),t.dateFormat))}}})}).blur(function(){if(i){r&&n.focus();return}if(!r)return;r.remove(),r=null})})},e.fn.calendricalDateRange=function(t){return this.length>=2&&(e(this[0]).calendricalDate(e.extend({endDate:e(this[1])},t)),e(this[1]).calendricalDate(t)),this},e.fn.calendricalDateRangeSingle=function(t){return this.length==1&&e(this).calendricalDate(t),this},e.fn.calendricalTime=function(t){return t=t||{},t.padding=t.padding||4,this.each(function(){var n=e(this),r,i=!1;n.bind("focus click",function(){if(r)return;var s=t.startTime;s&&t.startDate&&t.endDate&&!c(a(t.startDate.val()),a(t.endDate.val()))&&(s=!1);var o=n.position();r=e("<div />").addClass("calendricalTimePopup").mouseenter(function(){i=!0}).mouseleave(function(){i=!1}).mousedown(function(e){e.preventDefault()}).css({position:"absolute",left:o.left,top:o.top+n.height()+t.padding*2}),s&&r.addClass("calendricalEndTimePopup"),n.after(r);var u={selection:n.val(),selectTime:function(e){i=!1,n.val(e),r.remove(),r=null},isoTime:t.isoTime||!1,defaultHour:t.defaultHour!=null?t.defaultHour:8};s&&(u.startTime=f(t.startTime.val())),y(r,u)}).blur(function(){if(i){r&&n.focus();return}if(!r)return;r.remove(),r=null})})},e.fn.calendricalTimeRange=function(t){return this.length>=2&&(e(this[0]).calendricalTime(t),e(this[1]).calendricalTime(e.extend({startTime:e(this[0])},t))),this},e.fn.calendricalDateTimeRange=function(t){return this.length>=4&&(e(this[0]).calendricalDate(e.extend({endDate:e(this[2])},t)),e(this[1]).calendricalTime(t),e(this[2]).calendricalDate(t),e(this[3]).calendricalTime(e.extend({startTime:e(this[1]),startDate:e(this[0]),endDate:e(this[2])},t))),this};var S={allday:"#allday",start_date_input:"#start-date-input",start_time_input:"#start-time-input",start_time:"#start-time",end_date_input:"#end-date-input",end_time_input:"#end-time-input",end_time:"#end-time",twentyfour_hour:!1,date_format:"def",now:new Date},x={init:function(t){function C(){var e=a(s.val(),n.date_format).getTime()/1e3,t=f(l.val());e+=t.hour*3600+t.minute*60;var r=a(h.val(),n.date_format).getTime()/1e3,i=f(p.val());return r+=i.hour*3600+i.minute*60,r-e}function k(){var e=a(s.data("timespan.stored"),n.date_format),t=f(l.data("timespan.stored")),r=e.getTime()/1e3+t.hour*3600+t.minute*60+s.data("time_diff");return r=new Date(r*1e3),h.val(o(r,n.date_format)),p.val(u(r.getUTCHours(),r.getUTCMinutes(),n.twentyfour_hour)),!0}function L(){var e=a(s.val(),n.date_format).getTime()/1e3;if(!isNaN(e)){if(!i.get(0).checked){var t=f(l.val());t?e+=t.hour*3600+t.minute*60:e=""}}else e="";e>0&&c.val(r(new Date(e*1e3),!0));var o=a(h.val(),n.date_format).getTime()/1e3;if(!isNaN(o))if(i.get(0).checked)o+=86400;else{var t=f(p.val());t?o+=t.hour*3600+t.minute*60:o=""}else o="";o>0&&d.val(r(new Date(o*1e3),!0))}var n=e.extend({},S,t),i=e(n.allday),s=e(n.start_date_input),l=e(n.start_time_input),c=e(n.start_time),h=e(n.end_date_input),p=e(n.end_time_input),d=e(n.end_time),v=e("#ai1ec_instant_event"),m=h.add(p),g=s.add(n.end_date_input),y=l.add(n.end_time_input),x=s.add(n.start_time_input).add(n.end_date_input).add(n.end_time_input);x.bind("focus.timespan",w),v.bind("change.timespan",function(){this.checked?(m.closest("tr").fadeOut(),i.attr("disabled",!0)):(i.removeAttr("disabled"),m.closest("tr").fadeIn())});var T=new Date(n.now.getFullYear(),n.now.getMonth(),n.now.getDate()),N=!1;return i.bind("change.timespan",function(){this.checked?(y.fadeOut(),v.attr("disabled",!0)):(v.removeAttr("disabled"),y.fadeIn()),N||(N=!0,x.calendricalDateTimeRange({today:T,dateFormat:n.date_format,isoTime:n.twentyfour_hour,monthNames:n.month_names,dayNames:n.day_names,weekStartDay:n.week_start_day}))}).get().checked=!1,g.bind("blur.timespan",function(){var t=a(this.value,n.date_format);isNaN(t)?b(e(this)):(e(this).data("timespan.stored",this.value),e(this).val(o(t,n.date_format)))}),y.bind("blur.timespan",function(){var t=f(this.value);t?(e(this).data("timespan.stored",this.value),e(this).val(u(t.hour,t.minute,n.twentyfour_hour))):b(e(this))}),s.add(n.start_time_input).bind("focus.timespan",function(){s.data("time_diff",C())}).bind("blur.timespan",function(){s.data("time_diff")<0&&s.data("time_diff",900);var e=k()}),h.add(n.start_time_input).bind("blur.timespan",function(){if(C()<0){s.data("time_diff",900);var e=k()}}),s.closest("form").bind("submit.timespan",L),s.closest("form").find("#ai1ec_start-date-input, #ai1ec_end-date-input, 				 #ai1ec_start-time-input, #ai1ec_end-time-input").on("change",L),s.closest(".ai1ec-form").on("click",L),c.data("timespan.initial_value",c.val()),d.data("timespan.initial_value",d.val()),i.data("timespan.initial_value",i.get(0).checked),E(s,l,c,h,p,d,i,n.twentyfour_hour,n.date_format,n.now),this},reset:function(t){var n=e.extend({},S,t);return E(e(n.start_date_input),e(n.start_time_input),e(n.start_time),e(n.end_date_input),e(n.end_time_input),e(n.end_time),e(n.allday),n.twentyfour_hour,n.date_format,n.now),this},destroy:function(t){return t=e.extend({},S,t),e.each(t,function(t,n){e(n).unbind(".timespan")}),e(t.start_date_input).closest("form").unbind(".timespan"),this}};return e.timespan=function(t){if(x[t])return x[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return x.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timespan")},{formatDate:o,parseDate:a}});

==================================================
FILE PATH: ./public/js/external_libs/modernizr.js
==================================================
timely.define([],function(){var e=function(e,t,n){function S(e){f.cssText=e}function x(e,t){return S(h.join(e+";")+(t||""))}function T(e,t){return typeof e===t}function N(e,t){return!!~(""+e).indexOf(t)}function C(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:T(s,"function")?s.bind(r||t):s}return!1}var r="2.5.3",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p={},d={},v={},m=[],g=m.slice,y,b=function(e,n,r,i){var s,a,f,l=t.createElement("div"),c=t.body,h=c?c:t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),l.appendChild(f);return s=["&#173;","<style>",e,"</style>"].join(""),l.id=u,(c?l:h).innerHTML+=s,h.appendChild(l),c||(h.style.background="",o.appendChild(h)),a=n(l,e),c?l.parentNode.removeChild(l):h.parentNode.removeChild(h),!!a},w={}.hasOwnProperty,E;!T(w,"undefined")&&!T(w.call,"undefined")?E=function(e,t){return w.call(e,t)}:E=function(e,t){return t in e&&T(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=g.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(g.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(g.call(arguments)))};return i});var k=function(n,r){var s=n.join(""),o=r.length;b(s,function(n,r){var s=t.styleSheets[t.styleSheets.length-1],u=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"",a=n.childNodes,f={};while(o--)f[a[o].id]=a[o];i.touch="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch||(f.touch&&f.touch.offsetTop)===9},o,r)}([,["@media (",h.join("touch-enabled),("),u,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);p.touch=function(){return i.touch};for(var L in p)E(p,L)&&(y=L.toLowerCase(),i[y]=p[L](),m.push((i[y]?"":"no-")+y));return S(""),a=l=null,i._version=r,i._prefixes=h,i.testStyles=b,o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+m.join(" "):""),i}(window,window.document);return e});

==================================================
FILE PATH: ./public/js/external_libs/jquery.tablescroller.js
==================================================
/*

Copyright (c) 2009 Dimas Begunoff, http://www.farinspace.com

Licensed under the MIT license
http://en.wikipedia.org/wiki/MIT_License

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

*/

timely.define(["jquery_timely"],function(e){function n(){if(t)return t;var n=e('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>');e("body").append(n);var r=e("div",n).innerWidth();n.css("overflow-y","auto");var i=e("div",n).innerWidth();return e(n).remove(),t=r-i,t}var t=0;e.fn.tableScroll=function(t){if(t=="undo"){var r=e(this).parent().parent();r.hasClass("tablescroll_wrapper")&&(r.find(".tablescroll_head thead").prependTo(this),r.find(".tablescroll_foot tfoot").appendTo(this),r.before(this),r.empty());return}var i=e.extend({},e.fn.tableScroll.defaults,t);return i.scrollbarWidth=n(),this.each(function(){var t=i.flush,n=e(this).addClass("tablescroll_body"),r=e('<div class="tablescroll_wrapper ai1ec-popover-boundary"></div>').insertBefore(n).append(n);r.parent("div").hasClass(i.containerClass)||e("<div></div>").addClass(i.containerClass).insertBefore(r).append(r);var s=i.width?i.width:n.outerWidth(),o=i.scroll?"auto":"hidden";r.css({width:s+"px",height:i.height+"px",overflow:o}),n.css("width",s+"px");var u=r.outerWidth(),a=u-s;r.css({width:s-a-2+"px"}),n.css("width",s-a-i.scrollbarWidth+"px"),n.outerHeight()<=i.height&&(r.css({height:"auto",width:s-a+"px"}),t=!1);var f=e("thead",n).length?!0:!1,l=e("tfoot",n).length?!0:!1,c=e("thead tr:first",n),h=e("tbody tr:first",n),p=e("tfoot tr:first",n),d=0;e("th, td",c).each(function(t){d=e(this).width(),e("th:eq("+t+"), td:eq("+t+")",c).css("width",d+"px"),e("th:eq("+t+"), td:eq("+t+")",h).css("width",d+"px"),l&&e("th:eq("+t+"), td:eq("+t+")",p).css("width",d+"px")});if(f)var v=e('<table class="tablescroll_head" cellspacing="0"></table>').insertBefore(r).prepend(e("thead",n));if(l)var m=e('<table class="tablescroll_foot" cellspacing="0"></table>').insertAfter(r).prepend(e("tfoot",n));v!=undefined&&(v.css("width",s+"px"),t&&(e("tr:first th:last, tr:first td:last",v).css("width",d+i.scrollbarWidth+"px"),v.css("width",r.outerWidth()+"px"))),m!=undefined&&(m.css("width",s+"px"),t&&(e("tr:first th:last, tr:first td:last",m).css("width",d+i.scrollbarWidth+"px"),m.css("width",r.outerWidth()+"px")))}),this},e.fn.tableScroll.defaults={flush:!0,width:null,height:100,containerClass:"tablescroll",scroll:!0}});

==================================================
FILE PATH: ./public/js/external_libs/Placeholders.js
==================================================
/*
 * The MIT License
 *
 * Copyright (c) 2012 James Allardice
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

timely.define([],function(){function e(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent)return e.attachEvent("on"+t,n)}function t(e,t){var n,r;for(n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1}function n(e,t){var n;e.createTextRange?(n=e.createTextRange(),n.move("character",t),n.select()):e.selectionStart&&(e.focus(),e.setSelectionRange(t,t))}function r(e,t){try{return e.type=t,!0}catch(n){return!1}}function P(e){var t;return e.value===e.getAttribute(h)&&e.getAttribute(p)==="true"?(e.setAttribute(p,"false"),e.value="",e.className=e.className.replace(f,""),t=e.getAttribute(d),t&&(e.type=t),!0):!1}function H(e){var t;return e.value===""?(e.setAttribute(p,"true"),e.value=e.getAttribute(h),e.className+=" "+a,t=e.getAttribute(d),t?e.type="text":e.type==="password"&&S.changeType(e,"text")&&e.setAttribute(d,"password"),!0):!1}function B(e,t){var n,r,i,s,o;if(e&&e.getAttribute(h))t(e);else{n=e?e.getElementsByTagName("input"):n,r=e?e.getElementsByTagName("textarea"):r;for(o=0,s=n.length+r.length;o<s;o++)i=o<n.length?n[o]:r[o-n.length],t(i)}}function j(e){B(e,P)}function F(e){B(e,H)}function I(e){return function(){x&&e.value===e.getAttribute(h)&&e.getAttribute(p)==="true"?S.moveCaret(e,0):P(e)}}function q(e){return function(){H(e)}}function R(e){return function(t){N=e.value;if(e.getAttribute(p)==="true")return N!==e.getAttribute(h)||!S.inArray(o,t.keyCode)}}function U(e){return function(){var t;e.getAttribute(p)==="true"&&e.value!==N&&(e.className=e.className.replace(f,""),e.value=e.value.replace(e.getAttribute(h),""),e.setAttribute(p,!1),t=e.getAttribute(d),t&&(e.type=t)),e.value===""&&(e.blur(),S.moveCaret(e,0))}}function z(e){return function(){e===document.activeElement&&e.value===e.getAttribute(h)&&e.getAttribute(p)==="true"&&S.moveCaret(e,0)}}function W(e){return function(){j(e)}}function X(e){e.form&&(O=e.form,O.getAttribute(v)||(S.addEventListener(O,"submit",W(O)),O.setAttribute(v,"true"))),S.addEventListener(e,"focus",I(e)),S.addEventListener(e,"blur",q(e)),x&&(S.addEventListener(e,"keydown",R(e)),S.addEventListener(e,"keyup",U(e)),S.addEventListener(e,"click",z(e))),e.setAttribute(m,"true"),e.setAttribute(h,L),H(e)}var i={Utils:{addEventListener:e,inArray:t,moveCaret:n,changeType:r}},s=["text","search","url","tel","email","password","number","textarea"],o=[27,33,34,35,36,37,38,39,40,8,46],u="#ccc",a="placeholdersjs",f=new RegExp("\\b"+a+"\\b"),l,c,h="data-placeholder-value",p="data-placeholder-active",d="data-placeholder-type",v="data-placeholder-submit",m="data-placeholder-bound",g="data-placeholder-focus",y="data-placeholder-live",b=document.createElement("input"),w=document.getElementsByTagName("head")[0],E=document.documentElement,S=i.Utils,x,T,N,C,k,L,A,O,M,_,D;if(b.placeholder===void 0){l=document.getElementsByTagName("input"),c=document.getElementsByTagName("textarea"),x=E.getAttribute(g)==="false",T=E.getAttribute(y)!=="false",C=document.createElement("style"),C.type="text/css",k=document.createTextNode("."+a+" { color:"+u+"; }"),C.styleSheet?C.styleSheet.cssText=k.nodeValue:C.appendChild(k),w.insertBefore(C,w.firstChild);for(D=0,_=l.length+c.length;D<_;D++)M=D<l.length?l[D]:c[D-l.length],L=M.getAttribute("placeholder"),L&&S.inArray(s,M.type)&&X(M);A=setInterval(function(){for(D=0,_=l.length+c.length;D<_;D++){M=D<l.length?l[D]:c[D-l.length],L=M.getAttribute("placeholder");if(L&&S.inArray(s,M.type)){M.getAttribute(m)||X(M);if(L!==M.getAttribute(h)||M.type==="password"&&!M.getAttribute(d))M.type==="password"&&!M.getAttribute(d)&&S.changeType(M,"text")&&M.setAttribute(d,"password"),M.value===M.getAttribute(h)&&(M.value=L),M.setAttribute(h,L)}}T||clearInterval(A)},100)}return i.disable=j,i.enable=F,i});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap_timepicker.js
==================================================
/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit
 * Improvements by Christophe Sailly
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

timely.define(["jquery_timely"],function(e){(function(e,t,n,r){var i=function(t,n){this.widget="",this.$element=e(t),this.defaultTime=n.defaultTime,this.disableFocus=n.disableFocus,this.disableMousewheel=n.disableMousewheel,this.isOpen=n.isOpen,this.minuteStep=n.minuteStep,this.modalBackdrop=n.modalBackdrop,this.orientation=n.orientation,this.secondStep=n.secondStep,this.showInputs=n.showInputs,this.showMeridian=n.showMeridian,this.showSeconds=n.showSeconds,this.template=n.template,this.appendWidgetTo=n.appendWidgetTo,this.showWidgetOnAddonClick=n.showWidgetOnAddonClick,this._init()};i.prototype={constructor:i,_init:function(){var t=this;this.showWidgetOnAddonClick&&this.$element.parent().hasClass("ai1ec-input-group")?(this.$element.parent(".ai1ec-input-group").find(".ai1ec-input-group-addon").on({"click.timepicker":e.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":e.proxy(this.highlightUnit,this),"click.timepicker":e.proxy(this.showWidget,this),"keydown.timepicker":e.proxy(this.elementKeydown,this),"blur.timepicker":e.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":e.proxy(this.mousewheel,this)})):this.template?this.$element.on({"focus.timepicker":e.proxy(this.showWidget,this),"click.timepicker":e.proxy(this.showWidget,this),"blur.timepicker":e.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":e.proxy(this.mousewheel,this)}):this.$element.on({"focus.timepicker":e.proxy(this.highlightUnit,this),"click.timepicker":e.proxy(this.highlightUnit,this),"keydown.timepicker":e.proxy(this.elementKeydown,this),"blur.timepicker":e.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":e.proxy(this.mousewheel,this)}),this.template!==!1?this.$widget=e(this.getTemplate()).on("click",e.proxy(this.widgetClick,this)):this.$widget=!1,this.showInputs&&this.$widget!==!1&&this.$widget.find("input").each(function(){e(this).on({"click.timepicker":function(){e(this).select()},"keydown.timepicker":e.proxy(t.widgetKeydown,t),"keyup.timepicker":e.proxy(t.widgetKeyup,t)})}),this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null,this.updateFromElementVal()},clear:function(){this.hour="",this.minute="",this.second="",this.meridian="",this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(this.hour===1)this.hour=12;else{if(this.hour===12)return this.hour--,this.toggleMeridian();if(this.hour===0)return this.hour=11,this.toggleMeridian();this.hour--}else this.hour<=0?this.hour=23:this.hour--},decrementMinute:function(e){var t;e?t=this.minute-e:t=this.minute-this.minuteStep,t<0?(this.decrementHour(),this.minute=t+60):this.minute=t},decrementSecond:function(){var e=this.second-this.secondStep;e<0?(this.decrementMinute(!0),this.second=e+60):this.second=e},elementKeydown:function(e){switch(e.keyCode){case 9:case 27:this.updateFromElementVal();break;case 37:e.preventDefault(),this.highlightPrevUnit();break;case 38:e.preventDefault();switch(this.highlightedUnit){case"hour":this.incrementHour(),this.highlightHour();break;case"minute":this.incrementMinute(),this.highlightMinute();break;case"second":this.incrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:e.preventDefault(),this.highlightNextUnit();break;case 40:e.preventDefault();switch(this.highlightedUnit){case"hour":this.decrementHour(),this.highlightHour();break;case"minute":this.decrementMinute(),this.highlightMinute();break;case"second":this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update()}},getCursorPosition:function(){var e=this.$element.get(0);if("selectionStart"in e)return e.selectionStart;if(n.selection){e.focus();var t=n.selection.createRange(),r=n.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-r}},getTemplate:function(){var e,t,n,r,i,s;this.showInputs?(t='<input type="text" class="ai1ec-bootstrap-timepicker-hour" maxlength="2"/>',n='<input type="text" class="ai1ec-bootstrap-timepicker-minute" maxlength="2"/>',r='<input type="text" class="ai1ec-bootstrap-timepicker-second" maxlength="2"/>',i='<input type="text" class="ai1ec-bootstrap-timepicker-meridian" maxlength="2"/>'):(t='<span class="ai1ec-bootstrap-timepicker-hour"></span>',n='<span class="ai1ec-bootstrap-timepicker-minute"></span>',r='<span class="ai1ec-bootstrap-timepicker-second"></span>',i='<span class="ai1ec-bootstrap-timepicker-meridian"></span>'),s='<table><tr><td><a href="#" data-action="incrementHour"><i class="ai1ec-fa ai1ec-fa-chevron-up"></i></a></td><td class="ai1ec-separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="ai1ec-fa ai1ec-fa-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="ai1ec-separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="ai1ec-fa ai1ec-fa-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="ai1ec-separator">&nbsp;</td><td class="ai1ec-meridian-column"><a href="#" data-action="toggleMeridian"><i class="ai1ec-fa ai1ec-fa-chevron-up"></i></a></td>':"")+"</tr>"+"<tr>"+"<td>"+t+"</td> "+'<td class="ai1ec-separator">:</td>'+"<td>"+n+"</td> "+(this.showSeconds?'<td class="ai1ec-separator">:</td><td>'+r+"</td>":"")+(this.showMeridian?'<td class="ai1ec-separator">&nbsp;</td><td>'+i+"</td>":"")+"</tr>"+"<tr>"+'<td><a href="#" data-action="decrementHour"><i class="ai1ec-fa ai1ec-fa-chevron-down"></i></a></td>'+'<td class="ai1ec-separator"></td>'+'<td><a href="#" data-action="decrementMinute"><i class="ai1ec-fa ai1ec-fa-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="ai1ec-separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="ai1ec-fa ai1ec-fa-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="ai1ec-separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="ai1ec-fa ai1ec-fa-chevron-down"></i></a></td>':"")+"</tr>"+"</table>";switch(this.template){case"modal":e='<div class="ai1ec-bootstrap-timepicker-widget ai1ec-modal ai1ec-fade ai1ec-in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<a href="#" class="ai1ec-close" data-dismiss="ai1ec-modal"></a>'+"<h3>Pick a Time</h3>"+"</div>"+'<div class="ai1ec-modal-body">'+s+"</div>"+'<div class="ai1ec-modal-footer">'+'<a href="#" class="ai1ec-btn ai1ec-btn-primary" data-dismiss="ai1ec-modal">OK</a>'+"</div>"+"</div></div></div>";break;case"dropdown":e='<div class="ai1ec-bootstrap-timepicker-widget ai1ec-dropdown-menu">'+s+"</div>"}return e},getTime:function(){return this.hour===""?"":this.hour+":"+(this.minute.toString().length===1?"0"+this.minute:this.minute)+(this.showSeconds?":"+(this.second.toString().length===1?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){if(this.isOpen===!1)return;this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.template==="modal"&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("ai1ec-open"),e(n).off("mousedown.timepicker, touchend.timepicker"),this.isOpen=!1,this.$widget.detach()},highlightUnit:function(){this.position=this.getCursorPosition(),this.position>=0&&this.position<=2?this.highlightHour():this.position>=3&&this.position<=5?this.highlightMinute():this.position>=6&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():this.position>=9&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="hour",e.setSelectionRange&&setTimeout(function(){t.hour<10?e.setSelectionRange(0,1):e.setSelectionRange(0,2)},0)},highlightMinute:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="minute",e.setSelectionRange&&setTimeout(function(){t.hour<10?e.setSelectionRange(2,4):e.setSelectionRange(3,5)},0)},highlightSecond:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="second",e.setSelectionRange&&setTimeout(function(){t.hour<10?e.setSelectionRange(5,7):e.setSelectionRange(6,8)},0)},highlightMeridian:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="meridian",e.setSelectionRange&&(this.showSeconds?setTimeout(function(){t.hour<10?e.setSelectionRange(8,10):e.setSelectionRange(9,11)},0):setTimeout(function(){t.hour<10?e.setSelectionRange(5,7):e.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(this.hour===11)return this.hour++,this.toggleMeridian();this.hour===12&&(this.hour=0)}if(this.hour===23){this.hour=0;return}this.hour++},incrementMinute:function(e){var t;e?t=this.minute+e:t=this.minute+this.minuteStep-this.minute%this.minuteStep,t>59?(this.incrementHour(),this.minute=t-60):this.minute=t},incrementSecond:function(){var e=this.second+this.secondStep-this.second%this.secondStep;e>59?(this.incrementMinute(!0),this.second=e-60):this.second=e},mousewheel:function(t){if(this.disableMousewheel)return;t.preventDefault(),t.stopPropagation();var n=t.originalEvent.wheelDelta||-t.originalEvent.detail,r=null;t.type==="mousewheel"?r=t.originalEvent.wheelDelta*-1:t.type==="DOMMouseScroll"&&(r=40*t.originalEvent.detail),r&&(t.preventDefault(),e(this).scrollTop(r+e(this).scrollTop()));switch(this.highlightedUnit){case"minute":n>0?this.incrementMinute():this.decrementMinute(),this.highlightMinute();break;case"second":n>0?this.incrementSecond():this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian();break;default:n>0?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1},place:function(){if(this.isInline)return;var n=this.$widget.outerWidth(),r=this.$widget.outerHeight(),i=10,s=e(t).width(),o=e(t).height(),u=e(t).scrollTop(),a=parseInt(this.$element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,f=this.component?this.component.parent().offset():this.$element.offset(),l=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),c=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1),h=f.left,p=f.top;this.$widget.removeClass("ai1ec-timepicker-orient-top ai1ec-timepicker-orient-bottom ai1ec-timepicker-orient-right ai1ec-timepicker-orient-left"),this.orientation.x!=="auto"?(this.picker.addClass("ai1ec-datepicker-orient-"+this.orientation.x),this.orientation.x==="right"&&(h-=n-c)):(this.$widget.addClass("ai1ec-timepicker-orient-left"),f.left<0?h-=f.left-i:f.left+n>s&&(h=s-n-i));var d=this.orientation.y,v,m;d==="auto"&&(v=-u+f.top-r,m=u+o-(f.top+l+r),Math.max(v,m)===m?d="top":d="bottom"),this.$widget.addClass("ai1ec-timepicker-orient-"+d),d==="top"?p+=l:p-=r+parseInt(this.$widget.css("padding-top"),10),this.$widget.css({top:p,left:h,zIndex:a})},remove:function(){e("document").off(".ai1ec-timepicker"),this.$widget&&this.$widget.remove(),delete this.$element.data().timepicker},setDefaultTime:function(e){if(!this.$element.val())if(e==="current"){var t=new Date,n=t.getHours(),r=t.getMinutes(),i=t.getSeconds(),s="AM";i!==0&&(i=Math.ceil(t.getSeconds()/this.secondStep)*this.secondStep,i===60&&(r+=1,i=0)),r!==0&&(r=Math.ceil(t.getMinutes()/this.minuteStep)*this.minuteStep,r===60&&(n+=1,r=0)),this.showMeridian&&(n===0?n=12:n>=12?(n>12&&(n-=12),s="PM"):s="AM"),this.hour=n,this.minute=r,this.second=i,this.meridian=s,this.update()}else e===!1?(this.hour=0,this.minute=0,this.second=0,this.meridian="AM"):this.setTime(e);else this.updateFromElementVal()},setTime:function(e,t){if(!e){this.clear();return}var n,r,i,s,o;typeof e=="object"&&e.getMonth?(r=e.getHours(),i=e.getMinutes(),s=e.getSeconds(),this.showMeridian&&(o="AM",r>12&&(o="PM",r%=12),r===12&&(o="PM"))):(e.match(/p/i)!==null?o="PM":o="AM",e=e.replace(/[^0-9\:]/g,""),n=e.split(":"),r=n[0]?n[0].toString():n.toString(),i=n[1]?n[1].toString():"",s=n[2]?n[2].toString():"",r.length>4&&(s=r.substr(4,2)),r.length>2&&(i=r.substr(2,2),r=r.substr(0,2)),i.length>2&&(s=i.substr(2,2),i=i.substr(0,2)),s.length>2&&(s=s.substr(2,2)),r=parseInt(r,10),i=parseInt(i,10),s=parseInt(s,10),isNaN(r)&&(r=0),isNaN(i)&&(i=0),isNaN(s)&&(s=0),this.showMeridian?r<1?r=1:r>12&&(r=12):(r>=24?r=23:r<0&&(r=0),r<13&&o==="PM"&&(r+=12)),i<0?i=0:i>=60&&(i=59),this.showSeconds&&(isNaN(s)?s=0:s<0?s=0:s>=60&&(s=59))),this.hour=r,this.minute=i,this.second=s,this.meridian=o,this.update(t)},showWidget:function(){if(this.isOpen)return;if(this.$element.is(":disabled"))return;this.$widget.appendTo(this.appendWidgetTo);var t=this;e(n).on("mousedown.timepicker, touchend.timepicker",function(e){t.$element.parent().find(e.target).length||t.$widget.is(e.target)||t.$widget.find(e.target).length||t.hideWidget()}),this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.place(),this.disableFocus&&this.$element.blur(),this.hour===""&&(this.defaultTime?this.setDefaultTime(this.defaultTime):this.setTime("0:0:0")),this.template==="modal"&&this.$widget.modal?this.$widget.modal("show").on("hidden",e.proxy(this.hideWidget,this)):this.isOpen===!1&&this.$widget.addClass("ai1ec-open"),this.isOpen=!0},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM"},update:function(e){this.updateElement(),e||this.updateWidget(),this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(this.$widget===!1)return;var e=this.hour,t=this.minute.toString().length===1?"0"+this.minute:this.minute,n=this.second.toString().length===1?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.ai1ec-bootstrap-timepicker-hour").val(e),this.$widget.find("input.ai1ec-bootstrap-timepicker-minute").val(t),this.showSeconds&&this.$widget.find("input.ai1ec-bootstrap-timepicker-second").val(n),this.showMeridian&&this.$widget.find("input.ai1ec-bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.ai1ec-bootstrap-timepicker-hour").text(e),this.$widget.find("span.ai1ec-bootstrap-timepicker-minute").text(t),this.showSeconds&&this.$widget.find("span.ai1ec-bootstrap-timepicker-second").text(n),this.showMeridian&&this.$widget.find("span.ai1ec-bootstrap-timepicker-meridian").text(this.meridian))},updateFromWidgetInputs:function(){if(this.$widget===!1)return;var e=this.$widget.find("input.ai1ec-bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.ai1ec-bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.ai1ec-bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.ai1ec-bootstrap-timepicker-meridian").val():"");this.setTime(e,!0)},widgetClick:function(t){t.stopPropagation(),t.preventDefault();var n=e(t.target),r=n.closest("a").data("action");r&&this[r](),this.update(),n.is("input")&&n.get(0).setSelectionRange(0,2)},widgetKeydown:function(t){var n=e(t.target),r=n.attr("class").replace("bootstrap-timepicker-","");switch(t.keyCode){case 9:if(this.showMeridian&&r==="meridian"||this.showSeconds&&r==="second"||!this.showMeridian&&!this.showSeconds&&r==="minute")return this.hideWidget();break;case 27:this.hideWidget();break;case 38:t.preventDefault();switch(r){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),n.get(0).setSelectionRange(0,2);break;case 40:t.preventDefault();switch(r){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),n.get(0).setSelectionRange(0,2)}},widgetKeyup:function(e){(e.keyCode===65||e.keyCode===77||e.keyCode===80||e.keyCode===46||e.keyCode===8||e.keyCode>=46&&e.keyCode<=57)&&this.updateFromWidgetInputs()}},e.fn.timepicker=function(t){var n=Array.apply(null,arguments);return n.shift(),this.each(function(){var r=e(this),s=r.data("timepicker"),o=typeof t=="object"&&t;s||r.data("timepicker",s=new i(this,e.extend({},e.fn.timepicker.defaults,o,e(this).data()))),typeof t=="string"&&s[t].apply(s,n)})},e.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",y:"auto"},secondStep:15,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:!0},e.fn.timepicker.Constructor=i})(e,window,document)});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/tooltip.js
==================================================
/* ========================================================================
 * Bootstrap: tooltip.js v3.0.3
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="ai1ec-tooltip"><div class="ai1ec-tooltip-arrow"></div><div class="ai1ec-tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focus",a=o=="hover"?"mouseleave":"blur";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.tip();this.setContent(),this.options.animation&&n.addClass("ai1ec-fade");var r=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,s=i.test(r);s&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass("ai1ec-"+r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var o=this.getPosition(),u=n[0].offsetWidth,a=n[0].offsetHeight;if(s){var f=this.$element.parent(),l=r,c=document.documentElement.scrollTop||document.body.scrollTop,h=this.options.container=="body"?window.innerWidth:f.outerWidth(),p=this.options.container=="body"?window.innerHeight:f.outerHeight(),d=this.options.container=="body"?0:f.offset().left;r=r=="bottom"&&o.top+o.height+a-c>p?"top":r=="top"&&o.top-c-a<0?"bottom":r=="right"&&o.right+u>h?"left":r=="left"&&o.left-u<d?"right":r,n.removeClass("ai1ec-"+l).addClass("ai1ec-"+r)}var v=this.getCalculatedOffset(r,o,u,a);this.applyPlacement(v,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),e.top=e.top+o,e.left=e.left+u,r.offset(e).addClass("ai1ec-in");var a=r[0].offsetWidth,f=r[0].offsetHeight;t=="top"&&f!=s&&(n=!0,e.top=e.top+s-f);if(/bottom|top/.test(t)){var l=0;e.left<0&&(l=e.left*-2,e.left=0,r.offset(e),a=r[0].offsetWidth,f=r[0].offsetHeight),this.replaceArrow(l-i+a,a,"left")}else this.replaceArrow(f-s,f,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".ai1ec-tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("ai1ec-fade ai1ec-in ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach()}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("ai1ec-in"),e.support.transition&&this.$tip.hasClass("ai1ec-fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("ai1ec-in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/button.js
==================================================
/* ========================================================================
 * Bootstrap: button.js v3.0.3
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();e+="Text",i.resetText||n.data("resetText",n[r]()),n[r](i[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass("ai1ec-"+t).attr(t,t):n.removeClass("ai1ec-"+t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="ai1ec-buttons"]'),t=!0;if(e.length){var n=this.$element.find("input");n.prop("type")==="radio"&&(n.prop("checked")&&this.$element.hasClass("ai1ec-active")?t=!1:e.find(".ai1ec-active").removeClass("ai1ec-active")),t&&n.prop("checked",!this.$element.hasClass("ai1ec-active")).trigger("change")}t&&this.$element.toggleClass("ai1ec-active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=ai1ec-button]",function(t){var n=e(t.target);n.hasClass("ai1ec-btn")||(n=n.closest(".ai1ec-btn")),n.button("toggle"),t.preventDefault()})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/scrollspy.js
==================================================
/* ========================================================================
 * Bootstrap: scrollspy.js v3.0.3
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){function t(n,r){var i,s=e.proxy(this.process,this);this.$element=e(n).is("body")?e(window):e(n),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",s),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||(i=e(n).attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")||"")+" .ai1ec-nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var n=this,r=this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#\w/.test(i)&&e(i);return s&&s.length&&[[s[t]().top+(!e.isWindow(n.$scrollElement.get(0))&&n.$scrollElement.scrollTop()),i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parents(".ai1ec-active").removeClass("ai1ec-active");var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("ai1ec-active");r.parent(".ai1ec-dropdown-menu").length&&(r=r.closest("li.ai1ec-dropdown").addClass("ai1ec-active")),r.trigger("activate.bs.scrollspy")};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s=typeof n=="object"&&n;i||r.data("bs.scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="ai1ec-scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/tab.js
==================================================
/* ========================================================================
 * Bootstrap: tab.js v3.0.3
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.ai1ec-dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("ai1ec-active"))return;var i=n.find(".ai1ec-active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:i});t.trigger(s);if(s.isDefaultPrevented())return;var o=e(r);this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})},t.prototype.activate=function(t,n,r){function o(){i.removeClass("ai1ec-active").find("> .ai1ec-dropdown-menu > .ai1ec-active").removeClass("ai1ec-active"),t.addClass("ai1ec-active"),s?(t[0].offsetWidth,t.addClass("ai1ec-in")):t.removeClass("ai1ec-fade"),t.parent(".ai1ec-dropdown-menu")&&t.closest("li.ai1ec-dropdown").addClass("ai1ec-active"),r&&r()}var i=n.find("> .ai1ec-active"),s=r&&e.support.transition&&i.hasClass("ai1ec-fade");s?i.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),i.removeClass("ai1ec-in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="ai1ec-tab"], [data-toggle="ai1ec-pill"]',function(t){t.preventDefault(),e(this).tab("show")})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/modal.js
==================================================
/* ========================================================================
 * Bootstrap: modal.js v3.0.3
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r);if(this.isShown||r.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="ai1ec-modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("ai1ec-fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("ai1ec-in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".ai1ec-modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)})},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("ai1ec-in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this,r=this.$element.hasClass("ai1ec-fade")?"ai1ec-fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="ai1ec-modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("ai1ec-in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("ai1ec-in"),e.support.transition&&this.$element.hasClass("ai1ec-fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="ai1ec-modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".ai1ec-modal",function(){e(document.body).addClass("ai1ec-modal-open")}).on("hidden.bs.modal",".ai1ec-modal",function(){e(document.body).removeClass("ai1ec-modal-open")})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/carousel.js
==================================================
/* ========================================================================
 * Bootstrap: carousel.js v3.0.3
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".ai1ec-carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".ai1ec-item.ai1ec-active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},t.prototype.to=function(t){var n=this,r=this.getActiveIndex();if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid.bs.carousel",function(){n.to(t)}):r==t?this.pause().cycle():this.slide(t>r?"next":"prev",e(this.$items[t]))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".ai1ec-next, .ai1ec-prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(this.sliding)return;return this.slide("next")},t.prototype.prev=function(){if(this.sliding)return;return this.slide("prev")},t.prototype.slide=function(t,n){var r=this.$element.find(".ai1ec-item.ai1ec-active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this;if(!i.length){if(!this.options.wrap)return;i=this.$element.find(".ai1ec-item")[u]()}this.sliding=!0,s&&this.pause();var f=e.Event("slide.bs.carousel",{relatedTarget:i[0],direction:o});if(i.hasClass("ai1ec-active"))return;this.$indicators.length&&(this.$indicators.find(".ai1ec-active").removeClass("ai1ec-active"),this.$element.one("slid.bs.carousel",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("ai1ec-active")}));if(e.support.transition&&this.$element.hasClass("ai1ec-slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass("ai1ec-"+t),i[0].offsetWidth,r.addClass("ai1ec-"+o),i.addClass("ai1ec-"+o),r.one(e.support.transition.end,function(){i.removeClass(["ai1ec-"+t,"ai1ec-"+o].join(" ")).addClass("ai1ec-active"),r.removeClass(["ai1ec-active","ai1ec-"+o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(600)}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("ai1ec-active"),i.addClass("ai1ec-active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")}return s&&this.cycle(),this};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("bs.carousel"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("bs.carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-ai1ec-slide], [data-ai1ec-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o=n.attr("data-ai1ec-slide-to");o&&(s.interval=!1),i.carousel(s),(o=n.attr("data-ai1ec-slide-to"))&&i.data("bs.carousel").to(o),t.preventDefault()}),e(window).on("load",function(){e('[data-ride="ai1ec-carousel"]').each(function(){var t=e(this);t.carousel(t.data())})})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/transition.js
==================================================
/* ========================================================================
 * Bootstrap: transition.js v3.0.3
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/affix.js
==================================================
/* ========================================================================
 * Bootstrap: affix.js v3.1.1
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="ai1ec-affix ai1ec-affix-top ai1ec-affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("ai1ec-affix");var e=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;this.affixed=="top"&&(i.top+=r),typeof s!="object"&&(u=o=s),typeof o=="function"&&(o=s.top(this.$element)),typeof u=="function"&&(u=s.bottom(this.$element));var a=this.unpin!=null&&r+this.unpin<=i.top?!1:u!=null&&i.top+this.$element.height()>=n-u?"bottom":o!=null&&r<=o?"top":!1;if(this.affixed===a)return;this.unpin&&this.$element.css("top","");var f="ai1ec-affix"+(a?"-"+a:""),l=e.Event(f+".bs.affix");this.$element.trigger(l);if(l.isDefaultPrevented())return;this.affixed=a,this.unpin=a=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(f).trigger(e.Event(f.replace("affix","affixed"))),a=="bottom"&&this.$element.offset({top:n-u-this.$element.height()})};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="ai1ec-affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/alert.js
==================================================
/* ========================================================================
 * Bootstrap: alert.js v3.0.3
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t='[data-dismiss="ai1ec-alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed.bs.alert").remove()}var n=e(this),r=n.attr("data-target");r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var i=e(r);t&&t.preventDefault(),i.length||(i=n.hasClass("ai1ec-alert")?n:n.parent()),i.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;i.removeClass("ai1ec-in"),e.support.transition&&i.hasClass("ai1ec-fade")?i.one(e.support.transition.end,s).emulateTransitionEnd(150):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/dropdown.js
==================================================
/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){function i(){e(t).remove(),e(n).each(function(t){var n=s(e(this));if(!n.hasClass("ai1ec-open"))return;n.trigger(t=e.Event("hide.bs.dropdown"));if(t.isDefaultPrevented())return;n.removeClass("ai1ec-open").trigger("hidden.bs.dropdown")})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".ai1ec-dropdown-backdrop",n="[data-toggle=ai1ec-dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".ai1ec-disabled, :disabled"))return;var r=s(n),o=r.hasClass("ai1ec-open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".ai1ec-navbar-nav").length&&e('<div class="ai1ec-dropdown-backdrop"/>').insertAfter(e(this)).on("click",i),r.trigger(t=e.Event("show.bs.dropdown"));if(t.isDefaultPrevented())return;r.toggleClass("ai1ec-open").trigger("shown.bs.dropdown"),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".ai1ec-disabled, :disabled"))return;var i=s(r),o=i.hasClass("ai1ec-open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=e("[role=menu] li:not(.ai1ec-divider):visible a",i);if(!u.length)return;var a=u.index(u.filter(":focus"));t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<u.length-1&&a++,~a||(a=0),u.eq(a).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".ai1ec-dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/collapse.js
==================================================
/* ========================================================================
 * Bootstrap: collapse.js v3.0.3
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely"],function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("ai1ec-width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("ai1ec-in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .ai1ec-panel > .ai1ec-in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("ai1ec-collapse").addClass("ai1ec-collapsing")[i](0),this.transitioning=1;var s=function(){this.$element.removeClass("ai1ec-collapsing").addClass("ai1ec-in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("ai1ec-in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("ai1ec-collapsing").removeClass("ai1ec-collapse").removeClass("ai1ec-in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("ai1ec-collapsing").addClass("ai1ec-collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)},t.prototype.toggle=function(){this[this.$element.hasClass("ai1ec-in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=ai1ec-collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning)f&&f.find('[data-toggle=ai1ec-collapse][data-parent="'+a+'"]').not(n).addClass("ai1ec-collapsed"),n[s.hasClass("ai1ec-in")?"addClass":"removeClass"]("ai1ec-collapsed");s.collapse(u)})});

==================================================
FILE PATH: ./public/js/external_libs/bootstrap/popover.js
==================================================
/* ========================================================================
 * Bootstrap: popover.js v3.0.3
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

timely.define(["jquery_timely","external_libs/bootstrap/tooltip"],function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="ai1ec-popover"><div class="ai1ec-arrow"></div><h3 class="ai1ec-popover-title"></h3><div class="ai1ec-popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".ai1ec-popover-title")[this.options.html?"html":"text"](t),e.find(".ai1ec-popover-content")[this.options.html?"html":"text"](n),e.removeClass("ai1ec-fade ai1ec-top ai1ec-bottom ai1ec-left ai1ec-right ai1ec-in"),e.find(".ai1ec-popover-title").html()||e.find(".ai1ec-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".ai1ec-arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}});

==================================================
FILE PATH: ./public/js/external_libs/jquery_history.js
==================================================
/**
				 * History.js jQuery Adapter
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
				 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
				 */

/**
				 * History.js HTML4 Support
				 * Depends on the HTML5 Support
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
				 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
				 */

/**
		 * History.js Core
		 * @author Benjamin Arthur Lupton <contact@balupton.com>
		 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
		 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
		 */

/**
				 * History.getInternetExplorerMajorVersion()
				 * Get's the major version of Internet Explorer
				 * @return {integer}
				 * @license Public Domain
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 * @author James Padolsey <https://gist.github.com/527683>
				 */

/**
				 * History.isInternetExplorer()
				 * Are we using Internet Explorer?
				 * @return {boolean}
				 * @license Public Domain
				 * @author Benjamin Arthur Lupton <contact@balupton.com>
				 */

timely.define(["jquery_timely"],function(e){try{(function(t,n){var r=t.History=t.History||{};if(typeof r.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");r.Adapter={bind:function(t,n,r){e(t).bind(n,r)},trigger:function(t,n,r){e(t).trigger(n,r)},extractEventData:function(e,t,r){var i=t&&t.originalEvent&&t.originalEvent[e]||r&&r[e]||n;return i},onDomLoad:function(t){e(t)}},typeof r.init!="undefined"&&r.init()})(window),function(e,t){var n=e.document,r=e.setTimeout||r,i=e.clearTimeout||i,s=e.setInterval||s,o=e.History=e.History||{};if(typeof o.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){if(typeof o.initHtml4.initialized!="undefined")return!1;o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t=o.getHashByIndex(),n;return n=e===t,n},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return typeof e=="undefined"?t=o.savedHashes[o.savedHashes.length-1]:e<0?t=o.savedHashes[o.savedHashes.length+e]:t=o.savedHashes[e],t},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r=o.getHashByState(e),i;return i={discardedState:e,backState:n,forwardState:t},o.discardedStates[r]=i,!0},o.discardHash=function(e,t,n){var r={discardedHash:e,backState:n,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t=o.getHashByState(e),n;return n=o.discardedStates[t]||!1,n},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var t="",r,i,u,a;return o.isInternetExplorer()?(r="historyjs-iframe",i=n.createElement("iframe"),i.setAttribute("id",r),i.style.display="none",n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),u="",a=!1,o.checkerFunction=function(){if(a)return!1;a=!0;var n=o.getHash()||"",r=o.unescapeHash(i.contentWindow.document.location.hash)||"";return n!==t?(t=n,r!==n&&(u=r=n,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(n)),o.Adapter.trigger(e,"hashchange")):r!==u&&(u=r,o.setHash(r,!1)),a=!1,!0}):o.checkerFunction=function(){var n=o.getHash();return n!==t&&(t=n,o.Adapter.trigger(e,"hashchange")),!0},o.intervalList.push(s(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var r=t&&t.newURL||n.location.href,i=o.getHashByUrl(r),s=null,u=null,a=null,f;return o.isLastHash(i)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(i),i&&o.isTraditionalAnchor(i)?(o.Adapter.trigger(e,"anchorchange"),o.busy(!1),!1):(s=o.extractState(o.getFullUrl(i||n.location.href,!1),!0),o.isLastSavedState(s)?(o.busy(!1),!1):(u=o.getHashByState(s),f=o.discardedState(s),f?(o.getHashByIndex(-2)===o.getHashByState(f.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(s.data,s.title,s.url,!1),!0))))},o.Adapter.bind(e,"hashchange",o.onHashChange),o.pushState=function(t,r,i,s){if(o.getHashByUrl(i))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(s!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:s}),!1;o.busy(!0);var u=o.createStateObject(t,r,i),a=o.getHashByState(u),f=o.getState(!1),l=o.getHashByState(f),c=o.getHash();return o.storeState(u),o.expectedStateId=u.id,o.recycleState(u),o.setTitle(u),a===l?(o.busy(!1),!1):a!==c&&a!==o.getShortUrl(n.location.href)?(o.setHash(a,!1),!1):(o.saveState(u),o.Adapter.trigger(e,"statechange"),o.busy(!1),!0)},o.replaceState=function(e,t,n,r){if(o.getHashByUrl(n))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(r!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:r}),!1;o.busy(!0);var i=o.createStateObject(e,t,n),s=o.getState(!1),u=o.getStateByIndex(-2);return o.discardState(s,i,u),o.pushState(i.data,i.title,i.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,"hashchange")})},typeof o.init!="undefined"&&o.init()}(window),function(e,t){var n=e.console||t,r=e.document,i=e.navigator,s=e.sessionStorage||!1,o=e.setTimeout,u=e.clearTimeout,a=e.setInterval,f=e.clearInterval,l=e.JSON,c=e.alert,h=e.History=e.History||{},p=e.history;l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode;if(typeof h.init!="undefined")throw new Error("History.js Core has already been loaded...");h.init=function(){return typeof h.Adapter=="undefined"?!1:(typeof h.initCore!="undefined"&&h.initCore(),typeof h.initHtml4!="undefined"&&h.initHtml4(),!0)},h.initCore=function(){if(typeof h.initCore.initialized!="undefined")return!1;h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||r.title,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(typeof t!="undefined"&&t!==null){for(e=0;e<t.length;e++)f(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e=typeof n!="undefined"&&typeof n.log!="undefined"&&typeof n.log.apply!="undefined",t=r.getElementById("log"),i,s,o,u,a;e?(u=Array.prototype.slice.call(arguments),i=u.shift(),typeof n.debug!="undefined"?n.debug.apply(n,[i,u]):n.log.apply(n,[i,u])):i="\n"+arguments[0]+"\n";for(s=1,o=arguments.length;s<o;++s){a=arguments[s];if(typeof a=="object"&&typeof l!="undefined")try{a=l.stringify(a)}catch(f){}i+="\n"+a+"\n"}return t?(t.value+=i+"\n-----\n",t.scrollTop=t.scrollHeight-t.clientHeight):e||c(i),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached=typeof h.getInternetExplorerMajorVersion.cached!="undefined"?h.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement("div"),n=t.getElementsByTagName("i");while((t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n[0]);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached=typeof h.isInternetExplorer.cached!="undefined"?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=l.stringify(e),n=l.parse(t)):n={},n},h.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);if(r.location.port||!1)e+=":"+r.location.port;return e+="/",e},h.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,n="";return e.length===1&&(t=e[0],n=t.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e=h.getState(!1,!1),t=(e||{}).url||r.location.href,n;return n=t.replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+"/"}),n},h.getBasePageUrl=function(){var e=r.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},h.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t=typeof t=="undefined"?!0:t,/[a-z]+\:\/\//.test(e)||(r==="/"?n=h.getRootUrl()+e.replace(/^\/+/,""):r==="#"?n=h.getPageUrl().replace(/#.*/,"")+e:r==="?"?n=h.getPageUrl().replace(/[\?#].*/,"")+e:t?n=h.getBaseUrl()+e.replace(/^(\.\/)+/,""):n=h.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),r=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,"")),t=t.replace(r,"/"),h.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),t},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){typeof e=="undefined"&&(e=!0),typeof t=="undefined"&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t=h.extractId(e.url),n;if(!t){n=h.getStateString(e);if(typeof h.stateToId[n]!="undefined")t=h.stateToId[n];else if(typeof h.store.stateToId[n]!="undefined")t=h.store.stateToId[n];else{for(;;){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof h.idToState[t]=="undefined"&&typeof h.store.idToState[t]=="undefined")break}h.stateToId[n]=t,h.idToState[t]=e}}return t},h.normalizeState=function(e){var t,n;if(!e||typeof e!="object")e={};if(typeof e.normalized!="undefined")return e;if(!e.data||typeof e.data!="object")e.data={};t={},t.normalized=!0,t.title=e.title||"",t.url=h.getFullUrl(h.unescapeString(e.url||r.location.href)),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data);if(t.title||n)t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id;return t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t},h.createStateObject=function(e,t,n){var r={data:e,title:t,url:n};return r=h.normalizeState(r),r},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,r;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},r=l.stringify(n),r},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id,n},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash,n},h.extractId=function(e){var t,n,r;return n=/(.*)\&_suid=([0-9]+)$/.exec(e),r=n?n[1]||e:e,t=n?String(n[2]||""):"",t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n=null,r,i;return t=t||!1,r=h.extractId(e),r&&(n=h.getStateById(r)),n||(i=h.getFullUrl(e),r=h.getIdByUrl(i)||!1,r&&(n=h.getStateById(r)),!n&&t&&!h.isTraditionalAnchor(e)&&(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t=!1,n;return n=h.extractState(e.url),t=n&&n.id!==e.id,t},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1,n,r,i;return h.savedStates.length&&(n=e.id,r=h.getLastSavedState(),i=r.id,t=n===i),t},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return typeof e=="undefined"?t=h.savedStates[h.savedStates.length-1]:e<0?t=h.savedStates[h.savedStates.length+e]:t=h.savedStates[e],t},h.getHash=function(){var e=h.unescapeHash(r.location.hash);return e},h.unescapeString=function(t){var n=t,r;for(;;){r=e.unescape(n);if(r===n)break;n=r}return n},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=h.unescapeString(t),t},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},h.setHash=function(e,t){var n,i,s;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(n=h.escapeHash(e),h.busy(!0),i=h.extractState(e,!0),i&&!h.emulated.pushState?h.pushState(i.data,i.title,i.url,!1):r.location.hash!==n&&(h.bugs.setHash?(s=h.getPageUrl(),h.pushState(null,null,s+"#"+n,!1)):r.location.hash=n),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.escape(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=h.unescapeHash(t),t},h.setTitle=function(e){var t=e.title,n;t||(n=h.getStateByIndex(0),n&&n.url===e.url&&(t=n.title||h.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=t.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(i){}return r.title=t,h},h.queues=[],h.busy=function(e){typeof e!="undefined"?h.busy.flag=e:typeof h.busy.flag=="undefined"&&(h.busy.flag=!1);if(!h.busy.flag){u(h.busy.timeout);var t=function(){var e,n,r;if(h.busy.flag)return;for(e=h.queues.length-1;e>=0;--e){n=h.queues[e];if(n.length===0)continue;r=n.shift(),h.fireQueueItem(r),h.busy.timeout=o(t,h.options.busyDelay)}};h.busy.timeout=o(t,h.options.busyDelay)}return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return typeof e=="function"&&(e={callback:e}),typeof t!="undefined"&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(u(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=o(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t=h.extractState(r.location.href),n;if(!h.isLastSavedState(t))return n=t,n||(n=h.createStateObject()),h.Adapter.trigger(e,"popstate"),h;return},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;n<=e;++n)h.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=e;--n)h.back(t)}return h};if(h.emulated.pushState){var d=function(){};h.pushState=h.pushState||d,h.replaceState=h.replaceState||d}else h.onPopState=function(t,n){var i=!1,s=!1,o,u;return h.doubleCheckComplete(),o=h.getHash(),o?(u=h.extractState(o||r.location.href,!0),u?h.replaceState(u.data,u.title,u.url,!1):(h.Adapter.trigger(e,"anchorchange"),h.busy(!1)),h.expectedStateId=!1,!1):(i=h.Adapter.extractEventData("state",t,n)||!1,i?s=h.getStateById(i):h.expectedStateId?s=h.getStateById(h.expectedStateId):s=h.extractState(r.location.href),s||(s=h.createStateObject(null,null,r.location.href)),h.expectedStateId=!1,h.isLastSavedState(s)?(h.busy(!1),!1):(h.storeState(s),h.saveState(s),h.setTitle(s),h.Adapter.trigger(e,"statechange"),h.busy(!1),!0))},h.Adapter.bind(e,"popstate",h.onPopState),h.pushState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.pushState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0},h.replaceState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.replaceState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0};if(s){try{h.store=l.parse(s.getItem("History.store"))||{}}catch(v){h.store={}}h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,"beforeunload",h.clearAllIntervals),h.Adapter.bind(e,"unload",h.clearAllIntervals),h.saveState(h.storeState(h.extractState(r.location.href,!0))),s&&(h.onUnload=function(){var e,t;try{e=l.parse(s.getItem("History.store"))||{}}catch(n){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState){if(!h.idToState.hasOwnProperty(t))continue;e.idToState[t]=h.idToState[t]}for(t in h.urlToId){if(!h.urlToId.hasOwnProperty(t))continue;e.urlToId[t]=h.urlToId[t]}for(t in h.stateToId){if(!h.stateToId.hasOwnProperty(t))continue;e.stateToId[t]=h.stateToId[t]}h.store=e,h.normalizeStore(),s.setItem("History.store",l.stringify(e))},h.intervalList.push(a(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,"beforeunload",h.onUnload),h.Adapter.bind(e,"unload",h.onUnload));if(!h.emulated.pushState){h.bugs.safariPoll&&h.intervalList.push(a(h.safariStatePoll,h.options.safariPollInterval));if(i.vendor==="Apple Computer, Inc."||(i.appCodeName||"")==="Mozilla")h.Adapter.bind(e,"hashchange",function(){h.Adapter.trigger(e,"popstate")}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,"hashchange")})}},h.init()}(window)}catch(t){}});

==================================================
FILE PATH: ./public/js/external_libs/jquery.inputdate.js
==================================================
timely.define(["jquery_timely","external_libs/jquery.calendrical_timespan"],function(e,t){function n(e){e.addClass("error").fadeOut("normal",function(){e.val(e.data("timespan.stored")).removeClass("error").fadeIn("fast")})}function r(){e(this).data("timespan.stored",this.value)}function i(e,n,i,s,o){n.val(n.data("timespan.initial_value"));var u=parseInt(n.val());isNaN(parseInt(u))?u=new Date(o):u=new Date(parseInt(u)*1e3),e.val(t.formatDate(u,s)),e.each(r)}var s={start_date_input:"date-input",start_time:"time",twentyfour_hour:!1,date_format:"def",now:new Date},o={init:function(o){var u=e.extend({},s,o),a=e(u.start_date_input),f=e(u.start_time),l=a,c=a;return c.bind("focus.timespan",r),l.calendricalDate({today:new Date(u.now.getFullYear(),u.now.getMonth(),u.now.getDate()),dateFormat:u.date_format,monthNames:u.month_names,dayNames:u.day_names,weekStartDay:u.week_start_day}),l.bind("blur.timespan",function(){var r=t.parseDate(this.value,u.date_format);isNaN(r)?n(e(this)):(e(this).data("timespan.stored",this.value),e(this).val(t.formatDate(r,u.date_format)))}),a.bind("focus.timespan",function(){var e=t.parseDate(a.val(),u.date_format).getTime()/1e3}).bind("blur.timespan",function(){var e=t.parseDate(a.data("timespan.stored"),u.date_format)}),a.closest("form").bind("submit.timespan",function(){var e=t.parseDate(a.val(),u.date_format).getTime()/1e3;isNaN(e)&&(e=""),f.val(e)}),f.data("timespan.initial_value",f.val()),i(a,f,u.twentyfour_hour,u.date_format,u.now),this},reset:function(t){var n=e.extend({},s,t);return i(e(n.start_date_input),e(n.start_time),n.twentyfour_hour,n.date_format,n.now),this},destroy:function(t){return t=e.extend({},s,t),e.each(t,function(t,n){e(n).unbind(".timespan")}),e(t.start_date_input).closest("form").unbind(".timespan"),this}};e.inputdate=function(t){if(o[t])return o[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return o.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timespan")}});

==================================================
FILE PATH: ./public/js/domReady.js
==================================================
/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c});

==================================================
FILE PATH: ./public/js/jquery_timely20.js
==================================================
/*!
	 * jQuery JavaScript Library v2.0.0
	 * http://jquery.com/
	 *
	 * Includes Sizzle.js
	 * http://sizzlejs.com/
	 *
	 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2013-04-18
	 */

/*!
	 * Sizzle CSS Selector Engine v1.9.2-pre
	 * http://sizzlejs.com/
	 *
	 * Copyright 2013 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2013-04-16
	 */

timely.define("jquery_timely",[],function(){return function(window,undefined){function isArraylike(e){var t=e.length,n=jQuery.type(e);return jQuery.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||n!=="function"&&(t===0||typeof t=="number"&&t>0&&t-1 in e)}function createOptions(e){var t=optionsCache[e]={};return jQuery.each(e.match(core_rnotwhite)||[],function(e,n){t[n]=!0}),t}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(rmultiDash,"-$1").toLowerCase(),n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:rbrace.test(n)?JSON.parse(n):n}catch(i){}data_user.set(e,t,n)}else n=undefined}return n}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(e){}}function sibling(e,t){while((e=e[t])&&e.nodeType!==1);return e}function winnow(e,t,n){if(jQuery.isFunction(t))return jQuery.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return jQuery.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(isSimple.test(t))return jQuery.filter(t,e,n);t=jQuery.filter(t,e)}return jQuery.grep(e,function(e){return core_indexOf.call(t,e)>=0!==n})}function manipulationTarget(e,t){return jQuery.nodeName(e,"table")&&jQuery.nodeName(t.nodeType===1?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function disableScript(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function restoreScript(e){var t=rscriptTypeMasked.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function setGlobalEval(e,t){var n=e.length,r=0;for(;r<n;r++)data_priv.set(e[r],"globalEval",!t||data_priv.get(t[r],"globalEval"))}function cloneCopyEvent(e,t){var n,r,i,s,o,u,a,f;if(t.nodeType!==1)return;if(data_priv.hasData(e)){s=data_priv.access(e),o=jQuery.extend({},s),f=s.events,data_priv.set(t,o);if(f){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;n<r;n++)jQuery.event.add(t,i,f[i][n])}}data_user.hasData(e)&&(u=data_user.access(e),a=jQuery.extend({},u),data_user.set(t,a))}function getAll(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&jQuery.nodeName(e,t)?jQuery.merge([e],n):n}function fixInput(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&manipulation_rcheckableType.test(e.type))t.checked=e.checked;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function vendorPropName(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=cssPrefixes.length;while(i--){t=cssPrefixes[i]+n;if(t in e)return t}return r}function isHidden(e,t){return e=t||e,jQuery.css(e,"display")==="none"||!jQuery.contains(e.ownerDocument,e)}function getStyles(e){return window.getComputedStyle(e,null)}function showHide(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=data_priv.get(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&isHidden(r)&&(s[o]=data_priv.access(r,"olddisplay",css_defaultDisplay(r.nodeName)))):s[o]||(i=isHidden(r),(n&&n!=="none"||!i)&&data_priv.set(r,"olddisplay",i?n:jQuery.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function setPositiveNumber(e,t,n){var r=rnumsplit.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function augmentWidthOrHeight(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=jQuery.css(e,n+cssExpand[s],!0,i)),r?(n==="content"&&(o-=jQuery.css(e,"padding"+cssExpand[s],!0,i)),n!=="margin"&&(o-=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i))):(o+=jQuery.css(e,"padding"+cssExpand[s],!0,i),n!=="padding"&&(o+=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i)));return o}function getWidthOrHeight(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=getStyles(e),o=jQuery.support.boxSizing&&jQuery.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=curCSS(e,t,s);if(i<0||i==null)i=e.style[t];if(rnumnonpx.test(i))return i;r=o&&(jQuery.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+augmentWidthOrHeight(e,t,n||(o?"border":"content"),r,s)+"px"}function css_defaultDisplay(e){var t=document,n=elemdisplay[e];if(!n){n=actualDisplay(e,t);if(n==="none"||!n)iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(iframe[0].contentWindow||iframe[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=actualDisplay(e,t),iframe.detach();elemdisplay[e]=n}return n}function actualDisplay(e,t){var n=jQuery(t.createElement(e)).appendTo(t.body),r=jQuery.css(n[0],"display");return n.remove(),r}function buildParams(e,t,n,r){var i;if(jQuery.isArray(t))jQuery.each(t,function(t,i){n||rbracket.test(e)?r(e,i):buildParams(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&jQuery.type(t)==="object")for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}function addToPrefiltersOrTransports(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function inspectPrefiltersOrTransports(e,t,n,r){function o(u){var a;return i[u]=!0,jQuery.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===transports;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ajaxExtend(e,t){var n,r,i=jQuery.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&jQuery.extend(!0,e,r),e}function ajaxHandleResponses(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==a[0]&&a.unshift(s),n[s]}function ajaxConvert(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTweens(e,t){jQuery.each(t,function(t,n){var r=(tweeners[t]||[]).concat(tweeners["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Animation(e,t,n){var r,i,s=0,o=animationPrefilters.length,u=jQuery.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=fxNow||createFxNow(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:jQuery.extend({},t),opts:jQuery.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:fxNow||createFxNow(),duration:n.duration,tweens:[],createTween:function(t,n){var r=jQuery.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;propFilter(l,f.opts.specialEasing);for(;s<o;s++){r=animationPrefilters[s].call(f,e,l,f.opts);if(r)return r}return createTweens(f,l),jQuery.isFunction(f.opts.start)&&f.opts.start.call(e,f),jQuery.fx.timer(jQuery.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function propFilter(e,t){var n,r,i,s,o;for(n in e){r=jQuery.camelCase(n),i=t[r],s=e[n],jQuery.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=jQuery.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function defaultPrefilter(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},v=[],m=e.nodeType&&isHidden(e);n.queue||(l=jQuery._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,jQuery.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],jQuery.css(e,"display")==="inline"&&jQuery.css(e,"float")==="none"&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=data_priv.get(e,"fxshow");for(r in t){s=t[r];if(rfxtypes.exec(s)){delete t[r],a=a||s==="toggle";if(s===(m?"hide":"show")){if(s!=="show"||u===undefined||u[r]===undefined)continue;m=!0}v.push(r)}}o=v.length;if(o){u=data_priv.get(e,"fxshow")||data_priv.access(e,"fxshow",{}),"hidden"in u&&(m=u.hidden),a&&(u.hidden=!m),m?jQuery(e).show():h.done(function(){jQuery(e).hide()}),h.done(function(){var t;data_priv.remove(e,"fxshow");for(t in d)jQuery.style(e,t,d[t])});for(r=0;r<o;r++)i=v[r],f=h.createTween(i,m?u[i]:0),d[i]=u[i]||jQuery.style(e,i),i in u||(u[i]=f.start,m&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Tween(e,t,n,r,i){return new Tween.prototype.init(e,t,n,r,i)}function genFx(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=cssExpand[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function getWindow(e){return jQuery.isWindow(e)?e:e.nodeType===9&&e.defaultView}var rootjQuery,readyList,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="2.0.0-ai1ec",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(e,t){return new jQuery.fn.init(e,t,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rquickExpr=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(e,t){return t.toUpperCase()},completed=function(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(e,t,n){var r,i;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?r=[null,e,null]:r=rquickExpr.exec(e);if(r&&(r[1]||!t)){if(r[1]){t=t instanceof jQuery?t[0]:t,jQuery.merge(this,jQuery.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:document,!0));if(rsingleTag.test(r[1])&&jQuery.isPlainObject(t))for(r in t)jQuery.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=document.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=document,this.selector=e,this}return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):jQuery.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),jQuery.makeArray(e,this))},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=jQuery.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return jQuery.each(this,e,t)},ready:function(e){return jQuery.ready.promise().done(e),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},map:function(e){return this.pushStack(jQuery.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[1]||{},u=2),typeof o!="object"&&!jQuery.isFunction(o)&&(o={}),a===u&&(o=this,--u);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=jQuery.extend(f,s,r)):r!==undefined&&(o[t]=r)}return o},jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(e){return window.$===jQuery&&(window.$=_$),e&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(e){e?jQuery.readyWait++:jQuery.ready(!0)},ready:function(e){if(e===!0?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=!0;if(e!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready")},isFunction:function(e){return jQuery.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?class2type[core_toString.call(e)]||"object":typeof e},isPlainObject:function(e){if(jQuery.type(e)!=="object"||e.nodeType||jQuery.isWindow(e))return!1;try{if(e.constructor&&!core_hasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=rsingleTag.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=jQuery.buildFragment([e],t,i),i&&jQuery(i).remove(),jQuery.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||typeof e!="string")return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(code.indexOf("use strict")===1?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(e){return e.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":core_trim.call(e)},makeArray:function(e,t){var n=t||[];return e!=null&&(isArraylike(Object(e))?jQuery.merge(n,typeof e=="string"?[e]:e):core_push.call(n,e)),n},inArray:function(e,t,n){return t==null?-1:core_indexOf.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if(typeof n=="number")for(;i<n;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),r!=null&&(u[u.length]=r);return core_concat.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),jQuery.isFunction(e)?(r=core_slice.call(arguments,2),i=function(){return e.apply(t||this,r.concat(core_slice.call(arguments)))},i.guid=e.guid=e.guid||jQuery.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(jQuery.type(n)==="object"){i=!0;for(u in n)jQuery.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,jQuery.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(jQuery(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),jQuery.ready.promise=function(e){return readyList||(readyList=jQuery.Deferred(),document.readyState==="complete"?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(e)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){class2type["[object "+t+"]"]=t.toLowerCase()}),rootjQuery=jQuery(document),function(e,t){function it(e){return Q.test(e+"")}function st(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[y]=!0,e}function ut(e){var t=c.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function at(e,t,n,r){var i,s,o,u,a,f,h,v,m,E;(t?t.ownerDocument||t:b)!==c&&l(t),t=t||c,n=n||[];if(!e||typeof e!="string")return n;if((u=t.nodeType)!==1&&u!==9)return[];if(p&&!r){if(i=G.exec(e))if(o=i[1]){if(u===9){s=t.getElementById(o);if(!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&g(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return D.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&w.getElementsByClassName&&t.getElementsByClassName)return D.apply(n,t.getElementsByClassName(o)),n}if(w.qsa&&(!d||!d.test(e))){v=h=y,m=t,E=u===9&&e;if(u===1&&t.nodeName.toLowerCase()!=="object"){f=vt(e),(h=t.getAttribute("id"))?v=h.replace(et,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",a=f.length;while(a--)f[a]=v+mt(f[a]);m=X.test(e)&&t.parentNode||t,E=f.join(",")}if(E)try{return D.apply(n,m.querySelectorAll(E)),n}catch(S){}finally{h||t.removeAttribute("id")}}}return Tt(e.replace(U,"$1"),t,n,r)}function ft(e,t){var n=t&&e,r=n&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}function ct(e,n,r){var i;return r?t:i=e.getAttribute(n,n.toLowerCase()==="type"?1:2)}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function dt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(e,t){var n,r,s,o,u,a,f,l=T[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=z.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=W.exec(u))n=r.shift(),s.push({value:n,type:r[0].replace(U," ")}),u=u.slice(n.length);for(o in i.filter)(r=K[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(n=r.shift(),s.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?at.error(e):T(e,a).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function gt(e,t,n){var i=t.dir,s=n&&i==="parentNode",o=S++;return t.first?function(t,n,r){while(t=t[i])if(t.nodeType===1||s)return e(t,n,r)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[i])if(t.nodeType===1||s)if(e(t,n,u))return!0}else while(t=t[i])if(t.nodeType===1||s){l=t[y]||(t[y]={});if((f=l[i])&&f[0]===c){if((a=f[1])===!0||a===r)return a===!0}else{f=l[i]=[c],f[1]=e(t,n,u)||r;if(f[1]===!0)return!0}}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function wt(e,t,n,r,i,s){return r&&!r[y]&&(r=wt(r)),i&&!i[y]&&(i=wt(i,s)),ot(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||xt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?bt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=bt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?H.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=bt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):D.apply(o,g)})}function Et(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],f=o?1:0,l=gt(function(e){return e===t},u,!0),c=gt(function(e){return H.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==a)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;f<s;f++)if(n=i.relative[e[f].type])h=[gt(yt(h),n)];else{n=i.filter[e[f].type].apply(null,e[f].matches);if(n[y]){r=++f;for(;r<s;r++)if(i.relative[e[r].type])break;return wt(f>1&&yt(h),f>1&&mt(e.slice(0,f-1)).replace(U,"$1"),n,f<r&&Et(e.slice(f,r)),r<s&&Et(e=e.slice(r)),r<s&&mt(e))}h.push(n)}return yt(h)}function St(e,t){var n=0,s=t.length>0,o=e.length>0,u=function(u,f,l,h,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=p!=null,x=a,T=u||o&&i.find.TAG("*",p&&f.parentNode||f),N=E+=x==null?1:Math.random()||.1;S&&(a=f!==c&&f,r=n);for(;(d=T[b])!=null;b++){if(o&&d){v=0;while(m=e[v++])if(m(d,f,l)){h.push(d);break}S&&(E=N,r=++n)}s&&((d=!m&&d)&&y--,u&&w.push(d))}y+=b;if(s&&b!==y){v=0;while(m=t[v++])m(w,g,f,l);if(u){if(y>0)while(b--)!w[b]&&!g[b]&&(g[b]=M.call(h));g=bt(g)}D.apply(h,g),S&&!u&&g.length>0&&y+t.length>1&&at.uniqueSort(h)}return S&&(E=N,a=x),w};return s?ot(u):u}function xt(e,t,n){var r=0,i=t.length;for(;r<i;r++)at(e,t[r],n);return n}function Tt(e,t,n,r){var s,o,a,f,l,c=vt(e);if(!r&&c.length===1){o=c[0]=c[0].slice(0);if(o.length>2&&(a=o[0]).type==="ID"&&t.nodeType===9&&p&&i.relative[o[1].type]){t=(i.find.ID(a.matches[0].replace(tt,nt),t)||[])[0];if(!t)return n;e=e.slice(o.shift().value.length)}s=K.needsContext.test(e)?0:o.length;while(s--){a=o[s];if(i.relative[f=a.type])break;if(l=i.find[f])if(r=l(a.matches[0].replace(tt,nt),X.test(o[0].type)&&t.parentNode||t)){o.splice(s,1),e=r.length&&mt(o);if(!e)return D.apply(n,r),n;break}}}return u(e,c)(r,t,!p,n,X.test(e)),n}function Nt(){}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y="sizzle"+ -(new Date),b=e.document,w={},E=0,S=0,x=st(),T=st(),N=st(),C=!1,k=function(){return 0},L=typeof t,A=1<<31,O=[],M=O.pop,_=O.push,D=O.push,P=O.slice,H=O.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",I=F.replace("w","w#"),q="\\["+j+"*("+F+")"+j+"*(?:([*^$|!~]?=)"+j+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+I+")|)|)"+j+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+q.replace(3,8)+")*)|.*)\\)|)",U=new RegExp("^"+j+"+|((?:^|[^\\\\])(?:\\\\.)*)"+j+"+$","g"),z=new RegExp("^"+j+"*,"+j+"*"),W=new RegExp("^"+j+"*([>+~]|"+j+")"+j+"*"),X=new RegExp(j+"*[+~]"),V=new RegExp("="+j+"*([^\\]'\"]*)"+j+"*\\]","g"),$=new RegExp(R),J=new RegExp("^"+I+"$"),K={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+j+"*(even|odd|(([+-]|)(\\d*)n|)"+j+"*(?:([+-]|)"+j+"*(\\d+)|))"+j+"*\\)|)","i"),"boolean":new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+j+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+j+"*((?:-\\d)?\\d*)"+j+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,et=/'|\\/g,tt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,nt=function(e,t){var n="0x"+t-65536;return n!==n?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)};try{D.apply(O=P.call(b.childNodes),b.childNodes),O[b.childNodes.length].nodeType}catch(rt){D={apply:O.length?function(e,t){_.apply(e,P.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}o=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},l=at.setDocument=function(e){var n=e?e.ownerDocument||e:b;if(n===c||n.nodeType!==9||!n.documentElement)return c;c=n,h=n.documentElement,p=!o(n),w.getElementsByTagName=ut(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),w.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),w.sortDetached=ut(function(e){return e.compareDocumentPosition(c.createElement("div"))&1}),w.getById=ut(function(e){return h.appendChild(e).id=y,!n.getElementsByName||!n.getElementsByName(y).length}),w.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==L&&p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(tt,nt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==L&&p){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==L&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(tt,nt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=w.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},i.find.CLASS=w.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==L&&p)return t.getElementsByClassName(e)},v=[],d=[];if(w.qsa=it(n.querySelectorAll))ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+j+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var t=c.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+j+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")});return(w.matchesSelector=it(m=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ut(function(e){w.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",R)}),d=d.length&&new RegExp(d.join("|")),v=v.length&&new RegExp(v.join("|")),g=it(h.contains)||h.compareDocumentPosition?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=h.compareDocumentPosition?function(e,t){if(e===t)return C=!0,0;var r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);if(r)return r&1||!w.sortDetached&&t.compareDocumentPosition(e)===r?e===n||g(b,e)?-1:t===n||g(b,t)?1:f?H.call(f,e)-H.call(f,t):0:r&4?-1:1;return e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return C=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:f?H.call(f,e)-H.call(f,t):0;if(s===o)return ft(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ft(u[i],a[i]):u[i]===b?-1:a[i]===b?1:0},c},at.matches=function(e,t){return at(e,null,null,t)},at.matchesSelector=function(e,t){(e.ownerDocument||e)!==c&&l(e),t=t.replace(V,"='$1']");if(w.matchesSelector&&p&&(!v||!v.test(t))&&(!d||!d.test(t)))try{var n=m.call(e,t);if(n||w.disconnectedMatch||e.document&&e.document.nodeType!==11)return n}catch(r){}return at(t,c,null,[e]).length>0},at.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},at.attr=function(e,n){(e.ownerDocument||e)!==c&&l(e);var r=i.attrHandle[n.toLowerCase()],s=r&&r(e,n,!p);return s===t?w.attributes||!p?e.getAttribute(n):(s=e.getAttributeNode(n))&&s.specified?s.value:null:s},at.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},at.uniqueSort=function(e){var t,n=[],r=0,i=0;C=!w.detectDuplicates,f=!w.sortStable&&e.slice(0),e.sort(k);if(C){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return e},s=at.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r];r++)n+=s(t);else if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue;return n},i=at.selectors={cacheLength:50,createPseudo:ot,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(tt,nt),e[3]=(e[4]||e[5]||"").replace(tt,nt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&at.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return K.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&$.test(n)&&(t=vt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(tt,nt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+j+")"+e+"("+j+"|$)"))&&x(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),b=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&b){l=m[y]||(m[y]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[E,p,h];break}}else if(b&&(f=(t[y]||(t[y]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){b&&((c[y]||(c[y]={}))[e]=[E,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);return r[y]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=H.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=u(e.replace(U,"$1"));return r[y]?ot(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ot(function(e){return function(t){return at(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:ot(function(e){return J.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(tt,nt).toLowerCase(),function(t){var n;do if(n=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return Y.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[n<0?n+t:n]}),even:dt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=pt(n);u=at.compile=function(e,t){var n,r=[],i=[],s=N[e+" "];if(!s){t||(t=vt(e)),n=t.length;while(n--)s=Et(t[n]),s[y]?r.push(s):i.push(s);s=N(e,St(i,r))}return s},i.pseudos.nth=i.pseudos.eq,Nt.prototype=i.filters=i.pseudos,i.setFilters=new Nt,w.sortStable=y.split("").sort(k).join("")===y,l(),[0,0].sort(k),w.detectDuplicates=C,ut(function(e){e.innerHTML="<a href='#'></a>";if(e.firstChild.getAttribute("href")!=="#"){var t="type|href|height|width".split("|"),n=t.length;while(n--)i.attrHandle[t[n]]=ct}}),ut(function(e){if(e.getAttribute("disabled")!=null){var t=B.split("|"),n=t.length;while(n--)i.attrHandle[t[n]]=lt}}),jQuery.find=at,jQuery.expr=at.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=at.uniqueSort,jQuery.text=at.getText,jQuery.isXMLDoc=at.isXML,jQuery.contains=at.contains}(window);var optionsCache={};jQuery.Callbacks=function(e){e=typeof e=="string"?optionsCache[e]||createOptions(e):jQuery.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){t=e.memory&&c,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){jQuery.each(t,function(t,n){var r=jQuery.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&jQuery.each(arguments,function(e,t){var n;while((n=jQuery.inArray(t,u,n))>-1)u.splice(n,1),r&&(n<=s&&s--,n<=o&&o--)}),this},has:function(e){return e?jQuery.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],u&&(!n||a)&&(r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},jQuery.extend({Deferred:function(e){var t=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(t,function(t,s){var o=s[0],u=jQuery.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?jQuery.extend(e,r):r}},i={};return r.pipe=r.then,jQuery.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=core_slice.call(arguments),r=n.length,i=r!==1||e&&jQuery.isFunction(e.promise)?r:0,s=i===1?e:jQuery.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?core_slice.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&jQuery.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),jQuery.support=function(e){var t=document.createElement("input"),n=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("select"),s=i.appendChild(document.createElement("option"));return t.type?(t.type="checkbox",e.checkOn=t.value!=="",e.optSelected=s.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,t.checked=!0,e.noCloneChecked=t.cloneNode(!0).checked,i.disabled=!0,e.optDisabled=!s.disabled,t=document.createElement("input"),t.value="t",t.type="radio",e.radioValue=t.value==="t",t.setAttribute("checked","t"),t.setAttribute("name","t"),n.appendChild(t),e.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in window,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle=r.style.backgroundClip==="content-box",jQuery(function(){var t,n,i="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",s=document.getElementsByTagName("body")[0];if(!s)return;t=document.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(t).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",jQuery.swap(s,s.style.zoom!=null?{zoom:1}:{},function(){e.boxSizing=r.offsetWidth===4}),window.getComputedStyle&&(e.pixelPosition=(window.getComputedStyle(r,null)||{}).top!=="1%",e.boxSizingReliable=(window.getComputedStyle(r,null)||{width:"4px"}).width==="4px",n=r.appendChild(document.createElement("div")),n.style.cssText=r.style.cssText=i,n.style.marginRight=n.style.width="0",r.style.width="1px",e.reliableMarginRight=!parseFloat((window.getComputedStyle(n,null)||{}).marginRight)),s.removeChild(t)}),e):e}({});var data_user,data_priv,rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;Data.uid=1,Data.accepts=function(e){return e.nodeType?e.nodeType===1||e.nodeType===9:!0},Data.prototype={key:function(e){if(!Data.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=Data.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,jQuery.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if(typeof t=="string")s[t]=n;else if(jQuery.isEmptyObject(s))this.cache[i]=t;else for(r in t)s[r]=t[r]},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){return t===undefined||t&&typeof t=="string"&&n===undefined?this.get(e,t):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i=this.key(e),s=this.cache[i];if(t===undefined)this.cache[i]={};else{jQuery.isArray(t)?r=t.concat(t.map(jQuery.camelCase)):t in s?r=[t]:(r=jQuery.camelCase(t),r=r in s?[r]:r.match(core_rnotwhite)||[]),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!jQuery.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){delete this.cache[this.key(e)]}},data_user=new Data,data_priv=new Data,jQuery.extend({acceptData:Data.accepts,hasData:function(e){return data_user.hasData(e)||data_priv.hasData(e)},data:function(e,t,n){return data_user.access(e,t,n)},removeData:function(e,t){data_user.remove(e,t)},_data:function(e,t,n){return data_priv.access(e,t,n)},_removeData:function(e,t){data_priv.remove(e,t)}}),jQuery.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length){o=data_user.get(i);if(i.nodeType===1&&!data_priv.get(i,"hasDataAttrs")){n=i.attributes;for(;s<n.length;s++)r=n[s].name,r.indexOf("data-")===0&&(r=jQuery.camelCase(r.substring(5)),dataAttr(i,r,o[r]));data_priv.set(i,"hasDataAttrs",!0)}}return o}return typeof e=="object"?this.each(function(){data_user.set(this,e)}):jQuery.access(this,function(t){var n,r=jQuery.camelCase(e);if(i&&t===undefined){n=data_user.get(i,e);if(n!==undefined)return n;n=data_user.get(i,r);if(n!==undefined)return n;n=dataAttr(i,r,undefined);if(n!==undefined)return n;return}this.each(function(){var n=data_user.get(this,r);data_user.set(this,r,t),e.indexOf("-")!==-1&&n!==undefined&&data_user.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){data_user.remove(this,e)})}}),jQuery.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=data_priv.get(e,t),n&&(!r||jQuery.isArray(n)?r=data_priv.access(e,t,jQuery.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=jQuery.queue(e,t),r=n.length,i=n.shift(),s=jQuery._queueHooks(e,t),o=function(){jQuery.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),s.cur=i,i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return data_priv.get(e,n)||data_priv.access(e,n,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(e,[t+"queue",n])})})}}),jQuery.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?jQuery.queue(this[0],e):t===undefined?this:this.each(function(){var n=jQuery.queue(this,e,t);jQuery._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,e)})},dequeue:function(e){return this.each(function(){jQuery.dequeue(this,e)})},delay:function(e,t){return e=jQuery.fx?jQuery.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=jQuery.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=data_priv.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var nodeHook,boolHook,rclass=/[\t\r\n]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({attr:function(e,t){return jQuery.access(this,jQuery.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){jQuery.removeAttr(this,e)})},prop:function(e,t){return jQuery.access(this,jQuery.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[jQuery.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=typeof e=="string"&&e;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).addClass(e.call(this,t,this.className))});if(a){t=(e||"").match(core_rnotwhite)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=jQuery.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=arguments.length===0||typeof e=="string"&&e;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).removeClass(e.call(this,t,this.className))});if(a){t=(e||"").match(core_rnotwhite)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?jQuery.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return jQuery.isFunction(e)?this.each(function(n){jQuery(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=jQuery(this),u=t,a=e.match(core_rnotwhite)||[];while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n===core_strundefined||n==="boolean")this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||e===!1?"":data_priv.get(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(rclass," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=jQuery.valHooks[i.type]||jQuery.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(rreturn,""):n==null?"":n);return}return r=jQuery.isFunction(e),this.each(function(n){var i,s=jQuery(this);if(this.nodeType!==1)return;r?i=e.call(this,n,s.val()):i=e,i==null?i="":typeof i=="number"?i+="":jQuery.isArray(i)&&(i=jQuery.map(i,function(e){return e==null?"":e+""})),t=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),jQuery.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(jQuery.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!jQuery.nodeName(n.parentNode,"optgroup"))){t=jQuery(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=jQuery.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=jQuery.inArray(jQuery(r).val(),s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===core_strundefined)return jQuery.prop(e,t,n);if(s!==1||!jQuery.isXMLDoc(e))t=t.toLowerCase(),r=jQuery.attrHooks[t]||(jQuery.expr.match.boolean.test(t)?boolHook:nodeHook);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=jQuery.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);jQuery.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(core_rnotwhite);if(s&&e.nodeType===1)while(n=s[i++])r=jQuery.propFix[n]||n,jQuery.expr.match.boolean.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!jQuery.support.radioValue&&t==="radio"&&jQuery.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!jQuery.isXMLDoc(e),s&&(t=jQuery.propFix[t]||t,i=jQuery.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||rfocusable.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),boolHook={set:function(e,t,n){return t===!1?jQuery.removeAttr(e,n):e.setAttribute(n,n),n}},jQuery.each(jQuery.expr.match.boolean.source.match(/\w+/g),function(e,t){var n=jQuery.expr.attrHandle[t]||jQuery.find.attr;jQuery.expr.attrHandle[t]=function(e,t,r){var i=jQuery.expr.attrHandle[t],s=r?undefined:(jQuery.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return jQuery.expr.attrHandle[t]=i,s}}),jQuery.support.optSelected||(jQuery.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(e,t){if(jQuery.isArray(t))return e.checked=jQuery.inArray(jQuery(e).val(),t)>=0}},jQuery.support.checkOn||(jQuery.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.get(e);if(!m)return;n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=jQuery.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(e){return typeof jQuery===core_strundefined||!!e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(o.elem,arguments)},o.elem=e),t=(t||"").match(core_rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p)continue;c=jQuery.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=jQuery.event.special[p]||{},l=jQuery.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&jQuery.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,(!c.setup||c.setup.call(e,r,d,o)===!1)&&e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),jQuery.event.global[p]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.hasData(e)&&data_priv.get(e);if(!m||!(a=m.events))return;t=(t||"").match(core_rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in a)jQuery.event.remove(e,p+t[f],n,r,!0);continue}c=jQuery.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],(i||v===l.origType)&&(!n||n.guid===l.guid)&&(!u||u.test(l.namespace))&&(!r||r===l.selector||r==="**"&&l.selector)&&(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&jQuery.removeEvent(e,p,m.handle),delete a[p])}jQuery.isEmptyObject(a)&&(delete m.handle,data_priv.remove(e,"events"))},trigger:function(e,t,n,r){var i,s,o,u,a,f,l,c=[n||document],h=core_hasOwn.call(e,"type")?e.type:e,p=core_hasOwn.call(e,"namespace")?e.namespace.split("."):[];s=o=n=n||document;if(n.nodeType===3||n.nodeType===8)return;if(rfocusMorph.test(h+jQuery.event.triggered))return;h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,e=e[jQuery.expando]?e:new jQuery.Event(h,typeof e=="object"&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=t==null?[e]:jQuery.makeArray(t,[e]),l=jQuery.event.special[h]||{};if(!r&&l.trigger&&l.trigger.apply(n,t)===!1)return;if(!r&&!l.noBubble&&!jQuery.isWindow(n)){u=l.delegateType||h,rfocusMorph.test(u+h)||(s=s.parentNode);for(;s;s=s.parentNode)c.push(s),o=s;o===(n.ownerDocument||document)&&c.push(o.defaultView||o.parentWindow||window)}i=0;while((s=c[i++])&&!e.isPropagationStopped())e.type=i>1?u:l.bindType||h,f=(data_priv.get(s,"events")||{})[e.type]&&data_priv.get(s,"handle"),f&&f.apply(s,t),f=a&&s[a],f&&jQuery.acceptData(s)&&f.apply&&f.apply(s,t)===!1&&e.preventDefault();return e.type=h,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(c.pop(),t)===!1)&&jQuery.acceptData(n)&&a&&jQuery.isFunction(n[h])&&!jQuery.isWindow(n)&&(o=n[a],o&&(n[a]=null),jQuery.event.triggered=h,n[h](),jQuery.event.triggered=undefined,o&&(n[a]=o)),e.result},dispatch:function(e){e=jQuery.event.fix(e);var t,n,r,i,s,o=[],u=core_slice.call(arguments),a=(data_priv.get(this,"events")||{})[e.type]||[],f=jQuery.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===!1)return;o=jQuery.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(s.namespace))e.handleObj=s,e.data=s.data,r=((jQuery.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return f.postDispatch&&f.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||e.type!=="click"){r=[];for(n=0;n<u;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?jQuery(i,this).index(a)>=0:jQuery.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},fix:function(e){if(e[jQuery.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=rmouseEvent.test(i)?this.mouseHooks:rkeyEvent.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new jQuery.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target.nodeType===3&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(e){return jQuery.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=jQuery.extend(new jQuery.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?jQuery.event.trigger(i,null,t):jQuery.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},jQuery.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},jQuery.Event=function(e,t){if(!(this instanceof jQuery.Event))return new jQuery.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?returnTrue:returnFalse):this.type=e,t&&jQuery.extend(this,t),this.timeStamp=e&&e.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){jQuery.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!jQuery.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){jQuery.event.simulate(t,e.target,jQuery.event.fix(e),!0)};jQuery.event.special[t]={setup:function(){n++===0&&document.addEventListener(e,r,!0)},teardown:function(){--n===0&&document.removeEventListener(e,r,!0)}}}),jQuery.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=returnFalse;else if(!r)return this;return i===1&&(s=r,r=function(e){return jQuery().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,jQuery(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=returnFalse),this.each(function(){jQuery.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){jQuery.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return jQuery.event.trigger(e,t,n,!0)}});var isSimple=/^.[^:#\[\.,]*$/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(e){var t,n,r,i=this.length;if(typeof e!="string")return t=this,this.pushStack(jQuery(e).filter(function(){for(r=0;r<i;r++)if(jQuery.contains(t[r],this))return!0}));n=[];for(r=0;r<i;r++)jQuery.find(e,this[r],n);return n=this.pushStack(i>1?jQuery.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t=jQuery(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++)if(jQuery.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(winnow(this,e||[],!0))},filter:function(e){return this.pushStack(winnow(this,e||[],!1))},is:function(e){return!!e&&(typeof e=="string"?rneedsContext.test(e)?jQuery(e,this.context).index(this[0])>=0:jQuery.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=rneedsContext.test(e)||typeof e!="string"?jQuery(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&jQuery.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?jQuery.unique(s):s)},index:function(e){return e?typeof e=="string"?core_indexOf.call(jQuery(e),this[0]):core_indexOf.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?jQuery(e,t):jQuery.makeArray(e&&e.nodeType?[e]:e),r=jQuery.merge(this.get(),n);return this.pushStack(jQuery.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),jQuery.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return jQuery.dir(e,"parentNode")},parentsUntil:function(e,t,n){return jQuery.dir(e,"parentNode",n)},next:function(e){return sibling(e,"nextSibling")},prev:function(e){return sibling(e,"previousSibling")},nextAll:function(e){return jQuery.dir(e,"nextSibling")},prevAll:function(e){return jQuery.dir(e,"previousSibling")},nextUntil:function(e,t,n){return jQuery.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return jQuery.dir(e,"previousSibling",n)},siblings:function(e){return jQuery.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return jQuery.sibling(e.firstChild)},contents:function(e){return jQuery.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:jQuery.merge([],e.childNodes)}},function(e,t){jQuery.fn[e]=function(n,r){var i=jQuery.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=jQuery.filter(r,i)),this.length>1&&(guaranteedUnique[e]||jQuery.unique(i),e[0]==="p"&&i.reverse()),this.pushStack(i)}}),jQuery.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?jQuery.find.matchesSelector(r,e)?[r]:[]:jQuery.find.matches(e,jQuery.grep(t,function(e){return e.nodeType===1}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9)if(e.nodeType===1){if(i&&jQuery(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.col=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(e){return jQuery.access(this,function(e){return e===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?jQuery.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&jQuery.cleanData(getAll(n)),n.parentNode&&(t&&jQuery.contains(n.ownerDocument,n)&&setGlobalEval(getAll(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++)e.nodeType===1&&(jQuery.cleanData(getAll(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return jQuery.clone(this,e,t)})},html:function(e){return jQuery.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!rnoInnerhtml.test(e)&&!wrapMap[(rtagName.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(rxhtmlTag,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(jQuery.cleanData(getAll(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=jQuery.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],s=e[t++];s&&(jQuery(this).remove(),s.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=core_concat.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,p=e[0],d=jQuery.isFunction(p);if(d||!(l<=1||typeof p!="string"||jQuery.support.checkClone||!rchecked.test(p)))return this.each(function(r){var i=c.eq(r);d&&(e[0]=p.call(this,r,i.html())),i.domManip(e,t,n)});if(l){r=jQuery.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,r.childNodes.length===1&&(r=i);if(i){s=jQuery.map(getAll(r,"script"),disableScript),o=s.length;for(;f<l;f++)u=r,f!==h&&(u=jQuery.clone(u,!0,!0),o&&jQuery.merge(s,getAll(u,"script"))),t.call(this[f],u,f);if(o){a=s[s.length-1].ownerDocument,jQuery.map(s,restoreScript);for(f=0;f<o;f++)u=s[f],rscriptType.test(u.type||"")&&!data_priv.access(u,"globalEval")&&jQuery.contains(a,u)&&(u.src?jQuery._evalUrl(u.src):jQuery.globalEval(u.textContent.replace(rcleanScript,"")))}}}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){jQuery.fn[e]=function(e){var n,r=[],i=jQuery(e),s=i.length-1,o=0;for(;o<=s;o++)n=o===s?this:this.clone(!0),jQuery(i[o])[t](n),core_push.apply(r,n.get());return this.pushStack(r)}}),jQuery.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=jQuery.contains(e.ownerDocument,e);if(!jQuery.support.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!jQuery.isXMLDoc(e)){o=getAll(u),s=getAll(e);for(r=0,i=s.length;r<i;r++)fixInput(s[r],o[r])}if(t)if(n){s=s||getAll(e),o=o||getAll(u);for(r=0,i=s.length;r<i;r++)cloneCopyEvent(s[r],o[r])}else cloneCopyEvent(e,u);return o=getAll(u,"script"),o.length>0&&setGlobalEval(o,!a&&getAll(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;l<c;l++){i=e[l];if(i||i===0)if(jQuery.type(i)==="object")jQuery.merge(p,i.nodeType?[i]:i);else if(!rhtml.test(i))p.push(t.createTextNode(i));else{s=s||h.appendChild(t.createElement("div")),o=(rtagName.exec(i)||["",""])[1].toLowerCase(),u=wrapMap[o]||wrapMap._default,s.innerHTML=u[1]+i.replace(rxhtmlTag,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.firstChild;jQuery.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}}h.textContent="",l=0;while(i=p[l++]){if(r&&jQuery.inArray(i,r)!==-1)continue;a=jQuery.contains(i.ownerDocument,i),s=getAll(h.appendChild(i),"script"),a&&setGlobalEval(s);if(n){f=0;while(i=s[f++])rscriptType.test(i.type||"")&&n.push(i)}}return h},cleanData:function(e){var t,n,r,i=e.length,s=0,o=jQuery.event.special;for(;s<i;s++){n=e[s];if(jQuery.acceptData(n)){t=data_priv.access(n);if(t)for(r in t.events)o[r]?jQuery.event.remove(n,r):jQuery.removeEvent(n,r,t.handle)}data_user.discard(n),data_priv.discard(n)}},_evalUrl:function(e){return jQuery.ajax({url:e,type:"GET",dataType:"text",async:!1,global:!1,success:jQuery.globalEval})}}),jQuery.fn.extend({wrapAll:function(e){var t;return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapAll(e.call(this,t))}):(this[0]&&(t=jQuery(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapInner(e.call(this,t))}):this.each(function(){var t=jQuery(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=jQuery.isFunction(e);return this.each(function(n){jQuery(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});var curCSS,iframe,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(e,t){return jQuery.access(this,function(e,t,n){var r,i,s={},o=0;if(jQuery.isArray(t)){r=getStyles(e),i=t.length;for(;o<i;o++)s[t[o]]=jQuery.css(e,t[o],!1,r);return s}return n!==undefined?jQuery.style(e,t,n):jQuery.css(e,t)},e,t,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(e){var t=typeof e=="boolean";return this.each(function(){(t?e:isHidden(this))?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=curCSS(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=jQuery.camelCase(t),a=e.style;t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(a,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=rrelNum.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(jQuery.css(e,t)),s="number");if(n==null||s==="number"&&isNaN(n))return;s==="number"&&!jQuery.cssNumber[u]&&(n+="px"),!jQuery.support.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)a[t]=n},css:function(e,t,n,r){var i,s,o,u=jQuery.camelCase(t);return t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(e.style,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=curCSS(e,t,r)),i==="normal"&&t in cssNormalTransform&&(i=cssNormalTransform[t]),n===""||n?(s=parseFloat(i),n===!0||jQuery.isNumeric(s)?s||0:i):i}}),curCSS=function(e,t,n){var r,i,s,o=n||getStyles(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(u===""&&!jQuery.contains(e.ownerDocument,e)&&(u=jQuery.style(e,t)),rnumnonpx.test(u)&&rmargin.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},jQuery.each(["height","width"],function(e,t){jQuery.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&rdisplayswap.test(jQuery.css(e,"display"))?jQuery.swap(e,cssShow,function(){return getWidthOrHeight(e,t,r)}):getWidthOrHeight(e,t,r)},set:function(e,n,r){var i=r&&getStyles(e);return setPositiveNumber(e,n,r?augmentWidthOrHeight(e,t,r,jQuery.support.boxSizing&&jQuery.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(e,t){if(t)return jQuery.swap(e,{display:"inline-block"},curCSS,[e,"marginRight"])}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(e,t){jQuery.cssHooks[t]={get:function(e,n){if(n)return n=curCSS(e,t),rnumnonpx.test(n)?jQuery(e).position()[t]+"px":n}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},jQuery.expr.filters.visible=function(e){return!jQuery.expr.filters.hidden(e)}),jQuery.each({margin:"",padding:"",border:"Width"},function(e,t){jQuery.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+cssExpand[r]+t]=s[r]||s[r-2]||s[0];return i}},rmargin.test(e)||(jQuery.cssHooks[e+t].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=jQuery.prop(this,"elements");return e?jQuery.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(e)&&(this.checked||!manipulation_rcheckableType.test(e))}).map(function(e,t){var n=jQuery(this).val();return n==null?null:jQuery.isArray(n)?jQuery.map(n,function(e){return{name:t.name,value:e.replace(rCRLF,"\r\n")}}):{name:t.name,value:n.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(e,t){var n,r=[],i=function(e,t){t=jQuery.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(e)||e.jquery&&!jQuery.isPlainObject(e))jQuery.each(e,function(){i(this.name,this.value)});else for(n in e)buildParams(n,e[n],t,i);return r.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),jQuery.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(e,t,n){if(typeof e!="string"&&_load)return _load.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),jQuery.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(i="POST"),o.length>0&&jQuery.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?jQuery("<div>").append(jQuery.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){jQuery.fn[t]=function(e){return this.on(t,e)}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ajaxExtend(ajaxExtend(e,jQuery.ajaxSettings),t):ajaxExtend(jQuery.ajaxSettings,e)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(e,t){function S(e,t,s,u){var f,m,g,b,E,S=t;if(y===2)return;y=2,o&&clearTimeout(o),n=undefined,i=u||"",w.readyState=e>0?4:0,f=e>=200&&e<300||e===304,s&&(b=ajaxHandleResponses(l,w,s)),b=ajaxConvert(l,b,w,f);if(f)l.ifModified&&(E=w.getResponseHeader("Last-Modified"),E&&(jQuery.lastModified[r]=E),E=w.getResponseHeader("etag"),E&&(jQuery.etag[r]=E)),e===204?S="nocontent":e===304?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g);else{g=S;if(e||!S)S="error",e<0&&(e=0)}w.status=e,w.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,w]):p.rejectWith(c,[w,S,g]),w.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[w,l,f?m:g]),d.fireWith(c,[w,S]),a&&(h.trigger("ajaxComplete",[w,l]),--jQuery.active||jQuery.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=jQuery.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?jQuery(c):jQuery.event,p=jQuery.Deferred(),d=jQuery.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(y===2){if(!s){s={};while(t=rheaders.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return y===2?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(y<2)for(t in e)v[t]=[v[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),S(0,t),this}};p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=jQuery.trim(l.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],l.crossDomain==null&&(u=rurl.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===ajaxLocParts[1]&&u[2]===ajaxLocParts[2]&&(u[3]||(u[1]==="http:"?"80":"443"))===(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=jQuery.param(l.data,l.traditional)),inspectPrefiltersOrTransports(prefilters,l,t,w);if(y===2)return w;a=l.global,a&&jQuery.active++===0&&jQuery.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rnoContent.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(ajax_rquery.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=rts.test(r)?r.replace(rts,"$1_="+ajax_nonce++):r+(ajax_rquery.test(r)?"&":"?")+"_="+ajax_nonce++)),l.ifModified&&(jQuery.lastModified[r]&&w.setRequestHeader("If-Modified-Since",jQuery.lastModified[r]),jQuery.etag[r]&&w.setRequestHeader("If-None-Match",jQuery.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)w.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,w,l)!==!1&&y!==2){b="abort";for(f in{success:1,error:1,complete:1})w[f](l[f]);n=inspectPrefiltersOrTransports(transports,l,t,w);if(!n)S(-1,"No Transport");else{w.readyState=1,a&&h.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){w.abort("timeout")},l.timeout));try{y=1,n.send(m,S)}catch(E){if(!(y<2))throw E;S(-1,E)}}return w}return w.abort()},getJSON:function(e,t,n){return jQuery.get(e,t,n,"json")},getScript:function(e,t){return jQuery.get(e,undefined,t,"script")}}),jQuery.each(["get","post"],function(e,t){jQuery[t]=function(e,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),jQuery.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return jQuery.globalEval(e),e}}}),jQuery.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),jQuery.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=jQuery("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i(e.type==="error"?404:200,e.type)}),document.head.appendChild(t[0])},abort:function(){n&&n()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[e]=!0,e}}),jQuery.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(rjsonp.test(e.url)?"url":typeof e.data=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp")return r=e.jsonpCallback=jQuery.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(rjsonp,"$1"+r):e.jsonp!==!1&&(e.url+=(ajax_rquery.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||jQuery.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=window[r],window[r]=function(){s=arguments},n.always(function(){window[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,oldCallbacks.push(r)),s&&jQuery.isFunction(i)&&i(s[0]),s=i=undefined}),"script"}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrSupported=jQuery.ajaxSettings.xhr(),xhrSuccessStatus={0:200,1223:204},xhrId=0,xhrCallbacks={};window.ActiveXObject&&jQuery(window).on("unload",function(){for(var e in xhrCallbacks)xhrCallbacks[e]();xhrCallbacks=undefined}),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,jQuery.support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(e){var t;if(jQuery.support.cors||xhrSupported&&!e.crossDomain)return{send:function(n,r){var i,s,o=e.xhr();o.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete xhrCallbacks[s],t=o.onload=o.onerror=null,e==="abort"?o.abort():e==="error"?r(o.status||404,o.statusText):r(xhrSuccessStatus[o.status]||o.status,o.statusText,typeof o.responseText=="string"?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=xhrCallbacks[s=xhrId++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=rfxnum.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(jQuery.cssNumber[e]?"":"px");if(r!=="px"&&u){u=jQuery.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,jQuery.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(e,t){jQuery.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],tweeners[n]=tweeners[n]||[],tweeners[n].unshift(t)},prefilter:function(e,t){t?animationPrefilters.unshift(e):animationPrefilters.push(e)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(jQuery.cssNumber[n]?"":"px")},cur:function(){var e=Tween.propHooks[this.prop];return e&&e.get?e.get(this):Tween.propHooks._default.get(this)},run:function(e){var t,n=Tween.propHooks[this.prop];return this.options.duration?this.pos=t=jQuery.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=jQuery.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){jQuery.fx.step[e.prop]?jQuery.fx.step[e.prop](e):e.elem.style&&(e.elem.style[jQuery.cssProps[e.prop]]!=null||jQuery.cssHooks[e.prop])?jQuery.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},jQuery.each(["toggle","show","hide"],function(e,t){var n=jQuery.fn[t];jQuery.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(genFx(t,!0),e,r,i)}}),jQuery.fn.extend({fadeTo:function(e,t,n,r){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=jQuery.isEmptyObject(e),s=jQuery.speed(t,n,r),o=function(){var t=Animation(this,jQuery.extend({},e),s);o.finish=function(){t.stop(!0)},(i||data_priv.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=jQuery.timers,o=data_priv.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rrun.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&jQuery.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=data_priv.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=jQuery.timers,o=r?r.length:0;n.finish=!0,jQuery.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){jQuery.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),jQuery.speed=function(e,t,n){var r=e&&typeof e=="object"?jQuery.extend({},e):{complete:n||!n&&t||jQuery.isFunction(e)&&e,duration:e,easing:n&&t||t&&!jQuery.isFunction(t)&&t};r.duration=jQuery.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in jQuery.fx.speeds?jQuery.fx.speeds[r.duration]:jQuery.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){jQuery.isFunction(r.old)&&r.old.call(this),r.queue&&jQuery.dequeue(this,r.queue)},r},jQuery.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var e,t=jQuery.timers,n=0;fxNow=jQuery.now();for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(e){e()&&jQuery.timers.push(e)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(e){return jQuery.grep(jQuery.timers,function(t){return e===t.elem}).length}),jQuery.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){jQuery.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(!s)return;return t=s.documentElement,jQuery.contains(t,r)?(typeof r.getBoundingClientRect!==core_strundefined&&(i=r.getBoundingClientRect()),n=getWindow(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},jQuery.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=jQuery.css(e,"position"),c=jQuery(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=jQuery.css(e,"top"),a=jQuery.css(e,"left"),f=(l==="absolute"||l==="fixed")&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),jQuery.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},jQuery.fn.extend({position:function(){if(!this[0])return;var e,t,n=this[0],r={top:0,left:0};return jQuery.css(n,"position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),jQuery.nodeName(e[0],"html")||(r=e.offset()),r.top+=jQuery.css(e[0],"borderTopWidth",!0),r.left+=jQuery.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-jQuery.css(n,"marginTop",!0),left:t.left-r.left-jQuery.css(n,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||docElem;while(e&&!jQuery.nodeName(e,"html")&&jQuery.css(e,"position")==="static")e=e.offsetParent;return e||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;jQuery.fn[e]=function(r){return jQuery.access(this,function(e,r,i){var s=getWindow(e);if(i===undefined)return s?s[t]:e[r];s?s.scrollTo(n?window.pageXOffset:i,n?i:window.pageYOffset):e[r]=i},e,r,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(e,t){jQuery.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){jQuery.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return jQuery.access(this,function(t,n,r){var i;return jQuery.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?jQuery.css(t,n,o):jQuery.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,typeof window=="object"&&typeof window.document=="object"&&(window.jQuery=window.$=jQuery)}(window),jQuery.noConflict(!0)});

==================================================
FILE PATH: ./public/js/libs/collapse_helper.js
==================================================
timely.define(["jquery_timely","domReady","external_libs/bootstrap/transition","external_libs/bootstrap/collapse"],function(e,t){t(function(){e(document).on("click",'[data-toggle="ai1ec-collapse"]',function(){e(this).toggleClass("ai1ec-active"),e(".ai1ec-fa-caret-down, .ai1ec-fa-caret-up, .ai1ec-fa-chevron-down, .ai1ec-fa-chevron-up, .ai1ec-fa-arrow-down, .ai1ec-fa-arrow-up",this).toggleClass("ai1ec-hide")})})});

==================================================
FILE PATH: ./public/js/libs/tags_select.js
==================================================
timely.define(["jquery_timely","external_libs/select2"],function(e){var t=function(t){typeof t=="undefined"&&(t=e(document)),e(".ai1ec-tags-selector",t).each(function(){var t=e(this);t.select2({tags:t.data("ai1ecTags"),tokenSeparators:[","]})})},n=function(t){e(".ai1ec-tags-selector.select2-container",t).each(function(){e(this).data("select2").resizeSearch()})};return{init:t,refresh:n}});

==================================================
FILE PATH: ./public/js/libs/twig.js
==================================================
timely.define(["external_libs/twig"],function(e){return e.extendFunction("ai1ec_disable_content_output",function(){}),e});

==================================================
FILE PATH: ./public/js/libs/gmaps.js
==================================================
timely.define(["ai1ec_config"],function(e){var t=e.language,n=e.google_maps_api_key,r="async!https://maps.googleapis.com/maps/api/js?language="+t;return""!=n&&(r=r+"&key="+n),function(e){typeof google=="object"&&typeof google.maps=="object"?e():timely.require([r],e)}});

==================================================
FILE PATH: ./public/js/libs/frontend_utils.js
==================================================
timely.define([],function(){var e=function(e){var t,n;t=function(e){if(/&[^;]+;/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.firstChild?t.firstChild.nodeValue:e}return e};if(typeof e=="string")return t(e);if(typeof e=="object")for(n in e)typeof e[n]=="string"&&(e[n]=t(e[n]));return e},t=function(e,t,n){var r,i,s,o,u;if("#"===e.charAt(0)||"?"===e.charAt(0))e=e.substring(1);r={},e=e.split(t);for(i=0;i<e.length;i++)o=e[i].trim(),-1!==(u=o.indexOf(n))?(s=o.substring(0,u).trim(),o=o.substring(u+1).trim()):(s=o,o=!0),r[s]=o;return r},n=function(e){var n,r,i,s,o;e=t(e,"&","="),i=Object.keys(e),n={ai1ec:{},action:"month"};for(r=0;r<i.length;r++)if("ai1ec"===i[r]){var u=t(e[i[r]],"|",":");for(s in u)if(""!==u[s]){if("action"===s||"view"===s)n.action=u[s];n.ai1ec[s]=u[s]}}else"ai1ec_"===i[r].substring(0,6)?n.ai1ec[i[r].substring(6)]=e[i[r]]:n[i[r]]=e[i[r]];"ai1ec_"!==n.action.substring(0,6)&&(n.action="ai1ec_"+n.action),o="action="+n.action+"&ai1ec=";for(s in n.ai1ec)n.ai1ec.hasOwnProperty(s)&&(o+=escape(s)+":"+escape(n.ai1ec[s])+"|");o=o.substring(0,o.length-1);for(s in n)"ai1ec"!==s&&"action"!==s&&(o+="&"+s+"="+escape(n[s]));return o};return{ai1ec_convert_entities:e,ai1ec_map_internal_query:n,ai1ec_tokenize_uri:t}});

==================================================
FILE PATH: ./public/js/libs/captcha/recaptcha.js
==================================================
timely.define(["jquery_timely","//www.google.com/recaptcha/api.js"],function(e){var t=!1,n=function(){return"undefined"!=typeof Recaptcha},r=function(n){Recaptcha.create(n.key,n.object,{theme:"white",callback:function(){e(i(),n.captcha_object).attr("placeholder",n.placeholder),n.captcha_object.removeClass("ai1ec-initializing").addClass("ai1ec-initialized"),t=!0}}),n.captcha_object.addClass("ai1ec-initializing")},i=function(){return"#recaptcha_response_field"},s=function(t){e(i(),t).length&&n()&&Recaptcha.reload()},o=function(t){e(".ai1ec-recaptcha",t).removeClass("ai1ec-initializing ai1ec-initialized"),Recaptcha.destroy()},u=function(){if(!t)return!0;var n=e(i());return n.val().length>0};return{is_ready:n,init:r,get_field_name:i,reload:s,destroy:o,check_field:u}});

==================================================
FILE PATH: ./public/js/libs/captcha/nocaptcha.js
==================================================
timely.define(["jquery_timely","//www.google.com/recaptcha/api.js"],function(e){var t=!1,n=!1,r={},i=function(){return"undefined"!=typeof grecaptcha},s=function(i){if(n)return;r=i,e(i.object).html("");try{grecaptcha.render(i.object,{sitekey:i.key,theme:"white",callback:function(e){t=!0}})}catch(s){grecaptcha.reset()}n=!0},o=function(){return"#g-recaptcha-response"},u=function(e){t=!1,n=!1,s(r)},a=function(e){t=!1,n=!1},f=function(){return t};return{is_ready:i,init:s,get_field_name:o,reload:u,destroy:a,check_field:f}});

==================================================
FILE PATH: ./public/js/libs/captcha/void.js
==================================================
timely.define([],function(){var e=function(){return!1},t=function(e){},n=function(){return""},r=function(e){},i=function(e){},s=function(){return!0};return{is_ready:e,init:t,get_field_name:n,reload:r,destroy:i,check_field:s}});

==================================================
FILE PATH: ./public/js/libs/captcha.js
==================================================
timely.define("libs/captcha/recaptcha",["jquery_timely","//www.google.com/recaptcha/api.js"],function(e){var t=!1,n=function(){return"undefined"!=typeof Recaptcha},r=function(n){Recaptcha.create(n.key,n.object,{theme:"white",callback:function(){e(i(),n.captcha_object).attr("placeholder",n.placeholder),n.captcha_object.removeClass("ai1ec-initializing").addClass("ai1ec-initialized"),t=!0}}),n.captcha_object.addClass("ai1ec-initializing")},i=function(){return"#recaptcha_response_field"},s=function(t){e(i(),t).length&&n()&&Recaptcha.reload()},o=function(t){e(".ai1ec-recaptcha",t).removeClass("ai1ec-initializing ai1ec-initialized"),Recaptcha.destroy()},u=function(){if(!t)return!0;var n=e(i());return n.val().length>0};return{is_ready:n,init:r,get_field_name:i,reload:s,destroy:o,check_field:u}}),timely.define("libs/captcha/nocaptcha",["jquery_timely","//www.google.com/recaptcha/api.js"],function(e){var t=!1,n=!1,r={},i=function(){return"undefined"!=typeof grecaptcha},s=function(i){if(n)return;r=i,e(i.object).html("");try{grecaptcha.render(i.object,{sitekey:i.key,theme:"white",callback:function(e){t=!0}})}catch(s){grecaptcha.reset()}n=!0},o=function(){return"#g-recaptcha-response"},u=function(e){t=!1,n=!1,s(r)},a=function(e){t=!1,n=!1},f=function(){return t};return{is_ready:i,init:s,get_field_name:o,reload:u,destroy:a,check_field:f}}),timely.define("libs/captcha/void",[],function(){var e=function(){return!1},t=function(e){},n=function(){return""},r=function(e){},i=function(e){},s=function(){return!0};return{is_ready:e,init:t,get_field_name:n,reload:r,destroy:i,check_field:s}}),timely.define("libs/captcha",["jquery_timely","libs/captcha/recaptcha","libs/captcha/nocaptcha","libs/captcha/void"],function($,$recaptcha,$nocaptcha,$void){var $provider=$void,get_provider=function(e){if("recaptcha"===e)return $recaptcha;if("nocaptcha"===e)return $nocaptcha},init_captcha=function($form){var $captcha=$(".ai1ec-captcha",$form);if($captcha.length===0)return;$provider=get_provider($captcha.data("provider"));if($captcha.data("providerConstructor")){var $callback=$captcha.data("providerConstructor");$provider=eval($callback)()}if(!$provider.is_ready()||$captcha.is(".ai1ec-initializing, .ai1ec-initialized"))return;$provider.init({key:$captcha.data("captchaKey"),object:$captcha[0],placeholder:$captcha.data("placeholder"),captcha_object:$captcha})},destroy=function(e){$provider.destroy(e)},reload=function(e){$provider.reload(e)},get_field_name=function(){return $provider.get_field_name()},check_field=function(){return $provider.check_field()};return{init_captcha:init_captcha,destroy:destroy,reload:reload,get_field_name:get_field_name,check_field:check_field}});

==================================================
FILE PATH: ./public/js/libs/utils.js
==================================================
timely.define(["jquery_timely","external_libs/bootstrap/tab"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="ai1ec-alert ai1ec-alert-danger";break;case"success":i="ai1ec-alert ai1ec-alert-success";break;default:i="ai1ec-alert ai1ec-alert-info"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<button>",{type:"button","class":"ai1ec-close","data-dismiss":"ai1ec-alert",text:""});s.prepend(o)}return s},alert:function(t,n){$document=e(document.body),$one_shot_popup=e("#ai1ec-show-popup-alert",$document),0===$one_shot_popup.length&&($div=e('<div class="timely"/>'),$div.html('<div id="ai1ec-show-popup-alert" class="timely ai1ec-modal ai1ec-fade"role="dialog" aria-hidden="true" style="display: none;"><div class="ai1ec-modal-dialog"><div class="ai1ec-modal-content"><div class="ai1ec-modal-header"><button type="button" class="ai1ec-close"data-dismiss="ai1ec-modal" aria-hidden="true"></button><h4 class="ai1ec-modal-title" id="ai1ec-one-shot-popup-title"></h4></div><div class="ai1ec-modal-body"><p id="ai1ec-one-shot-popup-text"></p></div></div></div></div>').appendTo($document),$one_shot_popup=e("#ai1ec-show-popup-alert",$document));var r=e(this).closest("a");e("#ai1ec-one-shot-popup-title",$one_shot_popup).text(t),e("#ai1ec-one-shot-popup-text",$one_shot_popup).text(n),$one_shot_popup.modal("show")},make_popup_content_link:function(t,n,r){return'<div class="timely"><a href="#" class="timely ai1ec-link"data-toggle="ai1ec-modal" data-target="#popupMoreInfoInline">'+e("<div />").text(t).html()+"</a>"+'<div id="popupMoreInfoInline" class="timely ai1ec-modal ai1ec-fade"'+'role="dialog" aria-hidden="true" style="display: none;">'+'<div class="ai1ec-modal-dialog">'+'<div class="ai1ec-modal-content">'+'<div class="ai1ec-modal-header">'+'<button type="button" class="ai1ec-close"'+'data-dismiss="ai1ec-modal" aria-hidden="true"></button>'+"<strong>"+e("<div />").text(n).html()+"</strong>"+"</div>"+'<div class="ai1ec-modal-body ai1ec-clearfix">'+'<textarea class="ai1ec-form-control code" rows="8" cols="40">'+e("<div />").text(r).html()+"</textarea>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidUrl:function(e,t){if(!0===t){var n=/^(http|https):\/\//;return n.test(e)}return!0},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},activate_saved_tab_on_page_load:function(t){null===t||undefined===t?e("ul.ai1ec-nav a:first").tab("show"):e("ul.ai1ec-nav a[href="+t+"]").tab("show")},add_query_arg:function(e,t){if("string"!=typeof e)return!1;var n=e.indexOf("?")===-1?"?":"&";return-1!==e.indexOf(n+t[0]+"=")?e:e+n+t[0]+"="+t[1]},create_ai1ec_to_send:function(t){var n=e(t),r=[],i=["action","cat_ids","auth_ids","tag_ids","exact_date","display_filters","no_navigation","events_limit"];return n.each(function(){e.each(this.attributes,function(){this.specified&&this.value&&this.name.match(/^data-/)&&(-1<e.inArray(this.name.replace(/^data\-/,""),i)||this.name.match(/_ids$/))&&r.push(this.name.replace(/^data\-/,"")+"~"+this.value)})}),r.join("|")},init_autoselect:function(){e(document).on("click",".ai1ec-autoselect",function(t){if(e(this).data("clicked")&&t.originalEvent.detail<2)return;e(this).data("clicked",!0);var n;document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(this),n.select()):window.getSelection&&(selection=window.getSelection(),n=document.createRange(),n.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(n))})}}}();return t});

==================================================
FILE PATH: ./public/js/libs/timepicker_helper.js
==================================================
timely.define(["jquery_timely","external_libs/moment","external_libs/bootstrap_timepicker"],function(e,t,n){var r=function(){var n=e(this);if(typeof n.data("timepicker")=="undefined"){if(n.val()===""){var r=t().local(),i=n.data("showMeridian")?"hh:mm A":"HH:mm";n.val(r.format(i))}n.timepicker({showMeridian:n.data("showMeridian"),showInputs:!1,defaultTime:n.val()}).on("show.timepicker",function(){n.parents(".ai1ec-collapse").addClass("ai1ec-timepicker-visible")}).on("hide.timepicker",function(){n.parents(".ai1ec-collapse").removeClass("ai1ec-timepicker-visible")});var s=n.data("timepicker").$widget;s.addClass("timely")}},i=function(t){typeof t=="undefined"&&(t=e(document)),t.on("focus",".ai1ec-timepicker",r)};return{init:i}});

==================================================
FILE PATH: ./public/js/libs/select2_multiselect_helper.js
==================================================
timely.define(["jquery_timely","external_libs/select2"],function(e){var t=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""&&(s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> '),s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},n=function(t){var n=e(t.element),r=n.data("color"),i=n.data("description"),s="";return typeof r!="undefined"&&r!==""?s+='<span class="ai1ec-color-swatch" style="background: '+n.data("color")+'"></span> ':s+='<span class="ai1ec-color-swatch-empty"></span> ',s+=t.text,s='<span title="'+i+'">'+s+"</span>",s},r=function(r){typeof r=="undefined"&&(r=e(document)),e(".ai1ec-select2-multiselect-selector",r).select2({allowClear:!0,formatResult:n,formatSelection:t,escapeMarkup:function(e){return e}})},i=function(t){e(".ai1ec-select2-multiselect-selector.select2-container",t).each(function(){e(this).data("select2").resizeSearch()})};return{init:r,refresh:i}});

==================================================
FILE PATH: ./public/js/agenda.js
==================================================
timely.define(["libs/twig","agenda"],function(e){var t,n;return t=e.twig,n=t({id:"../js_src/agenda.twig",data:[{type:"output",stack:[{type:"Twig.expression.type.variable",value:"navigation",match:["navigation"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n\n<div class="ai1ec-agenda-view'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"has_product_buy_button",match:["has_product_buy_button"]}],output:[{type:"raw",value:" ai1ec-has-product-buy-button"}]}},{type:"raw",value:'">\n	'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"dates",match:["dates"]},{type:"Twig.expression.type.test",filter:"empty"}],output:[{type:"raw",value:'		<p class="ai1ec-no-results">\n			'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_upcoming_events",match:["text_upcoming_events"]}]},{type:"raw",value:"\n		</p>\n	"}]}},{type:"logic",token:{type:"Twig.logic.type.else",match:["else"],output:[{type:"raw",value:"		"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:"date",value_var:"date_info",expression:[{type:"Twig.expression.type.variable",value:"dates",match:["dates"]}],output:[{type:"raw",value:'			<div class="ai1ec-date\n				'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"today"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:"ai1ec-today"}]}},{type:"raw",value:'">\n				<a class="ai1ec-date-title ai1ec-load-view"\n					href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"href"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n					'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"data_type",match:["data_type"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'>\n					<div class="ai1ec-month">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"month"}]},{type:"raw",value:'</div>\n					<div class="ai1ec-day">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"day"}]},{type:"raw",value:'</div>\n					<div class="ai1ec-weekday">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"weekday"}]},{type:"raw",value:"</div>\n					"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_year_in_agenda_dates",match:["show_year_in_agenda_dates"]}],output:[{type:"raw",value:'						<div class="ai1ec-year">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"year"}]},{type:"raw",value:"</div>\n					"}]}},{type:"raw",value:'				</a>\n				<div class="ai1ec-date-events">\n					'},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"category",expression:[{type:"Twig.expression.type.variable",value:"date_info",match:["date_info"]},{type:"Twig.expression.type.key.period",key:"events"}],output:[{type:"raw",value:"						"},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"event",expression:[{type:"Twig.expression.type.variable",value:"category",match:["category"]}],output:[{type:"raw",value:'							<div class="ai1ec-event\n								ai1ec-event-id-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"post_id"}]},{type:"raw",value:"\n								ai1ec-event-instance-id-"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"instance_id"}]},{type:"raw",value:"\n								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"is_allday"}],output:[{type:"raw",value:"ai1ec-allday"}]}},{type:"raw",value:"								"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"expanded",match:["expanded"]}],output:[{type:"raw",value:"ai1ec-expanded"}]}},{type:"raw",value:'"\n								'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'									data-ticket-url="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n								'}]}},{type:"raw",value:'								data-end="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"end"}]},{type:"raw",value:'">\n\n								<div class="ai1ec-event-header">\n									<div class="ai1ec-event-toggle">\n										<i class="ai1ec-fa ai1ec-fa-minus-circle ai1ec-fa-lg"></i>\n										<i class="ai1ec-fa ai1ec-fa-plus-circle ai1ec-fa-lg"></i>\n									</div>\n									<span class="ai1ec-event-title">\n										'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_title"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"show_location_in_title",match:["show_location_in_title"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<span class="ai1ec-event-location"\n												>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_venue_separator",match:["text_venue_separator"]},{type:"Twig.expression.type.filter",value:"format",match:["| format","format"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"venue"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:"</span>\n										"}]}},{type:"raw",value:"									</span>\n									"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"action_buttons",match:["action_buttons"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									"},{type:"logic",token:{type:"Twig.logic.type.set",key:"edit_post_link",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"edit_post_link"}]}},{type:"raw",value:"									"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"edit_post_link",match:["edit_post_link"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'										<a class="post-edit-link" href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"edit_post_link",match:["edit_post_link"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'">\n											<i class="ai1ec-fa ai1ec-fa-pencil"></i> '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_edit",match:["text_edit"]}]},{type:"raw",value:"\n										</a>\n									"}]}},{type:"raw",value:'\n									<div class="ai1ec-event-time">\n										 '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"timespan_short"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n									</div>\n								</div>\n\n								"},{type:"raw",value:'\n								<div class="ai1ec-event-summary '},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"expanded",match:["expanded"]}],output:[{type:"raw",value:"ai1ec-expanded"}]}},{type:"raw",value:'">\n\n									<div class="ai1ec-event-description">\n										'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"content_img_url"},{type:"Twig.expression.type.test",filter:"empty"},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'											<a class="ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"avatar_not_wrapped"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</a>\n										"}]}},{type:"raw",value:"										"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"filtered_content"},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:'\n									</div>\n\n									<div class="ai1ec-event-summary-footer">\n										<div class="ai1ec-btn-group ai1ec-actions">\n											'},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"is_ticket_button_enabled",match:["is_ticket_button_enabled"]},{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"},{type:"Twig.expression.type.operator.binary",value:"and",precidence:13,associativity:"leftToRight",operator:"and"}],output:[{type:"raw",value:'												<a class="ai1ec-pull-right ai1ec-btn ai1ec-btn-primary\n														ai1ec-btn-xs ai1ec-buy-tickets"\n													target="_blank"\n													href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'"\n													>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"ticket_url_label"}]},{type:"raw",value:"</a>\n											"}]}},{type:"raw",value:'											<a class="ai1ec-read-more ai1ec-btn ai1ec-btn-default\n												ai1ec-load-event"\n												href="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"permalink"},{type:"Twig.expression.type.filter",value:"e",match:["| e","e"],params:[{type:"Twig.expression.type.parameter.start",value:"(",match:["("]},{type:"Twig.expression.type.string",value:"html_attr"},{type:"Twig.expression.type.parameter.end",value:")",match:[")"],expression:!1}]}]},{type:"raw",value:'">\n												'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_read_more",match:["text_read_more"]}]},{type:"raw",value:' <i class="ai1ec-fa ai1ec-fa-arrow-right"></i>\n											</a>\n										</div>\n										'},{type:"logic",token:{type:"Twig.logic.type.set",key:"categories",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"categories_html"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.set",key:"tags",expression:[{type:"Twig.expression.type.variable",value:"event",match:["event"]},{type:"Twig.expression.type.key.period",key:"tags_html"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"categories",match:["categories"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'											<span class="ai1ec-categories">\n												<span class="ai1ec-field-label">\n													<i class="ai1ec-fa ai1ec-fa-folder-open"></i>\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_categories",match:["text_categories"]}]},{type:"raw",value:"\n												</span>\n												"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"categories",match:["categories"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n										"}]}},{type:"raw",value:"										"},{type:"logic",token:{type:"Twig.logic.type.if",stack:[{type:"Twig.expression.type.variable",value:"tags",match:["tags"]},{type:"Twig.expression.type.test",filter:"empty",modifier:"not"}],output:[{type:"raw",value:'											<span class="ai1ec-tags">\n												<span class="ai1ec-field-label">\n													<i class="ai1ec-fa ai1ec-fa-tags"></i>\n													'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_tags",match:["text_tags"]}]},{type:"raw",value:"\n												</span>\n												"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"tags",match:["tags"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"\n											</span>\n										"}]}},{type:"raw",value:"									</div>\n								</div>\n\n							</div>\n						"}]}},{type:"raw",value:" "},{type:"raw",value:"\n					"}]}},{type:"raw",value:" "},{type:"raw",value:"\n				</div>\n			</div>\n		"}]}},{type:"raw",value:" "},{type:"raw",value:"\n	"}]}},{type:"raw",value:" "},{type:"raw",value:'\n</div>\n\n<div class="ai1ec-pull-left">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"pagination_links",match:["pagination_links"]},{type:"Twig.expression.type.filter",value:"raw",match:["| raw","raw"]}]},{type:"raw",value:"</div>\n"}],precompiled:!0}),n});

==================================================
FILE PATH: ./public/js/async.js
==================================================
/** @license
 * RequireJS plugin for async dependency load like JSONP and Google Maps
 * Author: Miller Medeiros
 * Version: 0.1.1 (2011/11/17)
 * Released under the MIT license
 */

timely.define([],function(){function n(e){var t,n;t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)}function r(t,n){var r=/!(.+)/,i=t.replace(r,""),s=r.test(t)?t.replace(/.+!/,""):e;return i+=i.indexOf("?")<0?"?":"&",i+s+"="+n}function i(){return t+=1,"__async_req_"+t+"__"}var e="callback",t=0;return{load:function(e,t,s,o){if(o.isBuild)s(null);else{var u=i();window[u]=s,n(r(e,u))}}}});

==================================================
FILE PATH: ./readme.txt
==================================================
=== Timely All-in-One Events Calendar ===
Contributors: timelynetwork
Tags:
Requires at least: 5.0
Tested up to: 6.7.1
Stable tag: 3.0.2
Requires PHP: 7.2
License: GNU General Public License, version 3 (GPL-3.0)

Timely All-in-One Events Calendar is no longer accepting new accounts, as we begin the process of retiring it from the WordPress Plugin Directory.

== Description ==

=  Important Notice =

As of August 7, 2025, the Timely All-in-One Event Calendar plugin is no longer accepting new accounts, as we begin the process of retiring it from the WordPress Plugin Directory.

This decision was made with great care and respect for the community that has supported us for more than a decade. Since its release in 2012, the All-in-One Event Calendar has empowered hundreds of thousands of WordPress users to share events, foster connections, and strengthen communities around the world. Were deeply grateful for the role this plugin has played in your websites, organizations, and lives.

That legacy means a lot to us. But as technology evolves and user expectations grow, weve focused our development efforts in recent years on our cloud-based SaaS platform. This shift allows us to deliver a more scalable, reliable, and modern experience  while continuing to support the needs of a global audience.

=  Introducing Our New Plugin =

Looking for a new WordPress event calendar that connects directly to Timely's SaaS platform?

 Please install the new [Event Calendar Plugin for WordPress by Timely](https://wordpress.org/plugins/event-calendar-timely/).

This dedicated plugin integrates directly with Timelys cloud-based SaaS platform, providing:
* Seamless login with your existing Timely credentials
* Full compatibility with the latest WordPress and PHP versions
* Improved calendar speed and overall performance
* Optional built-in tools for event registration and ticketing
* Access to premium features, such as advanced customizations, automated workflows, AI-powered tools, and more
* Continuous updates and ongoing customer support

=  Important Information for Existing All-in-One Event Calendar Plugin Users =

Please refer to the pinned post titled ** Plugin Retirement Notice  Please Read** on the plugin's support forum for detailed instructions and next steps.

Thank you again for being part of the Timely community. We look forward to continuing to support your events  now with even better tools and experiences!

The Timely Team

== Changelog ==

= Version 3.0.2 - final =
* Final release before plugin closure
* New accounts disabled
* Users advised to install the new SaaS-based plugin

= Version 3.0.1 =
* Improve performance by avoiding the complete application reload.

= Version 3.0.0 =
* PHP version updated to 7.2 or higher.
* New event management platform for new plugin installs.

= Version 2.6.8 =
* Fixed broken pages after updating to WordPress 5.5

= Version 2.6.7 =
* Some calendars wouldn't show the current date when using month view

= Version 2.6.6 =
* Removing one more PHP 7.4 deprecation warning.

= Version 2.6.5 =
* Remove use of get_magic_quotes_gpc() for PHP 7.4

= Version 2.6.4 =
* Fixed deprecated syntax in PHP 7.4

= Version 2.6.3 =
* Fixed compatibility with PHP 7.4
* Changed memory limit checking.

= Version 2.6.2 =
* Improved stability: Code cleanup.

= Version 2.6.1 =
* Fixed: In some cases the activation page would refresh automatically.

= Version 2.6.0 =
* Added new and integrated account activation process.

== Installation ==

As of August 7, 2025, the Timely All-in-One Event Calendar plugin is no longer accepting new accounts, as we begin the process of retiring it from the WordPress Plugin Directory.

== Upgrade Notice ==

= 3.0 =
PHP version updated to 7.2 or higher, and new event management platform for new plugin installs.

= 2.0 =
If you believe you are missing functionality, please visit our site and
download the corresponding Add-on.

= 1.0.3 =
When upgrading to from below `1.0.3` you must reactivate the plugin.

